{"version":3,"sources":["components/Layout/Layout.module.css","components/Window/Window.module.css","components/Desktop/Desktop.Dock/Dock.module.css","components/Layout/RowColumn/RowColumn.module.css","components/NoWrap/NoWrap.module.css","components/Menu/Menu.jsx","components/Menu/_Menu.LibWrapper/index.jsx","components/Padding/Padding.module.css","components/modals/SystemModal/SystemModal.module.css","components/ButtonTransparent/ButtonTransparent.module.css","components/audioMeters/AudioLevelMeter/AudioLevelMeter.module.css","components/FullViewport/FullViewport.jsx","components/FullViewport/FullViewport.module.css","components/AutoScaler/AutoScaler.module.css","components/Desktop/providers/NotificationProvider/views/NotificationStack/NotificationStack.module.css","components/Desktop/providers/NotificationProvider/views/Notification/Notification.module.css","components/VirtualLink/VirtualLink.module.css","components/LED/LED.module.css","components/Toggle/Toggle.module.css","components/labeled/LabeledToggle/LabeledToggle.module.css","portals/ExamplePortal/apps/ColorAdjusterApp/ColorAdjuster.module.css","components/ObjectViewer/ObjectViewer.module.css","components/StaggeredWaveLoading/StaggeredWaveLoading.module.css","components/audioMeters/VUMeter/VUMeter.module.css","components/audioVideoRenderers/Video.module.css","components/labeled/LabeledLED/LabeledLED.module.css","components/ButtonGroup/ButtonGroup.module.css","components/Layout/Header.jsx","components/Layout/Content.jsx","components/Layout/Footer.jsx","components/Layout/RowColumn/RowColumn.jsx","components/Layout/index.jsx","components/Layout/Layout.jsx","components/Window/Window.Border.jsx","components/NoWrap/index.jsx","components/NoWrap/NoWrap.jsx","hooks/useDesktopContext.js","hooks/useUIParadigm.js","components/Window/Window.TitleBar/Window.TitleBar.Button/Window.TitleBar.Button.jsx","components/Window/Window.TitleBar/index.jsx","components/Window/Window.TitleBar/Window.TitleBar.jsx","hooks/useObjectState.js","hooks/useAppOrchestrationContext.js","components/Window/hooks/useWindowAutoPositioner/index.js","components/Window/hooks/useWindowAutoPositioner/useWindowAutoPositioner.js","components/Window/hooks/useWindowAutoPositioner/useWindowOutOfBoundsPositionCorrection.js","components/Window/hooks/__window_hook_constants__.js","utils/getElCenterPoint.js","components/Window/Window.View.jsx","components/Window/hooks/useWindowOpenAnimation.js","components/Window/hooks/useWindowAutoSizer.js","components/Window/hooks/useWindowControls.js","components/Window/hooks/useWindowDragger.js","components/Window/hooks/useWindowDragResizer.js","components/Window/hooks/useWindowStyles.js","components/Window/index.jsx","components/Window/Window.jsx","components/Window/Window.Provider.jsx","components/Desktop/Desktop.WindowManager/WindowManager.RouteProvider.jsx","components/Desktop/Desktop.WindowManager/WindowManager.jsx","components/Window/hooks/useWindowContext.js","components/Desktop/Desktop.WindowManager/hooks/useRegistrationViewOnResized.js","components/Desktop/Desktop.WindowManager/index.jsx","components/Menu/index.jsx","components/MenuBar/index.jsx","components/MenuBar/MenuBar.jsx","services/UIModalService.js","components/Padding/index.jsx","components/Padding/Padding.jsx","components/icons/CloseIcon/index.jsx","components/icons/CloseIcon/DynamicIcon.jsx","hooks/useKeyboardEvents.js","components/modals/SystemModal/SystemModal.jsx","components/modals/SystemModal/index.jsx","hooks/useViewportSize.js","components/modals/ConfirmModal/index.jsx","components/modals/ConfirmModal/ConfirmModal.jsx","components/icons/RCACableIcon/index.jsx","components/icons/RCACableIcon/DynamicIcon.jsx","components/ButtonTransparent/ButtonTransparent.jsx","components/ButtonTransparent/index.jsx","hooks/useArrayDiff.js","hooks/usePrevious.js","hooks/useMultiAudioMediaStreamTrackLevelMonitor.js","components/audioMeters/AudioLevelMeter/index.jsx","components/audioMeters/AudioLevelMeter/AudioLevelMeter.jsx","components/icons/MicrophoneIcon/index.jsx","components/icons/MicrophoneIcon/DynamicIcon.jsx","components/InputMediaDevicesSelector/subComponents/AudioInputDeviceTableRow.js","services/MediaDeviceCachingService.js","services/InputMediaDevicesService.js","components/InputMediaDevicesSelector/subHooks/useInputMediaDevicesSelectorState.js","components/InputMediaDevicesSelector/index.jsx","components/InputMediaDevicesSelector/InputMediaDevicesSelector.jsx","components/modals/InputDeviceSelectorModal/index.jsx","components/modals/InputDeviceSelectorModal/InputDeviceSelectorModal.jsx","hooks/useUUID.js","components/modals/TextInputModal/index.jsx","components/modals/TextInputModal/TextInputModal.jsx","services/UIModalWidgetService.js","components/Desktop/Desktop.TopBar/Desktop.TopBar.MenuBar/index.jsx","components/Desktop/Desktop.TopBar/Desktop.TopBar.MenuBar/DesktopMenuBar.jsx","components/Desktop/Desktop.TopBar/index.jsx","components/Desktop/Desktop.TopBar/TopBar.jsx","components/Desktop/Desktop.Dock/DockItem.jsx","components/Desktop/Desktop.Dock/index.jsx","components/Desktop/Desktop.Dock/Dock.jsx","components/FullViewport/index.jsx","components/AutoScaler/AutoScaler.jsx","components/AutoScaler/index.jsx","components/icons/InfoIcon/index.jsx","components/icons/InfoIcon/DynamicIcon.jsx","components/Desktop/providers/NotificationProvider/views/Notification/index.jsx","components/Desktop/providers/NotificationProvider/views/Notification/Notification.jsx","components/Desktop/providers/NotificationProvider/views/NotificationStack/index.jsx","components/Desktop/providers/NotificationProvider/views/NotificationStack/NotificationStack.jsx","services/UINotificationService.js","components/Desktop/providers/NotificationProvider/NotificationProvider.jsx","components/Desktop/providers/NotificationProvider/index.jsx","components/Desktop/providers/ModalProvider/views/Modal/index.jsx","components/Desktop/providers/ModalProvider/views/Modal/Modal.jsx","components/Desktop/providers/ModalProvider/views/ModalStack/index.jsx","components/Desktop/providers/ModalProvider/views/ModalStack/ModalStack.jsx","components/Desktop/providers/ModalProvider/ModalProvider.jsx","components/Desktop/providers/ModalProvider/index.jsx","components/Desktop/index.jsx","components/Desktop/Desktop.jsx","components/VirtualLink/index.jsx","components/VirtualLink/VirtualLink.jsx","components/LED/index.jsx","components/LED/LED.jsx","portals/ExamplePortal/apps/ApplicationsApp/views/ApplicationSelector.jsx","portals/ExamplePortal/apps/ApplicationsApp/views/PortalSelector.jsx","portals/ExamplePortal/apps/ApplicationsApp/ApplicationsApp.jsx","portals/ExamplePortal/apps/ApplicationsApp/index.jsx","portals/ReShell.org/apps/ApplicationsApp.jsx","components/Timer/index.jsx","components/Timer/Timer.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/AppRuntime.Table.Row.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/AppRuntime.Table.jsx","components/AppLinkButton/index.jsx","components/AppLinkButton/AppLinkButton.jsx","hooks/useAppRegistrationLink.js","portals/ExamplePortal/apps/ServiceMonitorApp.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/ApplicationMonitorApp.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/index.jsx","components/ButtonPanel/index.jsx","components/ButtonPanel/ButtonPanel.jsx","components/Toggle/index.jsx","components/Toggle/Toggle.jsx","components/labeled/LabeledToggle/index.jsx","components/labeled/LabeledToggle/LabeledToggle.jsx","components/ExternalLink/index.jsx","components/ExternalLink/ExternalLink.jsx","components/ExternalLinkButton/index.jsx","components/ExternalLinkButton/ExternalLinkButton.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Details/Details.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Details/index.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Resources/Resources.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Resources/index.jsx","utils/getCopyright.js","portals/ExamplePortal/apps/AboutReShellApp/AboutReShellApp.jsx","portals/ExamplePortal/apps/AboutReShellApp/index.jsx","portals/ReShell.org/apps/AboutReShellApp.jsx","portals/ExamplePortal/apps/CheckForUpdatesApp/CheckForUpdatesApp.jsx","portals/ExamplePortal/apps/CheckForUpdatesApp/index.jsx","portals/ExamplePortal/apps/ColorAdjusterApp/index.jsx","portals/ExamplePortal/apps/ColorAdjusterApp/ColorAdjusterApp.jsx","components/ObjectViewer/index.jsx","components/ObjectViewer/ObjectViewer.jsx","portals/ExamplePortal/apps/EnvironmentApp/EnvironmentApp.jsx","portals/ExamplePortal/apps/EnvironmentApp/index.jsx","portals/ExamplePortal/apps/SoftwareInfoApp/SoftwareInfoApp.jsx","portals/ExamplePortal/apps/SoftwareInfoApp/index.jsx","components/StaggeredWaveLoading/index.jsx","components/StaggeredWaveLoading/StaggeredWaveLoading.jsx","components/Preload/index.jsx","components/Preload/Preload.jsx","components/audioMeters/VUMeter/images/vu.png","components/audioMeters/VUMeter/images/needle.png","components/audioMeters/VUMeter/index.jsx","components/audioMeters/VUMeter/VUMeter.jsx","portals/ExamplePortal/apps/VUMeterApp/VUMeterApp.jsx","portals/ExamplePortal/apps/VUMeterApp/index.jsx","components/audioVideoRenderers/AVBase.jsx","components/audioVideoRenderers/Video.jsx","services/ScreenCapturerService.js","portals/ExamplePortal/apps/ScreenCaptureApp/ScreenCaptureApp.jsx","hooks/useGetIsUnmounting.js","portals/ExamplePortal/apps/ScreenCaptureApp/index.jsx","portals/ExamplePortal/apps/InputMediaDevicesApp/InputMediaDevicesApp.jsx","portals/ExamplePortal/apps/InputMediaDevicesApp/index.jsx","utils/bytesToSize.js","portals/ExamplePortal/apps/MemoryInfoApp/index.jsx","portals/ExamplePortal/apps/MemoryInfoApp/MemoryInfoApp.jsx","portals/ExamplePortal/apps/KeyVaultApp/views/LocalStorageItems/index.jsx","portals/ExamplePortal/apps/KeyVaultApp/views/LocalStorageItems/LocalStorageItems.jsx","utils/getFormValues.js","components/Form/index.jsx","components/Form/Form.jsx","components/Form/hooks/useFormController.js","portals/ExamplePortal/apps/KeyVaultApp/views/KeyEditorForm.jsx","components/icons/BackArrowIcon/index.jsx","components/icons/BackArrowIcon/DynamicIcon.jsx","portals/ExamplePortal/apps/KeyVaultApp/KeyVaultApp.jsx","portals/ExamplePortal/apps/KeyVaultApp/index.jsx","portals/ExamplePortal/apps/AppRegistrationViewerApp/AppRegistrationViewerApp.jsx","portals/ExamplePortal/apps/AppRegistrationViewerApp/index.jsx","components/labeled/LabeledLED/LabeledLED.jsx","components/ButtonGroup/index.jsx","components/ButtonGroup/ButtonGroup.jsx","services/DesktopCommanderControllerService/commands.js","services/DesktopCommanderControllerService/DesktopCommanderControllerService.js","services/DesktopCommanderControllerService/index.js","portals/ExamplePortal/apps/DesktopCommanderDebuggerApp/DesktopCommanderDebuggerApp.jsx","portals/ExamplePortal/apps/DesktopCommanderDebuggerApp/index.jsx","portals/HackathonPortal/services/MesaSpeechRecognizerService/MesaSpeechRecognizer.js","portals/HackathonPortal/services/MesaSubscriptionKeyManagementService.js","portals/HackathonPortal/services/MesaSpeechRecognizerService/MesaSpeechRecognizerService.js","portals/HackathonPortal/services/MesaSpeechRecognizerService/index.js","portals/HackathonPortal/services/MesaSpeechDesktopControllerService.js","portals/HackathonPortal/apps/MesaSpeechRecognitionDebuggerApp/MesaSpeechRecognitionDebuggerApp.jsx","portals/HackathonPortal/apps/MesaSpeechRecognitionDebuggerApp/index.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/components/Footer/index.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/components/Footer/Footer.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/views/WithoutRecognizer/index.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/views/WithoutRecognizer/WithoutRecognizer.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/index.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/SpeechCommanderApp.jsx","portals/ReShell.org/index.jsx","portals/ReShell.org/ReShell.org.jsx"],"names":["module","exports","Menu","menuStructure","opened","onOpen","onClose","rest","refAnchor","useRef","useEffect","window","addEventListener","removeEventListener","ref","className","classNames","onMouseDown","setImmediate","disabled","label","role","anchorRef","state","current","portal","xChildren","children","submenu","item","type","push","length","onClick","click","checked","COMMON_PROPS","overflow","ControlledMenu","applyHOC","LibControlledMenu","SubMenu","applyStatics","LibSubMenu","FullViewport","useState","elContainer","setElContainer","document","documentElement","classList","add","styles","body","handleResize","style","height","innerHeight","scrollTop","remove","Header","Full","Content","Footer","Row","disableVerticalFill","Column","Layout","DIR_BORDER_NW","DIR_BORDER_NE","DIR_BORDER_E","DIR_BORDER_SE","DIR_BORDER_SW","DIR_BORDER_W","useDirectionalDragger","direction","onBorderDrag","useDrag","isDragging","down","movement","mx","my","pointer","touch","NoWrap","useDesktopContext","useContext","DesktopServiceContext","useUIParadigm","uiParadigm","isUIParadigmAutoSet","setStaticUIParadigm","WindowTitleBarMaximizeButton","WindowTitleBarButton","WindowTitleBarMinimizeButton","WindowTitleBarCloseButton","WindowTitleBar","title","onRestoreOrMaximize","onMinimize","TitleBarView","titleBarView","refElTitleBar","shouldDisplay","DESKTOP_PARADIGM","dynamicProps","useMemo","onDoubleClick","evt","target","tagName","useObjectState","initialState","_setMergedState","refState","setState","useCallback","updatedState","JSON","parse","err","console","error","TypeError","prevState","nextState","Object","keys","diff","useAppOrchestrationContext","AppOrchestrationServiceContext","useWindowAutoPositioner","elWindow","elWindowManager","windowController","onInitialAutoPosition","refOnInitialAutoPosition","outOfBoundsCorrectionPosition","useWindowOutOfBoundsPositionCorrection","x","y","correctionPosition","_setCorrectionPosition","getOutOfBoundsPositionCorrection","winManSize","getElSize","winSize","winPosition","getElPosition","winTL","winTR","width","correctedPosition","_handleResizeOrMove","debounce","getIsMinimized","nextCorrectionPosition","on","EVT_RESIZED","EVT_MOVED","unmount","off","currentPosition","getPosition","nextPosition","setPosition","handleCenter","winManCenter","getElCenterPoint","el","offsetLeft","offsetWidth","offsetTop","offsetHeight","handleScatter","Math","floor","random","appRuntimes","refInitialAppRuntimes","__INTERNAL__setCenterHandler","__INTERNAL__setScatterHandler","requestAnimationFrame","WindowView","isActive","_setElWindow","useWindowOpenAnimation","isOpenAnimationEnded","_setIsOpenAnimationEnded","useAnimation","domElement","animationName","animationDuration","shouldRun","Boolean","onAnimationEnd","useWindowAutoSizer","MOBILE_PARADIGM","maximize","restore","zIndex","_setZIndex","_setTitle","refTitle","__INTERNAL__attachWindowElement","isWindowBorderDisabled","_setIsWindowBorderDisabled","refIsWindowBorderDisabled","isMaximized","_setIsMaximized","isMinimized","_setIsMinimized","_handleWindowControllerUpdate","getState","windowTitle","getTitle","undefined","stackingIndex","shouldWindowBorderBeDisabled","getIsBorderDisabled","EVT_UPDATED","useWindowControls","getIsMaximized","minimize","getIsDestroying","destroy","useWindowDragger","isDisabled","refInitialDragPosition","refInitialWindowManagerSize","isUserDragging","setIsUserDragging","xy","event","getWindowManagerSize","initialWindowManagerWidth","initialWindowManagerHeight","dragBind","useWindowDragResizer","refInitialDragSizePosition","isUserResizing","setIsUserResizing","getSize","windowManagerWidth","windowManagerHeight","ReferenceError","includes","diffX","diffY","setSize","handleBorderDrag","isProfiling","DynamicProfilingWrapper","args","Profiler","id","getUUID","onRender","renderProfile","captureRenderProfile","Fragment","useWindowStyles","outerBorderStyle","windowStyle","backgroundColor","bodyStyle","padding","StackingContext","onMount","isAccelerated","Border","WindowBorder","borderWidth","bindNW","bindN","bindNE","bindE","bindSE","bindS","bindSW","bindW","maxHeight","maxWidth","cursor","Window","React","forwardRef","attachWindowController","useImperativeHandle","WindowContext","createContext","WindowProvider","initialSharedState","sharedState","setSharedState","Provider","value","WindowManagerRouteContext","WindowManagerRouteProvider","getAppRuntimesWithRegistrationID","activateAppRegistrationWithID","activeWindowController","setActiveWindowController","locationAppRegistrationID","useLocationAppRegistrationID","activeRegistrationID","getAppRuntime","getRegistrationID","history","useHistory","handleRegistrationOrLocationChange","clear","WindowManagerView","elBase","setElBase","desktopContextActiveWindowController","setDesktopContextActiveWindowController","windowControllerMaps","setWindowControllerMaps","getWindowControllerMapWithKey","key","refDesktopContextActiveWindowController","handleSetActiveWindow","setIsMinimized","is","handleGetIsActiveWindow","startServiceClass","useServicesContext","refHandleSetActiveWindow","_handleElBaseTouch","passive","windows","map","appRuntime","appDescriptor","getAppDescriptor","ViewComponent","view","serviceClasses","windowProps","isPinned","isPinnedToDock","isAutoStart","dataMap","appServices","serviceClass","service","onTouchStart","WindowController","onBringToTop","setTitle","__INTERNAL__attachWindowManagerElement","setAppRuntime","__INTERNAL__setWindowController","prev","next","once","EVT_DESTROYED","WrappedWindowView","filter","Cover","position","WrappedTitleBarView","forceUpdate","useForceUpdate","useWindowContext","_handleServiceUpdate","values","setResizeHandler","useRegistrationViewOnResized","refSetResizeHandler","handleResized","_handleExecResizedCallback","onResized","WindowManager","appDescriptors","addOrUpdateAppRegistration","forEach","descriptor","MenuBar","menuStructures","openedIndexes","_setOpenedIndexes","_setIsActive","nextIsActive","idx","Set","pred","onMouseOver","UIModalService","modals","showModal","options","uuid","uuidv4","timeout","_handleClose","clearTimeout","closeModalWithUUID","this","onCancel","duration","setTimeout","nextModals","prevUUID","UIServiceCore","Padding","setEl","hasSiblings","setHasSiblings","parentNode","DynamicIcon","propsRest","DEFAULT_PROPS","onKeyDown","keyCode","onKeyUp","onEnter","onEscape","isEnabled","useKeyboardEvents","domNode","props","_handleKeyDown","repeat","which","_handleKeyUp","preventDefault","_prevIsSmallViewport","SystemModal","headerView","footerView","textAlign","CloseIcon","isSmallViewport","_setIsSmallViewport","useViewportSize","onChange","debounceTime","_getViewportSize","innerWidth","refOnChange","_handleViewportSize","ConfirmModal","text","display","Center","canOverflow","fontWeight","ButtonTransparent","useArrayDiff","usePrevious","defaultPreviousValue","refPrev","added","removed","addedRemoved","_setAddedRemoved","Array","isArray","Error","PhantomCollection","getChildrenDiff","EVT_AUDIO_LEVEL_UPDATED","MultiAudioMediaStreamTrackLevelMonitor","useMultiAudioMediaStreamTrackLevelMonitor","mediaStreamTrackOrTracks","onAudioLevelChange","mediaStreamTracks","track","MediaStreamTrack","kind","mediaStreamMonitor","_setMediaStreamMonitor","refOnAudioLevelChange","audioLevel","addedMediaStreamTracks","removedMediaStreamTracks","addMediaStreamTrack","removeMediaStreamTrack","AudioLevelMeter","mediaStreamTrack","elAudioLevel","setElAudioLevel","handleAudioLevelChange","requestSkippableAnimationFrame","inset","clipPath","WebkitClipPath","AudioInputDeviceTableRow","device","isCapturing","onToggleCapture","isMuted","onToggleMute","audioQualityPresets","audioQualityPresetName","onChangeAudioQualityPresetName","marginTop","fontSize","minWidth","color","float","preset","presetName","name","MicrophoneIcon","KEY_STORAGE_ENGINE_MEDIA_DEVICES","KEY_DMETA_USER_METADATA","MediaDeviceCachingService","devicesWithUserMetadata","_storageEngine","useServiceClass","KeyVaultService","getSecureLocalStorageEngine","a","_fetchCachedMediaDeviceUserMetadata","then","userMetadata","update","isMatch","utils","mediaDevice","getIsSameMediaDevice","deepMerge","filteredCache","setItem","fetchItem","cache","getMediaDeviceUserMetadata","cachedDevice","find","InputMediaDeviceFactoryCollection","MediaStreamTrackControllerFactoryCollection","InputMediaDevicesService","isFetchingMediaDevices","isAudioContextStarted","devices","_mediaDeviceCachingService","_inputMediaDeviceFactoryCollection","bindCollectionClass","fetchInputMediaDevices","isAggressive","untilAudioContextResumed","catch","finally","inputMediaDevices","audioContext","getIsFetchingMediaDevices","getInputMediaDevices","getAudioInputMediaDevices","predicate","getCaptureFactories","getTrackControllerFactories","getIsAudioMediaDeviceBeingCaptured","mediaDeviceInfo","MediaStreamTrackControllerFactory","getFactoriesWithInputMediaDevice","getMediaDeviceCaptureFactory","factories","userConstraints","factoryOptions","captureSpecificMediaDevice","factory","addTrackControllerFactory","uncaptureSpecificMediaDevice","getIsCapturingAnyAudio","getAudioTrackControllers","getIsAllAudioMuted","getIsAudioMuted","setIsAllAudioMuted","isAllAudioMuted","setIsAudioMuted","muteAllAudio","muteAudio","unmuteAllAudio","unmuteAudio","constraints","DEFAULT_AUDIO_QUALITY_PRESET","AUDIO_QUALITY_PRESET_TALK_RADIO","InputMediaDevicesSelector","onDeviceCapture","onDeviceUncapture","useInputMediaDevicesSelectorState","inputMediaDevicesService","serviceInstance","mediaDevicesCachingService","setDevicePreferredAudioQualityPresetName","warn","audioQualityPreset","getAudioQualityPresetWithName","setMediaDeviceUserMetadata","deviceUserMetadata","preferredConstraints","getAudioQualityPresetConstraints","getDevicePreferredAudioQualityPresetName","toggleSpecificAudioInputDevice","audioInputDevices","capturedAudioInputDevices","lenAudioInputDevices","isFetching","lenCapturedAudioInputDevices","border","borderRadius","deviceCaptureFactory","getOutputMediaStream","getTracks","getIsMuted","toggleMute","minHeight","RCACableIcon","marginLeft","InputDeviceSelectorModal","handleDeviceCapture","useUUID","TextInputModal","placeholder","elInput","setElInput","setValue","handleChange","handleClose","handleSubmit","elInputId","htmlFor","borderTopRightRadius","borderBottomRightRadius","borderTopLeftRadius","borderBottomLeftRadius","UIModalWidgetService","_uiModalService","Promise","resolve","reject","consume","selection","DesktopMenuBar","uiModalWidgetService","appRegistrations","activateAppRegistration","runningAppRegistrations","applicationsMenuData","app","getID","pinnedAppsMenuData","pinnedApps","registration","getIsPinned","hasOpenedWindows","DESKTOP_MENU_STRUCTURE","AUTO_DETECT_PARADIGM","runtime","getWindowController","scatter","center","confirm","ReShellCore","reload","activeWindowTitle","ACTIVE_APP_MENU_STRUCTURE","ACTIVE_WINDOW_MENU_STRUCTURE","TopBar","DockItem","appRegistration","isActiveRegistration","elDock","elDockItem","_setElDockItem","scrollTo","top","left","behavior","Dock","_setElDock","elContentWrapper","_setElContentWrapper","isOverflown","useOverflowDetection","handleDockScroll","scroll","scrollLeft","deltaY","dockRegistrations","getIsPinnedToDock","activeRegistration","getAppRegistration","onWheel","ResizeObserver","install","AutoScaler","elOuterWrap","setElOuterWrap","elInnerWrap","setElInnerWrap","outerWrapSize","innerWrapSize","visibility","ro","entries","entry","size","maxScaleX","maxScaleY","scale","min","transform","observe","unobserve","Notification","image","autoCloseTime","isClosing","setIsClosing","refOnClose","stopPropagation","autoCloseTimeout","startTimeout","stopTimeout","Image","alt","src","InfoIcon","MessageButton","onTouchEnd","onMouseUp","Animation","NotificationStack","notifications","onNotificationClose","UINotificationService","showNotification","closeNotificationWithUUID","isKept","NotificationContext","NotificationProvider","serviceState","notification","Modal","View","ModalStack","ModalContext","ModalProvider","modal","Desktop","backgroundView","whiteSpace","bottom","right","pointerEvents","getReShellVersion","PhantomCore","getPhantomCoreVersion","process","VirtualLink","LED","ApplicationSelector","searchQuery","onResetSearchQuery","appRuntimeRegistrations","getRegistration","filteredRegistrations","toUpperCase","totalInstances","borderColor","nonUsed","margin","PortalSwitcher","getPortals","portalName","switchToPortal","LEN_PORTALS","REGISTRATION_ID","ApplicationsApp","elSearch","setElSearch","handleSetSearchQuery","handleDoubleClick","isDisplayingPortals","setIsDisplayingPortals","handleResetSearchQuery","ApplicationsOverrideApp","Timer","secs","onTick","seconds","_setSeconds","getSeconds","handleUpdate","updateInterval","setInterval","clearInterval","Date","toISOString","substr","AppRuntimeTableRow","isTopMostWindowController","elProfilerPhase","setElProfilerPhase","elProfilerActualDuration","setElProfilerActualDuration","elProfilerBaseDuration","setElProfilerBaseDuration","elProfilerStartTime","setElProfilerStartTime","elProfilerCommitTime","setElProfilerCommitTime","elProfilerInteractions","setElProfilerInteractions","handleRenderProfile","arrRenderProfile","phase","actualDuration","baseDuration","startTime","commitTime","interactions","innerHTML","parseFloat","toFixed","EVT_RENDER_PROFILED","fontStyle","getInstanceUptime","colSpan","log","environment","getEnvironment","bringToTop","AppRuntimeTable","rowSpan","AppLinkButton","useAppRegistrationLink","appDescriptorID","getAppRegistrationTitleWithID","link","registrationTitle","ButtonView","ServiceMonitorApp","services","UIServicesContext","overflowY","getUptime","APPLICATION_MONITOR_REGISTRATION_ID","verticalAlign","ApplicationMonitorApp","setIsProfiling","SERVICE_MONITOR_REGISTRATION_ID","ButtonPanel","buttons","selectedIdx","button","isSelected","setSelectedIdx","refRenderIdx","content","Toggle","isOn","domId","LabeledToggle","labelOff","labelOn","masterLabel","lenLabelOff","lenLabelOn","longestLength","diffOff","diffOn","paddingLeft","paddingRight","ExternalLink","ExternalLinkButton","href","open","LINKS","SyncObject","MediaStreamController","WebRTCPeer","LINK_BUTTON_STYLE","Details","rel","urlOrAction","zenOSmosis","GitHub","Resources","url","FULL_YEAR","getFullYear","AboutReShellApp","screen","uuidAutoDetectCheckbox","marginBottom","isDesktop","opacity","AboutReShellOverrideApp","CheckForUpdatesApp","isLatest","setIsLatest","isChecking","setIsChecking","isError","setIsError","lastCheckTime","setLastCheckTime","refIsChecking","handleCheckForUpdates","fetchIsLatestVersion","getTime","dayjs","format","ColorAdjusterApp","isGrayscale","setIsGrayscale","ObjectViewer","theme","EnvironmentApp","packageJson","require","SoftwareInfoApp","getPortalName","CHECK_FOR_UPDATES_REGISTRATION_ID","ENVIRONMENT_REGISTRATION_ID","StaggeredWaveLoading","Preload","preloadResources","disabledLoadingIndicator","onError","usePreload","isPreloaded","VUMeter","elVU","setElVU","elNeedle","setElNeedle","backgroundImage","vuBackground","backgroundPosition","backgroundRepeat","vuNeedle","VUMeterApp","controller","getOutputMediaStreamTrack","flat","INPUT_MEDIA_DEVICES_REGISTRATION_ID","AVBase","mediaType","onEl","mediaStream","MediaStream","srcObject","play","muted","refOnEl","createElement","autoPlay","playsInline","controls","Video","ScreenCaptureFactoryCollection","ScreenCapturerService","getIsScreenCaptureSupported","captureScreen","getCollectionInstance","getMediaStreamTracks","getChildren","getTrackControllers","ScreenCaptureApp","scs","isScreenCaptureSupported","screenCaptureFactory","setScreenCaptureFactory","getIsUnmounting","useGetIsUnmounting","refIsUnmounting","handleStartScreenCapture","startScreenCapture","videoTrack","getVideoTrackControllers","getOutputTrack","audioTrack","InputMediaDevicesApp","mds","VU_METER_REGISTRATION_ID","SCREEN_CAPTURE_REGISTRATION_ID","bytesToSize","bytes","sizes","i","parseInt","abs","MemoryInfoApp","jsHeapSizeLimit","totalJSHeapSize","usedJSHeapSize","_setMemoryInfo","fetchMemoryInfo","performance","memory","memoryInfo","refetchInterval","LocalStorageItems","keyStorageEngineMaps","onGetValue","onEmpty","onNewItem","keyMap","storageEngine","getEncryptionType","getFormValues","formElement","elements","Form","autoComplete","validator","formValues","onSubmit","useFormController","setFormRef","getAttribute","isValid","setIsValid","errors","setErrors","handleFormValidate","hasErrors","fromEntries","handleFormChange","handleFormSubmit","submit","validate","KeyEditorForm","initialKey","initialValue","initialStorageEngine","storageEngines","defaultValue","required","getShortUUID","shortUUID","KeyVaultApp","localDataPersistenceService","rawKeyStorageEngineMaps","getKeyStorageEngineMaps","setKeyStorageEngineMaps","isCreatingNewKey","setIsCreatingNewKey","handleKeyValueSubmit","getStorageEngineWithShortUUID","handleEmpty","clearAllStorageEngines","BackArrowIcon","getStorageEngines","AppRegistrationSelector","onRegistrationChange","AppRegistrationViewerApp","setRegistration","handleSetRegistration","registrationId","matchedRegistration","LabeledLED","ButtonGroup","REPOSITION_OFFSET","CMD_OPEN_APPLICATIONS","keywords","description","action","commander","appOrchestrationService","APPLICATIONS_REGISTRATION_ID","CMD_MOVE_WINDOW_UP","prevPosition","CMD_MOVE_WINDOW_UP_AND_RIGHT","CMD_MOVE_WINDOW_UP_AND_LEFT","CMD_MOVE_WINDOW_RIGHT","CMD_MOVE_WINDOW_DOWN","CMD_MOVE_WINDOW_DOWN_AND_RIGHT","CMD_MOVE_WINDOW_DOWN_AND_LEFT","CMD_MOVE_WINDOW_LEFT","CMD_CENTER_WINDOW","CMD_CENTER_ALL_WINDOWS","getWindowControllers","CMD_SCATTER_WINDOW","CMD_SCATTER_ALL_WINDOWS","CMD_MAXIMIZE_WINDOW","CMD_MINIMIZE_WINDOW","CMD_RESTORE_WINDOW","CLOSE_APPLICATION","SWITCH_TO_DESKTOP_PARADIGM","uiParadigmService","SWITCH_TO_MOBILE_PARADIGM","SWITCH_TO_AUTO_DETECT_PARADIGM","DesktopCommanderControllerService","lastCommand","lastCommandInvokeTime","_appOrchestrationService","AppOrchestrationService","_uiParadigmService","UIParadigmService","_commands","COMMANDS","commandId","command","registerCommand","getCommands","split","getCommandWithId","getLastCommand","getLastCommandInvokeTime","params","getActiveWindowController","getUnixTime","DesktopCommanderDebuggerApp","selectedWindowController","_setSelectedWindowController","selectedWindowControllerUUID","commandService","commands","appRuntimeWindowControllers","getAppRuntimes","obj","handleSelectWindowControllerChange","getWindowControllerWithUUID","join","execCommand","sdk","EVT_BEGIN_RECOGNIZE","EVT_END_RECOGNIZE","EVT_TRANSCRIPTION_RECOGNIZING","EVT_TRANSCRIPTION_FINALIZED","MesaSpeechRecognizer","subscriptionKey","_isRecognizing","_isRecognized","_subscriptionKey","_locationRegion","_speechRecognitionLanguage","_mediaStream","_startRecognizing","getLocationRegion","getRecognitionLanguage","_recognitionLanguage","_setIsRecognizing","isRecognizing","emit","_setFinalizedTranscription","stream","speechConfig","SpeechConfig","fromSubscription","speechRecognitionLanguage","audioConfig","AudioConfig","fromStreamInput","recognizer","SpeechRecognizer","EVT_BEFORE_DESTROY","stopContinuousRecognitionAsync","close","recognizing","s","e","result","recognized","reason","ResultReason","RecognizedSpeech","NoMatch","canceled","CancellationReason","errorCode","errorDetails","sessionStopped","startContinuousRecognitionAsync","KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY","MesaSubscriptionKeyManagementService","hasCachedSubscriptionKey","_keyVaultService","_secureLocalStorageEngine","_fetchSecureLocalStorageSubscriptionKey","proxyOn","cachedKey","removeItem","getHasCachedSubscriptionKey","showTextInputModal","_setSecureLocalStorageSubscriptionKey","acquireSubscriptionKey","MesaSpeechRecognizerService","hasRecognizer","realTimeTranscription","finalizedTranscription","_recognizer","registerCleanupHandler","_inputMediaDevicesService","_subscriptionKeyService","getHasRecognizer","getRealTimeTranscription","getFinalizedTranscription","getIsRecognizing","inputCaptureFactories","showInputMediaDevicesSelectionModal","MesaSpeechDesktopControllerService","isDesktopControlEnabled","_desktopControllerService","_speechRecognizerService","getIsDesktopControlEnabled","extractCommandIntentFromText","setIsDesktopControlEnabled","normalizedText","toLowerCase","replace","words","commandStrengths","strength","word","bestMatchCommandStrength","reduce","b","MesaSpeechRecognitionDebuggerApp","speechRecognizerService","keyManagementService","hasSubscriptionKey","stopRecognizing","startRecognizing","deleteCachedSubscriptionKey","KEY_VAULT_REGISTRATION_ID","COMMAND_DEBUGGER_REGISTRATION_ID","MESA_SPEECH_RECOGNITION_TEST_APP_REGISTRATION_ID","WithoutRecognizer","subscriptionKeyManagementService","SpeechCommanderApp","desktopControllerService","ReShellOrg","ReShellOrgPortal"],"mappings":"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","file":"static/js/6.2193ff9d.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"layout\":\"Layout_layout__3PvPc\",\"header\":\"Layout_header__3EItT\",\"content\":\"Layout_content__1t8Hf\",\"footer\":\"Layout_footer__3EMQb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"window-outer-border\":\"Window_window-outer-border__3TebC\",\"hidden\":\"Window_hidden__3nppO\",\"maximized\":\"Window_maximized__1kLcW\",\"minimized\":\"Window_minimized__10t2-\",\"dragging\":\"Window_dragging__2Ctk1\",\"window\":\"Window_window__uDx5P\",\"active\":\"Window_active__eAyll\",\"title-bar\":\"Window_title-bar__376LO\",\"title\":\"Window_title__3FnAS\",\"window-controls\":\"Window_window-controls__1ACD5\",\"maximize\":\"Window_maximize__2aW7z\",\"minimize\":\"Window_minimize__hemKn\",\"close\":\"Window_close__38hm-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dock\":\"Dock_dock__XYNmR\",\"overflown\":\"Dock_overflown__1vLoU\",\"horizontal-orientation\":\"Dock_horizontal-orientation__32KfK\",\"content-wrapper\":\"Dock_content-wrapper__3sQLP\",\"dock-item\":\"Dock_dock-item__2wvel\",\"active\":\"Dock_active__1Zqia\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"RowColumn_row__2MIpa\",\"disable-vertical-fill\":\"RowColumn_disable-vertical-fill__YiYeg\",\"column\":\"RowColumn_column__3aAA3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"no-wrap\":\"NoWrap_no-wrap__2b0bc\"};","import React, { useEffect, useRef } from \"react\";\nimport LibControlledMenu, {\n  MenuItem as LibMenuItem,\n  SubMenu as LibSubMenu,\n  MenuDivider as LibMenuDivider,\n  MenuHeader as LibMenuHeader,\n} from \"./_Menu.LibWrapper\";\n\nimport PropTypes from \"prop-types\";\n\nimport classNames from \"classnames\";\n\nMenu.propTypes = {\n  /**\n   * FIXME: (jh) Document structure\n   *\n   * Reference example:\n   * @see {@link https://www.electronjs.org/docs/api/menu#examples}\n   */\n  menuStructure: PropTypes.object.isRequired,\n\n  /** If set to true, the menu will be opened */\n  opened: PropTypes.bool,\n\n  /**\n   * Invoked once the menu opens, or the internal logic determines the menu\n   * should open. The containing component should set \"opened\" as necessary,\n   * depending on this state.\n   **/\n  onOpen: PropTypes.func,\n\n  /**\n   * Invoked once the menu closes, or the internal logic determines the menu\n   * should be closed. The containing component should set \"opened\" as\n   * necessary, depending on this state.\n   **/\n  onClose: PropTypes.func,\n};\n\n/**\n * Wraps react-menu with data structure handling which is mostly compatible\n * with Electron's menu API.\n *\n * @see {@link https://www.electronjs.org/docs/api/menu#examples}\n */\nexport default function Menu({\n  menuStructure,\n  opened = false,\n  onOpen = () => null,\n  onClose = () => null,\n  ...rest\n}) {\n  // Coordinates the button position with the menu\n  const refAnchor = useRef(null);\n\n  // Close menu when screen size changes (menu can go offscreen, or be\n  // incorrectly positioned otherwise)\n  useEffect(() => {\n    // TODO: Use common handler instead\n    window.addEventListener(\"resize\", onClose);\n\n    return () => {\n      window.removeEventListener(\"resize\", onClose);\n    };\n  }, [onClose]);\n\n  return (\n    <>\n      <button\n        ref={refAnchor}\n        {...rest}\n        // Retain non-controlled class for easier styling\n        className={classNames(\n          \"szh-menu-button\",\n          opened && \"szh-menu-button--open\"\n        )}\n        // NOTE: onMouseDown also works on mobile (thanks to React) and fixes\n        // issue where onClick handling would always result in an open state,\n        // never togging off\n        onMouseDown={() => {\n          // NOTE: This setImmediate call fixes an issue with Firefox where\n          // selecting a menu item in the list, then clicking on the menu\n          // button again would not activate the menu button without a double-\n          // click\n          setImmediate(() => {\n            opened ? onClose() : onOpen();\n          });\n        }}\n        disabled={menuStructure.disabled}\n      >\n        {\n          // TODO: Normalize label / role handling\n        }\n        {menuStructure.label || menuStructure.role}\n      </button>\n\n      {\n        // NOTE: useMenuStateHook may be of eventual interest here:\n        // @see https://szhsin.github.io/react-menu/docs#use-menu-state\n      }\n      <LibControlledMenu\n        anchorRef={refAnchor}\n        // NOTE: The controlled menu cannot be initially opened to true (see\n        // related issue: https://github.com/szhsin/react-menu/issues/2#issuecomment-719166062)\n        // This issue was caused by hovering a menu option in a structure\n        // beyond the first (i.e. \"Restore\" in \"Window\" menu), then clicking on\n        // the desktop itself, then re-selecting the window.\n        state={refAnchor.current && opened ? \"open\" : \"closed\"}\n        // NOTE: onClose binds to escape / non-child pointer clicks\n        onClose={onClose}\n        portal={true}\n      >\n        {xChildren(menuStructure)}\n      </LibControlledMenu>\n    </>\n  );\n}\n\n/**\n * Provides dynamic, data-driven children for the given menu structure.\n *\n * NOTE: This function may call itself recursively if there is a child sub\n * menu.\n *\n * IMPORTANT: This is NOT a React component itself.\n *\n * @param {Object} menuStructure\n * @return {React.FC[]}\n */\nfunction xChildren(menuStructure) {\n  const children = [];\n\n  // Every top-level menu has a submenu\n  for (const item of menuStructure.submenu) {\n    if (item.type === \"separator\") {\n      children.push(<LibMenuDivider key={children.length} />);\n      // NOTE: This doesn't seem to conform to Electron's API\n      if (item.label) {\n        children.push(\n          <LibMenuHeader key={children.length}>{item.label}</LibMenuHeader>\n        );\n      }\n    } else {\n      if (item.submenu) {\n        children.push(\n          <LibSubMenu key={children.length} label={item.label}>\n            {xChildren(item)}\n          </LibSubMenu>\n        );\n      } else {\n        /**\n         * @see {@link https://www.electronjs.org/docs/latest/api/menu-item}\n         * @see {@link https://szhsin.github.io/react-menu/docs#menu-item}\n         */\n        children.push(\n          <LibMenuItem\n            key={children.length}\n            onClick={item.click}\n            disabled={item.disabled}\n            checked={item.checked}\n            // FIXME: (jh) Update checkbox handling\n            // @see https://szhsin.github.io/react-menu/docs#menu-item\n            // @see https://www.electronjs.org/docs/latest/api/menu-item\n            type={item.type}\n          >\n            {\n              // TODO: Normalize label / role handling\n            }\n            {item.role || item.label}\n          </LibMenuItem>\n        );\n      }\n    }\n  }\n\n  return children;\n}\n","// Basic wrapper interface around react-menu which the data-driven menu builds\n// on top of.\n\n// @see https://szhsin.github.io/react-menu/#basic-menu\nimport {\n  ControlledMenu as LibControlledMenu,\n  MenuItem,\n  MenuButton,\n  MenuHeader,\n  MenuDivider,\n  SubMenu as LibSubMenu,\n  applyHOC,\n  applyStatics,\n} from \"@szhsin/react-menu\";\nimport \"@szhsin/react-menu/dist/index.css\";\nimport \"@szhsin/react-menu/dist/transitions/slide.css\";\nimport \"./Menu.LibWrapper.css\";\n\nconst COMMON_PROPS = {\n  // Enable menu items to overflow in case they overextend the viewport\n  overflow: \"auto\",\n};\n\nconst ControlledMenu = applyHOC(function Menu({ ...rest }) {\n  return <LibControlledMenu {...rest} portal={true} {...COMMON_PROPS} />;\n}, LibControlledMenu);\n\nconst SubMenu = applyStatics(LibSubMenu)(function SubMenu({ ...rest }) {\n  return <LibSubMenu {...rest} {...COMMON_PROPS} />;\n});\n\n// TODO: Apply HOC and adjust styling as necessary (overflow=\"auto\" prop works\n// on Menu & SubMenu outside of styling)\n// @see https://szhsin.github.io/react-menu/#styles-prop for managing menu\n// styles (maybe not necessary to override CSS manually)\n// @see [HOC example] https://codesandbox.io/s/0bipn\n\nexport default ControlledMenu;\nexport { MenuItem, MenuButton, MenuHeader, MenuDivider, SubMenu };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"padding\":\"Padding_padding__3cEtV\",\"no-siblings\":\"Padding_no-siblings__1nLrM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"system-modal\":\"SystemModal_system-modal__3GtOL\",\"outer-wrap\":\"SystemModal_outer-wrap__1fPfM\",\"inner-wrap\":\"SystemModal_inner-wrap__1k8mt\",\"small-viewport\":\"SystemModal_small-viewport__3gvyy\",\"header\":\"SystemModal_header__37UXg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button-transparent\":\"ButtonTransparent_button-transparent__nu1PF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"levels\":\"AudioLevelMeter_levels__3baNN\",\"level-container\":\"AudioLevelMeter_level-container__12piT\",\"level\":\"AudioLevelMeter_level__2fRqJ\"};","import React, { useEffect, useState } from \"react\";\nimport classNames from \"classnames\";\n\nimport styles from \"./FullViewport.module.css\";\n\n// import PropTypes from \"prop-types\";\n\nexport default function FullViewport({ className, children, ...rest }) {\n  const [elContainer, setElContainer] = useState(null);\n\n  useEffect(() => {\n    if (elContainer) {\n      // Dynamically add .full-viewport to html / body elements\n      document.documentElement.classList.add(styles[\"html-full-viewport\"]);\n      document.body.classList.add(styles[\"body-full-viewport\"]);\n\n      const handleResize = () => {\n        // NOTE: The setImmediate wrap seems to help fix layout issues on iOS\n        // 14 after screen rotation\n        //\n        // FIXME: (jh) Potentially don't run this if the user is typing\n        setImmediate(() => {\n          elContainer.style.height = window.innerHeight + \"px\";\n\n          // Fixes issue on iOS where the content may be behind the URL bar after typing\n          document.body.scrollTop = 0;\n        });\n      };\n\n      // Perform initial size handling\n      handleResize();\n\n      // Bind resize handler\n      // TODO: Use common handler instead\n      window.addEventListener(\"resize\", handleResize);\n\n      // Poll the resize handler every second to help fix layout issues with iOS\n      // const resizeInterval = setInterval(handleResize, 1000);\n\n      return () => {\n        // Dynamically remove .full-viewport from html / body elements\n        document.documentElement.classList.remove(styles[\"html-full-viewport\"]);\n        document.body.classList.remove(styles[\"body-full-viewport\"]);\n\n        // Unbind resize handler\n        window.removeEventListener(\"resize\", handleResize);\n\n        // Stop poll interval\n        // clearInterval(resizeInterval);\n      };\n    }\n  }, [elContainer]);\n\n  return (\n    <div\n      {...rest}\n      ref={setElContainer}\n      className={classNames(styles[\"full-viewport\"], className)}\n    >\n      {children}\n    </div>\n  );\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"html-full-viewport\":\"FullViewport_html-full-viewport__2FFOO\",\"body-full-viewport\":\"FullViewport_body-full-viewport__2_xlv\",\"full-viewport\":\"FullViewport_full-viewport__2RwSj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"auto-scaler\":\"AutoScaler_auto-scaler__zdzsp\",\"content-wrap\":\"AutoScaler_content-wrap__2tFDr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notification-stack\":\"NotificationStack_notification-stack__1UiWO\",\"inner-wrap\":\"NotificationStack_inner-wrap__2Mc0d\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notification\":\"Notification_notification__3v54G\",\"action\":\"Notification_action__3RBsB\",\"main-image-wrap\":\"Notification_main-image-wrap__eqHez\",\"main-image\":\"Notification_main-image__1PfuN\",\"title\":\"Notification_title__2OHSD\",\"body-outer-wrap\":\"Notification_body-outer-wrap__3eJfO\",\"body\":\"Notification_body__1eZc4\",\"close\":\"Notification_close__1O8FQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"virtual-link\":\"VirtualLink_virtual-link__76t27\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"led\":\"LED_led__1cyGI\",\"gray\":\"LED_gray__3hMZV\",\"grey\":\"LED_grey__1_Ool\",\"red\":\"LED_red__2O1gd\",\"orange\":\"LED_orange__1Asac\",\"yellow\":\"LED_yellow__H5_0O\",\"green\":\"LED_green__5BS9Y\",\"blue\":\"LED_blue__fOsqG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toggle-wrapper\":\"Toggle_toggle-wrapper__1K_Qn\",\"disabled\":\"Toggle_disabled__3_Ejj\",\"toggle\":\"Toggle_toggle__2zmhC\",\"checkbox\":\"Toggle_checkbox__2zOQF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"labeled-toggle\":\"LabeledToggle_labeled-toggle__14B6D\",\"disabled\":\"LabeledToggle_disabled__11klv\",\"cell\":\"LabeledToggle_cell__2ahlq\",\"right\":\"LabeledToggle_right__3UVvj\",\"active\":\"LabeledToggle_active__vC7cP\",\"left\":\"LabeledToggle_left__V16KX\",\"title-row\":\"LabeledToggle_title-row__2_m3u\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-adjuster\":\"ColorAdjuster_color-adjuster__2X490\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"object-viewer\":\"ObjectViewer_object-viewer__8k3ak\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-wrapper\":\"StaggeredWaveLoading_loading-wrapper__35kvv\",\"loading\":\"StaggeredWaveLoading_loading__9ah1x\",\"dot\":\"StaggeredWaveLoading_dot__1cWhz\",\"wave\":\"StaggeredWaveLoading_wave__Du7Gv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"vu\":\"VUMeter_vu__Xlt7R\",\"mask\":\"VUMeter_mask__2OXhL\",\"needle\":\"VUMeter_needle__AmMsB\",\"vu-label\":\"VUMeter_vu-label__3kDDJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"video\":\"Video_video__2GgL9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"labeled-led\":\"LabeledLED_labeled-led__wOicI\",\"led-wrap\":\"LabeledLED_led-wrap__1c0-2\",\"label-wrap\":\"LabeledLED_label-wrap__1FyWJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button-group\":\"ButtonGroup_button-group__3JQ0y\"};","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Header({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"header\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Content({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"content\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Footer({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"footer\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./RowColumn.module.css\";\nimport PropTypes from \"prop-types\";\n\n// @see https://dev.to/drews256/ridiculously-easy-row-and-column-layouts-with-flexbox-1k01\n\nRow.propTypes = {\n  className: PropTypes.string,\n\n  /**\n   * If false, the row will fill up the complete vertical space of its parent.\n   *\n   * Default value = false\n   **/\n  disableVerticalFill: PropTypes.bool,\n};\n\n// TODO: Document\nfunction Row({ children, className, disableVerticalFill = false, ...rest }) {\n  // TODO: Enforce that only Column components are direct descendants of this\n\n  return (\n    <div\n      {...rest}\n      className={classNames(\n        styles[\"row\"],\n        disableVerticalFill && styles[\"disable-vertical-fill\"],\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\n// TODO: Implement prop-types\n/**\n * Evenly-sized column.\n */\nfunction Column({ children, className, ...rest }) {\n  // TODO: Enforce that only Row component is direct parent of this\n\n  return (\n    <div {...rest} className={classNames(styles[\"column\"], className)}>\n      {children}\n    </div>\n  );\n}\n\nexport { Row, Column };\n","import Layout, { Header, Content, Footer, Row, Column } from \"./Layout\";\n\nexport default Layout;\nexport { Header, Content, Footer, Row, Column };\n","import React from \"react\";\nimport Full from \"../Full\";\nimport Header from \"./Header\";\nimport Content from \"./Content\";\nimport Footer from \"./Footer\";\nimport { Row, Column } from \"./RowColumn\";\nimport styles from \"./Layout.module.css\";\nimport classNames from \"classnames\";\n\n// TODO: Add prop-types\n// TODO: Consider renaming; there are unrelated components that deal with Layout as well\nexport default function Layout({ className, children, ...rest }) {\n  return (\n    <Full {...rest} className={classNames(styles[\"layout\"], className)}>\n      {children}\n    </Full>\n  );\n}\n\nexport { Header, Content, Footer, Row, Column };\n","import Layout, { Header, Content, Footer, Row, Column } from \"../Layout\";\nimport { useDrag } from \"@use-gesture/react\";\n\n// FIXME: (jh) Look into resizble element for touch displays: https://csslayout.io/resizable-element/\n\nexport const DIR_BORDER_NW = \"NW\";\nexport const DIR_BORDER_N = \"N\";\nexport const DIR_BORDER_NE = \"NE\";\nexport const DIR_BORDER_E = \"E\";\nexport const DIR_BORDER_SE = \"SE\";\nexport const DIR_BORDER_S = \"S\";\nexport const DIR_BORDER_SW = \"SW\";\nexport const DIR_BORDER_W = \"W\";\n\n// @see https://use-gesture.netlify.app/docs/#simple-example\nconst useDirectionalDragger = function (direction, onBorderDrag) {\n  return useDrag(\n    ({ down: isDragging, movement: [mx, my] }) => {\n      onBorderDrag(direction, { mx, my, isDragging });\n    },\n    {\n      pointer: {\n        // IMPORTANT: This makes use-gesture utilize touch events instead of\n        // pointer events and fixes an issue where pointercancel would\n        // sometimes be fired on certain Android devices\n        touch: true,\n      },\n    }\n  );\n};\n\n// TODO: Use prop-types\n// TODO: Document\nexport default function WindowBorder({\n  children,\n  onBorderDrag,\n  // FIXME: (jh) Document how height and width are synonymous\n  borderWidth = 3,\n  isDisabled = false,\n  ...rest\n}) {\n  const bindNW = useDirectionalDragger(DIR_BORDER_NW, onBorderDrag);\n  const bindN = useDirectionalDragger(DIR_BORDER_N, onBorderDrag);\n  const bindNE = useDirectionalDragger(DIR_BORDER_NE, onBorderDrag);\n  const bindE = useDirectionalDragger(DIR_BORDER_E, onBorderDrag);\n  const bindSE = useDirectionalDragger(DIR_BORDER_SE, onBorderDrag);\n  const bindS = useDirectionalDragger(DIR_BORDER_S, onBorderDrag);\n  const bindSW = useDirectionalDragger(DIR_BORDER_SW, onBorderDrag);\n  const bindW = useDirectionalDragger(DIR_BORDER_W, onBorderDrag);\n\n  return (\n    // TODO: Enable merge-able styles / classNames\n    // TODO: Extract classes to module.css\n    <Layout {...rest}>\n      <Header>\n        {!isDisabled && (\n          <Row style={{ maxHeight: borderWidth, height: borderWidth }}>\n            <Column\n              {...bindNW()}\n              style={{ maxWidth: borderWidth, cursor: \"nwse-resize\" }}\n            ></Column>\n            <Column {...bindN()} style={{ cursor: \"ns-resize\" }}></Column>\n            <Column\n              {...bindNE()}\n              style={{ maxWidth: borderWidth, cursor: \"nesw-resize\" }}\n            ></Column>\n          </Row>\n        )}\n      </Header>\n      <Content>\n        <Row>\n          {!isDisabled && (\n            <Column\n              {...bindW()}\n              style={{ maxWidth: borderWidth, cursor: \"ew-resize\" }}\n            ></Column>\n          )}\n\n          <Column>\n            {\n              // TODO: Use layout to wrap the child in a frame, w/ diagonal positions included\n            }\n            {children}\n          </Column>\n          {!isDisabled && (\n            <Column\n              {...bindE()}\n              style={{ maxWidth: borderWidth, cursor: \"ew-resize\" }}\n            ></Column>\n          )}\n        </Row>\n      </Content>\n      <Footer>\n        {!isDisabled && (\n          <Row style={{ maxHeight: borderWidth, height: borderWidth }}>\n            <Column\n              {...bindSW()}\n              style={{ maxWidth: borderWidth, cursor: \"nesw-resize\" }}\n            ></Column>\n            <Column {...bindS()} style={{ cursor: \"ns-resize\" }}></Column>\n            <Column\n              {...bindSE()}\n              style={{ maxWidth: borderWidth, cursor: \"nwse-resize\" }}\n            ></Column>\n          </Row>\n        )}\n      </Footer>\n    </Layout>\n  );\n}\n","import NoWrap from \"./NoWrap\";\n\nexport default NoWrap;\n","import classNames from \"classnames\";\nimport styles from \"./NoWrap.module.css\";\n\n// TODO: Document\nexport default function NoWrap({ children, className, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"no-wrap\"], className)}>\n      {children}\n    </div>\n  );\n}\n","import { useContext } from \"react\";\nimport { DesktopServiceContext } from \"../core/providers/DesktopServiceProvider\";\n\nexport default function useDesktopContext() {\n  return useContext(DesktopServiceContext);\n}\n","import useDesktopContext from \"./useDesktopContext\";\n\nimport {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n  AUTO_DETECT_PARADIGM,\n} from \"@services/UIParadigmService\";\n\nexport { DESKTOP_PARADIGM, MOBILE_PARADIGM, AUTO_DETECT_PARADIGM };\n\n/**\n * Retrieves the currently detected paradigm.\n *\n * @return {{\n *  uiParadigm: DESKTOP_PARADIGM | MOBILE_PARADIGM,\n *  isUIParadigmAutoSet: boolean,\n *  setStaticUIParadigm: Function\n * }}\n */\nexport default function useUIParadigm() {\n  // NOTE: The desktop context is utilized for this vs. tapping into the\n  // UIParadigmService directly in order to prevent excess event emitters from\n  // being added to the service. This decision was also made because a paradigm\n  // change would typically affect the entire app, and should not happen\n  // frequently, so having the entire app re-render per paradigm change is not\n  // unreasonable.\n  const { uiParadigm, isUIParadigmAutoSet, setStaticUIParadigm } =\n    useDesktopContext();\n\n  return {\n    uiParadigm,\n    isUIParadigmAutoSet,\n    setStaticUIParadigm,\n  };\n}\n","import styles from \"../../Window.module.css\";\n\nexport function WindowTitleBarMaximizeButton({ ...rest }) {\n  return <WindowTitleBarButton {...rest} className={styles[\"maximize\"]} />;\n}\n\nexport function WindowTitleBarMinimizeButton({ ...rest }) {\n  return <WindowTitleBarButton {...rest} className={styles[\"minimize\"]} />;\n}\n\nexport function WindowTitleBarCloseButton({ ...rest }) {\n  return <WindowTitleBarButton {...rest} className={styles[\"close\"]} />;\n}\n\nfunction WindowTitleBarButton({ ...rest }) {\n  // TODO: Compose with specific buttons for \"green\", \"yellow\", and \"red\".\n\n  return <button {...rest}></button>;\n}\n","import WindowTitleBar from \"./Window.TitleBar\";\n\nexport default WindowTitleBar;\n","import { useMemo, useRef } from \"react\";\nimport NoWrap from \"@components/NoWrap\";\nimport Full from \"@components/Full\";\n\nimport styles from \"../Window.module.css\";\n\nimport useUIParadigm, { DESKTOP_PARADIGM } from \"@hooks/useUIParadigm\";\n\nimport {\n  WindowTitleBarMaximizeButton,\n  WindowTitleBarMinimizeButton,\n  WindowTitleBarCloseButton,\n} from \"./Window.TitleBar.Button\";\n\n// TODO: Document\n// TODO: Add prop-types\nexport default function WindowTitleBar({\n  title,\n  onRestoreOrMaximize,\n  onMinimize,\n  onClose,\n  titleBarView: TitleBarView,\n  ...rest\n}) {\n  const refElTitleBar = useRef(null);\n\n  const { uiParadigm } = useUIParadigm();\n\n  /** @type {boolean} Whether or not the title bar should display at all */\n  const shouldDisplay = uiParadigm === DESKTOP_PARADIGM || TitleBarView;\n\n  /**\n   * These props are dynamically created for the title bar depending on the\n   * current UI paradigm.\n   *\n   * @type {Object}\n   */\n  const dynamicProps = useMemo(() => {\n    if (uiParadigm === DESKTOP_PARADIGM) {\n      return {\n        onDoubleClick: evt => {\n          // This conditional is intended to prevent inadvertent maximizing or\n          // restoring if a custom title bar is used with additional control\n          // inputs\n          if (evt.target.tagName === \"DIV\") {\n            onRestoreOrMaximize(evt);\n          }\n        },\n      };\n    } else {\n      return {};\n    }\n  }, [uiParadigm, onRestoreOrMaximize]);\n\n  if (!shouldDisplay) {\n    return null;\n  }\n\n  return (\n    <div\n      {...rest}\n      ref={refElTitleBar}\n      className={styles[\"title-bar\"]}\n      {...dynamicProps}\n    >\n      {TitleBarView ? (\n        <Full>{TitleBarView}</Full>\n      ) : (\n        <NoWrap className={styles[\"title\"]}>{title}</NoWrap>\n      )}\n\n      {uiParadigm === DESKTOP_PARADIGM && (\n        <NoWrap className={styles[\"window-controls\"]}>\n          <WindowTitleBarMaximizeButton onClick={onRestoreOrMaximize} />\n          <WindowTitleBarMinimizeButton onClick={onMinimize} />\n          <WindowTitleBarCloseButton onClick={onClose} />\n        </NoWrap>\n      )}\n    </div>\n  );\n}\n","import { useCallback, useRef, useState } from \"react\";\nimport { diff } from \"deep-object-diff\";\n\n// FIXME: (jh) See other implementation here (might be more performant; search\n// for useObjectState): https://thoughtspile.github.io/2021/10/11/usestate-object-vs-multiple/?utm_campaign=thisweekinreact&utm_medium=email&utm_source=Revue%20newsletter\n\n/**\n * Applies a shallow-merge strategy to object updates so that setState() calls\n * don't completely overwrite previous object state.\n *\n * Maintains backwards-compatibility for class-based components which have been\n * migrated to hook versions, without having to write a bunch of useState\n * references for every state property.\n *\n * NOTE: This will perform a deep-equality, non-referential check after pre-\n * merging state updates and only update the state if there is a difference in\n * the deep-equality comparison.\n *\n * @param {Object} initialState\n * @return {[state: Object, setState: Function]} Merged state\n */\nexport default function useObjectState(initialState = {}) {\n  const [state, _setMergedState] = useState(initialState);\n\n  const refState = useRef(state);\n  refState.current = state;\n\n  /**\n   * @param {Object | string | Function} updatedState If passed as a string, it will try\n   * to JSON parse into an object.\n   * @return {void}\n   */\n  const setState = useCallback(updatedState => {\n    // Check type validity / apply type coercion, etc.\n    switch (typeof updatedState) {\n      case \"string\":\n        try {\n          updatedState = JSON.parse(updatedState);\n        } catch (err) {\n          console.error(\n            \"Unable to parse string into JSON.  Did you forget to use an Object when setting object state?\"\n          );\n\n          throw err;\n        }\n        break;\n\n      case \"function\":\n        // i.e. setState(prevState => nextState)\n        updatedState = updatedState(refState.current);\n        break;\n\n      case \"object\":\n        // Objects are okay the way they are\n        break;\n\n      default:\n        throw new TypeError(\n          `Unhandled useObjectState type: ${typeof updatedState}`\n        );\n    }\n\n    _setMergedState(prevState => {\n      const nextState = { ...prevState, ...updatedState };\n\n      if (Object.keys(diff(prevState, nextState)).length) {\n        // There is a difference in values; update the next state\n        return nextState;\n      } else {\n        // Skip rendering if there is no difference in values. This relies on\n        // the React principle that \"if your update function returns the exact\n        // same value as the current state, the subsequent rerender will be\n        // skipped completely.\"\n        // @see https://reactjs.org/docs/hooks-reference.html#usestate\n        return prevState;\n      }\n    });\n  }, []);\n\n  return [state, setState];\n}\n","import { useContext } from \"react\";\nimport { AppOrchestrationServiceContext } from \"@core/providers/AppOrchestrationServiceProvider\";\n\nexport default function useAppOrchestrationContext() {\n  return useContext(AppOrchestrationServiceContext);\n}\n","import useWindowAutoPositioner from \"./useWindowAutoPositioner\";\n\nexport default useWindowAutoPositioner;\n","import { useCallback, useEffect, useRef } from \"react\";\n\nimport getElCenterPoint from \"@utils/getElCenterPoint\";\nimport getElSize from \"@utils/getElSize\";\n\nimport useWindowOutOfBoundsPositionCorrection from \"./useWindowOutOfBoundsPositionCorrection\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\n/**\n * Handles auto-positioning of the given windows.\n *\n * @typedef { import('../../classesWindowController').default} WindowController\n *\n * @param {{elWindow: HTMLElement, elWindowManager: HTMLElement, windowController: WindowController, onInitialAutoPosition?: Function }} options\n * @return {void}\n */\nexport default function useWindowAutoPositioner({\n  elWindow,\n  elWindowManager,\n  windowController,\n  onInitialAutoPosition = () => null,\n}) {\n  const refOnInitialAutoPosition = useRef(null);\n  if (elWindow) {\n    refOnInitialAutoPosition.current = onInitialAutoPosition;\n  }\n\n  const outOfBoundsCorrectionPosition = useWindowOutOfBoundsPositionCorrection({\n    elWindow,\n    elWindowManager,\n    windowController,\n  });\n\n  // Apply auto-position to window if viewport is resized and window is out-of-\n  // bounds\n  useEffect(() => {\n    if (windowController) {\n      if (\n        outOfBoundsCorrectionPosition.x !== null ||\n        outOfBoundsCorrectionPosition.y !== null\n      ) {\n        const currentPosition = windowController.getPosition();\n\n        const nextPosition = {\n          x:\n            outOfBoundsCorrectionPosition.x !== null\n              ? outOfBoundsCorrectionPosition.x\n              : currentPosition.x,\n          y:\n            outOfBoundsCorrectionPosition.y !== null\n              ? outOfBoundsCorrectionPosition.y\n              : currentPosition.y,\n        };\n\n        windowController.setPosition(nextPosition);\n      }\n    }\n  }, [windowController, outOfBoundsCorrectionPosition]);\n\n  /**\n   * Centers the window in relation to the desktop layout.\n   *\n   * @return {void}\n   */\n  const handleCenter = useCallback(() => {\n    const winManCenter = getElCenterPoint(elWindowManager);\n    const winSize = getElSize(elWindow);\n\n    const x = winManCenter.x - winSize.width / 2;\n    const y = winManCenter.y - winSize.height / 2;\n\n    windowController.setPosition({\n      x,\n      y,\n    });\n  }, [elWindowManager, elWindow, windowController]);\n\n  /**\n   * Randomly positions the window within the confines of the desktop layout.\n   *\n   * @return {void}\n   */\n  const handleScatter = useCallback(() => {\n    if (windowController) {\n      const winManSize = getElSize(elWindowManager);\n      const winSize = getElSize(elWindow);\n\n      // Randomly position, but try to keep full window in viewport\n      const x = Math.floor(Math.random() * (winManSize.width - winSize.width));\n      const y = Math.floor(\n        Math.random() * (winManSize.height - winSize.height)\n      );\n\n      windowController.setPosition({ x, y });\n    }\n  }, [elWindowManager, elWindow, windowController]);\n\n  // TODO: Refactor; Determine current app runtimes so we can determine if\n  // we're going to center or scatter new windows\n  const { appRuntimes } = useAppOrchestrationContext();\n  const refInitialAppRuntimes = useRef(appRuntimes);\n\n  // Apply initial auto-position\n  useEffect(() => {\n    if (elWindowManager && elWindow && windowController) {\n      // Apply center / scatter handlers to window controller so they can be\n      // called externally\n      windowController.__INTERNAL__setCenterHandler(handleCenter);\n      windowController.__INTERNAL__setScatterHandler(handleScatter);\n\n      // IMPORTANT: This must be called asynchronously or it will not set\n      window.requestAnimationFrame(() => {\n        // Determine initial window position\n        // TODO: Obtain previous value from local storage, or from window\n        // registration\n        //\n        // TODO: Fix issue where opening more than one initial window will not\n        // center the first window\n        if (refInitialAppRuntimes.current.length < 2) {\n          // Center first window\n          handleCenter();\n        } else {\n          // Randomly scatter subsequent windows\n          handleScatter();\n        }\n\n        // IMPORTANT: This must be called in a subsequent asynchronous call or\n        // it may execute before the previous callback (i.e. handleCenter /\n        // handleScatter)\n        //\n        // FIXME: (jh) Use setImmediate instead?\n        window.requestAnimationFrame(() => {\n          refOnInitialAutoPosition.current();\n        });\n      });\n    }\n  }, [\n    elWindowManager,\n    elWindow,\n    windowController,\n    handleCenter,\n    handleScatter,\n  ]);\n}\n","import { useEffect, useCallback } from \"react\";\nimport debounce from \"debounce\";\n\nimport { EVT_RESIZED, EVT_MOVED } from \"../../classes/WindowController\";\n\nimport getElSize from \"@utils/getElSize\";\nimport getElPosition from \"@utils/getElPosition\";\n\nimport useObjectState from \"@hooks/useObjectState\";\n\nimport {\n  WINDOW_POSITION_OOB_TOP_THRESHOLD,\n  WINDOW_POSITION_OOB_BOTTOM_THRESHOLD,\n  WINDOW_POSITION_OOB_LEFT_THRESHOLD,\n  WINDOW_POSITION_OOB_RIGHT_THRESHOLD,\n} from \"../__window_hook_constants__\";\n\nimport useUIParadigm, { DESKTOP_PARADIGM } from \"@hooks/useUIParadigm\";\n\n/**\n * Dynamically detects if the given window is out-of-bounds and calculates\n * the corrected position to bring it back within the acceptable boundary.\n *\n * This actively monitors the window for moving and resizing, as well as the\n * window manager for resizing.\n *\n * @typedef { import('../../classesWindowController').default} WindowController\n *\n * @param {{elWindow: HTMLElement, elWindowManager: HTMLElement, windowController: WindowController}} options\n * @return {{x: number | null, y: number | null}}\n */\nexport default function useWindowOutOfBoundsPositionCorrection({\n  elWindow,\n  elWindowManager,\n  windowController,\n}) {\n  const [correctionPosition, _setCorrectionPosition] = useObjectState({\n    x: null,\n    y: null,\n  });\n\n  /**\n   * @param {{elWindow: HTMLElement, elWindowManager: HTMLElement}}\n   * @return {{x: number | null, y: number | null}}\n   */\n  const getOutOfBoundsPositionCorrection = useCallback(\n    (elWindow, elWindowManager) => {\n      // const winManCenter = getElCenterPoint(elWindowManager);\n      const winManSize = getElSize(elWindowManager);\n      const winSize = getElSize(elWindow);\n      const winPosition = getElPosition(elWindow);\n\n      const winTL = {\n        x: winPosition.x,\n        y: winPosition.y,\n      };\n\n      const winTR = {\n        x: winPosition.x + winSize.width,\n        y: winPosition.y,\n      };\n\n      const correctedPosition = {\n        x: null,\n        y: null,\n      };\n\n      // If top-right position of window is less than left threshold\n      if (winTR.x < WINDOW_POSITION_OOB_LEFT_THRESHOLD) {\n        correctedPosition.x =\n          WINDOW_POSITION_OOB_LEFT_THRESHOLD - winSize.width;\n      }\n\n      // If top position of window is less than top threshold\n      if (winTR.y < WINDOW_POSITION_OOB_TOP_THRESHOLD) {\n        correctedPosition.y = WINDOW_POSITION_OOB_TOP_THRESHOLD;\n      }\n\n      // If top-left position of window is less than window manager width minus\n      // right threshold\n      if (winTL.x > winManSize.width - WINDOW_POSITION_OOB_RIGHT_THRESHOLD) {\n        correctedPosition.x =\n          winManSize.width - WINDOW_POSITION_OOB_RIGHT_THRESHOLD;\n      }\n\n      // If top position of window is less than window manager height minus\n      // bottom threshold\n      if (winTL.y > winManSize.height - WINDOW_POSITION_OOB_BOTTOM_THRESHOLD) {\n        correctedPosition.y =\n          winManSize.height - WINDOW_POSITION_OOB_BOTTOM_THRESHOLD;\n      }\n\n      return correctedPosition;\n    },\n    []\n  );\n\n  const { uiParadigm } = useUIParadigm();\n\n  // Bind event listeners\n  useEffect(() => {\n    if (\n      // Only run in desktop paradigm\n      uiParadigm === DESKTOP_PARADIGM &&\n      elWindow &&\n      elWindowManager &&\n      windowController\n    ) {\n      // Invoked when window is resized or removed, or if the viewport is\n      // resized\n      const _handleResizeOrMove = debounce(\n        () => {\n          // Fixes issue where previously minimized windows might be out of\n          // position once restored\n          // Relevant issue: https://github.com/jzombie/pre-re-shell/issues/131\n          if (windowController.getIsMinimized()) {\n            return;\n          }\n\n          const nextCorrectionPosition = getOutOfBoundsPositionCorrection(\n            elWindow,\n            elWindowManager\n          );\n\n          // NOTE: This relies on useObjectState's equality checking to not re\n          // render if nothing has changed\n          _setCorrectionPosition(nextCorrectionPosition);\n        },\n\n        100,\n        // Run on trailing edge\n        false\n      );\n\n      windowController.on(EVT_RESIZED, _handleResizeOrMove);\n      windowController.on(EVT_MOVED, _handleResizeOrMove);\n\n      // TODO: Use common handler instead\n      window.addEventListener(\"resize\", _handleResizeOrMove);\n\n      // Perform initial check\n      _handleResizeOrMove();\n\n      return function unmount() {\n        windowController.off(EVT_RESIZED, _handleResizeOrMove);\n        windowController.off(EVT_MOVED, _handleResizeOrMove);\n\n        window.removeEventListener(\"resize\", _handleResizeOrMove);\n      };\n    }\n  }, [\n    uiParadigm,\n    elWindow,\n    elWindowManager,\n    windowController,\n    getOutOfBoundsPositionCorrection,\n    _setCorrectionPosition,\n  ]);\n\n  return correctionPosition;\n}\n","// Window pointer drag thresholds represent the minimum closeness to the\n// relevant edge that the mouse / touch pointer can be before it stops\n// responding\nexport const WINDOW_POINTER_DRAG_TOP_THRESHOLD = 0;\nexport const WINDOW_POINTER_DRAG_RIGHT_THRESHOLD = 0;\nexport const WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD = 58;\nexport const WINDOW_POINTER_DRAG_LEFT_THRESHOLD = 0;\n\n// Window position out-of-bounds thresholds represent the minimum amount of\n// pixels the window can display for the relevant edge before it will be\n// automatically repositioned\nexport const WINDOW_POSITION_OOB_TOP_THRESHOLD = 0;\nexport const WINDOW_POSITION_OOB_RIGHT_THRESHOLD = 58;\nexport const WINDOW_POSITION_OOB_BOTTOM_THRESHOLD = 58;\nexport const WINDOW_POSITION_OOB_LEFT_THRESHOLD = 58;\n","/**\n * TODO: Document\n *\n * @see https://stackoverflow.com/a/46921780\n *\n * @param {DOMElement} el\n * @return {Object} // TODO: Document more thoroughly\n */\nexport default function getElCenterPoint(el) {\n  const x = el.offsetLeft + el.offsetWidth / 2;\n  const y = el.offsetTop + el.offsetHeight / 2;\n\n  return {\n    x,\n    y,\n  };\n}\n","import { EVT_UPDATED } from \"./classes/WindowController\";\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport StackingContext from \"../StackingContext\";\nimport Full from \"../Full\";\nimport Layout, { Header, Content } from \"../Layout\";\n\nimport WindowBorder from \"./Window.Border\";\nimport WindowTitleBar from \"./Window.TitleBar\";\n\nimport styles from \"./Window.module.css\";\nimport classNames from \"classnames\";\n\nimport useWindowStyles from \"./hooks/useWindowStyles\";\nimport useWindowAutoPositioner from \"./hooks/useWindowAutoPositioner\";\nimport useWindowAutoSizer from \"./hooks/useWindowAutoSizer\";\nimport useWindowDragger from \"./hooks/useWindowDragger\";\nimport useWindowDragResizer from \"./hooks/useWindowDragResizer\";\nimport useWindowOpenAnimation from \"./hooks/useWindowOpenAnimation\";\nimport useWindowControls from \"./hooks/useWindowControls\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\n\n// TODO: Apply considerations from Apple's Human Interface Guidelines:\n// https://developer.apple.com/design/human-interface-guidelines/macos/windows-and-views/window-anatomy/\n\n// TODO: Consider adjusting tabindex for non-active windows dynamically so that\n// tabbing will stay within constraints of the active window\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex\n\n// TODO: Add prop-types\n// TODO: Document\n// TODO: Include option to be able to drag the window from within the window body (i.e. like a widget)\nconst WindowView = ({\n  children,\n  elWindowManager,\n\n  windowController,\n\n  // TODO: Obtain via windowController instead?\n  isActive,\n\n  titleBarView = null,\n\n  style = {},\n  ...rest\n}) => {\n  /** @type {DOMElement} */\n  const [elWindow, _setElWindow] = useState(null);\n\n  // TODO: Document\n  const { isOpenAnimationEnded } = useWindowOpenAnimation(elWindow);\n\n  // TODO: Document\n  useWindowAutoPositioner({ elWindow, elWindowManager, windowController });\n\n  // TODO: Document\n  useWindowAutoSizer({ windowController });\n\n  const [zIndex, _setZIndex] = useState(0);\n  const [title, _setTitle] = useState(null);\n  const refTitle = useRef(null);\n  refTitle.current = title;\n\n  // Associate window element with window controller\n  // TODO: Refactor into useWindowController hook\n  useEffect(() => {\n    if (windowController && elWindow) {\n      windowController.__INTERNAL__attachWindowElement(elWindow);\n    }\n  }, [windowController, elWindow]);\n\n  /** @type {boolean} */\n  const [isWindowBorderDisabled, _setIsWindowBorderDisabled] = useState(false);\n  const refIsWindowBorderDisabled = useRef(null);\n  refIsWindowBorderDisabled.current = isWindowBorderDisabled;\n\n  const [isMaximized, _setIsMaximized] = useState(false);\n  const [isMinimized, _setIsMinimized] = useState(false);\n\n  // TODO: Document\n  // TODO: Refactor into useWindowController hook\n  // TODO: Move into container view?\n  useEffect(() => {\n    if (windowController) {\n      const _handleWindowControllerUpdate = updatedState => {\n        if (!updatedState) {\n          updatedState = windowController.getState() || {};\n        }\n\n        // Only apply view state change when necessary\n        const windowTitle = windowController.getTitle();\n        if (windowTitle !== refTitle.current) {\n          _setTitle(windowTitle);\n        }\n\n        // Only apply view state change when necessary\n        if (\n          updatedState.stackingIndex !== undefined &&\n          // TODO: Rather than checking dep value here, create conditionally-setting useState wrapper\n          updatedState.stackingIndex !== zIndex\n        ) {\n          _setZIndex(updatedState.stackingIndex);\n        }\n\n        if (updatedState.isMaximized !== undefined) {\n          _setIsMaximized(updatedState.isMaximized);\n        }\n\n        if (updatedState.isMinimized !== undefined) {\n          _setIsMinimized(updatedState.isMinimized);\n        }\n\n        const shouldWindowBorderBeDisabled =\n          windowController.getIsBorderDisabled();\n        if (\n          refIsWindowBorderDisabled.current !== shouldWindowBorderBeDisabled\n        ) {\n          _setIsWindowBorderDisabled(shouldWindowBorderBeDisabled);\n        }\n      };\n\n      // Perform initial update sync\n      _handleWindowControllerUpdate();\n\n      windowController.on(EVT_UPDATED, _handleWindowControllerUpdate);\n\n      return function unmount() {\n        windowController.off(EVT_UPDATED, _handleWindowControllerUpdate);\n      };\n    }\n  }, [windowController, title, zIndex]);\n\n  const { onRestoreOrMaximize, onMinimize, onClose } = useWindowControls({\n    windowController,\n  });\n\n  // Binds window dragging functionality\n  const [dragBind, isUserDragging] = useWindowDragger({\n    windowController,\n    isDisabled: isWindowBorderDisabled,\n  });\n\n  // Binds border resizing functionality\n  const [handleBorderDrag, isUserResizing] = useWindowDragResizer({\n    windowController,\n  });\n\n  const { isProfiling } = useDesktopContext();\n\n  // TODO: Document\n  const DynamicProfilingWrapper = useMemo(\n    () =>\n      ({ ...args }) =>\n        isProfiling ? (\n          // @see https://reactjs.org/docs/profiler.html\n          <React.Profiler\n            {...args}\n            id={windowController.getUUID()}\n            onRender={(...renderProfile) =>\n              windowController.captureRenderProfile(renderProfile)\n            }\n          />\n        ) : (\n          <React.Fragment {...args} />\n        ),\n    [isProfiling, windowController]\n  );\n\n  // Delegate style properties to their respective sub-components\n  const { outerBorderStyle, windowStyle, bodyStyle } = useWindowStyles({\n    style,\n    isMaximized,\n    isMinimized,\n  });\n\n  return (\n    // TODO: Wrap with ErrorBoundary and React.Suspense\n    <StackingContext\n      onMount={_setElWindow}\n      {...rest}\n      style={{ ...outerBorderStyle, zIndex }}\n      className={classNames(\n        styles[\"window-outer-border\"],\n\n        // Prevents \"popping\" of window before open animation ends\n        !isOpenAnimationEnded && styles[\"hidden\"],\n\n        isActive && styles[\"active\"],\n        isMaximized && styles[\"maximized\"],\n        isMinimized && styles[\"minimized\"],\n        (isUserDragging || isUserResizing) && styles[\"dragging\"]\n      )}\n      // Enable hardware acceleration of window stacking context when user is\n      // dragging or resizing\n      isAccelerated={isUserDragging || isUserResizing}\n      // For debugging reference\n      data-reshell-window-title={windowController.getTitle()}\n    >\n      {\n        // IMPORTANT: The DynamicProfilingWrapper is contained within the\n        // stacking context due to an issue w/ the window losing its\n        // positioning state if profiling is enabled / disabled\n      }\n      <DynamicProfilingWrapper>\n        <WindowView.Border\n          isDisabled={isWindowBorderDisabled}\n          onBorderDrag={handleBorderDrag}\n        >\n          <Full\n            className={classNames(\n              styles[\"window\"],\n              isActive && styles[\"active\"],\n              // NOTE: This check intentionally is not taking resizing into\n              // consideration\n              isUserDragging && styles[\"dragging\"]\n            )}\n            style={windowStyle}\n          >\n            <Layout>\n              <Header>\n                <WindowTitleBar\n                  {...dragBind()}\n                  title={title}\n                  onRestoreOrMaximize={onRestoreOrMaximize}\n                  onMinimize={onMinimize}\n                  onClose={onClose}\n                  titleBarView={titleBarView}\n                />\n              </Header>\n              <Content className={styles[\"body\"]} style={bodyStyle}>\n                {children}\n              </Content>\n            </Layout>\n          </Full>\n        </WindowView.Border>\n      </DynamicProfilingWrapper>\n    </StackingContext>\n  );\n};\n\nWindowView.Border = WindowBorder;\n\nexport default WindowView;\n","import { useState } from \"react\";\nimport useAnimation from \"@hooks/useAnimation\";\n\n// FIXME: (jh) Apply animations to open, close, minimize, maximize, restore,\n// etc. Some of these animations are currently handled directly via\n// Window.module.css and the functionality could be cleaned up / refactored.\n//\n// @see https://animate.style/\n// @see https://github.com/miniMAC/magic (what is \"magic / puffin\"?) (TODO: Create test app to try these libs?)\n// # mac minimize genie effect warp\n\n/**\n * [Currently only] Handles window opening animation.\n *\n * @param {HTMLElement} elWindow\n * @return {{isOpenAnimationEnded: boolean}}\n */\nexport default function useWindowOpenAnimation(elWindow) {\n  //const [phase, setPhase] = useState(\"transition-in\");\n\n  const [isOpenAnimationEnded, _setIsOpenAnimationEnded] = useState(false);\n\n  // Window opening transition\n  useAnimation({\n    domElement: elWindow,\n    animationName: \"zoomInUp\",\n    animationDuration: \".5s\",\n    shouldRun: Boolean(elWindow),\n    onAnimationEnd: () => _setIsOpenAnimationEnded(true),\n  });\n\n  return { isOpenAnimationEnded };\n}\n","import { useEffect } from \"react\";\n\nimport useUIParadigm, {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n} from \"@hooks/useUIParadigm\";\n\n/**\n * Handles auto-sizing of the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController }} options\n * @return {void}\n */\nexport default function useWindowAutoSizer({ windowController }) {\n  const { uiParadigm } = useUIParadigm();\n\n  // Apply auto-maximize / restore depending on paradigm\n  useEffect(() => {\n    if (windowController) {\n      if (!windowController.getIsMinimized()) {\n        switch (uiParadigm) {\n          case MOBILE_PARADIGM:\n            // Auto-maximize windows if on mobile\n            windowController.maximize();\n            break;\n\n          case DESKTOP_PARADIGM:\n            // Restore windows if switched to desktop\n            windowController.restore();\n            break;\n\n          default:\n            break;\n        }\n      }\n    }\n  }, [windowController, uiParadigm]);\n}\n","import { useCallback } from \"react\";\n\n/**\n * Handles window control binding for the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController }} options\n * @return {{ onRestoreOrMaximize: Function, onMinimize: Function, onClose: Function}}\n */\nexport default function useWindowControls({ windowController }) {\n  /**\n   * Handles toggling of window restore or maximize, depending on current\n   * state.\n   *\n   * @return {void}\n   */\n  const handleRestoreOrMaximize = useCallback(() => {\n    if (windowController.getIsMaximized()) {\n      windowController.restore();\n    } else {\n      windowController.maximize();\n    }\n  }, [windowController]);\n\n  /**\n   * Handles minimizing of the window.\n   *\n   * @return {void}\n   */\n  const handleMinimize = useCallback(() => {\n    windowController.minimize();\n  }, [windowController]);\n\n  /**\n   * Handles closing of the window.\n   *\n   * @return {void}\n   */\n  const handleClose = useCallback(() => {\n    if (!windowController.getIsDestroying()) {\n      windowController.destroy();\n    }\n  }, [windowController]);\n\n  return {\n    onRestoreOrMaximize: handleRestoreOrMaximize,\n    onMinimize: handleMinimize,\n    onClose: handleClose,\n  };\n}\n","import { useRef, useState } from \"react\";\nimport { useDrag } from \"@use-gesture/react\";\n\nimport {\n  WINDOW_POINTER_DRAG_TOP_THRESHOLD,\n  WINDOW_POINTER_DRAG_RIGHT_THRESHOLD,\n  WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD,\n  WINDOW_POINTER_DRAG_LEFT_THRESHOLD,\n} from \"./__window_hook_constants__\";\n\n/**\n * Handles window drag binding for the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController, isDisabled: boolean }} options\n * @return {[bind: Function, isUserDragging: boolean]}\n */\nexport default function useWindowDragger({ windowController, isDisabled }) {\n  const refInitialDragPosition = useRef(null);\n  const refInitialWindowManagerSize = useRef(null);\n\n  const [isUserDragging, setIsUserDragging] = useState(false);\n\n  // @see https://use-gesture.netlify.app/docs/#simple-example\n  const bind = useDrag(\n    ({ down: isDragging, movement: [mx, my], xy, event }) => {\n      if (isDisabled) {\n        if (isUserDragging) {\n          setIsUserDragging(false);\n        }\n        return;\n      }\n\n      if (isDragging !== isUserDragging) {\n        setIsUserDragging(isDragging);\n      }\n\n      if (isDragging) {\n        if (!refInitialDragPosition.current) {\n          refInitialDragPosition.current = windowController.getPosition();\n        }\n\n        if (!refInitialWindowManagerSize.current) {\n          refInitialWindowManagerSize.current =\n            windowController.getWindowManagerSize();\n        }\n\n        let x = refInitialDragPosition.current.x + mx;\n        let y = refInitialDragPosition.current.y + my;\n\n        const initialWindowManagerWidth =\n          refInitialWindowManagerSize.current.width;\n        const initialWindowManagerHeight =\n          refInitialWindowManagerSize.current.height;\n\n        // Prevent window from being dragged above top threshold\n        if (y < WINDOW_POINTER_DRAG_TOP_THRESHOLD) {\n          y = WINDOW_POINTER_DRAG_TOP_THRESHOLD;\n        }\n\n        // Prevent window from being dragged below bottom threshold\n        if (\n          y >\n          initialWindowManagerHeight - WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD\n        ) {\n          y = initialWindowManagerHeight - WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD;\n        }\n\n        // Prevent window from being dragged left of left threshold\n        if (xy[0] < WINDOW_POINTER_DRAG_LEFT_THRESHOLD) {\n          x = null;\n        }\n\n        // Prevent window from being dragged right of right threshold\n        if (\n          xy[0] >\n          initialWindowManagerWidth - WINDOW_POINTER_DRAG_RIGHT_THRESHOLD\n        ) {\n          x = null;\n        }\n\n        windowController.setPosition({\n          x,\n          y,\n        });\n      } else {\n        // Reset initial drag position\n        refInitialDragPosition.current = null;\n        refInitialWindowManagerSize.current = null;\n      }\n    }\n  );\n\n  return [bind, isUserDragging];\n}\n","import { useCallback, useRef, useState } from \"react\";\n\nimport {\n  DIR_BORDER_NW,\n  DIR_BORDER_N,\n  DIR_BORDER_NE,\n  DIR_BORDER_E,\n  DIR_BORDER_SE,\n  DIR_BORDER_S,\n  DIR_BORDER_SW,\n  DIR_BORDER_W,\n} from \"../Window.Border\";\n\nimport { WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD } from \"./__window_hook_constants__\";\n\n// FIXME: (jh) Implement ability to disable drag resizing\n/**\n * Handles window border drag resize binding for the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController }} options\n * @return {[handleBorderDrag: Function, isUserResizing: boolean]}\n */\nexport default function useWindowDragResizer({ windowController }) {\n  const refInitialDragSizePosition = useRef(null);\n  const refInitialWindowManagerSize = useRef(null);\n\n  const [isUserResizing, setIsUserResizing] = useState(false);\n\n  const handleBorderDrag = useCallback(\n    (direction, { mx, my, isDragging }) => {\n      if (isDragging !== isUserResizing) {\n        setIsUserResizing(isDragging);\n      }\n\n      if (isDragging) {\n        if (!refInitialDragSizePosition.current) {\n          refInitialDragSizePosition.current = {\n            ...windowController.getSize(),\n            ...windowController.getPosition(),\n          };\n        }\n\n        if (!refInitialWindowManagerSize.current) {\n          refInitialWindowManagerSize.current =\n            windowController.getWindowManagerSize();\n        }\n\n        let { width, height, x, y } = refInitialDragSizePosition.current;\n\n        let windowManagerWidth = refInitialWindowManagerSize.current.width;\n        let windowManagerHeight = refInitialWindowManagerSize.current.height;\n\n        switch (direction) {\n          case DIR_BORDER_NW:\n            width = width - mx;\n            height = height - my;\n\n            x = x + mx;\n            y = y + my;\n\n            break;\n\n          case DIR_BORDER_N:\n            height = height - my;\n            y = y + my;\n            break;\n\n          case DIR_BORDER_NE:\n            height = height - my;\n            width = width + mx;\n\n            y = y + my;\n            break;\n\n          case DIR_BORDER_E:\n            width = width + mx;\n            break;\n\n          case DIR_BORDER_SE:\n            width = width + mx;\n            height = height + my;\n            break;\n\n          case DIR_BORDER_S:\n            height = height + my;\n            break;\n\n          case DIR_BORDER_SW:\n            width = width - mx;\n            height = height + my;\n\n            x = x + mx;\n            break;\n\n          case DIR_BORDER_W:\n            width = width - mx;\n\n            x = x + mx;\n            break;\n\n          default:\n            throw new ReferenceError(`Unknown direction: ${direction}`);\n        }\n\n        // TODO: Handle min width / height\n\n        // NOTE: The directional check fixes an issue where resizing the right\n        // edge of the window while very close to the left of the window\n        // manager would make the window reposition substantially to the right\n        // before resizing\n        if (![DIR_BORDER_NE, DIR_BORDER_E, DIR_BORDER_SE].includes(direction)) {\n          // Prevent left resize from extending left of left threshold\n          if (x < 0) {\n            // This affects window height calculations when cursor is left of\n            // left threshold\n            const diffX = 0 - x;\n            x = 0;\n            width = width - diffX;\n          }\n        }\n\n        // Prevent top resize from extending above top threshold\n        if (y < 0) {\n          // IMPORTANT: Order of operations is important here; diffY comes\n          // before y\n          const diffY = 0 - y;\n          y = 0;\n          height = height - diffY;\n        }\n\n        // NOTE: The directional check fixes an issue where resizing the left\n        // edge of the window while very close to the right of the window\n        // manager would appear to resize from the right side of the window\n        // instead\n        // @see https://github.com/jzombie/pre-re-shell/issues/116\n        if (![DIR_BORDER_NW, DIR_BORDER_W, DIR_BORDER_SW].includes(direction)) {\n          // Prevent right resize from extending right of right threshold\n          if (width + x > windowManagerWidth) {\n            width = windowManagerWidth - x;\n            x = null;\n          }\n        }\n\n        // Prevent bottom resize from extending below bottom threshold\n        if (height + y > windowManagerHeight) {\n          if (\n            // Fix issue where resizing windows from the top, which extended\n            // below the bottom threshold, would move the bottom edge up\n            direction === DIR_BORDER_S ||\n            direction === DIR_BORDER_SE ||\n            direction === DIR_BORDER_SW\n          ) {\n            height = windowManagerHeight - y;\n            y = null;\n          }\n        }\n\n        // Prevent drags from the top to be able to drag below bottom threshold\n        if (windowManagerHeight - y < WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD) {\n          return;\n        }\n\n        windowController.setSize({ width, height });\n        windowController.setPosition({ x, y });\n      } else {\n        refInitialDragSizePosition.current = null;\n        refInitialWindowManagerSize.current = null;\n      }\n    },\n    [windowController, isUserResizing]\n  );\n\n  return [handleBorderDrag, isUserResizing];\n}\n","import { useMemo } from \"react\";\n\n/**\n * Dynamically applies and filters styling based on current state of given\n * window.\n *\n * @param {{ style: Object, isMaximized: boolean, isMinimized: boolean }}\n * @return {{ outerBorderStyle: Object, windowStyle: Object, bodyStyle: Object }}\n */\nexport default function useWindowStyles({ style, isMaximized, isMinimized }) {\n  // Conditionally overrides style property when window is maximized or\n  // minimized so that they do not conflict with the CSS classes\n  const outerBorderStyle = useMemo(() => {\n    if (isMaximized || isMinimized) {\n      return {};\n    } else {\n      return {\n        width: style.width,\n        height: style.height,\n      };\n    }\n  }, [style.width, style.height, isMaximized, isMinimized]);\n\n  const windowStyle = useMemo(() => {\n    return {\n      backgroundColor: style.backgroundColor,\n    };\n  }, [style.backgroundColor]);\n\n  const bodyStyle = useMemo(() => {\n    return {\n      padding: style.padding,\n    };\n  }, [style.padding]);\n\n  return {\n    outerBorderStyle,\n    windowStyle,\n    bodyStyle,\n  };\n}\n","import Window from \"./Window\";\n\nexport default Window;\n","import React, { useImperativeHandle, useState } from \"react\";\n\nimport WindowView from \"./Window.View\";\n\n// TODO: Implement CodeSandbox support for development / debugging:  https://codesandbox.io/docs/embedding#embed-options\n// TODO: See https://csslayout.io/patterns\n\n// TODO: Add prop-types\n// TODO: Document\n// TODO: Include option to be able to drag the window from within the window body (i.e. like a widget)\nconst Window = React.forwardRef(\n  (\n    {\n      children,\n      elWindowManager,\n\n      // TODO: Obtain via windowController instead?\n      isActive,\n\n      titleBarView,\n\n      style = {},\n      ...rest\n    },\n    ref\n  ) => {\n    const [windowController, attachWindowController] = useState(null);\n\n    // These are exposed to the WindowManager\n    useImperativeHandle(ref, () => ({\n      // windowSymbol: Symbol(\"window\"),\n      attachWindowController,\n    }));\n\n    // The windowController should already be supplied by WindowManager before\n    // rendering is even attempted\n    if (!windowController) {\n      return null;\n    }\n\n    return (\n      <WindowView\n        {...rest}\n        style={style}\n        elWindowManager={elWindowManager}\n        windowController={windowController}\n        isActive={isActive}\n        titleBarView={titleBarView}\n      >\n        {children}\n      </WindowView>\n    );\n  }\n);\n\nexport default Window;\n","import React from \"react\";\n\nimport useObjectState from \"@hooks/useObjectState\";\n\nexport const WindowContext = React.createContext({});\n\n// TODO: Document (per-window WindowProvider)\n// TODO: Use prop-types\nexport default function WindowProvider({ children, initialSharedState = {} }) {\n  const [sharedState, setSharedState] = useObjectState(initialSharedState);\n\n  return (\n    <WindowContext.Provider\n      value={{\n        setSharedState,\n        sharedState,\n      }}\n    >\n      {children}\n    </WindowContext.Provider>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport debounce from \"debounce\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useLocationAppRegistrationID from \"@hooks/useLocationAppRegistrationID\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nimport { useHistory } from \"react-router-dom\";\n\nexport const WindowManagerRouteContext = React.createContext({});\n\n/**\n * Updates React Router location and provides location-based handling for\n * ReShell applications.\n */\nexport default function WindowManagerRouteProvider({ children }) {\n  const { getAppRuntimesWithRegistrationID, activateAppRegistrationWithID } =\n    useAppOrchestrationContext();\n\n  const { activeWindowController, setActiveWindowController } =\n    useDesktopContext();\n\n  // Detected app registration ID from React Router URL location\n  const locationAppRegistrationID = useLocationAppRegistrationID();\n\n  // Update active app registration based on location changes\n  useEffect(() => {\n    if (locationAppRegistrationID) {\n      // Launch, or bring to front\n      activateAppRegistrationWithID(locationAppRegistrationID);\n    } else {\n      setActiveWindowController(null);\n    }\n  }, [\n    locationAppRegistrationID,\n    getAppRuntimesWithRegistrationID,\n    setActiveWindowController,\n    activateAppRegistrationWithID,\n  ]);\n\n  // Active window controller app registration ID\n  const activeRegistrationID = activeWindowController\n    ?.getAppRuntime()\n    ?.getRegistrationID();\n\n  const history = useHistory();\n\n  // Update URL when active registration ID changes\n  useEffect(() => {\n    if (activeRegistrationID !== locationAppRegistrationID) {\n      // IMPORTANT: This debounce fixes an issue where the browser could get\n      // stuck in an infinite URL redirect loop if in-development and certain\n      // host files were updated. Firefox could still see the issue present\n      // with a lower debounce time (of 0).\n      // @see https://github.com/jzombie/pre-re-shell/issues/129\n      const handleRegistrationOrLocationChange = debounce(\n        () =>\n          history.push(activeRegistrationID ? `/${activeRegistrationID}` : \"/\"),\n\n        50,\n        false\n      );\n\n      handleRegistrationOrLocationChange();\n\n      return () => handleRegistrationOrLocationChange.clear();\n    }\n  }, [activeRegistrationID, locationAppRegistrationID, history]);\n\n  return (\n    <WindowManagerRouteContext.Provider value={{}}>\n      {children}\n    </WindowManagerRouteContext.Provider>\n  );\n}\n","import { EVT_UPDATED, EVT_DESTROYED } from \"phantom-core\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\n\nimport useRegistrationViewOnResized from \"./hooks/useRegistrationViewOnResized\";\n\nimport Cover from \"@components/Cover\";\nimport Window from \"@components/Window\";\nimport WindowProvider from \"@components/Window/Window.Provider\";\nimport useWindowContext from \"@components/Window/hooks/useWindowContext\";\nimport WindowController from \"@components/Window/classes/WindowController\";\n\nimport WindowManagerRouteProvider from \"./WindowManager.RouteProvider\"; // WindowManagerRouteContext,\n\nimport useServicesContext from \"@hooks/useServicesContext\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport useForceUpdate from \"@hooks/useForceUpdate\";\n\n// TODO: Add hotkey listener service and map to active window\n\n// TODO: Refactor (shared across all windows to determine relevant zIndexes)\nlet stackingIndex = 0;\n\n// TODO: Document\n// TODO: Use prop-types\nexport default function WindowManager({ appDescriptors = [], children }) {\n  const { addOrUpdateAppRegistration } = useAppOrchestrationContext();\n\n  // TODO: Refactor outside of window manager?\n  useEffect(() => {\n    appDescriptors.forEach(descriptor =>\n      addOrUpdateAppRegistration(descriptor)\n    );\n\n    // TODO: Add or update these descriptors in the appropriate provider\n  }, [appDescriptors, addOrUpdateAppRegistration]);\n\n  return (\n    <WindowManagerRouteProvider>\n      <WindowManagerView>{children}</WindowManagerView>\n    </WindowManagerRouteProvider>\n  );\n}\n\nfunction WindowManagerView({ children }) {\n  const { appRuntimes } = useAppOrchestrationContext();\n\n  const [elBase, setElBase] = useState(null);\n\n  const {\n    activeWindowController: desktopContextActiveWindowController,\n    setActiveWindowController: setDesktopContextActiveWindowController,\n  } = useDesktopContext();\n\n  // TODO: Document\n  const [windowControllerMaps, setWindowControllerMaps] = useState({});\n\n  /**\n   * @param {number | string } key\n   * @return {Object | void} // TODO: Document structure\n   */\n  const getWindowControllerMapWithKey = useCallback(\n    key => {\n      const map = windowControllerMaps[key];\n\n      return map;\n    },\n    [windowControllerMaps]\n  );\n\n  // IMPORTANT: Prevents infinite loop of handleSetActiveWindow when used as dependency\n  const refDesktopContextActiveWindowController = useRef(null);\n  refDesktopContextActiveWindowController.current =\n    desktopContextActiveWindowController;\n\n  /**\n   * @param {WindowController | null} windowController?\n   * @return {void}\n   */\n  const handleSetActiveWindow = useCallback(\n    windowController => {\n      // Restore minimized windows\n      // IMPORTANT: This should come before the is-current-window determination\n      // so that the Dock (and other activators) can un-minimize, regardless of\n      // the active window\n      if (windowController?.getIsMinimized()) {\n        windowController.setIsMinimized(false);\n      }\n\n      if (\n        !Object.is(\n          windowController,\n          refDesktopContextActiveWindowController.current\n        )\n      ) {\n        setDesktopContextActiveWindowController(windowController);\n\n        if (windowController) {\n          // TODO: Don't bring to front if already in front (i.e. is already the active window)\n          windowController.setState({ stackingIndex: ++stackingIndex });\n        }\n      }\n    },\n    [setDesktopContextActiveWindowController]\n  );\n\n  /**\n   * Retrieves whether or not the given window controller is attached to the\n   * active window.\n   *\n   * @return {boolean}\n   */\n  const handleGetIsActiveWindow = useCallback(\n    windowController =>\n      Object.is(desktopContextActiveWindowController, windowController),\n    [desktopContextActiveWindowController]\n  );\n\n  const { startServiceClass } = useServicesContext();\n\n  // Handle when window manager is clicked on directly (no window interacted with directly)\n  const refHandleSetActiveWindow = useRef(handleSetActiveWindow);\n  refHandleSetActiveWindow.current = handleSetActiveWindow;\n  useEffect(() => {\n    if (elBase) {\n      const _handleElBaseTouch = evt => {\n        // Deselect active window if desktop base is touched\n        if (evt.target === elBase) {\n          refHandleSetActiveWindow.current(null);\n        }\n      };\n\n      elBase.addEventListener(\"mousedown\", _handleElBaseTouch);\n      elBase.addEventListener(\"touchstart\", _handleElBaseTouch, {\n        // @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n        passive: true,\n      });\n\n      return function unmount() {\n        elBase.removeEventListener(\"mousedown\", _handleElBaseTouch);\n        elBase.removeEventListener(\"touchstart\", _handleElBaseTouch, {\n          // FIXME: (jh) I'm not positive if this should be on the\n          // removeEventListener (I think not, but erroring on the side of\n          // caution)\n          // @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n          // @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener\n          passive: true,\n        });\n      };\n    }\n  }, [elBase]);\n\n  /**\n   * Determines which windows are rendered to the screen at any given time, as\n   * \\well as controls instantiation and association of window controllers with\n   * their respective views.\n   *\n   * @type {React.Component[]}\n   */\n  // TODO: Can this be memoized again even w/ hooks running in window\n  // descriptors?\n  // TODO: Fix issue where every window will re-render when another window\n  // actively goes on top (not sure if it's a huge deal, but is seemingly\n  // unnecessary)\n  //\n  // TODO: Somehow figure out support for reparenting if needing to change\n  // window manager layouts: https://github.com/facebook/react/issues/3965\n  // (maybe this? https://www.npmjs.com/package/react-reverse-portal)\n  const windows = appRuntimes\n    .map(appRuntime => {\n      const appDescriptor = appRuntime.getAppDescriptor();\n      if (!appDescriptor) {\n        return null;\n      }\n\n      // TODO: Ensure key is unique across the map\n      const key = appRuntime.getUUID();\n\n      // NOTE: The variables absorbed by this decompositor (except for\n      // windowProps) are NOT passed down to the underlying DOM element of the\n      // window\n      //\n      // FIXME: (jh) Perhaps this logic should be refactored and most props not\n      // utilized on every single render (maybe the complete wrapped window\n      // could be a separate component instead of re-calcuating all of this\n      // stuff on every render)\n      const {\n        view: ViewComponent,\n        titleBarView,\n        initialSharedState,\n\n        // This one is tricky, don't pass up registration ID as DOM element ID\n        id,\n\n        title,\n        serviceClasses = [],\n        isPinned,\n        isPinnedToDock,\n        isAutoStart,\n        ...windowProps\n      } = appDescriptor;\n\n      if (!ViewComponent) {\n        return null;\n      }\n\n      // TODO: Re-active previously focused element when bringing new window to\n      // top\n\n      // TODO: (mostly for development), determine changed descriptor window\n      // title and update the window controller w/ new values\n\n      // TODO: Document\n      const dataMap = getWindowControllerMapWithKey(key);\n\n      /** @type {WindowController | void} */\n      const windowController = dataMap && dataMap.windowController;\n\n      // TODO: Fix issues with rendering errors related to the usage of this\n      /*\n      if (windowController) {\n        windowController.__INTERNAL__setIsActive(\n          handleGetIsActiveWindow(windowController)\n        );\n      }\n      */\n\n      // If we previously had a window controller running with this id\n      //\n      // TODO: Implement ability to flush this and restart a window with the same id?\n      if (dataMap && !dataMap.windowController) {\n        return null;\n      }\n\n      // TODO: Memoize this handling\n      // TODO: Attach services to window controller so other UI utilities can\n      // reference what is specific to this window\n      // TODO: Rename to appServices?\n      const appServices = {};\n      for (const serviceClass of serviceClasses) {\n        const service = startServiceClass(serviceClass);\n\n        appServices[serviceClass] = service;\n      }\n\n      // TODO: Memoize this component, when refactoring outer map\n      return (\n        <WindowProvider key={key} initialSharedState={initialSharedState}>\n          <Window\n            {...windowProps}\n            elWindowManager={elBase}\n            // TODO: Remove isActive and pass in from WindowController to the window\n            isActive={handleGetIsActiveWindow(windowController)}\n            onMouseDown={() => handleSetActiveWindow(windowController)}\n            onTouchStart={() => handleSetActiveWindow(windowController)}\n            titleBarView={\n              titleBarView ? (\n                <WrappedTitleBarView\n                  titleBarView={titleBarView}\n                  appServices={appServices}\n                  windowController={windowController}\n                  appRuntime={appRuntime}\n                />\n              ) : null\n            }\n            ref={ref => {\n              if (ref && !windowController) {\n                // Begin process of attaching window controller to rendered view\n                // and setting up event bindings\n\n                const windowController = new WindowController(\n                  {},\n                  {\n                    onBringToTop: handleSetActiveWindow,\n                  }\n                );\n\n                windowController.setTitle(title);\n\n                windowController.__INTERNAL__attachWindowManagerElement(elBase);\n\n                // Link app runtime to window controller (so that when the window\n                // controller is destructed it will take down the app runtime)\n                windowController.setAppRuntime(appRuntime);\n                appRuntime.__INTERNAL__setWindowController(windowController);\n\n                // Attach the view controller to the window\n                ref.attachWindowController(windowController);\n\n                setWindowControllerMaps(prev => {\n                  const next = { ...prev };\n                  next[key] = {\n                    windowController,\n                    key,\n                    // windowSymbol: ref.windowSymbol,\n                  };\n\n                  return next;\n                });\n\n                windowController.once(EVT_DESTROYED, () => {\n                  setWindowControllerMaps(prev => {\n                    const next = { ...prev };\n\n                    next[key].windowController = null;\n\n                    return next;\n                  });\n                });\n\n                // Set this new window as the active window\n                handleSetActiveWindow(windowController);\n              }\n            }}\n          >\n            {\n              // Wrap the view so that it updates when a bound service updates\n              // NOTE: (jh) I originally tried wrapping the window itself, but\n              // it didn't work, and it's a better idea to only update what's\n              // necessary anyway\n            }\n            {windowController && (\n              <WrappedWindowView\n                appServices={appServices}\n                windowController={windowController}\n                appRuntime={appRuntime}\n                view={ViewComponent}\n              />\n            )}\n          </Window>\n        </WindowProvider>\n      );\n    })\n    .filter(window => Boolean(window));\n\n  return (\n    <Cover>\n      {\n        // TODO: Bind touch event to this element, and if directly touching it,\n        // make currently active window not active (if cursor is in another\n        // window, ensure it is removed as well)\n        //\n        // setActiveWindowController(null)\n      }\n      <div\n        ref={setElBase}\n        style={{ width: \"100%\", height: \"100%\", position: \"relative\" }}\n      >\n        {children}\n\n        {windows}\n      </div>\n    </Cover>\n  );\n}\n\n// TODO: Document\nconst WrappedTitleBarView = function ({ titleBarView, ...rest }) {\n  return <WrappedWindowView {...rest} view={titleBarView} />;\n};\n\n// FIXME: (jh) [As a consideration] Implement Svelte lifecycle methods, to\n// avoid users having to deal with hooks (keep hooks as more of a low-level\n// thing instead, if possible)\n// - https://svelte.dev/tutorial/onmount\n// - https://svelte.dev/tutorial/ondestroy\n// - https://svelte.dev/tutorial/update\n// - https://svelte.dev/tutorial/tick\n// Maybe we can say, \"we built a rendering engine on top of React, so that\n// React components can be used, without the complexity of dealing with React\n// hook dependencies, in order to reduce excessive rendering, or stale states,\n// caused by improper user of hook dependencies\".... could also smooth the\n// transition over to Svelte or any other rendering engine for apps created on\n// top of one of them.\n//\n// TODO: Document; rename? (NOTE: this wrapped view was designed to make it\n// easier to make the wrapping view render out-of-sequence with the containing\n// view, such as when a service updates, etc.)\nfunction WrappedWindowView({\n  appServices,\n  windowController,\n  appRuntime,\n  view: ViewComponent,\n}) {\n  const forceUpdate = useForceUpdate();\n\n  const { sharedState, setSharedState } = useWindowContext();\n\n  // Re-render window when a service updates\n  useEffect(() => {\n    const _handleServiceUpdate = () => {\n      forceUpdate();\n    };\n\n    for (const service of Object.values(appServices)) {\n      // TODO: Make this channel-specific (i.e. EVT_MAIN_STATE_UPDATED)?\n      service.on(EVT_UPDATED, _handleServiceUpdate);\n    }\n\n    return function unmount() {\n      for (const service of Object.values(appServices)) {\n        // TODO: Make this channel-specific (i.e. EVT_MAIN_STATE_UPDATED)?\n        service.off(EVT_UPDATED, _handleServiceUpdate);\n      }\n    };\n  }, [appServices, forceUpdate]);\n\n  // TODO: Document\n  const setResizeHandler = useRegistrationViewOnResized(windowController);\n\n  return (\n    <ViewComponent\n      windowController={windowController}\n      appServices={appServices}\n      appRuntime={appRuntime}\n      setResizeHandler={setResizeHandler}\n      sharedState={sharedState}\n      setSharedState={setSharedState}\n    />\n  );\n}\n","import { useContext } from \"react\";\nimport { WindowContext } from \"../Window.Provider\";\n\n// TODO: Document (per-window useWindowContext)\nexport default function useWindowContext() {\n  return useContext(WindowContext);\n}\n","import { useCallback, useEffect, useRef } from \"react\";\nimport WindowController, {\n  EVT_RESIZED,\n} from \"@components/Window/classes/WindowController\";\n\n/**\n * Handles automatic invocation of AppRegistration view's setResizeHandler when\n * the relevant window resizes.\n *\n * @param {WindowController} windowController\n * @return {function}\n */\nexport default function useRegistrationViewOnResized(windowController) {\n  const refSetResizeHandler = useRef(null);\n\n  /**\n   * @param {function | void} setResizeHandler Passed up from AppRegistration view\n   * properties.\n   */\n  const handleResized = useCallback(setResizeHandler => {\n    /**\n     * onResized is passed from view, and is executed by the WindowManager when\n     * the WindowController emits EVT_RESIZED event.\n     */\n    refSetResizeHandler.current = setResizeHandler;\n  }, []);\n\n  useEffect(() => {\n    if (windowController) {\n      if (!(windowController instanceof WindowController)) {\n        throw new TypeError(\"windowController is not a WindowController\");\n      }\n\n      const _handleExecResizedCallback = () => {\n        const onResized = refSetResizeHandler.current;\n\n        // AppRegistration view might not set an onResized handler\n        if (typeof onResized === \"function\") {\n          onResized();\n        }\n      };\n\n      windowController.on(EVT_RESIZED, _handleExecResizedCallback);\n\n      return function unmount() {\n        windowController.off(EVT_RESIZED, _handleExecResizedCallback);\n      };\n    }\n  }, [windowController]);\n\n  return handleResized;\n}\n","import WindowManager from \"./WindowManager\";\n\nexport default WindowManager;\n","import Menu from \"./Menu\";\n\nexport default Menu;\n","import MenuBar from \"./MenuBar\";\n\nexport default MenuBar;\n","import { useEffect, useState } from \"react\";\nimport Menu from \"../Menu\";\nimport NoWrap from \"../NoWrap\";\n\nimport PropTypes from \"prop-types\";\n\n// FIXME: (jh) Implement keyboard accessibility across menu bar: https://szhsin.github.io/react-menu/docs#keyboard\n\nMenuBar.propTypes = {\n  /**\n   * FIXME: (jh) Document structure\n   *\n   * Reference example:\n   * @see {@link https://www.electronjs.org/docs/api/menu#examples}\n   */\n  menuStructures: PropTypes.arrayOf(PropTypes.object).isRequired,\n};\n\nexport default function MenuBar({ menuStructures = [] }) {\n  const [openedIndexes, _setOpenedIndexes] = useState([]);\n  const [isActive, _setIsActive] = useState(false);\n\n  // Set active state depending on if there are opened menu indexes\n  useEffect(() => {\n    const nextIsActive = Boolean(openedIndexes.length);\n\n    if (isActive !== nextIsActive) {\n      _setIsActive(nextIsActive);\n\n      if (!nextIsActive) {\n        _setOpenedIndexes([]);\n      }\n    }\n  }, [isActive, openedIndexes]);\n\n  // Reset menus if there is an open index registered to a now non-existent\n  // menu structure index\n  useEffect(() => {\n    for (const idx of openedIndexes) {\n      if (!menuStructures[idx]) {\n        _setOpenedIndexes([]);\n        _setIsActive(false);\n\n        break;\n      }\n    }\n  }, [openedIndexes, menuStructures]);\n\n  // FIXME: (jh) Determine if overflown, and adjust layout as necessary (perhaps\n  // by converging menu data structures)\n\n  return (\n    <NoWrap>\n      {menuStructures.map(\n        (menuStructure, idx) =>\n          menuStructure && (\n            <Menu\n              key={idx}\n              menuStructure={menuStructure}\n              onOpen={() =>\n                // Add this idx to list of opened indexes, if not already added\n                _setOpenedIndexes(prev => [...new Set([...prev, idx])])\n              }\n              onClose={() =>\n                // Remove this idx from list of opened indexes\n                _setOpenedIndexes(prev => prev.filter(pred => pred !== idx))\n              }\n              opened={Boolean(openedIndexes.includes(idx))}\n              onMouseOver={() => {\n                if (isActive) {\n                  if (!openedIndexes.includes(idx)) {\n                    // Close other menus\n                    _setOpenedIndexes([idx]);\n                  }\n                }\n              }}\n            />\n          )\n      )}\n    </NoWrap>\n  );\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n/**\n * Handles management of UI modals.\n *\n * FIXME: (jh) This class cannot be reliably extended and still maintain\n * correct functionality in extended services. PhantomCore needs the ability\n * to not be able to extend a class.\n * Relevant issue: https://github.com/zenOSmosis/phantom-core/issues/149\n */\nexport default class UIModalService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"UI Modal Service\");\n\n    this.setState({\n      modals: [],\n    });\n  }\n\n  /**\n   * Renders the given modal view.\n   *\n   * Sends the given React component as a message to the ModalProvider.\n   *\n   * @param {React.Component} view\n   * @param {Object} options? [default = {}] TODO: Document options\n   */\n  showModal(view, options = {}) {\n    const uuid = uuidv4();\n\n    let timeout = null;\n\n    /**\n     * Closes the modal.\n     *\n     * @return {void}\n     */\n    const _handleClose = () => {\n      clearTimeout(timeout);\n\n      this.closeModalWithUUID(uuid);\n    };\n\n    this.setState({\n      // Add new modals to end of stack\n      modals: [\n        ...this.getState().modals,\n        {\n          view,\n          uuid,\n          // NOTE: It is intended for onCancel and onClose to call the same\n          // _handleClose handler, as they are both intended to close the\n          // modal. Functionality differences between the two callbacks are\n          // handled within the view composition.\n          onClose: _handleClose,\n          onCancel: _handleClose,\n        },\n      ],\n    });\n\n    // TODO: [To fix issue where typing can still occur on below elements] If\n    // an element was focused before modal is displayed, remove the focus, and\n    // [potentially] reapply to the element once the modal is gone.  Can\n    // underlying elements still be selected and can tabindex somehow fix that?\n\n    // Handles auto-closing of the modal if it has a set duration\n    if (options.duration) {\n      timeout = setTimeout(() => {\n        this.closeModalWithUUID(uuid);\n      }, options.duration);\n    }\n  }\n\n  /**\n   * Closes the modal with the given UUID, if exists.\n   *\n   * @param {string} uuid\n   * @return {void}\n   */\n  closeModalWithUUID(uuid) {\n    const nextModals = this.getState().modals.filter(({ uuid: prevUUID }) => {\n      const isKept = uuid !== prevUUID;\n\n      return isKept;\n    });\n\n    this.setState({\n      modals: nextModals,\n    });\n  }\n}\n","import Padding from \"./Padding\";\n\nexport default Padding;\n","import { useEffect, useState } from \"react\";\n\nimport styles from \"./Padding.module.css\";\nimport classNames from \"classnames\";\n\nexport default function Padding({ children, className, ...rest }) {\n  const [el, setEl] = useState(null);\n  const [hasSiblings, setHasSiblings] = useState(false);\n\n  // Auto-determine if the element has siblings\n  useEffect(() => {\n    if (el) {\n      const hasSiblings = Boolean([...el.parentNode.children].length > 1);\n\n      setHasSiblings(hasSiblings);\n    }\n  }, [el]);\n\n  return (\n    <div\n      {...rest}\n      ref={setEl}\n      className={classNames(\n        styles[\"padding\"],\n        !hasSiblings && styles[\"no-siblings\"],\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`id92dd65b22cd4a62996cb3b8e0f579db-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import { useEffect, useMemo } from \"react\";\n\nconst DEFAULT_PROPS = {\n  onKeyDown: keyCode => null,\n  onKeyUp: keyCode => null,\n  onEnter: () => null,\n  onEscape: () => null,\n  isEnabled: true,\n};\n\n/**\n * Binds keyboard event handlers to the given DOM element.\n *\n * IMPORTANT: If domNode is captured via a ref on a React element, the ref\n * should be wired through a useState in the component, and the resulting state\n * be sent here, or it might not work on subsequent calls. This is a known\n * issue when trying to use with multiple iterations of TextInputModal.\n *\n * @param {DOMElement} domNode // TODO: Default to window or document body?\n * @param {Object} props TODO: Document structure\n */\nexport default function useKeyboardEvents(domNode, props = {}) {\n  const { onKeyDown, onKeyUp, onEnter, onEscape, isEnabled } = useMemo(\n    () => ({ ...DEFAULT_PROPS, ...props }),\n    [props]\n  );\n\n  // Handle event binding and unbinding\n  useEffect(() => {\n    if (!domNode || !isEnabled) {\n      return;\n    }\n\n    const _handleKeyDown = evt => {\n      // Prevent repeated calls from holding down a key\n      if (evt.repeat) {\n        return;\n      }\n\n      onKeyDown(evt.which);\n\n      switch (evt.which) {\n        case 13:\n          onEnter();\n          break;\n\n        case 27:\n          onEscape();\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    const _handleKeyUp = evt => {\n      evt.preventDefault();\n\n      onKeyUp(evt.which);\n    };\n\n    domNode.addEventListener(\"keydown\", _handleKeyDown);\n    domNode.addEventListener(\"keyup\", _handleKeyUp);\n\n    return () => {\n      domNode.removeEventListener(\"keydown\", _handleKeyDown);\n      domNode.removeEventListener(\"keyup\", _handleKeyUp);\n    };\n  }, [domNode, onKeyDown, onKeyUp, onEnter, onEscape, isEnabled]);\n}\n","import React, { useState } from \"react\";\nimport Full from \"@components/Full\";\nimport Layout, { Header, Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\n\nimport CloseIcon from \"@icons/CloseIcon\";\n\nimport classNames from \"classnames\";\nimport styles from \"./SystemModal.module.css\";\n\nimport useViewportSize from \"@hooks/useViewportSize\";\nimport useKeyboardEvents from \"@hooks/useKeyboardEvents\";\n\nlet _prevIsSmallViewport = false;\n\n// TODO: Add prop-types\n/**\n * TODO: Document updated type\n *\n * SystemModal is inspired by OS setup screens, and is typically used outside\n * of the main application to drive any sort of helper utilities needed to\n * configure the application.\n */\nexport default function SystemModal({\n  children,\n  className,\n  onClose,\n  onCancel,\n  headerView = null,\n  footerView = ({ onCancel }) => (\n    <div style={{ textAlign: \"center\" }}>\n      <Padding>\n        <button onClick={onCancel} style={{ backgroundColor: \"red\" }}>\n          <CloseIcon /> Cancel\n        </button>\n      </Padding>\n    </div>\n  ),\n  // theme = THEME_DARK,\n}) {\n  const [isSmallViewport, _setIsSmallViewport] = useState(_prevIsSmallViewport);\n\n  // Cache value for next full SystemModal lifecycle\n  //\n  // Fixes issue where display readjusts when switching navigation links in\n  // SystemModal\n  _prevIsSmallViewport = isSmallViewport;\n\n  // Automatically configure layout based on viewport size\n  useViewportSize(({ width, height }) => {\n    // TODO: Use range constants\n    if (width < 500 || height < 600) {\n      _setIsSmallViewport(true);\n    } else {\n      _setIsSmallViewport(false);\n    }\n  });\n\n  // Close modal when escape button is pressed\n  useKeyboardEvents(window, {\n    onEscape: onCancel,\n  });\n\n  return (\n    <Full\n      className={classNames(\n        styles[\"system-modal\"],\n        isSmallViewport ? styles[\"small-viewport\"] : null,\n        className\n      )}\n    >\n      <div className={styles[\"outer-wrap\"]}>\n        <div className={styles[\"inner-wrap\"]}>\n          <Layout>\n            {headerView && (\n              <Header className={styles[\"header\"]}>\n                {typeof headerView === \"function\"\n                  ? headerView({ onCancel, onClose })\n                  : headerView}\n              </Header>\n            )}\n\n            <Content>{children}</Content>\n\n            {footerView && (\n              <Footer className={styles[\"footer\"]}>\n                {typeof footerView === \"function\"\n                  ? footerView({ onCancel, onClose })\n                  : footerView}\n              </Footer>\n            )}\n          </Layout>\n        </div>\n      </div>\n    </Full>\n  );\n}\n","import SystemModal from \"./SystemModal\";\n\nexport default SystemModal;\n","import { useCallback, useEffect, useRef } from \"react\";\nimport { debounce } from \"debounce\";\n\nconst DEFAULT_DEBOUNCE_TIME = 100;\n\n/**\n * Calls onChange handler whenever viewport size changes.\n *\n * Note that this does not re-render the component per size change in order to\n * save render cycles / prevent weird effects such as inputs losing focus when\n * mobile software keyboards render.\n *\n * @param {function | any} onChange If a non-functional value is passed the\n * hook will not monitor viewport size\n * @param {number} debounceTime? [default = 100] Minimum number of milliseconds\n * to wait between subsequent onChange callbacks\n */\nexport default function useViewportSize(\n  /**\n   * i.e. ({ width, height }) => console.log({width, height})\n   */\n  onChange,\n  debounceTime = DEFAULT_DEBOUNCE_TIME\n) {\n  const _getViewportSize = useCallback(() => {\n    const { innerWidth: width, innerHeight: height } = window;\n\n    return {\n      width,\n      height,\n    };\n  }, []);\n\n  // Wrap onChange so we can pass it through the next useEffect without\n  // creating a dependency\n  const refOnChange = useRef(onChange);\n  refOnChange.current = onChange;\n\n  useEffect(() => {\n    if (typeof refOnChange.current === \"function\") {\n      const _handleViewportSize = debounce(\n        () => {\n          const onChange = refOnChange.current;\n\n          const size = _getViewportSize();\n\n          onChange(size);\n        },\n        debounceTime,\n        // Trailing edge\n        false\n      );\n\n      // Perform initial sync\n      _handleViewportSize();\n\n      // TODO: Use common handler instead\n      window.addEventListener(\"resize\", _handleViewportSize);\n\n      return function unmount() {\n        window.removeEventListener(\"resize\", _handleViewportSize);\n      };\n    }\n  }, [debounceTime, _getViewportSize]);\n}\n","import ConfirmModal from \"./ConfirmModal\";\n\nexport default ConfirmModal;\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\n\nimport SystemModal from \"../SystemModal\";\n\nimport PropTypes from \"prop-types\";\n\nConfirmModal.propTypes = {\n  text: PropTypes.string.isRequired,\n};\n\n/**\n * Renders a boolean \"accept\" / \"reject\" (yes / no) dialog.\n */\nexport default function ConfirmModal({\n  text,\n  onCancel,\n  onClose,\n  footerView = ({ onCancel, onClose }) => (\n    <div style={{ textAlign: \"center\" }}>\n      <Padding>\n        <button\n          onClick={onClose}\n          style={{\n            // TODO: Use color variable for highlighted elements\n            backgroundColor: \"#347fe8\",\n          }}\n        >\n          Accept\n        </button>\n\n        <div style={{ display: \"inline-block\", width: \"1em\" }} />\n\n        <button onClick={onCancel} style={{ backgroundColor: \"red\" }}>\n          Reject\n        </button>\n      </Padding>\n    </div>\n  ),\n  ...rest\n}) {\n  return (\n    <SystemModal\n      {...rest}\n      onCancel={onCancel}\n      onClose={onClose}\n      footerView={footerView}\n    >\n      <Center canOverflow={true} style={{ fontWeight: \"bold\" }}>\n        {text}\n      </Center>\n    </SystemModal>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`i91eec2200f934fc6a4087e250fa26340-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./ButtonTransparent.module.css\";\n\n// TODO: Rename to ButtonUnstyled?\nfunction ButtonTransparent({ children, className, ...rest }) {\n  return (\n    <button\n      className={classNames(styles[\"button-transparent\"], className)}\n      {...rest}\n    >\n      {children}\n    </button>\n  );\n}\n\nexport default ButtonTransparent;\n","import ButtonTransparent from './ButtonTransparent';\n\nexport default ButtonTransparent;","import { PhantomCollection } from \"phantom-core\";\nimport { useEffect, useState } from \"react\";\nimport usePrevious from \"./usePrevious\";\n\n/**\n * @typedef {Object} ArrayDiff\n * @property {any[]} added Elements added since last change\n * @property {any[]} removed Elements removed since last change\n *\n * @param {any[]} next\n * @return {ArrayDiff}\n */\nexport default function useArrayDiff(next) {\n  // IMPORTANT: Using empty array for previous default value\n  const prev = usePrevious(next, []);\n\n  const [addedRemoved, _setAddedRemoved] = useState({ added: [], removed: [] });\n\n  useEffect(() => {\n    // NOTE: This check is inside the useEffect so it is not re-run more often\n    // than it should\n    if (!Array.isArray(next)) {\n      throw new Error(\"next should be an array\");\n    }\n\n    const { added, removed } = PhantomCollection.getChildrenDiff(prev, next);\n\n    if (added.length || removed.length) {\n      _setAddedRemoved({\n        added,\n        removed,\n      });\n    }\n  }, [prev, next]);\n\n  return {\n    added: addedRemoved.added,\n    removed: addedRemoved.removed,\n  };\n}\n","import { useEffect, useRef } from \"react\";\n\nconst DEFAULT_REF_VALUE = null;\n\n/**\n * Adapted from:\n * @see https://usehooks.com/usePrevious\n *\n * getPreviousValue, a memoized callback with no dependencies, was added so\n * that the value could be obtained from within a hook without the value being\n * called as a dependency, which could cause an additional render.\n *\n * @param {any} value The current value\n * @param {boolean} defaultPreviousValue? [default = null]\n * @return {any} The previous value\n */\nexport default function usePrevious(\n  value,\n  defaultPreviousValue = DEFAULT_REF_VALUE\n) {\n  // The ref object is a generic container whose \"current\" property is mutable\n  // and can hold any value, similar to an instance property on a class\n  const refPrev = useRef(defaultPreviousValue);\n\n  // Store current value in ref\n  // Only re-run if value changes\n  useEffect(() => {\n    refPrev.current = value;\n  }, [value]);\n\n  // Return previous value (happens before update in useEffect above)\n  return refPrev.current;\n}\n","import { useEffect, useMemo, useRef, useState } from \"react\";\nimport { MultiAudioMediaStreamTrackLevelMonitor } from \"media-stream-track-controller\";\nimport useArrayDiff from \"./useArrayDiff\";\n\nconst { EVT_AUDIO_LEVEL_UPDATED } = MultiAudioMediaStreamTrackLevelMonitor;\n\n/**\n * Utilizes a MultiAudioMediaStreamTrackLevelMonitor as a React hook.\n *\n * @param {MediaStreamTrack | MediaStreamTrack[] | null} mediaStreamTrackOrTracks?\n * [default = []] A single track, or an array of tracks.  It is made optional\n * because rendered audio level meters may not already have an associated\n * MediaStreamTrack. NOTE: It will automatically filter out non-audio tracks.\n * @param {function} onAudioLevelChange Callback which is executed each time the audio level is changed.\n * @return {void}\n */\nexport default function useMultiAudioMediaStreamTrackLevelMonitor(\n  mediaStreamTrackOrTracks = [],\n  onAudioLevelChange\n) {\n  /**\n   * @type {MediaStreamTrack[]}\n   */\n  const mediaStreamTracks = useMemo(\n    () =>\n      (!mediaStreamTrackOrTracks\n        ? []\n        : Array.isArray(mediaStreamTrackOrTracks)\n        ? mediaStreamTrackOrTracks\n        : [mediaStreamTrackOrTracks]\n      ).filter(\n        track => track instanceof MediaStreamTrack && track.kind === \"audio\"\n      ),\n    [mediaStreamTrackOrTracks]\n  );\n\n  const [mediaStreamMonitor, _setMediaStreamMonitor] = useState(null);\n\n  const refOnAudioLevelChange = useRef(onAudioLevelChange);\n  refOnAudioLevelChange.current = onAudioLevelChange;\n\n  // Instantiate and bind MultiAudioMediaStreamTrackLevelMonitor audio level\n  // state to hook state\n  useEffect(() => {\n    const mediaStreamMonitor = new MultiAudioMediaStreamTrackLevelMonitor();\n\n    // NOTE: This event handler will automatically be unbound once the class\n    // destructs\n    mediaStreamMonitor.on(EVT_AUDIO_LEVEL_UPDATED, audioLevel => {\n      refOnAudioLevelChange.current(audioLevel);\n    });\n\n    _setMediaStreamMonitor(mediaStreamMonitor);\n\n    return function unmount() {\n      if (!mediaStreamMonitor.getIsDestroying()) {\n        mediaStreamMonitor.destroy();\n      }\n    };\n  }, []);\n\n  const { added: addedMediaStreamTracks, removed: removedMediaStreamTracks } =\n    useArrayDiff(mediaStreamTracks);\n\n  // Sync hook's media stream tracks with the audio monitor instance\n  useEffect(() => {\n    if (mediaStreamMonitor) {\n      // Handle added / existing tracks\n      for (const track of addedMediaStreamTracks) {\n        mediaStreamMonitor.addMediaStreamTrack(track);\n      }\n\n      // Handle removed tracks\n      for (const track of removedMediaStreamTracks) {\n        mediaStreamMonitor.removeMediaStreamTrack(track);\n      }\n    }\n  }, [mediaStreamMonitor, addedMediaStreamTracks, removedMediaStreamTracks]);\n}\n","import AudioLevelMeter from \"./AudioLevelMeter\";\n\nexport default AudioLevelMeter;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./AudioLevelMeter.module.css\";\n\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport PropTypes from \"prop-types\";\n\nimport useMultiAudioMediaStreamTrackLevelMonitor from \"@hooks/useMultiAudioMediaStreamTrackLevelMonitor\";\n\nAudioLevelMeter.propTypes = {\n  className: PropTypes.string,\n\n  /** When multiple audio tracks may be used together */\n  mediaStreamTracks: PropTypes.arrayOf(PropTypes.instanceOf(MediaStreamTrack)),\n\n  /** When only a single track is used */\n  mediaStreamTrack: PropTypes.instanceOf(MediaStreamTrack),\n};\n\n/**\n * A vertical bar audio meter which takes up its full available vertical space\n * by default.\n *\n * Borrowed from:\n * @see https://codepen.io/snart1/pen/rRvwwr\n */\nexport default function AudioLevelMeter({\n  className,\n  mediaStreamTrack,\n  mediaStreamTracks,\n  ...rest\n}) {\n  const [elAudioLevel, setElAudioLevel] = useState(null);\n\n  // TODO: Replace w/ useUUID\n  const uuid = useMemo(uuidv4, []);\n\n  /**\n   * @param {number} audioLevel A float value from 0 - 100, where 100\n   * represents maximum strength.\n   * @return {void}\n   */\n  const handleAudioLevelChange = useCallback(\n    audioLevel => {\n      if (elAudioLevel) {\n        requestSkippableAnimationFrame(() => {\n          // Inset is inverse of the audio level\n          const inset = 100 - audioLevel;\n\n          elAudioLevel.style.clipPath = `inset(${inset}% 0 0 0)`;\n          elAudioLevel.style.WebkitClipPath = `inset(${inset}% 0 0 0)`;\n        }, uuid);\n      }\n    },\n    [elAudioLevel, uuid]\n  );\n\n  // Set initial level (otherwise they will default to appearing fully\n  // maxed-out, due to the CSS rules)\n  useEffect(() => {\n    if (elAudioLevel) {\n      handleAudioLevelChange(0);\n    }\n  }, [handleAudioLevelChange, elAudioLevel]);\n\n  useMultiAudioMediaStreamTrackLevelMonitor(\n    mediaStreamTrack || mediaStreamTracks,\n    handleAudioLevelChange\n  );\n\n  return (\n    <div className={classNames(styles[\"levels\"], className)} {...rest}>\n      {/*\n        NOTE: The original version of this supported a nice multi-track\n        reading, which is not compatible with this implementation. However it\n        could be enabled by adapting the following to the current setup.\n\n        {renderedLevels.map((percent, idx) => (\n        */}\n\n      <div className={styles[\"level-container\"]}>\n        <div ref={setElAudioLevel} className={styles[\"level\"]}></div>\n      </div>\n      {/*\n      ))}\n      */}\n    </div>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`ie8e4f3089b614c28aa33b6aaeff7d8b0-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import Padding from \"@components/Padding\";\nimport ButtonTransparent from \"@components/ButtonTransparent\";\nimport Center from \"@components/Center\";\nimport AudioLevelMeter from \"@components/audioMeters/AudioLevelMeter\";\n\nimport MicrophoneIcon from \"@icons/MicrophoneIcon\";\nimport CloseIcon from \"@icons/CloseIcon\";\n\n// TODO: Document and add prop-types\nexport default function AudioInputDeviceTableRow({\n  device,\n  mediaStreamTracks,\n  isCapturing,\n  onToggleCapture,\n  isMuted,\n  onToggleMute,\n  audioQualityPresets,\n  audioQualityPresetName,\n  onChangeAudioQualityPresetName,\n}) {\n  // TODO: Use constant for check type\n  if (device.kind !== \"audioinput\") {\n    throw new TypeError(\"device is not an audioinput device\");\n  }\n\n  return (\n    <tr style={isCapturing ? { backgroundColor: \"rgba(0,174,255,.2)\" } : null}>\n      <td>\n        <Padding>\n          <div style={{ fontWeight: \"bold\" }}>\n            {device.label || `[Unknown Label]`}\n          </div>\n\n          <div style={{ marginTop: 4 }}>\n            <span style={{ fontSize: \".7em\" }}>Quality:</span>{\" \"}\n            {!isCapturing ? (\n              <select\n                value={audioQualityPresetName}\n                onChange={evt =>\n                  onChangeAudioQualityPresetName(evt.target.value)\n                }\n                // FIXME: (jh) Due to issues with dynamically changing\n                // constraints while a media device is capturing in Chromium-\n                // based browsers, along with issues with WebRTCPeer / ZenRTCPeer\n                // not seeming to handle rapid track unpublishing / republishing,\n                // it seems better to force the user to have to stop the media\n                // device capturing before changing the preferred audio quality\n                // settings\n                disabled={isCapturing}\n              >\n                {audioQualityPresets.map((preset, idx) => {\n                  const presetName = preset.name;\n\n                  return (\n                    <option key={idx} value={presetName}>\n                      {presetName}\n                    </option>\n                  );\n                })}\n              </select>\n            ) : (\n              <button\n                onClick={onToggleCapture}\n                style={{ minWidth: 145, textAlign: \"left\" }}\n              >\n                {audioQualityPresetName}{\" \"}\n                <CloseIcon style={{ color: \"orange\", float: \"right\" }} />\n              </button>\n            )}\n          </div>\n        </Padding>\n      </td>\n\n      <td className=\"center\">\n        <Padding>\n          <button\n            onClick={onToggleCapture}\n            style={{\n              backgroundColor: isCapturing ? \"red\" : \"#347FE8\",\n              width: \"100%\",\n            }}\n          >\n            {isCapturing ? \"Stop\" : \"Start\"}\n          </button>\n        </Padding>\n      </td>\n      <td className=\"center\">\n        <Padding>\n          <ButtonTransparent\n            disabled={!isCapturing}\n            onClick={onToggleMute}\n            style={{\n              color: !isCapturing ? \"inherit\" : isMuted ? \"white\" : \"orange\",\n            }}\n          >\n            <div style={{ textAlign: \"center\" }}></div>\n            <MicrophoneIcon style={{ fontSize: \"1.5em\" }} />\n            <div style={{ fontSize: \".7em\", marginTop: 4 }}>\n              {!isCapturing ? \"N/A\" : isMuted ? \"Yes\" : \"No\"}\n            </div>\n          </ButtonTransparent>\n        </Padding>\n      </td>\n      <td\n        className=\"center\"\n        style={{\n          width: 80,\n          // NOTE: This height cascades down to the audio level meter and helps\n          // keep the row height consistent regardless of whether the meter is\n          // active or not\n          height: 70,\n        }}\n      >\n        <Padding>\n          {isCapturing ? (\n            device.kind === \"audioinput\" && (\n              <AudioLevelMeter mediaStreamTracks={mediaStreamTracks} />\n            )\n          ) : (\n            <Center style={{ color: \"gray\", fontSize: \".7em\" }}>Off</Center>\n          )}\n        </Padding>\n      </td>\n    </tr>\n  );\n}\n","import { deepMerge } from \"phantom-core\";\nimport UIServiceCore from \"@core/classes/UIServiceCore\";\nimport KeyVaultService from \"./KeyVaultService\";\n\nimport { utils } from \"media-stream-track-controller\";\n\nconst KEY_STORAGE_ENGINE_MEDIA_DEVICES = \"media-devices\";\n\nconst KEY_DMETA_DEVICE = \"device\";\nconst KEY_DMETA_USER_METADATA = \"userMetadata\";\n\n/**\n * Manages arbitrary associative information for media devices.\n */\nexport default class MediaDeviceCachingService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setState({\n      devicesWithUserMetadata: [],\n    });\n\n    this.setTitle(\"Media Device Caching Service\");\n\n    this._storageEngine =\n      this.useServiceClass(KeyVaultService).getSecureLocalStorageEngine();\n\n    // Set initial state from local storage\n    (async () => {\n      this._fetchCachedMediaDeviceUserMetadata().then(devicesWithUserMetadata =>\n        this.setState({ devicesWithUserMetadata })\n      );\n    })();\n  }\n\n  /**\n   * Adds user-defined information to the given media device.\n   *\n   * Subsequent calls will deep merge userMetadata with existing metadata.\n   *\n   * @param {MediaDeviceInfo} device\n   * @param {Object} userMetadata\n   * @return {Promise<void>}\n   */\n  async setMediaDeviceUserMetadata(device, userMetadata) {\n    if (typeof device !== \"object\") {\n      throw new TypeError(\"device must be an object\");\n    }\n\n    if (typeof userMetadata !== \"object\") {\n      throw new TypeError(\"userMetadata must be an object\");\n    }\n\n    // Current device (may be overwritten after fetching from cache)\n    let update = {\n      [KEY_DMETA_DEVICE]: device,\n      [KEY_DMETA_USER_METADATA]: userMetadata,\n    };\n\n    // Previously cached devices without the current device\n    const filteredCache = await this._fetchCachedMediaDeviceUserMetadata().then(\n      devicesWithUserMetadata =>\n        // Remove matched device from prev\n        devicesWithUserMetadata.filter(pred => {\n          const isMatch = utils.mediaDevice.getIsSameMediaDevice(\n            pred.device,\n            device\n          );\n\n          if (isMatch) {\n            // Deep merge new meta data on top of previous metadata\n            update = deepMerge(pred, {\n              [KEY_DMETA_USER_METADATA]: userMetadata,\n            });\n          }\n\n          return !isMatch;\n        })\n    );\n\n    // This is what will be written back to the local storage cache\n    const next = [...filteredCache, update];\n\n    await this._storageEngine.setItem(KEY_STORAGE_ENGINE_MEDIA_DEVICES, next);\n\n    this.setState({ devicesWithUserMetadata: next });\n  }\n\n  /**\n   * Fetches stored device information from local storage.\n   *\n   * @return {Promise<Object[]>} TODO: Document structure\n   */\n  async _fetchCachedMediaDeviceUserMetadata() {\n    const cache = await this._storageEngine.fetchItem(\n      KEY_STORAGE_ENGINE_MEDIA_DEVICES\n    );\n\n    if (Array.isArray(cache)) {\n      return cache;\n    } else {\n      return [];\n    }\n  }\n\n  /**\n   * Retrieves stored device information from local state.\n   *\n   * NOTE: This does not make a disk call, only reads from memory (current\n   * state); it is not intended to be asynchronous\n   *\n   * @param {MediaDeviceInfo} device\n   * @return {Object} TODO: Document structure\n   */\n  getMediaDeviceUserMetadata(device) {\n    const cachedDevice = this.getState().devicesWithUserMetadata.find(pred =>\n      utils.mediaDevice.getIsSameMediaDevice(pred.device, device)\n    );\n\n    if (cachedDevice) {\n      return cachedDevice[KEY_DMETA_USER_METADATA];\n    }\n  }\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport {\n  MediaStreamTrackControllerFactory,\n  MediaStreamTrackControllerFactoryCollection,\n  utils,\n} from \"media-stream-track-controller\";\n\nimport MediaDeviceCachingService from \"./MediaDeviceCachingService\";\n\n// TODO: Refactor\nclass InputMediaDeviceFactoryCollection extends MediaStreamTrackControllerFactoryCollection {}\n\n/**\n * Manages capturing of physical input media devices (i.e. microphone or camera).\n *\n * It does not manage virtual devices, such as screen captures, canvas, etc.\n */\nexport default class InputMediaDevicesService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Input Media Devices Service\");\n\n    this.setState({\n      isFetchingMediaDevices: false,\n      isAudioContextStarted: false,\n      devices: [],\n    });\n\n    this._mediaDeviceCachingService = this.useServiceClass(\n      MediaDeviceCachingService\n    );\n\n    this._inputMediaDeviceFactoryCollection = this.bindCollectionClass(\n      InputMediaDeviceFactoryCollection\n    );\n\n    // TODO: Re-fetch when devices have been changed (listen to event; backport\n    // from original Speaker.app)\n    //\n    // TODO: Capture fetch errors and set them as state / UI notifications\n\n    this.fetchInputMediaDevices();\n  }\n\n  /**\n   * Performs a \"system call\" against the browser in order to determine\n   * physical input media devices.\n   *\n   * This will internally cache the media device info in the state, and calls\n   * to this.getInputMediaDevices() can retrieve that state for the UI.\n   *\n   * @param {boolean} isAggressive [default = true]  If true, temporarily\n   * turn on devices in order to obtain label information.\n   * @return {MediaDeviceInfo[] || Object[]}\n   */\n  async fetchInputMediaDevices(isAggressive = true) {\n    this.setState({ isFetchingMediaDevices: true });\n\n    // Fixes issue where sending media stream track to remote peers is muted\n    // until something starts the audio context (TODO: Define which\n    // environments this is happening in; all? Should this fix be moved into\n    // media-stream-track-controller itself?)\n    //\n    // IMPORTANT: This isn't the ONLY fix related to this, and others are\n    // specified in the LocalZenRTCPeer connect sequence (currently part of\n    // SpeakerAppPortal)\n    await this.untilAudioContextResumed();\n\n    const inputMediaDevices = await utils.mediaDevice\n      .fetchInputMediaDevices(isAggressive)\n      .catch(console.error)\n      .finally(() => this.setState({ isFetchingMediaDevices: false }));\n\n    // Set the captured device information as state so that calls to\n    // this.getInputMediaDevices() can retrieve cached state, and any UI\n    // listeners can see the state of cached device information.\n    this.setState({ devices: inputMediaDevices });\n\n    return inputMediaDevices;\n  }\n\n  // TODO: Document\n  async untilAudioContextResumed() {\n    await utils.audioContext.untilAudioContextResumed();\n\n    this.setState({\n      isAudioContextStarted: true,\n    });\n  }\n\n  /**\n   * Retrieves whether or not this service is currently fetching media devices.\n   *\n   * @return {boolean}\n   */\n  getIsFetchingMediaDevices() {\n    return this.getState().isFetchingMediaDevices;\n  }\n\n  // TODO: Document\n  //\n  // IMPORTANT: This depends on a prior resolved call to\n  // this.fetchInputMediaDevices() before this will return anything\n  getInputMediaDevices() {\n    const { devices } = this.getState();\n\n    return devices || [];\n  }\n\n  // TODO: Document\n  //\n  // IMPORTANT: This depends on a prior resolved call to\n  // this.fetchInputMediaDevices() before this will return anything\n  getAudioInputMediaDevices() {\n    const inputMediaDevices = this.getInputMediaDevices();\n\n    // TODO: Use utility function for filtering\n    return inputMediaDevices.filter(predicate =>\n      predicate.kind.includes(\"audioinput\")\n    );\n  }\n\n  // TODO: Document\n  getCaptureFactories() {\n    return this._inputMediaDeviceFactoryCollection.getTrackControllerFactories();\n  }\n\n  // TODO: Document\n  getIsAudioMediaDeviceBeingCaptured(mediaDeviceInfo) {\n    return Boolean(\n      MediaStreamTrackControllerFactory.getFactoriesWithInputMediaDevice(\n        mediaDeviceInfo,\n        // TODO: Use constant here\n        // TODO: Auto-detect this input value from the device (within\n        // media-stream-track-controller)\n        \"audio\"\n      ).length\n    );\n  }\n\n  // TODO: Document\n  getMediaDeviceCaptureFactory(mediaDeviceInfo) {\n    const factories =\n      MediaStreamTrackControllerFactory.getFactoriesWithInputMediaDevice(\n        mediaDeviceInfo,\n        // TODO: Use constant here\n        \"audio\"\n      );\n\n    if (factories) {\n      return factories[0];\n    }\n  }\n\n  // TODO: Document\n  //\n  // IMPORTANT: For most use cases, use this.captureSpecificMediaDevice\n  // instead\n  /*\n  async captureDefaultAudioInputDevice(\n    userConstraints = {},\n    factoryOptions = {}\n  ) {\n    // TODO: Implement ability to apply preset quality settings to default\n    // audio device (potentially obtain default audio device from list, apply\n    // the settings there, then call this.captureSpecificMediaDevice())\n\n    const factory = await utils.mediaDevice.captureMediaDevice(\n      userConstraints,\n      factoryOptions\n    );\n\n    this._inputMediaDeviceFactoryCollection.addTrackControllerFactory(\n      factory\n    );\n\n    return factory;\n  }\n  */\n\n  // TODO: Document\n  async captureSpecificMediaDevice(\n    mediaDeviceInfo,\n    userConstraints = {},\n    factoryOptions = {}\n  ) {\n    const factory = await utils.mediaDevice.captureSpecificMediaDevice(\n      mediaDeviceInfo,\n      userConstraints,\n      factoryOptions\n    );\n\n    this._inputMediaDeviceFactoryCollection.addTrackControllerFactory(factory);\n\n    return factory;\n  }\n\n  // TODO: Document\n  async uncaptureSpecificMediaDevice(mediaDeviceInfo) {\n    return utils.mediaDevice.uncaptureSpecificMediaDevice(mediaDeviceInfo);\n  }\n\n  /**\n   * Determines whether or not any audio input devices are currently capturing.\n   *\n   * @return {boolean}\n   */\n  getIsCapturingAnyAudio() {\n    return this._inputMediaDeviceFactoryCollection.getAudioTrackControllers()\n      .length;\n  }\n\n  /**\n   * Determines whether or not all audio input devices are muted.\n   *\n   * @return {boolean}\n   */\n  getIsAllAudioMuted() {\n    return this._inputMediaDeviceFactoryCollection.getIsAudioMuted();\n  }\n\n  /**\n   * Sets whether or not all audio input devices are muted.\n   *\n   * @param {boolean} isAllAudioMuted\n   * @return {void}\n   */\n  setIsAllAudioMuted(isAllAudioMuted) {\n    return this._inputMediaDeviceFactoryCollection.setIsAudioMuted(\n      isAllAudioMuted\n    );\n  }\n\n  /**\n   * Mutes all audio input devices.\n   *\n   * NOTE: Subsequently added input devices will not be muted by default.\n   *\n   * @return {void}\n   */\n  muteAllAudio() {\n    return this._inputMediaDeviceFactoryCollection.muteAudio();\n  }\n\n  /**\n   * Unmutes all audio input devices.\n   *\n   * @return {void}\n   */\n  unmuteAllAudio() {\n    return this._inputMediaDeviceFactoryCollection.unmuteAudio();\n  }\n}\n","import { useCallback, useEffect } from \"react\";\n\nimport useServiceClass from \"@hooks/useServiceClass\";\nimport InputMediaDevicesService from \"@services/InputMediaDevicesService\";\nimport MediaDeviceCachingService from \"@services/MediaDeviceCachingService\";\n\n// FIXME: (jh) Move to service class?\nimport { utils } from \"media-stream-track-controller\";\nconst { audioQualityPresets } = utils.constraints;\n\n// FIXME: (jh) Move to service class?\nconst DEFAULT_AUDIO_QUALITY_PRESET =\n  audioQualityPresets.AUDIO_QUALITY_PRESET_TALK_RADIO;\n\n// TODO: Document\nexport default function useInputMediaDevicesSelectorState({\n  onDeviceCapture = device => null,\n  onDeviceUncapture = device => null,\n}) {\n  const { serviceInstance: inputMediaDevicesService } = useServiceClass(\n    InputMediaDevicesService\n  );\n\n  const { serviceInstance: mediaDevicesCachingService } = useServiceClass(\n    MediaDeviceCachingService\n  );\n\n  // Automatically fetch input media devices when component mounts\n  useEffect(() => {\n    if (inputMediaDevicesService) {\n      inputMediaDevicesService.fetchInputMediaDevices();\n    }\n  }, [inputMediaDevicesService]);\n\n  /**\n   * @return {Promise<void>}\n   */\n  const setDevicePreferredAudioQualityPresetName = useCallback(\n    async (device, audioQualityPresetName) => {\n      // TODO: Use constant\n      if (device.kind !== \"audioinput\") {\n        console.warn(\n          `Cannot set device preferred audio quality preset name for \"${device.kind}\" kind.  Expected audioinput kind.`\n        );\n        return;\n      }\n\n      const audioQualityPreset =\n        utils.constraints.audioQualityPresets.getAudioQualityPresetWithName(\n          audioQualityPresetName\n        );\n\n      return mediaDevicesCachingService.setMediaDeviceUserMetadata(device, {\n        audioQualityPreset,\n      });\n\n      // TODO: Uncapture device (if being captured)\n      // TODO: Re-capture device (using new audio constraints)\n    },\n    [mediaDevicesCachingService]\n  );\n\n  // FIXME: (jh) Constraint matching could be moved into the service level\n  // instead\n  /**\n   * @return {Promise<void>}\n   */\n  const captureSpecificMediaDevice = useCallback(\n    async device => {\n      const deviceUserMetadata =\n        mediaDevicesCachingService.getMediaDeviceUserMetadata(device);\n\n      let preferredConstraints =\n        deviceUserMetadata &&\n        deviceUserMetadata.audioQualityPreset?.constraints;\n\n      // TODO: Use constant for kind\n      if (!preferredConstraints && device.kind === \"audioinput\") {\n        preferredConstraints =\n          audioQualityPresets.getAudioQualityPresetConstraints(\n            DEFAULT_AUDIO_QUALITY_PRESET\n          );\n      }\n\n      // Start the capturing\n      return inputMediaDevicesService.captureSpecificMediaDevice(\n        device,\n        preferredConstraints\n        // FIXME: (jh) Use device title in factory options?\n      );\n    },\n    [inputMediaDevicesService, mediaDevicesCachingService]\n  );\n\n  /**\n   * @return {string}\n   */\n  const getDevicePreferredAudioQualityPresetName = useCallback(\n    device => {\n      const deviceUserMetadata =\n        mediaDevicesCachingService.getMediaDeviceUserMetadata(device);\n\n      if (deviceUserMetadata) {\n        return deviceUserMetadata.audioQualityPreset?.name;\n      } else {\n        return DEFAULT_AUDIO_QUALITY_PRESET.name;\n      }\n    },\n    [mediaDevicesCachingService]\n  );\n\n  // TODO: Document\n  const toggleSpecificAudioInputDevice = useCallback(\n    async device => {\n      const isCapturing =\n        inputMediaDevicesService.getIsAudioMediaDeviceBeingCaptured(device);\n\n      if (!isCapturing) {\n        // IMPORTANT: Using the local (non-service) version here, as it\n        // utilizes the user constraint handling\n        await captureSpecificMediaDevice(device);\n\n        // UI callback\n        onDeviceCapture(device);\n      } else {\n        // Stop the capturing\n        await inputMediaDevicesService.uncaptureSpecificMediaDevice(device);\n\n        // UI callback\n        onDeviceUncapture(device);\n      }\n    },\n    [\n      inputMediaDevicesService,\n      captureSpecificMediaDevice,\n      onDeviceCapture,\n      onDeviceUncapture,\n    ]\n  );\n\n  const audioInputDevices =\n    inputMediaDevicesService?.getAudioInputMediaDevices() || [];\n\n  const capturedAudioInputDevices = audioInputDevices.filter(device =>\n    inputMediaDevicesService?.getIsAudioMediaDeviceBeingCaptured(device)\n  );\n\n  return {\n    inputMediaDevicesService,\n    mediaDevicesCachingService,\n    audioInputDevices,\n    capturedAudioInputDevices,\n    audioQualityPresets,\n    toggleSpecificAudioInputDevice,\n    setDevicePreferredAudioQualityPresetName,\n    getDevicePreferredAudioQualityPresetName,\n  };\n}\n","import InputMediaDevicesSelector from \"./InputMediaDevicesSelector\";\n\nexport default InputMediaDevicesSelector;\n","import Full from \"../Full\";\nimport Layout, { Header, Content, Footer } from \"../Layout\";\nimport Padding from \"../Padding\";\nimport Center from \"../Center\";\nimport Cover from \"../Cover\";\n\nimport RCACableIcon from \"@icons/RCACableIcon\";\n\nimport AudioInputDeviceTableRow from \"./subComponents/AudioInputDeviceTableRow\";\n\nimport useInputMediaDevicesSelectorState from \"./subHooks/useInputMediaDevicesSelectorState\";\n\n// TODO: Document and add prop-types\n// TODO: Refactor for all input device types\nexport default function InputMediaDevicesSelector({\n  onDeviceCapture = device => null,\n  onDeviceUncapture = device => null,\n}) {\n  const {\n    inputMediaDevicesService,\n    mediaDevicesCachingService,\n    audioInputDevices,\n    capturedAudioInputDevices,\n    audioQualityPresets,\n    toggleSpecificAudioInputDevice,\n    setDevicePreferredAudioQualityPresetName,\n    getDevicePreferredAudioQualityPresetName,\n  } = useInputMediaDevicesSelectorState({\n    onDeviceCapture,\n    onDeviceUncapture,\n  });\n\n  if (!inputMediaDevicesService || !mediaDevicesCachingService) {\n    return null;\n  }\n\n  const lenAudioInputDevices = audioInputDevices.length;\n\n  const isFetching = inputMediaDevicesService.getIsFetchingMediaDevices();\n\n  if (!audioInputDevices.length) {\n    return (\n      <Center style={{ fontWeight: \"bold\" }}>\n        {isFetching\n          ? \"Fetching audio devices...\"\n          : \"No audio input devices are currently available.\"}\n      </Center>\n    );\n  }\n\n  const lenCapturedAudioInputDevices = capturedAudioInputDevices.length;\n\n  return (\n    <Layout>\n      <Header>Select device(s) for sound input:</Header>\n      <Content>\n        <Padding>\n          <Full\n            style={{\n              overflow: \"auto\",\n              border: \"4px #22668F solid\",\n              borderRadius: 4,\n            }}\n          >\n            <table style={{ width: \"100%\" }}>\n              <thead>\n                <tr>\n                  <td>Name</td>\n                  <td className=\"center\">f(x)</td>\n                  <td className=\"center\">Muted</td>\n                  <td className=\"center\">Level</td>\n                </tr>\n              </thead>\n              <tbody>\n                {audioInputDevices.map((device, idx) => {\n                  const isCapturing =\n                    capturedAudioInputDevices.includes(device);\n\n                  const deviceCaptureFactory =\n                    inputMediaDevicesService.getMediaDeviceCaptureFactory(\n                      device\n                    );\n\n                  const mediaStreamTracks =\n                    isCapturing &&\n                    deviceCaptureFactory?.getOutputMediaStream()?.getTracks();\n\n                  // TODO: Remove\n                  /*\n                  const audioTrackController =\n                    isCapturing &&\n                    deviceCaptureFactory?.getAudioTrackControllers()[0];\n                  if (audioTrackController) {\n                    console.log({\n                      settings: audioTrackController.getSettings(),\n                    });\n                  }\n                  */\n\n                  return (\n                    <AudioInputDeviceTableRow\n                      key={idx}\n                      device={device}\n                      mediaStreamTracks={mediaStreamTracks}\n                      isCapturing={isCapturing}\n                      onToggleCapture={() =>\n                        toggleSpecificAudioInputDevice(device)\n                      }\n                      isMuted={deviceCaptureFactory?.getIsMuted()}\n                      onToggleMute={() => deviceCaptureFactory?.toggleMute()}\n                      audioQualityPresets={audioQualityPresets}\n                      audioQualityPresetName={getDevicePreferredAudioQualityPresetName(\n                        device\n                      )}\n                      onChangeAudioQualityPresetName={audioQualityPresetName =>\n                        setDevicePreferredAudioQualityPresetName(\n                          device,\n                          audioQualityPresetName\n                        )\n                      }\n                    />\n                  );\n                })}\n              </tbody>\n            </table>\n          </Full>\n        </Padding>\n      </Content>\n\n      <Footer style={{ minHeight: 50 }}>\n        <Padding>\n          <RCACableIcon\n            style={{\n              fontSize: 38,\n              marginLeft: 20,\n              color: \"rgba(255,255,255,.2)\",\n            }}\n          />\n          <Cover>\n            <Center>\n              <div>\n                {lenAudioInputDevices} audio input device\n                {lenAudioInputDevices !== 1 && \"s\"} available.\n              </div>\n              <div>\n                {lenCapturedAudioInputDevices} audio input device\n                {lenCapturedAudioInputDevices !== 1 && \"s\"} currently being\n                captured.\n              </div>\n            </Center>\n          </Cover>\n        </Padding>\n      </Footer>\n    </Layout>\n  );\n}\n","import InputDeviceSelectorModal from \"./InputDeviceSelectorModal\";\n\nexport default InputDeviceSelectorModal;\n","import { useCallback } from \"react\";\nimport Padding from \"@components/Padding\";\nimport InputMediaDevicesSelector from \"@components/InputMediaDevicesSelector\";\nimport SystemModal from \"../SystemModal\";\n\n// TODO: Add prop-types\nexport default function InputDeviceSelectorModal({\n  onDeviceCapture,\n  onDeviceUncapture,\n  onCancel,\n  onClose,\n}) {\n  /**\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/InputDeviceInfo}\n   *\n   * @param {InputDeviceInfo}\n   * @return {void}\n   */\n  const handleDeviceCapture = useCallback(\n    device => {\n      onDeviceCapture(device);\n\n      onClose();\n    },\n    [onDeviceCapture, onClose]\n  );\n\n  /*\n  const handleCancel = useCallback(() => {\n    onCancel();\n\n    onClose();\n  }, [onCancel, onClose]);\n  */\n\n  return (\n    <SystemModal onClose={onClose} onCancel={onCancel}>\n      <Padding>\n        <InputMediaDevicesSelector\n          onDeviceCapture={handleDeviceCapture}\n          onDeviceUncapture={onDeviceUncapture}\n        />\n      </Padding>\n    </SystemModal>\n  );\n}\n","import { useRef } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n/**\n * Creates a stable UUID for usage in React components and hooks.\n *\n * @return {string} i.e. '1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed'\n */\nexport default function useUUID() {\n  const refUUID = useRef(uuidv4());\n\n  return refUUID.current;\n}\n","import TextInputModal from \"./TextInputModal\";\n\nexport default TextInputModal;\n","import { useCallback, useState } from \"react\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport { Row, Column } from \"@components/Layout\";\n\nimport SystemModal from \"../SystemModal\";\n\nimport useKeyboardEvents from \"@hooks/useKeyboardEvents\";\nimport useUUID from \"@hooks/useUUID\";\n\n// TODO: Document\n// TODO: Add prop-types\n// TODO: Implement optional default value\nexport default function TextInputModal({\n  className,\n  label,\n  placeholder,\n  onClose,\n  onCancel,\n  onChange = () => null,\n  ...rest\n}) {\n  const [elInput, setElInput] = useState(null);\n  const [value, setValue] = useState(\"\");\n\n  // TODO: Document\n  const handleChange = useCallback(\n    evt => {\n      const value = evt.target.value;\n      setValue(value);\n      onChange(value);\n    },\n    [onChange]\n  );\n\n  // TODO: Document\n  const handleClose = useCallback(() => {\n    onClose(value);\n  }, [onClose, value]);\n\n  const handleSubmit = handleClose;\n\n  // FIXME: (jh) Use form controller instead?\n  useKeyboardEvents(elInput, {\n    onEnter: handleClose,\n    // NOTE: Escape event is already handled by SystemModal\n  });\n\n  const elInputId = useUUID();\n\n  return (\n    <SystemModal\n      {...rest}\n      className={className}\n      label={label}\n      onCancel={onCancel}\n      onClose={handleClose}\n    >\n      <Padding>\n        <Center>\n          <div style={{ textAlign: \"left\" }}>\n            {label && <label htmlFor={elInputId}>{label}</label>}\n\n            <Row>\n              <Column>\n                <input\n                  ref={setElInput}\n                  id={elInputId}\n                  type=\"text\"\n                  onChange={handleChange}\n                  placeholder={placeholder}\n                  style={{\n                    borderTopRightRadius: 0,\n                    borderBottomRightRadius: 0,\n                  }}\n                />\n              </Column>\n              <Column style={{ maxWidth: 100 }}>\n                <button\n                  style={{\n                    borderTopLeftRadius: 0,\n                    borderBottomLeftRadius: 0,\n\n                    // TODO: Use color variable for highlighted element\n                    backgroundColor: \"#347fe8\",\n                  }}\n                  disabled={!Boolean(value)}\n                  onClick={handleSubmit}\n                >\n                  Submit\n                </button>\n              </Column>\n            </Row>\n          </div>\n        </Center>\n      </Padding>\n    </SystemModal>\n  );\n}\n","import { consume } from \"phantom-core\";\nimport UIServiceCore from \"@core/classes/UIServiceCore\";\n\nimport UIModalService from \"@services/UIModalService\";\n\nimport ConfirmModal from \"@components/modals/ConfirmModal\";\nimport InputDeviceSelectorModal from \"@components/modals/InputDeviceSelectorModal\";\nimport TextInputModal from \"@components/modals/TextInputModal\";\n\n// TODO: Rename to UIModalDialogHelperService?\n/**\n * An assortment of modals designed for async programmatic usage.\n */\nexport default class UIModalWidgetService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"UIModal Widget Service\");\n\n    this._uiModalService = this.useServiceClass(UIModalService);\n  }\n\n  // TODO: Document\n  async confirm(text) {\n    try {\n      await new Promise((resolve, reject) => {\n        this._uiModalService.showModal(({ onClose, onCancel, ...rest }) => (\n          <ConfirmModal\n            text={text}\n            onClose={() => {\n              resolve();\n\n              onClose();\n            }}\n            onCancel={() => {\n              reject();\n\n              onCancel();\n            }}\n            {...rest}\n          />\n        ));\n      });\n\n      return true;\n    } catch (err) {\n      consume(err);\n\n      return false;\n    }\n  }\n\n  /**\n   * Controls a UIModal specifically for input media device selection.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/InputDeviceInfo}\n   *\n   * @return {Promise<InputDeviceInfo>}\n   */\n  async showInputMediaDevicesSelectionModal() {\n    const selection = await new Promise(resolve =>\n      this._uiModalService.showModal(({ ...rest }) => (\n        <InputDeviceSelectorModal onDeviceCapture={resolve} {...rest} />\n      ))\n    );\n\n    return selection;\n  }\n\n  // Add a modal to replace window.prompt (possibly extend dialog modal)\n  // TODO: Document\n  async showTextInputModal({ label }) {\n    const value = await new Promise(resolve =>\n      this._uiModalService.showModal(({ onClose, ...rest }) => (\n        <TextInputModal\n          label={label}\n          // TODO: Refactor so the onClose handler is called with the value\n          onClose={text => {\n            onClose();\n\n            resolve(text);\n          }}\n          {...rest}\n        />\n      ))\n    );\n\n    return value;\n  }\n}\n","import DesktopMenuBar from \"./DesktopMenuBar\";\n\nexport default DesktopMenuBar;\n","import { EVT_UPDATED } from \"phantom-core\";\nimport ReShellCore from \"@core\";\nimport { useEffect, useMemo } from \"react\";\nimport MenuBar from \"@components/MenuBar\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport useForceUpdate from \"@hooks/useForceUpdate\";\nimport useUIParadigm, {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n  AUTO_DETECT_PARADIGM,\n} from \"@hooks/useUIParadigm\";\nimport useServiceClass from \"@hooks/useServiceClass\";\n\nimport UIModalWidgetService from \"@services/UIModalWidgetService\";\n\n// TODO: Document\nexport default function DesktopMenuBar() {\n  const { uiParadigm, isUIParadigmAutoSet, setStaticUIParadigm } =\n    useUIParadigm();\n\n  const { serviceInstance: uiModalWidgetService } = useServiceClass(\n    UIModalWidgetService,\n    false\n  );\n\n  const { activeWindowController } = useDesktopContext();\n  const {\n    appRegistrations,\n    activateAppRegistration,\n    appRuntimes,\n    runningAppRegistrations,\n  } = useAppOrchestrationContext();\n\n  const forceUpdate = useForceUpdate();\n\n  // Force update menus when active window controller updates (i.e. when\n  // changed, minimized, maximized, etc.)\n  useEffect(() => {\n    if (activeWindowController) {\n      activeWindowController.on(EVT_UPDATED, forceUpdate);\n\n      return () => {\n        activeWindowController.off(EVT_UPDATED, forceUpdate);\n      };\n    }\n  }, [activeWindowController, forceUpdate]);\n\n  const applicationsMenuData = useMemo(\n    () =>\n      appRegistrations.map(app => ({\n        type: \"checkbox\",\n        label: app.getTitle(),\n        checked: runningAppRegistrations\n          .map(pred => pred.getID())\n          .includes(app.getID()),\n        click: () => activateAppRegistration(app),\n      })),\n    [appRegistrations, runningAppRegistrations, activateAppRegistration]\n  );\n\n  const pinnedAppsMenuData = useMemo(() => {\n    const pinnedApps = appRegistrations\n      .filter(registration => registration.getIsPinned())\n      .map(app => ({\n        // FIXME: (jh) Include checkboxes next to active pinned registrations?\n        label: app.getTitle(),\n        click: () => activateAppRegistration(app),\n      }));\n\n    if (pinnedApps.length) {\n      return [\n        {\n          // TODO: Use constant\n          type: \"separator\",\n          label: \"Pinned Applications\",\n        },\n        ...pinnedApps,\n      ];\n    } else {\n      return [];\n    }\n  }, [appRegistrations, activateAppRegistration]);\n\n  const hasOpenedWindows = appRuntimes.length > 0;\n\n  // FIXME: (jh) Include menu option to reload the app (force refresh)\n  const DESKTOP_MENU_STRUCTURE = {\n    label: \"Desktop\",\n    submenu: [\n      {\n        label: \"Applications\",\n        submenu: applicationsMenuData,\n      },\n      // Dynamically include pinned apps and their corresponding separator, if\n      // exists\n      ...pinnedAppsMenuData,\n      {\n        // TODO: Use constant\n        type: \"separator\",\n        label: \"Layout Control\",\n      },\n      {\n        label: \"UI Paradigm\",\n        submenu: [\n          {\n            label: \"Desktop Paradigm\",\n            click: () => setStaticUIParadigm(DESKTOP_PARADIGM),\n            type: \"checkbox\",\n            checked: uiParadigm === DESKTOP_PARADIGM,\n          },\n          {\n            label: \"Mobile Paradigm\",\n            click: () => setStaticUIParadigm(MOBILE_PARADIGM),\n            type: \"checkbox\",\n            checked: uiParadigm === MOBILE_PARADIGM,\n          },\n          {\n            label: \"Auto Detect\",\n            click: () => setStaticUIParadigm(AUTO_DETECT_PARADIGM),\n            type: \"checkbox\",\n            checked: isUIParadigmAutoSet,\n          },\n        ],\n      },\n      ...(() => {\n        if (uiParadigm === DESKTOP_PARADIGM) {\n          return [\n            {\n              label: \"Scatter Windows\",\n              click: () =>\n                appRuntimes.forEach(runtime => {\n                  const windowController = runtime.getWindowController();\n\n                  if (windowController) {\n                    windowController.scatter();\n                  }\n                }),\n              disabled: !hasOpenedWindows,\n            },\n            {\n              label: \"Center Windows\",\n              click: () =>\n                appRuntimes.forEach(runtime => {\n                  const windowController = runtime.getWindowController();\n\n                  if (windowController) {\n                    windowController.center();\n                  }\n                }),\n              disabled: !hasOpenedWindows,\n            },\n          ];\n        } else {\n          return [];\n        }\n      })(),\n      {\n        // TODO: Use constant\n        type: \"separator\",\n        label: \"Desktop Operations\",\n      },\n      {\n        label: \"Reload ReShell\",\n        click: async () => {\n          // TODO: Replace w/ UIModal\n          (await uiModalWidgetService.confirm(\n            \"Are you sure you wish to reload?\"\n          )) && ReShellCore.reload();\n        },\n      },\n      {\n        label: \"Quit ReShell\",\n        click: async () => {\n          // TODO: Replace w/ UIModal\n          (await uiModalWidgetService.confirm(\n            \"Are you sure you wish to close the desktop?\"\n          )) && ReShellCore.destroy();\n        },\n      },\n    ],\n  };\n\n  const activeWindowTitle = activeWindowController?.getTitle();\n\n  const ACTIVE_APP_MENU_STRUCTURE = useMemo(() => {\n    if (activeWindowController) {\n      return {\n        label: activeWindowTitle,\n        submenu: [\n          {\n            // TODO: Use role instead\n            label: \"Quit\",\n            click: () => activeWindowController.destroy(),\n          },\n        ],\n      };\n    }\n  }, [activeWindowController, activeWindowTitle]);\n\n  const ACTIVE_WINDOW_MENU_STRUCTURE = (() => {\n    if (uiParadigm === DESKTOP_PARADIGM && activeWindowController) {\n      return {\n        label: \"Window\",\n        submenu: [\n          {\n            label: \"Minimize\",\n            click: () => activeWindowController.minimize(),\n            disabled: activeWindowController.getIsMinimized(),\n          },\n          {\n            label: \"Maximize\",\n            click: () => activeWindowController.maximize(),\n            disabled: activeWindowController.getIsMaximized(),\n          },\n          {\n            label: \"Restore\",\n            click: () => activeWindowController.restore(),\n            disabled:\n              !activeWindowController.getIsMaximized() &&\n              !activeWindowController.getIsMinimized(),\n          },\n          {\n            label: \"Scatter\",\n            click: () => activeWindowController.scatter(),\n          },\n          {\n            label: \"Center\",\n            click: () => activeWindowController.center(),\n          },\n        ],\n      };\n    }\n  })();\n\n  return (\n    <MenuBar\n      menuStructures={[\n        DESKTOP_MENU_STRUCTURE,\n        ACTIVE_APP_MENU_STRUCTURE,\n        ACTIVE_WINDOW_MENU_STRUCTURE,\n      ]}\n    />\n  );\n}\n","import TopBar from \"./TopBar\";\n\nexport default TopBar;\n","import DesktopMenuBar from \"./Desktop.TopBar.MenuBar\";\n\nimport { Row, Column } from \"@components/Layout\";\n\n// FIXME: (jh) Refactor commented-code into panel applet which can be tied-into\n// services (related issue: https://github.com/jzombie/pre-re-shell/issues/159)\n// import LED from \"@components/LED\";\n\n// TODO: Change this to use data-driven MenuBar\n// import Menu, { MenuButton, MenuItem } from \"@components/Menu/_Menu.LibWrapper\";\n\n// import useServicesContext from \"@hooks/useServicesContext\";\n// import useAppRegistrationLink from \"@hooks/useAppRegistrationLink\";\n\n// import { REGISTRATION_ID as SERVICE_MONITOR_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/ServiceMonitorApp\";\n\n// TODO: Use prop-types\n// TODO: Document\nexport default function TopBar() {\n  // FIXME: (jh) This currently triggers a \"Could not locate appRegistration\n  // with id: service-monitor\" warning on first render; it should be refactored\n  /*\n  const { link: openServiceMonitor } = useAppRegistrationLink(\n    SERVICE_MONITOR_REGISTRATION_ID\n  );\n  */\n\n  // const { services } = useServicesContext();\n\n  return (\n    <Row>\n      <Column style={{ width: \"100%\" }}>\n        <DesktopMenuBar />\n      </Column>\n      {/*\n        <Column\n        style={{\n          // TODO: Rework so column width expands according to content\n          maxWidth: 110,\n        }}\n      >\n        <div style={{ textAlign: \"right\" }}>\n          {\n            // TODO: Change this to use data-driven MenuBar\n          }\n          <Menu\n            portal={true}\n            menuButton={\n              <MenuButton>\n                Service Core{\" \"}\n                <LED color={services.length > 0 ? \"green\" : \"gray\"} />\n              </MenuButton>\n            }\n          >\n            {services.length === 0 ? (\n              <MenuItem>\n                <span style={{ fontStyle: \"italic\" }}>No running services</span>\n              </MenuItem>\n            ) : (\n              services.map(service => (\n                <MenuItem\n                  key={service.getUUID()}\n                  // TODO: Open direct service in service monitor\n                  onClick={openServiceMonitor}\n                >\n                  {service.getTitle()}\n                </MenuItem>\n              ))\n            )}\n          </Menu>\n        </div>\n      </Column>\n        */}\n    </Row>\n  );\n}\n","import { useEffect, useState } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./Dock.module.css\";\n\n// TODO: Document\n// TODO: Add prop-types\nexport default function DockItem({\n  appRegistration,\n  isActiveRegistration,\n  onClick,\n  elDock,\n}) {\n  const [elDockItem, _setElDockItem] = useState(null);\n\n  // Automatically scroll to relevant dock item when active\n  useEffect(() => {\n    if (elDock && elDockItem && isActiveRegistration) {\n      const offsetLeft = elDockItem.offsetLeft;\n      const offsetTop = elDockItem.offsetTop;\n\n      elDock.scrollTo({\n        top: offsetTop,\n        left: offsetLeft,\n        behavior: \"smooth\",\n      });\n    }\n  }, [elDock, elDockItem, isActiveRegistration]);\n\n  return (\n    <button\n      ref={_setElDockItem}\n      className={classNames(\n        styles[\"dock-item\"],\n        isActiveRegistration && styles[\"active\"]\n      )}\n      onClick={onClick}\n    >\n      {appRegistration.getTitle()}\n    </button>\n  );\n}\n","import Dock from \"./Dock\";\n\nexport default Dock;\n","import { useCallback, useMemo, useState } from \"react\";\nimport DockItem from \"./DockItem\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useOverflowDetection from \"@hooks/useOverflowDetection\";\n\nimport styles from \"./Dock.module.css\";\nimport classNames from \"classnames\";\n\n/**\n * Application selection Dock component.\n */\nexport default function Dock() {\n  const [elDock, _setElDock] = useState(null);\n  const [elContentWrapper, _setElContentWrapper] = useState(null);\n\n  /**\n   * @type {boolean} If true, the Dock is scrollable\n   */\n  const isOverflown = useOverflowDetection(elContentWrapper);\n\n  /**\n   * Handles scrolling of Dock in relation to mousewheel.\n   *\n   * @return {void}\n   */\n  const handleDockScroll = useCallback(\n    evt => {\n      /**\n       * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/scroll}\n       */\n      elDock.scroll({\n        top: 0,\n        // If horizontal orientation...\n        left: elDock.scrollLeft + evt.deltaY,\n        // FIXME: (jh) I can't yet tell if it's just me, or maybe my hardware,\n        // but \"smooth\" scrolling on my laptop seems a bit quirky to get\n        // started, as if the initial delta should be multiplied higher than\n        // subsequent deltas\n        // behavior: \"smooth\",\n      });\n    },\n    [elDock]\n  );\n\n  const { activeWindowController } = useDesktopContext();\n  const { appRegistrations, runningAppRegistrations, activateAppRegistration } =\n    useAppOrchestrationContext();\n\n  // TODO: Import type definition\n  /** @type {AppRegistration[]} */\n  const dockRegistrations = useMemo(\n    () => [\n      // Show unique app registrations\n      ...new Set([\n        ...appRegistrations.filter(registration =>\n          registration.getIsPinnedToDock()\n        ),\n        ...runningAppRegistrations,\n      ]),\n    ],\n    [appRegistrations, runningAppRegistrations]\n  );\n\n  // TODO: Import type definition\n  /** @type {AppRegistration | void} */\n  const activeRegistration = useMemo(\n    () => activeWindowController?.getAppRegistration(),\n    [activeWindowController]\n  );\n\n  return (\n    <div\n      ref={_setElDock}\n      className={classNames(\n        styles[\"dock\"],\n        styles[\"horizontal-orientation\"],\n        isOverflown && styles[\"overflown\"]\n      )}\n      onWheel={handleDockScroll}\n    >\n      {\n        // TODO: Add tooltip functionality\n        // - https://www.npmjs.com/package/rc-tooltip\n        // - https://www.npmjs.com/package/react-tooltip\n        // - Note: Original Shell's Antd theme used rc-tooltip as the base (https://github.com/zenOSmosis/js-shell/blob/master/frontend/src/components/Desktop/Dock/DockItem.jsx)\n        //\n        // TODO: Add button menu\n        // - See original Shell implementation: https://github.com/zenOSmosis/js-shell/blob/master/frontend/src/components/Desktop/Dock/DockItem.jsx\n      }\n      <div\n        ref={_setElContentWrapper}\n        className={classNames(\"button-group\", styles[\"content-wrapper\"])}\n      >\n        {\n          // FIXME: (jh) Add left / right scroll buttons [in horizontal\n          // orientation] when Dock overflows\n          //\n          // TODO: (jh) Automatically switch to another window / dock item if\n          // a window is minimized or closed (should be handled via\n          // AppOrchestrationService; there's a TODO there as well; search for\n          // \"Activating Windows\")\n        }\n        {dockRegistrations.map(registration => (\n          <DockItem\n            key={registration.getUUID()}\n            appRegistration={registration}\n            isActiveRegistration={registration === activeRegistration}\n            onClick={() => activateAppRegistration(registration)}\n            elDock={elDock}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n","import FullViewport from './FullViewport';\n\nexport default FullViewport;","import React, { useEffect, useMemo, useState } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./AutoScaler.module.css\";\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n/**\n * Fix issue on iOS 13 where ResizeObserver isn't available.\n */\nimport { install } from \"resize-observer\";\nif (!window.ResizeObserver) {\n  install();\n}\n\n// FIXME: (jh) Fix issue where SVG images appear blurry if scaled on Safari\n// (experienced issues on Safari 14 & 15; not tested on other versions at this\n// time)\n// Related issue: https://github.com/jzombie/pre-re-shell/issues/174\n\n/**\n * Automatically applies CSS transform scaling to children to fill parent node,\n * while preserving aspect ratio.\n *\n * Useful for videos and canvases, where the resolution is a fixed size and\n * should not change.\n */\nexport default function AutoScaler({ children, className, ...rest }) {\n  const [elOuterWrap, setElOuterWrap] = useState(null);\n  const [elInnerWrap, setElInnerWrap] = useState(null);\n\n  // TODO: Replace w/ useUUID\n  const uuid = useMemo(uuidv4, []);\n\n  // Handle scaling\n  useEffect(() => {\n    if (elOuterWrap && elInnerWrap) {\n      let outerWrapSize = {\n        width: 0,\n        height: 0,\n      };\n      let innerWrapSize = {\n        width: 0,\n        height: 0,\n      };\n\n      // This is uesd w/ visibility below to try to reduce position defects\n      // when first rendering\n      elInnerWrap.style.visibility = \"hidden\";\n\n      const ro = new ResizeObserver(entries => {\n        requestSkippableAnimationFrame(() => {\n          for (const entry of entries) {\n            const size = {\n              width: entry.target.offsetWidth,\n              height: entry.target.offsetHeight,\n            };\n\n            if (entry.target === elOuterWrap) {\n              outerWrapSize = size;\n            } else {\n              innerWrapSize = size;\n            }\n          }\n\n          // Determine against all available space\n          const maxScaleX = outerWrapSize.width / innerWrapSize.width;\n          const maxScaleY = outerWrapSize.height / innerWrapSize.height;\n\n          const scale = Math.min(maxScaleX, maxScaleY);\n\n          elInnerWrap.style.transform = `scale(${scale}, ${scale})`;\n\n          if (elInnerWrap.style.visibility === \"hidden\") {\n            setTimeout(() => {\n              elInnerWrap.style.visibility = \"visible\";\n            }, 4);\n          }\n        }, uuid);\n      });\n\n      ro.observe(elOuterWrap);\n      ro.observe(elInnerWrap);\n\n      return function unmount() {\n        ro.unobserve(elOuterWrap);\n        ro.unobserve(elInnerWrap);\n      };\n    }\n  }, [elOuterWrap, elInnerWrap, uuid]);\n\n  return (\n    <div\n      {...rest}\n      ref={setElOuterWrap}\n      className={classNames(styles[\"auto-scaler\"], className)}\n    >\n      <div ref={setElInnerWrap} className={styles[\"content-wrap\"]}>\n        {children}\n      </div>\n    </div>\n  );\n}\n","import AutoScaler from \"./AutoScaler\";\n\nexport default AutoScaler;\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`ibcd0b21d7ccf498b89d8ce646138a3ec-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import Notification from \"./Notification\";\n\nexport default Notification;\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport Animation from \"@components/Animation\";\nimport ButtonTransparent from \"@components/ButtonTransparent\";\nimport Padding from \"@components/Padding\";\n\nimport InfoIcon from \"@icons/InfoIcon\";\nimport CloseIcon from \"@icons/CloseIcon\";\n\nimport styles from \"./Notification.module.css\";\n\n// TODO: Add PropTypes\n// TODO: Document\nexport default function Notification({\n  body,\n  image,\n  title,\n  uuid,\n  onClose,\n  onClick,\n  // In milliseconds\n  autoCloseTime = 4000,\n  ...rest\n}) {\n  // TODO: Should this state be managed from the outside?\n  const [isClosing, setIsClosing] = useState(false);\n\n  // IMPORTANT: refOnClose is memoized to fix an issue where generating new\n  // notifications would restart the internal timer\n  const refOnClose = useRef(onClose);\n  const handleClose = useCallback(\n    evt => {\n      if (evt) {\n        evt.stopPropagation();\n      }\n\n      setIsClosing(true);\n\n      // NOTE (jh): We could also listen for Animation ended event, but decided\n      // to do the easy route at first.\n      setTimeout(\n        () => {\n          refOnClose.current(uuid);\n        },\n        // TODO: Make this value dynamic?\n        500\n      );\n    },\n    [uuid]\n  );\n\n  const [el, setEl] = useState(null);\n\n  // TODO: Document\n  useEffect(() => {\n    if (el) {\n      let autoCloseTimeout = null;\n\n      const startTimeout = () => {\n        autoCloseTimeout = setTimeout(handleClose, autoCloseTime);\n      };\n\n      startTimeout();\n\n      const stopTimeout = () => {\n        clearTimeout(autoCloseTimeout);\n      };\n\n      el.addEventListener(\"mouseover\", stopTimeout, { passive: true });\n      el.addEventListener(\"mouseout\", startTimeout, { passive: true });\n      el.addEventListener(\"touchstart\", stopTimeout, { passive: true });\n\n      return function unmount() {\n        el.removeEventListener(\"mouseover\", stopTimeout, { passive: true });\n        el.removeEventListener(\"mouseout\", startTimeout, { passive: true });\n        el.removeEventListener(\"touchstart\", stopTimeout, { passive: true });\n\n        stopTimeout();\n      };\n    }\n  }, [el, autoCloseTime, handleClose]);\n\n  // TODO: Refactor into Image component?\n  const Image = useMemo(\n    () => () => {\n      switch (typeof image) {\n        case \"string\":\n          return (\n            <img alt={title} src={image} className={styles[\"main-image\"]} />\n          );\n\n        case \"function\":\n          return image();\n\n        default:\n          return image || <InfoIcon />;\n      }\n    },\n    [image, title]\n  );\n\n  /**\n   * Note: Exports a button only if an onClick handler has been defined for\n   * the notification.\n   */\n  const MessageButton = useMemo(\n    () =>\n      ({ ...rest }) =>\n        typeof onClick === \"function\" ? (\n          <ButtonTransparent\n            {...rest}\n            onClick={onClick}\n            className={styles[\"action\"]}\n          />\n        ) : (\n          <React.Fragment {...rest} />\n        ),\n    [onClick]\n  );\n\n  return (\n    <div\n      ref={setEl}\n      onTouchEnd={handleClose}\n      onMouseUp={handleClose}\n      className={styles[\"notification\"]}\n      {...rest}\n    >\n      <Animation\n        animationName={!isClosing ? \"slideInRight\" : \"slideOutRight\"}\n        animationDuration=\".5s\"\n      >\n        <div className={styles[\"body-outer-wrap\"]}>\n          <MessageButton>\n            <Padding>\n              <div className={styles[\"main-image-wrap\"]}>\n                <Image />\n              </div>\n              <div className={styles[\"title\"]}>{title}</div>\n\n              <div className={styles[\"body\"]}>{body}</div>\n            </Padding>\n          </MessageButton>\n          <ButtonTransparent onClick={handleClose} className={styles[\"close\"]}>\n            <Padding>\n              <CloseIcon />\n            </Padding>\n          </ButtonTransparent>\n        </div>\n      </Animation>\n    </div>\n  );\n}\n","import NotificationStack from \"./NotificationStack\";\n\nexport default NotificationStack;\n","import React from \"react\";\n\nimport styles from \"./NotificationStack.module.css\";\n\nimport Notification from \"../Notification\";\n\n// TODO: Fix issue where notifications may move up if previous notifications\n// are closed before-hand\n\n// TODO: Document\n// Handles multiple-rendered notifications\nexport default function NotificationStack({\n  notifications = [],\n  onNotificationClose,\n}) {\n  return (\n    <div className={styles[\"notification-stack\"]}>\n      {\n        // NOTE: The inner-wrap enables too many UI notifications to be\n        // scrollable\n      }\n      <div className={styles[\"inner-wrap\"]}>\n        {\n          // IMPORTANT: onClose is not mapped from the data object because it is\n          // handled internally by the provider\n          notifications.map(({ body, image, onClick, title, uuid }) => {\n            return (\n              <div key={uuid}>\n                <Notification\n                  body={body}\n                  image={image}\n                  onClick={onClick}\n                  title={title}\n                  uuid={uuid}\n                  onClose={() => onNotificationClose(uuid)}\n                />\n              </div>\n            );\n          })\n        }\n      </div>\n    </div>\n  );\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport const EVT_NOTIFICATION = \"notification\";\n\n// TODO: Implement ability to store previous notifications so they can be retrieved\n\n/**\n * Handles management of UI notifications.\n */\nexport default class UINotificationService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"UI Notification Service\");\n\n    this.setState({\n      notifications: [],\n    });\n  }\n\n  // TODO: Document\n  // TODO: Borrow API from Apple: https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/DisplayNotifications.html#//apple_ref/doc/uid/TP40016239-CH61-SW1\n  showNotification({ image, title, body, onClick, onClose = () => null }) {\n    // TODO: Capture notification time\n\n    this.setState({\n      // Add new notifications to end of stack\n      notifications: [\n        ...this.getState().notifications,\n        {\n          image,\n          title,\n          body,\n          onClick,\n          onClose,\n          uuid: uuidv4(),\n        },\n      ],\n    });\n  }\n\n  // TODO: Document\n  closeNotificationWithUUID(uuid) {\n    const next = this.getState().notifications.filter(\n      ({ uuid: prevUUID, onClose }) => {\n        const isKept = uuid !== prevUUID;\n\n        if (!isKept) {\n          // Call the onClose handler passed to showNotification\n          onClose();\n        }\n\n        return isKept;\n      }\n    );\n\n    this.setState({\n      notifications: next,\n    });\n  }\n}\n","import React, { useCallback } from \"react\";\n\nimport NotificationStack from \"./views/NotificationStack\";\nimport useServiceClass from \"@hooks/useServiceClass\";\nimport UINotificationService from \"@services/UINotificationService\";\n\nexport const NotificationContext = React.createContext({});\n\n// TODO: Document\n// TODO: Borrow API logic from https://www.npmjs.com/package/react-notifications\nexport default function NotificationProvider({ children }) {\n  const { serviceInstance, serviceState } = useServiceClass(\n    UINotificationService\n  );\n\n  // TODO: Document\n  const showNotification = useCallback(\n    notification => serviceInstance.showNotification(notification),\n    [serviceInstance]\n  );\n\n  // TODO: Document\n  const closeNotificationWithUUID = useCallback(\n    uuid => serviceInstance.closeNotificationWithUUID(uuid),\n    [serviceInstance]\n  );\n\n  return (\n    <NotificationContext.Provider\n      value={{\n        showNotification,\n      }}\n    >\n      {children}\n\n      <NotificationStack\n        notifications={serviceState.notifications}\n        onNotificationClose={closeNotificationWithUUID}\n      />\n    </NotificationContext.Provider>\n  );\n}\n","import NotificationProvider, {\n  NotificationContext,\n} from \"./NotificationProvider\";\n\nexport default NotificationProvider;\nexport { NotificationContext };\n","import Modal from \"./Modal\";\n\nexport default Modal;\n","import React from \"react\";\n\nimport Cover from \"@components/Cover\";\n\n// TODO: Add PropTypes\n// TODO: Document\nexport default function Modal({ view: View, onClose, ...rest }) {\n  return (\n    <Cover>\n      <View {...rest} onClose={onClose} />\n    </Cover>\n  );\n}\n","import ModalStack from \"./ModalStack\";\n\nexport default ModalStack;\n","import React from \"react\";\n\nimport Modal from \"../Modal\";\n\n// TODO: Document\n// Handles multiple-rendered modals\nexport default function ModalStack({ modals = [] }) {\n  return (\n    <>\n      {modals.map(({ view, uuid, onClose, ...rest }) => {\n        return (\n          <div key={uuid}>\n            <Modal {...rest} view={view} uuid={uuid} onClose={onClose} />\n          </div>\n        );\n      })}\n    </>\n  );\n}\n","import React, { useCallback } from \"react\";\n\nimport ModalStack from \"./views/ModalStack\";\nimport useServiceClass from \"@hooks/useServiceClass\";\nimport UIModalService from \"@services/UIModalService\";\n\nexport const ModalContext = React.createContext({});\n\n// TODO: Document\nexport default function ModalProvider({ children }) {\n  const { serviceInstance, serviceState } = useServiceClass(UIModalService);\n\n  // TODO: Document\n  const showModal = useCallback(\n    modal => serviceInstance.showModal(modal),\n    [serviceInstance]\n  );\n\n  return (\n    <ModalContext.Provider\n      value={{\n        showModal,\n      }}\n    >\n      {children}\n\n      <ModalStack modals={serviceState.modals} />\n    </ModalContext.Provider>\n  );\n}\n","import ModalProvider, { ModalContext } from \"./ModalProvider\";\n\nexport default ModalProvider;\nexport { ModalContext };\n","import Desktop from \"./Desktop\";\n\nexport default Desktop;\n","import PhantomCore from \"phantom-core\";\nimport ReShellCore from \"@core\";\n\nimport WindowManager from \"./Desktop.WindowManager\";\nimport TopBar from \"./Desktop.TopBar\";\nimport Dock from \"./Desktop.Dock\";\n\nimport FullViewport from \"../FullViewport\";\nimport Cover from \"../Cover\";\nimport Layout, { Header, Content } from \"../Layout\";\n\nimport AutoScaler from \"../AutoScaler\";\n\nimport NotificationProvider from \"./providers/NotificationProvider\";\nimport ModalProvider from \"./providers/ModalProvider\";\n\n// TODO: Consider using Noto Sans font for UI (same that Slack uses, nice font;\n// preload resources w/ Preloader component): https://fonts.google.com/noto/specimen/Noto+Sans\n\n// TODO: Implement context menu\n// @see https://szhsin.github.io/react-menu/#context-menu\n\n// TODO: Use prop-types\n// TODO: Document\nexport default function Desktop({ backgroundView = null, appDescriptors }) {\n  return (\n    <FullViewport>\n      {\n        // IMPORTANT: Using NotificationProvider directly on the BaseView does\n        // not apply CSS module styling\n      }\n      <ModalProvider>\n        <NotificationProvider>\n          <Cover\n            // TODO: Remove this hardcoding\n            style={{\n              backgroundColor: \"#424242\",\n            }}\n          >\n            {\n              // TODO: Refactor\n            }\n            {backgroundView}\n          </Cover>\n          <Cover>\n            <Layout>\n              <Header\n                style={{\n                  // borderBottom: \"1px #ccc solid\",\n                  whiteSpace: \"nowrap\",\n                  backgroundColor: \"rgba(0,0,0,.5)\",\n                }}\n              >\n                <TopBar />\n              </Header>\n              <Content>\n                {\n                  // TODO: Allow videos to play on background\n                }\n\n                {\n                  // TODO: Refactor into a version component\n                }\n                <div\n                  style={{\n                    maxWidth: \"50%\",\n                    position: \"absolute\",\n                    bottom: 28,\n                    right: 10,\n                    color: \"rgba(255,255,255,.2)\",\n                    fontSize: \"2rem\",\n\n                    // The following properties enable this to overlay all (or\n                    // most) other components without interfering with their\n                    // handling (thanks to \"pointer-events: none\")\n                    pointerEvents: \"none\",\n                    // FIXME: (jh) Is there a way to do this overlawy w/o using\n                    // z-index?\n                    zIndex: 2147483647,\n                  }}\n                >\n                  <AutoScaler style={{ whiteSpace: \"nowrap\" }}>\n                    <div style={{ textAlign: \"left\", fontSize: \".5em\" }}>\n                      {\n                        // TODO: Load as env variable\n                      }\n                      <div>ReShell {ReShellCore.getReShellVersion()}</div>\n                      <div>\n                        PhantomCore {PhantomCore.getPhantomCoreVersion()}\n                      </div>\n                      {\n                        // FIXME: (jh) This typically always renders \"default\"\n                        // for the portal name, and portal name acquisition\n                        // needs to be improved (more than likely via\n                        // reshell-scripts and __registerPortals__.js)\n                        /*\n                        <div>Portal: {ReShellCore.getPortalName()}</div>\n                        */\n                      }\n                      <div>Env: {process.env.NODE_ENV}</div>\n                    </div>\n                  </AutoScaler>\n                </div>\n                <WindowManager appDescriptors={appDescriptors}>\n                  <Dock />\n                </WindowManager>\n              </Content>\n            </Layout>\n          </Cover>\n        </NotificationProvider>\n      </ModalProvider>\n    </FullViewport>\n  );\n}\n","import VirtualLink from \"./VirtualLink\";\n\nexport default VirtualLink;\n","import ButtonTransparent from \"../ButtonTransparent\";\n\nimport styles from \"./VirtualLink.module.css\";\nimport classNames from \"classnames\";\n\n/**\n * NOTE: Fake links need to be a button, so this button is designed to look\n * like a real link, for the most part.\n */\nexport default function VirtualLink({ children, className, onClick, ...rest }) {\n  return (\n    <ButtonTransparent\n      {...rest}\n      // IMPORTANT: The seemingly double link styles are placed on purpose (one\n      // is the normal CSS, and the other is the module.css override)\n      className={classNames(\"link\", styles[\"virtual-link\"], className)}\n      onClick={onClick}\n    >\n      {children}\n    </ButtonTransparent>\n  );\n}\n","import LED from \"./LED\";\n\nexport default LED;\n","import React from \"react\";\nimport styles from \"./LED.module.css\";\nimport classNames from \"classnames\";\nimport PropTypes from \"prop-types\";\n\nLED.propTypes = {\n  /** The color of the LED */\n  color: PropTypes.string,\n};\n\n/**\n * @see https://github.com/aus/led.css\n * @see http://jsfiddle.net/XrHcA/\n */\nexport default function LED({ color = null, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"led\"], styles[color])}></div>\n  );\n}\n","import { consume } from \"phantom-core\";\nimport { useMemo } from \"react\";\nimport Center from \"@components/Center\";\nimport LED from \"@components/LED\";\nimport Padding from \"@components/Padding\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nexport default function ApplicationSelector({\n  searchQuery = \"\",\n  onResetSearchQuery,\n}) {\n  const { appRegistrations, appRuntimes, activateAppRegistration } =\n    useAppOrchestrationContext();\n\n  const appRuntimeRegistrations = useMemo(\n    () => appRuntimes.map(runtime => runtime.getRegistration()),\n    [appRuntimes]\n  );\n\n  // TODO: Move application search into a service and implement keyword-based\n  // searching, other criteria\n  const filteredRegistrations = useMemo(\n    () =>\n      appRegistrations.filter(registration =>\n        !Boolean(searchQuery)\n          ? true\n          : registration\n              .getTitle()\n              .toUpperCase()\n              .includes(searchQuery.toUpperCase())\n      ),\n    [appRegistrations, searchQuery]\n  );\n\n  if (searchQuery?.length && !filteredRegistrations.length) {\n    return (\n      <Center>\n        <Padding style={{ fontWeight: \"bold\" }}>\n          No applications found for search.\n        </Padding>\n        <Padding>\n          <button onClick={onResetSearchQuery}>Reset Search Query</button>\n        </Padding>\n      </Center>\n    );\n  }\n\n  return (\n    <Center canOverflow={true}>\n      <Padding>\n        {filteredRegistrations.map(registration => {\n          // const isRunning = appRuntimeRegistrations.includes(registration);\n          const totalInstances = appRuntimeRegistrations.filter(\n            predicate => predicate === registration\n          ).length;\n\n          return (\n            <button\n              key={registration.getUUID()}\n              // TODO: Extract to module.css\n              style={{\n                width: 100,\n                height: 100,\n                // IMPORTANT: This overflow being hidden was causing an issue\n                // in Chrome where buttons could be clickable in the title bar\n                // region of the window, if scrolled beyond.\n                // Relevant issue: https://github.com/jzombie/pre-re-shell/issues/169\n                //\n                // overflow: \"hidden\",\n                backgroundColor: \"transparent\",\n                borderColor: totalInstances > 0 ? \"green\" : \"\",\n              }}\n              onClick={() => activateAppRegistration(registration)}\n            >\n              {registration.getTitle()}\n\n              {\n                // FIXME: (jh) This isn't valid HTML, as a button element\n                // shouldn't contain non-inline styling\n              }\n              <div style={{ position: \"absolute\", bottom: 0, right: 0 }}>\n                {[...new Array(totalInstances)].map((nonUsed, idx) => {\n                  consume(nonUsed);\n\n                  return (\n                    <LED\n                      key={idx}\n                      color={totalInstances > 0 ? \"green\" : \"gray\"}\n                      // TODO: Extract to module.css\n                      style={{ margin: \"0px 2px\" }}\n                    />\n                  );\n                })}\n              </div>\n            </button>\n          );\n        })}\n      </Padding>\n    </Center>\n  );\n}\n","import Center from \"@components/Center\";\n\nimport ReShellCore from \"@core\";\n\nexport default function PortalSwitcher() {\n  return (\n    <Center canOverflow={true}>\n      {Object.entries(ReShellCore.getPortals()).map(([portalName]) => (\n        <button\n          key={portalName}\n          onClick={() =>\n            // TODO: Use dialog modal for this, and dynamically set the title based on the current portal state\n            window.confirm(\n              \"Any unsaved state will be lost and the current call will be dropped if switching portals.  Proceed?\"\n            ) && ReShellCore.switchToPortal(portalName)\n          }\n        >\n          {portalName}\n        </button>\n      ))}\n    </Center>\n  );\n}\n","import ReShellCore from \"@core\";\n\nimport { useCallback, useEffect, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\nimport VirtualLink from \"@components/VirtualLink\";\n\nimport useKeyboardEvents from \"@hooks/useKeyboardEvents\";\n\nimport ApplicationSelector from \"./views/ApplicationSelector\";\nimport PortalSwitcher from \"./views/PortalSelector\";\n\nconst LEN_PORTALS = Object.keys(ReShellCore.getPortals()).length;\n\nconst DEFAULT_SEARCH_QUERY = \"\";\n\nexport const REGISTRATION_ID = \"applications\";\n\nconst ApplicationsApp = {\n  id: REGISTRATION_ID,\n  title: \"Applications\",\n  style: {\n    width: 640 * 1.2,\n    height: 400 * 1.2,\n  },\n  isAutoStart: true,\n  isPinnedToDock: true,\n  initialSharedState: {\n    searchQuery: DEFAULT_SEARCH_QUERY,\n  },\n  // TODO: Implement the ability to set control handlers which can be driven by the menu\n  /*\n  controlMethods: {\n    // [ROLE_WINDOW_MENU_SUBITEM]\n    setIsDisplayingPortals: ({...samePropsAsView, etc.}) => {\n    }\n  },\n  */\n  // TODO: Implement custom menu functionality\n  /**\n  menu: {\n    window: [\n      {\n        role: 'view-switch'\n        getIsShown: ({sharedState}) => !sharedState.isShowingApplications\n        title: 'Show Applications',\n        onClick: ({controlMethods}) => ...\n      },\n      {\n        role: 'view-switch'\n        getIsShown: ({sharedState}) => sharedState.isShowingApplications\n        title: 'Show Portals',\n        onClick: ({controlMethods}) => ...\n      },\n  ]\n  }\n  */\n  titleBarView: function TitleBarView({ sharedState, setSharedState }) {\n    const [elSearch, setElSearch] = useState(null);\n\n    // Clear search query on escape\n    useKeyboardEvents(elSearch, {\n      onEscape: () => setSharedState({ searchQuery: \"\" }),\n    });\n\n    const handleSetSearchQuery = useCallback(\n      evt => setSharedState({ searchQuery: evt.target.value }),\n      [setSharedState]\n    );\n\n    const handleDoubleClick = useCallback(\n      evt => {\n        // Prevent double-clicks from propagating if there is text\n        if (Boolean(sharedState.searchQuery)) {\n          evt.stopPropagation();\n        }\n      },\n      [sharedState]\n    );\n\n    return (\n      <Padding>\n        {\n          // TODO: Automatically focus when window is activated (unless on mobile)\n          //\n          // TODO: Switch to Applications view on change\n          //\n          // FIXME: (jh) I tried to use type=\"search\", which gives you an X in\n          // the input field, however I wasn't able to make it clear itself. If\n          // this were an uncontrolled component, it might work. Needs some\n          // refactoring.\n          //\n          // FIXME: Create common TextInput component which has double-click\n          // functionality baked in; use in TextInputModal as well, etc. It\n          // shouldn't get fancy and it should be compatible with regular DOM-\n          // based text input props\n        }\n        <input\n          ref={setElSearch}\n          placeholder=\"Search Applications\"\n          onChange={handleSetSearchQuery}\n          value={sharedState.searchQuery}\n          style={{ width: \"100%\" }}\n          onDoubleClick={handleDoubleClick}\n        />\n      </Padding>\n    );\n  },\n  view: function View({ windowController, sharedState, setSharedState }) {\n    const [isDisplayingPortals, setIsDisplayingPortals] = useState(false);\n\n    // Auto-switch window title depending on \"Applications\" or \"Portals\" mode\n    useEffect(() => {\n      windowController.setTitle(\n        // TODO: Use default values instead of hardcoded\n        !isDisplayingPortals ? \"Applications\" : \"Portals\"\n      );\n    }, [windowController, isDisplayingPortals]);\n\n    const searchQuery = sharedState?.searchQuery;\n\n    const handleResetSearchQuery = useCallback(\n      () => setSharedState({ searchQuery: DEFAULT_SEARCH_QUERY }),\n      [setSharedState]\n    );\n\n    return (\n      <Layout>\n        <Content>\n          {!isDisplayingPortals ? (\n            <ApplicationSelector\n              searchQuery={searchQuery}\n              onResetSearchQuery={handleResetSearchQuery}\n            />\n          ) : (\n            <PortalSwitcher />\n          )}\n        </Content>\n        {Boolean(LEN_PORTALS > 1) && (\n          <Footer>\n            <Padding>\n              <button onClick={() => setIsDisplayingPortals(prev => !prev)}>\n                {!isDisplayingPortals ? \"Portals\" : \"Applications\"}\n              </button>{\" \"}\n              <span className=\"note\">\n                {!isDisplayingPortals ? (\n                  <>\n                    Other applications may be available in{\" \"}\n                    <VirtualLink onClick={() => setIsDisplayingPortals(true)}>\n                      another portal\n                    </VirtualLink>\n                    .\n                  </>\n                ) : (\n                  <>\n                    Return to{\" \"}\n                    <VirtualLink onClick={() => setIsDisplayingPortals(false)}>\n                      application list\n                    </VirtualLink>\n                    .\n                  </>\n                )}\n              </span>\n            </Padding>\n          </Footer>\n        )}\n      </Layout>\n    );\n  },\n};\n\nexport default ApplicationsApp;\n","import ApplicationsApp, { REGISTRATION_ID } from \"./ApplicationsApp\";\n\nexport default ApplicationsApp;\nexport { REGISTRATION_ID };\n","import ApplicationsApp from \"../../ExamplePortal/apps/ApplicationsApp\";\n\nconst ApplicationsOverrideApp = {\n  ...ApplicationsApp,\n  isAutoStart: false,\n};\n\nexport default ApplicationsOverrideApp;\n","import Timer from \"./Timer\";\n\nexport default Timer;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport NoWrap from \"../NoWrap\";\n\nimport PropTypes from \"prop-types\";\n\nTimer.propTypes = {\n  onTick: PropTypes.func.isRequired,\n};\n\n// TODO: Document\nexport default function Timer({ onTick, className, ...rest }) {\n  const [seconds, _setSeconds] = useState(onTick());\n\n  const getSeconds = useCallback(() => {\n    const seconds = onTick();\n\n    return seconds;\n  }, [onTick]);\n\n  useEffect(() => {\n    const handleUpdate = () => _setSeconds(getSeconds());\n\n    // Perform initial render\n    handleUpdate();\n\n    // FIXME: (jh) Would it be more performant to combine these intervals?\n    const updateInterval = window.setInterval(handleUpdate, 1000);\n\n    return function unmount() {\n      window.clearInterval(updateInterval);\n    };\n  }, [getSeconds]);\n\n  return <NoWrap {...rest}>{getSecondsToHHMMSS(seconds)}</NoWrap>;\n}\n\n// TODO: Refactor\n/**\n * @see https://stackoverflow.com/questions/1322732/convert-seconds-to-hh-mm-ss-with-javascript\n *\n * @param {number} seconds\n * @return {string} hh:mm:ss format\n */\nfunction getSecondsToHHMMSS(secs) {\n  // Note: This version should handle seconds if length is longer than one day\n  return new Date((secs % (60 * 60 * 24)) * 1000).toISOString().substr(11, 8);\n}\n","import { consume } from \"phantom-core\";\nimport { useEffect, useState } from \"react\";\nimport Timer from \"@components/Timer\";\nimport { EVT_RENDER_PROFILED } from \"@components/Window/classes/WindowController\";\nimport LED from \"@components/LED\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\n\nexport default function AppRuntimeTableRow({ appRuntime }) {\n  const { activeWindowController } = useDesktopContext();\n\n  const windowController = appRuntime.getWindowController();\n\n  const isTopMostWindowController =\n    !windowController || windowController === activeWindowController;\n\n  const [elProfilerPhase, setElProfilerPhase] = useState(null);\n  const [elProfilerActualDuration, setElProfilerActualDuration] =\n    useState(null);\n  const [elProfilerBaseDuration, setElProfilerBaseDuration] = useState(null);\n  const [elProfilerStartTime, setElProfilerStartTime] = useState(null);\n  const [elProfilerCommitTime, setElProfilerCommitTime] = useState(null);\n  const [elProfilerInteractions, setElProfilerInteractions] = useState(null);\n\n  useEffect(() => {\n    if (windowController && elProfilerPhase) {\n      // @see https://reactjs.org/docs/profiler.html\n      const handleRenderProfile = arrRenderProfile => {\n        // IMPORTANT: (jh) This was not cast to an Object because I'm not\n        // positive if that would induce a lot of extra overhead over time;\n        // React defines this as an array, so maybe it's best just leaving it\n        // the way it is\n        const [\n          id, // the \"id\" prop of the Profiler tree that has just committed\n          phase, // either \"mount\" (if the tree just mounted) or \"update\" (if it re-rendered)\n          actualDuration, // time spent rendering the committed update\n          baseDuration, // estimated time to render the entire subtree without memoization\n          startTime, // when React began rendering this update\n          commitTime, // when React committed this update\n          interactions, // the Set of interactions belonging to this update\n        ] = arrRenderProfile;\n\n        // We're not doing anything w/ id, but if we remove it from the array,\n        // the other variable names are out of sync\n        consume(id);\n\n        // We have to skip setting these as state or we'll run into an infinite loop\n        elProfilerPhase.innerHTML = phase;\n        elProfilerActualDuration.innerHTML =\n          parseFloat(actualDuration).toFixed(2);\n        elProfilerBaseDuration.innerHTML = parseFloat(baseDuration).toFixed(2);\n        elProfilerStartTime.innerHTML = parseFloat(startTime / 1000).toFixed(2);\n        elProfilerCommitTime.innerHTML = parseFloat(commitTime / 1000).toFixed(\n          2\n        );\n        elProfilerInteractions.innerHTML = Object.values(interactions).length;\n      };\n\n      windowController.on(EVT_RENDER_PROFILED, handleRenderProfile);\n\n      return function unmount() {\n        windowController.off(EVT_RENDER_PROFILED, handleRenderProfile);\n      };\n    }\n  }, [\n    windowController,\n    elProfilerPhase,\n    elProfilerActualDuration,\n    elProfilerBaseDuration,\n    elProfilerStartTime,\n    elProfilerCommitTime,\n    elProfilerInteractions,\n  ]);\n\n  return (\n    <>\n      <tr key={appRuntime.getUUID()} style={{ textAlign: \"center\" }}>\n        <td>{appRuntime.getTitle() || \"[Untitled]\"}</td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerPhase}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerActualDuration}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerBaseDuration}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerStartTime}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerCommitTime}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerInteractions}>N/A</span>\n        </td>\n      </tr>\n      <tr style={{ textAlign: \"center\" }}>\n        <td style={{ fontStyle: \"italic\" }}>\n          Uptime: <Timer onTick={() => appRuntime.getInstanceUptime()} />\n        </td>\n        <td colSpan=\"3\">\n          <button\n            // TODO: Implement alternate handling\n            onClick={() => console.log({ appRuntime })}\n            disabled\n          >\n            Process\n          </button>\n          <span> | </span>\n          <button\n            // TODO: Implement alternate handling\n            onClick={() =>\n              console.log({ environment: appRuntime.getEnvironment() })\n            }\n            disabled\n          >\n            Environment\n          </button>\n        </td>\n        <td>\n          <LED color={isTopMostWindowController ? \"green\" : \"gray\"} />\n        </td>\n        <td colSpan=\"2\">\n          <button\n            onClick={() => windowController.bringToTop()}\n            style={{ backgroundColor: \"blue\" }}\n            disabled={isTopMostWindowController}\n          >\n            Bring to Top\n          </button>\n          <span> | </span>\n          <button\n            onClick={() => {\n              if (!appRuntime.getIsDestroying()) {\n                appRuntime.destroy();\n              }\n            }}\n            style={{ backgroundColor: \"red\" }}\n          >\n            Close\n          </button>\n        </td>\n      </tr>\n      <tr>\n        <td colSpan=\"7\" style={{ backgroundColor: \"gray\", height: 4 }}></td>\n      </tr>\n    </>\n  );\n}\n","import AppRuntimeTableRow from \"./AppRuntime.Table.Row\";\n\n// TODO: Document\nexport default function AppRuntimeTable({ appRuntimes }) {\n  return (\n    <table style={{ width: \"100%\" }}>\n      <thead>\n        <tr>\n          <td rowSpan=\"2\">Name</td>\n          <td colSpan=\"6\" style={{ backgroundColor: \"purple\" }}>\n            Profiler\n          </td>\n          <td colSpan=\"2\"></td>\n        </tr>\n        <tr>\n          <td style={{ backgroundColor: \"purple\" }}>Phase</td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Actual\n            <br />\n            Duration\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Base\n            <br />\n            Duration\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Start\n            <br />\n            Time\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Commit\n            <br />\n            Time\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>Interactions</td>\n        </tr>\n      </thead>\n      <tbody>\n        {appRuntimes.map((runtime) => (\n          <AppRuntimeTableRow key={runtime.getUUID()} appRuntime={runtime} />\n        ))}\n      </tbody>\n    </table>\n  );\n}\n","import AppLinkButton from \"./AppLinkButton\";\n\nexport default AppLinkButton;\n","import { useMemo } from \"react\";\nimport useAppRegistrationLink from \"@hooks/useAppRegistrationLink\";\nimport ButtonTransparent from \"../ButtonTransparent\";\n\nimport PropTypes from \"prop-types\";\n\n// FIXME: (jh) Apply \"active\" class to button whenever registration is active?\n\nAppLinkButton.propTypes = {\n  // App descriptor / registration ID\n  id: PropTypes.string.isRequired,\n\n  // Optional title override for button link, if wanting to inherit title from\n  // app itself\n  title: PropTypes.string,\n};\n\n// TODO: Document\nexport default function AppLinkButton({\n  id,\n  children = null,\n  title = null,\n  ...rest\n}) {\n  const { title: registrationTitle, link } = useAppRegistrationLink(id);\n\n  // If there are children, show a non-styled [transparent] button, otherwise,\n  // show a standard button\n  const ButtonView = useMemo(\n    () => props =>\n      children ? <ButtonTransparent {...props} /> : <button {...props} />,\n    [children]\n  );\n\n  // Link might not be available if calling from another portal or if the app\n  // descriptor is not currently registered with app registrations\n  if (!link) {\n    return null;\n  }\n\n  return (\n    <ButtonView\n      // IMPORTANT: ...rest is moved before onClick handler so the internal\n      // onClick handler will not be overridden\n      {...rest}\n      onClick={link}\n    >\n      {children || title || registrationTitle}\n    </ButtonView>\n  );\n}\n","import { useCallback, useMemo } from \"react\";\n// TODO: Refactor\nimport useAppOrchestrationContext from \"./useAppOrchestrationContext\";\n\n// TODO: Move to @core/hooks\n\n// FIXME: (jh) Is there any reason to not just use the appDescriptor itself,\n// and not the ID?\n\n// TODO: Document\nexport default function useAppRegistrationLink(appDescriptorID) {\n  const { getAppRegistrationTitleWithID, activateAppRegistrationWithID } =\n    useAppOrchestrationContext();\n\n  const title = useMemo(\n    () => getAppRegistrationTitleWithID(appDescriptorID),\n    [getAppRegistrationTitleWithID, appDescriptorID]\n  );\n  const link = useCallback(\n    () => activateAppRegistrationWithID(appDescriptorID),\n    [activateAppRegistrationWithID, appDescriptorID]\n  );\n\n  return {\n    title,\n    link,\n  };\n}\n","// NOTE: No hook is wrapped directly around this because the goal is to not\n// make it easy to expose services to windows which don't directly use said\n// service\n\nimport PhantomCore from \"phantom-core\";\n\nimport { useContext } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport Timer from \"@components/Timer\";\nimport NoWrap from \"@components/NoWrap\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { UIServicesContext } from \"@core/providers/UIServicesProvider\";\n\nimport { REGISTRATION_ID as APPLICATION_MONITOR_REGISTRATION_ID } from \"./ApplicationMonitorApp\";\n\n// TODO: Include (either here, or elsewhere,) ability to monitor running\n// PhantomCore instances (use WeakRef here or there, as well)?\n\n// TODO: Show last update time, state, etc.\n\n// TODO: Include ability to render service reporters, once functionality is\n// integrated\n\n// TODO: Include ability to monitor React providers exposed by the service\n\nexport const REGISTRATION_ID = \"service-monitor\";\n\nconst ServiceMonitorApp = {\n  id: REGISTRATION_ID,\n  title: \"Service Monitor\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  isPinned: true,\n  view: function View() {\n    const { services } = useContext(UIServicesContext);\n\n    // TODO: Group by runtime\n\n    return (\n      <Layout>\n        <Content>\n          <Full style={{ overflowY: \"auto\" }}>\n            <table style={{ width: \"100%\" }}>\n              <thead>\n                <tr>\n                  <td>\n                    <Padding>Service Name</Padding>\n                  </td>\n                  <td>\n                    <Padding>Uptime</Padding>\n                  </td>\n                  <td>\n                    <Padding>f(x)</Padding>\n                  </td>\n                  {/**\n              <td>\n                Active\n                <br />\n                App Runtimes\n              </td>\n              <td>\n                Dynamically\n                <br />\n                Linked Providers\n              </td>  \n               */}\n                </tr>\n              </thead>\n              <tbody>\n                {services.map(service => (\n                  <tr key={service.getUUID()}>\n                    <td>\n                      <Padding>{service.getTitle() || \"[Untitled]\"}</Padding>\n                    </td>\n                    <td className=\"center\">\n                      <Timer onTick={() => service.getInstanceUptime()} />\n                    </td>\n                    {/*\n                  <td className=\"center\">N/A</td>\n                  <td className=\"center\">N/A</td>\n                  */}\n                    {/*\n              <td>\n                <button\n                  onClick={() => service.destroy()}\n                  style={{ width: \"100%\" }}\n                >\n                  Close\n                </button>\n              </td>\n                */}\n                    <td className=\"center\">\n                      {\n                        // TODO: Remove\n                      }\n                      <Padding>\n                        <button onClick={() => service.log(service.getState())}>\n                          <NoWrap>log(state)</NoWrap>\n                        </button>\n                      </Padding>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </Full>\n        </Content>\n        <Footer>\n          <hr style={{ margin: 0, padding: 0 }} />\n          <Padding>\n            <Full>\n              <div style={{ position: \"absolute\", bottom: 0, left: 0 }}>\n                PhantomCore uptime:{\" \"}\n                <Timer onTick={() => PhantomCore.getUptime()} />\n              </div>\n              <AppLinkButton\n                id={APPLICATION_MONITOR_REGISTRATION_ID}\n                style={{ float: \"right\", verticalAlign: \"bottom\" }}\n              />\n            </Full>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ServiceMonitorApp;\n","import PhantomCore from \"phantom-core\";\n\nimport { useEffect } from \"react\";\n\nimport AppRuntimeTable from \"./AppRuntime.Table\";\n\nimport Center from \"@components/Center\";\nimport Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Timer from \"@components/Timer\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { REGISTRATION_ID as SERVICE_MONITOR_REGISTRATION_ID } from \"../ServiceMonitorApp\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nexport const REGISTRATION_ID = \"application-monitor\";\n\nconst ApplicationMonitorApp = {\n  id: REGISTRATION_ID,\n  title: \"Application Monitor\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  isPinned: true,\n  view: function View({ windowController }) {\n    const { appRuntimes } = useAppOrchestrationContext();\n    const { isProfiling, setIsProfiling } = useDesktopContext();\n\n    useEffect(() => {\n      if (isProfiling) {\n        return () => setIsProfiling(false);\n      }\n    }, [isProfiling, setIsProfiling]);\n\n    // TODO: Determine if profiler is available in the current environment\n\n    // TODO: Group by registration\n    // TODO: Show attached services, per application\n    // TODO: Show last render time / frequency / graph?\n    // TODO: Implement ability to record render profile intervals, with the ability to show them in a graph (per application; use legend)\n    // TODO: Implement ability to show how linked services affect render profiles; capture in recordings\n    // TODO: Implement ability to do call stack tracing (only when recording)\n\n    if (!isProfiling) {\n      return (\n        <Center>\n          <div>\n            <p style={{ fontWeight: \"bold\" }}>\n              Application Profiling is experimental!\n            </p>\n\n            <ol\n              style={{\n                maxWidth: 500,\n                textAlign: \"left\",\n                display: \"inline-block\",\n              }}\n            >\n              <li>\n                Each window may lose its current state once profiling is\n                enabled.\n              </li>\n              <li>\n                Also, once enabled and closing this application, the state may\n                be lost again!\n              </li>\n            </ol>\n\n            <Padding>\n              <button\n                onClick={() => setIsProfiling(true)}\n                style={{ backgroundColor: \"red\" }}\n              >\n                Enable Profiling\n              </button>\n              <p className=\"note\">\n                Profiling will be disabled once closing this window\n              </p>\n            </Padding>\n          </div>\n        </Center>\n      );\n    }\n\n    return (\n      <Layout>\n        <Content>\n          <Padding style={{ overflowY: \"auto\" }}>\n            <AppRuntimeTable appRuntimes={appRuntimes} />\n          </Padding>\n        </Content>\n        <Footer style={{ fontSize: \".8rem\" }}>\n          <hr style={{ margin: 0, padding: 0 }} />\n          <Padding>\n            <Full>\n              <div style={{ position: \"absolute\", bottom: 0, left: 0 }}>\n                PhantomCore uptime:{\" \"}\n                <Timer onTick={() => PhantomCore.getUptime()} />\n              </div>\n              <AppLinkButton\n                id={SERVICE_MONITOR_REGISTRATION_ID}\n                style={{ float: \"right\", verticalAlign: \"bottom\" }}\n              />\n            </Full>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ApplicationMonitorApp;\n","import ApplicationMonitorApp, {\n  REGISTRATION_ID,\n} from \"./ApplicationMonitorApp\";\n\nexport default ApplicationMonitorApp;\nexport { REGISTRATION_ID };\n","import ButtonPanel from \"./ButtonPanel\";\n\nexport default ButtonPanel;\n","import React, { useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\n\nButtonPanel.propTypes = {\n  buttons: PropTypes.arrayOf(\n    PropTypes.shape({\n      // TODO: Require to be React component (or any?)\n      // TODO: Rename to view, or label\n      content: PropTypes.any.isRequired,\n\n      onClick: PropTypes.func.isRequired,\n\n      type: PropTypes.string,\n\n      disabled: PropTypes.bool,\n\n      // Optional style override\n      style: PropTypes.string,\n\n      // Optional style override\n      className: PropTypes.string,\n\n      /** If set to true, this acts as the default button */\n      isSelected: PropTypes.bool,\n    })\n  ),\n};\n\n/**\n * ButtonPanel is utilized for a set of buttons which need to maintain state\n * relative to one another, operating much like radio controls.\n */\nexport default function ButtonPanel({ buttons, className, ...rest }) {\n  const [selectedIdx, setSelectedIdx] = useState(() => {\n    let selectedIdx = 0;\n\n    buttons.forEach((button, idx) => {\n      if (button.isSelected) {\n        selectedIdx = idx;\n      }\n    });\n\n    return selectedIdx;\n  });\n\n  // TODO: Document\n  const refRenderIdx = useRef(-1);\n  ++refRenderIdx.current;\n\n  return (\n    <div className={classNames(\"button-group\", className)} {...rest}>\n      {buttons.map(\n        (\n          {\n            content: Content,\n            onClick,\n            disabled,\n            isSelected,\n            style,\n            className,\n            type = \"button\",\n            ...args\n          },\n          idx\n        ) => {\n          // If first render, and we're at the defaultSelectedIdx, call the onClick handler\n          // TODO: Detect if first render of React after page updates\n          if (refRenderIdx.current === 0 && selectedIdx === idx) {\n            // Fixes issue:  Cannot update a component (`X`) while rendering a\n            // different component (`Y`).\n            setTimeout(() => {\n              onClick();\n            });\n          }\n\n          return (\n            <button\n              {...args}\n              key={idx}\n              type={type}\n              onClick={() => {\n                setSelectedIdx(idx);\n\n                onClick();\n              }}\n              disabled={disabled}\n              style={style}\n              className={classNames([\n                selectedIdx === idx && \"active\",\n                className,\n              ])}\n            >\n              {\n                // TODO: Refactor\n                typeof Content === \"string\" ? (\n                  Content\n                ) : typeof Content === \"function\" ? (\n                  <Content />\n                ) : (\n                  { Content }\n                )\n              }\n            </button>\n          );\n        }\n      )}\n    </div>\n  );\n}\n","import Toggle from \"./Toggle\";\n\nexport default Toggle;\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./Toggle.module.css\";\nimport PropTypes from \"prop-types\";\nimport useUUID from \"@hooks/useUUID\";\n\nToggle.propTypes = {\n  isOn: PropTypes.bool,\n\n  // Invoked with boolean \"on\" value as its argument\n  onChange: PropTypes.func,\n\n  disabled: PropTypes.bool,\n};\n\nexport default function Toggle({\n  className,\n  isOn,\n  disabled,\n  onChange = () => null,\n  ...rest\n}) {\n  const domId = useUUID();\n\n  return (\n    <div\n      className={classNames(\n        styles[\"toggle-wrapper\"],\n        disabled && styles[\"disabled\"],\n        className\n      )}\n      {...rest}\n    >\n      <input\n        type=\"checkbox\"\n        id={domId}\n        className={styles[\"checkbox\"]}\n        // FIXME: (jh) Implement optional name and value: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/checkbox#value\n        checked={isOn}\n        onChange={evt => onChange(evt.target.checked)}\n        disabled={disabled}\n      />\n      <label htmlFor={domId} className={styles[\"toggle\"]}></label>\n    </div>\n  );\n}\n","import LabeledToggle from \"./LabeledToggle\";\n\nexport default LabeledToggle;\n","import React, { useMemo } from \"react\";\nimport Toggle from \"@components/Toggle\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./LabeledToggle.module.css\";\n\nLabeledToggle.propTypes = {\n  labelOff: PropTypes.string,\n  labelOn: PropTypes.string,\n\n  masterLabel: PropTypes.string,\n};\n\n// TODO: Implement ability to disable\nexport default function LabeledToggle({\n  className,\n  labelOff = \"Off\",\n  labelOn = \"On\",\n  masterLabel = \"\",\n  isOn,\n  disabled,\n  style,\n  ...rest\n}) {\n  // Calculate padding for off / on labels in order to keep their positions\n  // centered\n  const [diffOff, diffOn] = useMemo(() => {\n    const lenLabelOff = labelOff.length;\n    const lenLabelOn = labelOn.length;\n    const longestLength =\n      lenLabelOff === lenLabelOn\n        ? lenLabelOff\n        : lenLabelOff > lenLabelOn\n        ? lenLabelOff\n        : lenLabelOn;\n    const diffOff = longestLength - lenLabelOff;\n    const diffOn = longestLength - lenLabelOn;\n\n    return [diffOff, diffOn];\n  }, [labelOff, labelOn]);\n\n  return (\n    <div\n      className={classNames(\n        styles[\"labeled-toggle\"],\n        disabled && styles[\"disabled\"],\n        className\n      )}\n      style={style}\n    >\n      <div className={styles[\"content-row\"]}>\n        <div\n          className={classNames(\n            styles[\"cell\"],\n            styles[\"label-wrap\"],\n            styles[\"left\"],\n            !isOn ? !disabled && styles[\"active\"] : null\n          )}\n          // Add style 1/2 of an em per diff increment in order to balance\n          // switch layout\n          style={{ paddingLeft: `${diffOff / 2}em` }}\n        >\n          {labelOff}\n        </div>\n        <div className={styles[\"cell\"]}>\n          <Toggle isOn={isOn} disabled={disabled} style={style} {...rest} />\n        </div>\n        <div\n          className={classNames(\n            styles[\"cell\"],\n            styles[\"label-wrap\"],\n            styles[\"right\"],\n            isOn ? !disabled && styles[\"active\"] : null\n          )}\n          // Add style 1/2 of an em per diff increment in order to balance\n          // switch layout\n          style={{ paddingRight: `${diffOn / 2}em` }}\n        >\n          {labelOn}\n        </div>\n      </div>\n      <div className={styles[\"title-row\"]}>{masterLabel}</div>\n    </div>\n  );\n}\n","import ExternalLink from \"./ExternalLink\";\n\nexport default ExternalLink;\n","export default function ExternalLink({ children, target = \"_blank\", ...rest }) {\n  return (\n    <a {...rest} target={target}>\n      {children}\n    </a>\n  );\n}\n","import ExternalLinkButton from \"./ExternalLinkButton\";\n\nexport default ExternalLinkButton;\n","// TODO: Document w/ prop-types\nexport default function ExternalLinkButton({\n  href,\n  target = \"_blank\",\n  ...rest\n}) {\n  return (\n    <button\n      {...rest}\n      // TODO: Refactor to useCallback\n      onClick={() => window.open(href, target)}\n    />\n  );\n}\n","import Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport ExternalLink from \"@components/ExternalLink\";\nimport ExternalLinkButton from \"@components/ExternalLinkButton\";\n\nconst LINKS = {\n  PhantomCore: \"https://github.com/zenOSmosis/phantom-core\",\n  PhantomCollection:\n    \"https://github.com/zenOSmosis/phantom-core/tree/main/src/PhantomCollection\",\n\n  ReShellCore: \"https://github.com/zenOSmosis/reshell.org-static\",\n\n  SyncObject: \"https://github.com/zenOSmosis/sync-object\",\n  MediaStreamController:\n    \"https://github.com/zenOSmosis/media-stream-track-controller\",\n  WebRTCPeer: \"https://github.com/zenOSmosis/webrtc-peer\",\n};\n\n// TODO: Refactor\nconst LINK_BUTTON_STYLE = {\n  minHeight: \"4em\",\n  whiteSpace: \"wrap\",\n  width: \"100%\",\n  height: \"100%\",\n};\n\nexport default function Details() {\n  return (\n    <Full style={{ overflowY: \"auto\" }}>\n      <p>\n        ReShell is a browser-based layout library and UI services engine\n        composed of various{\" \"}\n        <a\n          href=\"https://github.com/zenosmosis\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          open-source components\n        </a>\n        .\n      </p>\n      <p>\n        It is currently in an alpha phase, and{\" \"}\n        <span style={{ fontWeight: \"bold\" }}>\n          other builds (i.e. \"portals\") may have other built-in applications\n        </span>\n        .\n      </p>\n      <p>\n        Leveraged off of the core code for{\" \"}\n        <ExternalLink href=\"https://speaker.app\">Speaker.app</ExternalLink> and\n        other{\" \"}\n        <ExternalLink href=\"https://zenosmosis.com\">zenOSmosis</ExternalLink>{\" \"}\n        projects based on{\" \"}\n        <ExternalLink href=\"https://github.com/zenOSmosis/phantom-core\">\n          PhantomCore\n        </ExternalLink>\n        , a library for managing the JavaScript application lifecycle.\n      </p>\n\n      <p style={{ fontWeight: \"bold\" }}>Some included technologies:</p>\n\n      <div style={{ textAlign: \"center\" }}>\n        {Object.entries(LINKS).map(([title, urlOrAction], idx) => {\n          return (\n            <Padding key={idx} style={{ width: 200, display: \"inline-block\" }}>\n              {typeof urlOrAction === \"string\" ? (\n                <ExternalLinkButton\n                  href={urlOrAction}\n                  style={LINK_BUTTON_STYLE}\n                >\n                  {title}\n                </ExternalLinkButton>\n              ) : (\n                <button onClick={urlOrAction} style={LINK_BUTTON_STYLE}>\n                  {title}\n                </button>\n              )}\n            </Padding>\n          );\n        })}\n      </div>\n    </Full>\n  );\n}\n","import Details from \"./Details\";\n\nexport default Details;\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport ExternalLink from \"@components/ExternalLink\";\n\nconst LINKS = {\n  zenOSmosis: \"https://zenOSmosis.com\",\n  GitHub: \"https://github.com/zenosmosis\",\n  \"Speaker.app\": \"https://speaker.app\",\n};\n\nexport default function Resources() {\n  return (\n    <Center canOverflow={true}>\n      <p style={{ fontWeight: \"bold\" }}>Additional resources:</p>\n      <div style={{ display: \"inline-block\", textAlign: \"left\" }}>\n        {Object.entries(LINKS).map(([name, url], idx) => (\n          <Padding key={idx}>\n            {name}:{\" \"}\n            {\n              // TODO: Use ExternalLink component for this\n            }\n            <ExternalLink href={url}>{url}</ExternalLink>\n          </Padding>\n        ))}\n      </div>\n\n      <hr />\n\n      <p>\n        To contact us directly, email:{\" \"}\n        <ExternalLink href=\"mailto:info@zenosmosis.com\">\n          info@zenosmosis.com\n        </ExternalLink>\n        .\n      </p>\n    </Center>\n  );\n}\n","import Resources from \"./Resources\";\n\nexport default Resources;\n","const FULL_YEAR = new Date().getFullYear();\n\n// FIXME: (jh) Rename to getReShellCopyright\n/**\n * @return {string}\n */\nexport default function getCopyright() {\n  return `Copyright © 2010 - ${FULL_YEAR} zenOSmosis. All rights reserved.`;\n}\n","import Padding from \"@components/Padding\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport AutoScaler from \"@components/AutoScaler\";\nimport ButtonPanel from \"@components/ButtonPanel\";\nimport VirtualLink from \"@components/VirtualLink\";\nimport NoWrap from \"@components/NoWrap\";\nimport LabeledToggle from \"@components/labeled/LabeledToggle\";\n\nimport Details from \"./views/Details\";\nimport Resources from \"./views/Resources\";\n\nimport useUUID from \"@hooks/useUUID\";\n\nimport getCopyright from \"@utils/getCopyright\";\n\n// TODO: Include ReShell documentation here, as well as architecture overview\n\n// TODO: Include property for \"about\" view (per app), where its rendered HTML can be utilized for SEO purposes\n\n// TODO: Include license link type: https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types\n\n// TODO: Include \"declarative API\" (it is React, but the components themselves\n// do their base to abstract away logic w/ their opinionated internal handling,\n// while trying to stay very performant themselves)\n\nimport useUIParadigm, {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n  AUTO_DETECT_PARADIGM,\n} from \"@hooks/useUIParadigm\";\n\nexport const REGISTRATION_ID = \"about-reshell\";\n\nconst AboutReShellApp = {\n  id: REGISTRATION_ID,\n  title: \"About ReShell\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  initialSharedState: {\n    screen: \"overview\",\n  },\n  titleBarView: function TitleBarView({ sharedState, setSharedState }) {\n    /*\n    const handleSetSearchQuery = useCallback(\n      evt => setSharedState({ searchQuery: evt.target.value }),\n      [setSharedState]\n    );\n\n    const handleDoubleClick = useCallback(\n      evt => {\n        // Prevent double-clicks from resizing the window if there is text in\n        // the search bar\n        if (Boolean(sharedState.searchQuery)) {\n          evt.stopPropagation();\n        }\n      },\n      [sharedState]\n    );\n    */\n\n    return (\n      <Padding>\n        <ButtonPanel\n          // Force update if the screen changes\n          key={sharedState.screen}\n          buttons={[\n            {\n              content: \"Overview\",\n              onClick: () => setSharedState({ screen: \"overview\" }),\n              isSelected: sharedState.screen === \"overview\",\n            },\n            {\n              content: \"Details\",\n              onClick: () => setSharedState({ screen: \"details\" }),\n              isSelected: sharedState.screen === \"details\",\n            },\n            {\n              content: \"Resources\",\n              onClick: () => setSharedState({ screen: \"resources\" }),\n              isSelected: sharedState.screen === \"resources\",\n            },\n          ]}\n        />\n      </Padding>\n    );\n  },\n  view: function View({ sharedState, setSharedState }) {\n    const { uiParadigm, isUIParadigmAutoSet, setStaticUIParadigm } =\n      useUIParadigm();\n\n    const uuidAutoDetectCheckbox = useUUID();\n\n    return (\n      <Padding>\n        <Layout>\n          <Content>\n            {sharedState.screen === \"overview\" && (\n              <AutoScaler>\n                <Center>\n                  <div style={{ fontSize: \"5rem\", fontStyle: \"italic\" }}>\n                    ReShell\n                  </div>\n                  <NoWrap style={{ fontSize: \"1.5rem\" }}>\n                    Web Desktop and UI Service Engine\n                  </NoWrap>\n                </Center>\n              </AutoScaler>\n            )}\n\n            {sharedState.screen === \"details\" && <Details />}\n\n            {sharedState.screen === \"resources\" && <Resources />}\n          </Content>\n          <Footer style={{ textAlign: \"center\" }}>\n            {sharedState.screen === \"overview\" && (\n              <div>\n                <div style={{ marginBottom: 4 }}>\n                  <NoWrap>\n                    <LabeledToggle\n                      labelOff=\"Mobile\"\n                      labelOn=\"Desktop\"\n                      isOn={uiParadigm === DESKTOP_PARADIGM}\n                      onChange={isDesktop =>\n                        setStaticUIParadigm(\n                          isDesktop ? DESKTOP_PARADIGM : MOBILE_PARADIGM\n                        )\n                      }\n                    />\n                    <NoWrap>\n                      <input\n                        id={uuidAutoDetectCheckbox}\n                        type=\"checkbox\"\n                        checked={isUIParadigmAutoSet}\n                        onChange={evt =>\n                          setStaticUIParadigm(\n                            evt.target.checked\n                              ? AUTO_DETECT_PARADIGM\n                              : uiParadigm\n                          )\n                        }\n                      />{\" \"}\n                      <label\n                        htmlFor={uuidAutoDetectCheckbox}\n                        style={{ display: \"inline-block\" }}\n                      >\n                        Auto-Detect\n                      </label>\n                    </NoWrap>\n                  </NoWrap>\n                </div>\n\n                <div>\n                  <VirtualLink\n                    onClick={() => setSharedState({ screen: \"details\" })}\n                  >\n                    Details\n                  </VirtualLink>{\" \"}\n                  |{\" \"}\n                  <VirtualLink\n                    onClick={() => setSharedState({ screen: \"resources\" })}\n                  >\n                    Resources\n                  </VirtualLink>\n                </div>\n              </div>\n            )}\n\n            <div style={{ opacity: 0.5 }}>{getCopyright()}</div>\n\n            {/*\n              <div style={{ padding: 4 }}>\n               Get\n              started with{\" \"}\n              {\n                // TODO: Make link\n              }\n              <span style={{ color: \"orange\", textDecoration: \"underline\" }}>\n                wrapping your app with ReShell\n              </span>\n              .\n            </div>\n              */}\n          </Footer>\n        </Layout>\n      </Padding>\n    );\n  },\n};\n\nexport default AboutReShellApp;\n","import AboutReShellApp, { REGISTRATION_ID } from \"./AboutReShellApp\";\n\nexport default AboutReShellApp;\nexport { REGISTRATION_ID };\n","import AboutReShellApp from \"../../ExamplePortal/apps/AboutReShellApp\";\n\nconst AboutReShellOverrideApp = {\n  ...AboutReShellApp,\n  isAutoStart: true,\n};\n\nexport default AboutReShellOverrideApp;\n","import ReShellCore from \"@core\";\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport Center from \"@components/Center\";\nimport Layout, { Header, Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\n\nimport fetchIsLatestVersion from \"@utils/fetchIsLatestVersion\";\n\nimport dayjs from \"dayjs\";\n\nexport const REGISTRATION_ID = \"check-for-updates\";\n\nconst CheckForUpdatesApp = {\n  id: REGISTRATION_ID,\n  title: \"Check for Updates\",\n  style: {\n    width: 320,\n    height: 240,\n  },\n  isPinned: true,\n  view: function View() {\n    const [isLatest, setIsLatest] = useState(true);\n    const [isChecking, setIsChecking] = useState(false);\n    const [isError, setIsError] = useState(false);\n    const [lastCheckTime, setLastCheckTime] = useState(null);\n\n    const refIsChecking = useRef(null);\n    refIsChecking.current = isChecking;\n\n    // TODO: Refactor into service\n    const handleCheckForUpdates = useCallback(async () => {\n      const isChecking = refIsChecking.current;\n\n      if (isChecking) {\n        return;\n      }\n\n      try {\n        setIsError(false);\n        setIsChecking(true);\n\n        const isLatest = await fetchIsLatestVersion();\n\n        setIsLatest(isLatest);\n      } catch (err) {\n        console.error(err);\n\n        setIsError(true);\n        setIsLatest(false);\n      } finally {\n        setIsChecking(false);\n        setLastCheckTime(new Date().getTime());\n      }\n    }, []);\n\n    // Automatically check for updates when app starts\n    useEffect(() => {\n      handleCheckForUpdates();\n    }, [handleCheckForUpdates]);\n\n    return (\n      <Layout>\n        <Header>\n          <Padding style={{ textAlign: \"center\" }}>\n            <button onClick={handleCheckForUpdates} disabled={isChecking}>\n              Check for Updates\n            </button>\n          </Padding>\n        </Header>\n        <Content>\n          <Center canOverflow={true}>\n            {isError ? (\n              <>\n                <p>\n                  There was an error checking for updates.{\" \"}\n                  <button onClick={handleCheckForUpdates}>Try again?</button>\n                </p>\n              </>\n            ) : isLatest ? (\n              <p>You appear to be running the latest version of ReShell.</p>\n            ) : (\n              <>\n                <p>\n                  Your version of ReShell appears out of date.{\" \"}\n                  <button onClick={() => ReShellCore.forceUpdate()}>\n                    Refresh?\n                  </button>\n                </p>\n              </>\n            )}\n          </Center>\n        </Content>\n        <Footer>\n          <Padding>\n            <div className=\"note\">\n              Last checked:{\" \"}\n              {lastCheckTime ? dayjs(lastCheckTime).format(\"LLL\") : \"N/A\"}\n            </div>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default CheckForUpdatesApp;\n","import CheckForUpdatesApp, { REGISTRATION_ID } from \"./CheckForUpdatesApp\";\n\nexport default CheckForUpdatesApp;\nexport { REGISTRATION_ID };\n","import ColorAdjusterApp from \"./ColorAdjusterApp\";\n\nexport default ColorAdjusterApp;\n","import { useState, useEffect } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\n\nimport styles from \"./ColorAdjuster.module.css\";\n\nconst ColorAdjusterApp = {\n  id: \"color-adjuster\",\n  title: \"Color Adjuster\",\n  style: {\n    width: 640,\n    height: 400,\n  },\n  // serviceClasses: [],\n  view: function View({ windowController, appServices }) {\n    // TODO: Add service state; fix issue where if choosing grayscale, closing, then re-opening disables grayscale\n    const [isGrayscale, setIsGrayscale] = useState(false);\n\n    useEffect(() => {\n      if (isGrayscale) {\n        document.body.classList.add(\"grayscale\");\n      } else {\n        document.body.classList.remove(\"grayscale\");\n      }\n    }, [isGrayscale]);\n\n    return (\n      <Layout className={styles[\"color-adjuster\"]}>\n        <Content>\n          <Center>\n            <button onClick={() => setIsGrayscale(prev => !prev)}>\n              {isGrayscale ? \"Disable\" : \"Enable\"} Grayscale\n            </button>\n          </Center>\n        </Content>\n        <Footer>\n          {\n            // @see https://color.adobe.com/create/color-wheel\n\n            [\"#B04628\", \"#B9FC6D\", \"#FC7853\", \"#3A65FC\", \"#314EB0\"].map(\n              (color, idx) => (\n                <div\n                  key={idx}\n                  style={{\n                    backgroundColor: color,\n                    height: 100,\n                    width: \"20%\",\n                    display: \"inline-block\",\n                  }}\n                >\n                  <Center>\n                    <span\n                      style={{\n                        padding: 4,\n                        backgroundColor: \"rgba(0,0,0,.4)\",\n                        borderRadius: 4,\n                      }}\n                    >\n                      {color}\n                    </span>\n                  </Center>\n                </div>\n              )\n            )\n          }\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ColorAdjusterApp;\n","import ObjectViewer from \"./ObjectViewer\";\n\nexport default ObjectViewer;\n","import Full from \"../Full\";\nimport ReactJson from \"react-json-view\";\nimport classNames from \"classnames\";\nimport styles from \"./ObjectViewer.module.css\";\nimport PropTypes from \"prop-types\";\n\nObjectViewer.propTypes = {\n  src: PropTypes.object.isRequired,\n};\n\nexport default function ObjectViewer({ className, src, ...rest }) {\n  return (\n    <Full {...rest} className={classNames(styles[\"object-viewer\"], className)}>\n      <ReactJson\n        src={src}\n        theme=\"monokai\"\n        // NOTE: className appears to be unsupported here\n        style={{ width: \"100%\", height: \"100%\" }}\n      />\n    </Full>\n  );\n}\n","import Layout, { Content /* Footer */ } from \"@components/Layout\";\nimport ObjectViewer from \"@components/ObjectViewer\";\n\n// TODO: Include ability to show environment of any given AppRuntime?\n\nexport const REGISTRATION_ID = \"environment\";\n\nconst EnvironmentApp = {\n  id: REGISTRATION_ID,\n  title: \"Environment\",\n  style: {\n    width: 640 * 0.8,\n    height: 480 * 0.8,\n  },\n  view: function View() {\n    return (\n      <Layout>\n        <Content>\n          <ObjectViewer src={process.env} />\n        </Content>\n      </Layout>\n    );\n  },\n};\n\nexport default EnvironmentApp;\n","import EnvironmentApp, { REGISTRATION_ID } from \"./EnvironmentApp\";\n\nexport default EnvironmentApp;\nexport { REGISTRATION_ID };\n","import ReShellCore from \"@core\";\nimport PhantomCore from \"phantom-core\";\n\nimport Layout, {\n  Header,\n  Content,\n  Footer,\n  Row,\n  Column,\n} from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport ObjectViewer from \"@components/ObjectViewer\";\n\nimport { REGISTRATION_ID as ENVIRONMENT_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/EnvironmentApp\";\nimport { REGISTRATION_ID as CHECK_FOR_UPDATES_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/CheckForUpdatesApp\";\n\nconst packageJson = require(\"@root/package.json\");\n\nexport const REGISTRATION_ID = \"software-info\";\n\nconst SoftwareInfoApp = {\n  id: REGISTRATION_ID,\n  title: \"Software Info\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  view: function View() {\n    return (\n      <Layout>\n        <Header>\n          <Padding>Package.json content</Padding>\n        </Header>\n        <Content>\n          <ObjectViewer src={packageJson} />\n        </Content>\n        <Footer>\n          <Padding>\n            <Row>\n              <Column>\n                <Center>\n                  <div\n                    style={{ float: \"left\", textAlign: \"left\" }}\n                    className=\"note\"\n                  >\n                    ReShell version: {ReShellCore.getReShellVersion()}\n                    <br />\n                    PhantomCore version: {PhantomCore.getPhantomCoreVersion()}\n                    <br />\n                    Portal: {ReShellCore.getPortalName()}\n                  </div>\n                </Center>\n              </Column>\n              <Column>\n                <Center style={{ textAlign: \"right\" }}>\n                  <AppLinkButton id={CHECK_FOR_UPDATES_REGISTRATION_ID} />{\" \"}\n                  <AppLinkButton id={ENVIRONMENT_REGISTRATION_ID} />\n                </Center>\n              </Column>\n            </Row>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default SoftwareInfoApp;\n","import SoftwareInfoApp, { REGISTRATION_ID } from \"./SoftwareInfoApp\";\n\nexport default SoftwareInfoApp;\nexport { REGISTRATION_ID };\n","import StaggeredWaveLoading from \"./StaggeredWaveLoading\";\n\nexport default StaggeredWaveLoading;\n","import React from \"react\";\nimport styles from \"./StaggeredWaveLoading.module.css\";\n\n// @see https://codepen.io/alphardex/pen/XWWWBmQ\nexport default function StaggeredWaveLoading({ ...rest }) {\n  return (\n    <div className={styles[\"loading-wrapper\"]} {...rest}>\n      <div className={styles[\"loading\"]}>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n      </div>\n    </div>\n  );\n}\n","import Preload from \"./Preload\";\n\nexport default Preload;\n","import React from \"react\";\nimport AutoScaler from \"../AutoScaler\";\nimport StaggeredWaveLoading from \"../StaggeredWaveLoading\";\nimport PropTypes from \"prop-types\";\n\nimport usePreload from \"@hooks/usePreload\";\n\nPreload.propTypes = {\n  /** An array of URLs to preload */\n  preloadResources: PropTypes.arrayOf(PropTypes.string.isRequired).isRequired,\n\n  /** Called when there is a loading error  */\n  onError: PropTypes.func,\n\n  /** If true, disables loading indicator */\n  disabledLoadingIndicator: PropTypes.bool,\n};\n\nexport default function Preload({\n  children,\n  preloadResources,\n  disabledLoadingIndicator = false,\n  onError = err => console.warn(\"Caught\", err),\n  ...rest\n}) {\n  const { isPreloaded /* progress */ } = usePreload(preloadResources);\n\n  if (!isPreloaded && !disabledLoadingIndicator) {\n    return (\n      <AutoScaler {...rest}>\n        <StaggeredWaveLoading />\n      </AutoScaler>\n    );\n  } else {\n    return <React.Fragment>{children}</React.Fragment>;\n  }\n}\n","export default __webpack_public_path__ + \"static/media/vu.8cb21748.png\";","export default \"data:image/png;base64,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\"","import VUMeter from \"./VUMeter\";\n\nexport default VUMeter;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport Preload from \"@components/Preload\";\n\nimport classNames from \"classnames\";\nimport styles from \"./VUMeter.module.css\";\n\nimport PropTypes from \"prop-types\";\n\nimport useMultiAudioMediaStreamTrackLevelMonitor from \"@hooks/useMultiAudioMediaStreamTrackLevelMonitor\";\n\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport vuBackground from \"./images/vu.png\";\nimport vuNeedle from \"./images/needle.png\";\n\nVUMeter.propTypes = {\n  label: PropTypes.string,\n\n  className: PropTypes.string,\n\n  /** When multiple audio tracks may be used together */\n  mediaStreamTracks: PropTypes.arrayOf(PropTypes.instanceOf(MediaStreamTrack)),\n\n  /** When only a single track is used */\n  mediaStreamTrack: PropTypes.instanceOf(MediaStreamTrack),\n};\n\n/**\n * A needle-based audio meter.\n */\nexport default function VUMeter({\n  label = \"Mono\",\n  className,\n  mediaStreamTrack,\n  mediaStreamTracks,\n  ...rest\n}) {\n  const [elVU, setElVU] = useState(null);\n  const [elNeedle, setElNeedle] = useState(null);\n\n  // TODO: Replace w/ useUUID\n  const uuid = useMemo(uuidv4, []);\n\n  useEffect(() => {\n    if (elVU && elNeedle) {\n      elVU.style.backgroundImage = `url(${vuBackground})`;\n      elVU.style.backgroundPosition = \"top left\";\n      elVU.style.backgroundRepeat = \"no-repeat\";\n\n      elNeedle.style.backgroundImage = `url(${vuNeedle})`;\n      elNeedle.style.backgroundPosition = \"top left\";\n      elNeedle.style.backgroundRepeat = \"no-repeat\";\n    }\n  }, [elVU, elNeedle]);\n\n  /**\n   * @param {number} audioLevel A float value from 0 - 100, where 100\n   * represents maximum strength.\n   * @return {void}\n   */\n  const handleAudioLevelChange = useCallback(\n    audioLevel => {\n      if (elNeedle) {\n        requestSkippableAnimationFrame(() => {\n          elNeedle.style.transform = `rotateZ(${Math.min(\n            87 * (audioLevel / 100)\n          )}deg)`;\n        }, uuid);\n      }\n    },\n    [elNeedle, uuid]\n  );\n\n  // Set initial level\n  useEffect(() => {\n    if (elNeedle) {\n      handleAudioLevelChange(0);\n    }\n  }, [handleAudioLevelChange, elNeedle]);\n\n  useMultiAudioMediaStreamTrackLevelMonitor(\n    mediaStreamTrack || mediaStreamTracks,\n    handleAudioLevelChange\n  );\n\n  return (\n    <Preload preloadResources={[vuBackground, vuNeedle]}>\n      <div\n        ref={setElVU}\n        className={classNames(styles[\"vu\"], className)}\n        {...rest}\n      >\n        <div className={styles[\"mask\"]}>\n          <div\n            ref={setElNeedle}\n            className={styles[\"needle\"]}\n            style={{ transform: \"rotateZ(0deg)\" }}\n          ></div>\n        </div>\n        <p className={styles[\"vu-label\"]}>{label}</p>\n      </div>\n    </Preload>\n  );\n}\n","import InputMediaDevicesService from \"@services/InputMediaDevicesService\";\n\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport AudioLevelMeter from \"@components/audioMeters/AudioLevelMeter\";\nimport VULevelMeter from \"@components/audioMeters/VUMeter\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"../InputMediaDevicesApp\";\n\nexport const REGISTRATION_ID = \"vu-meter\";\n\nconst VUMeterApp = {\n  id: REGISTRATION_ID,\n  title: \"VU Meter\",\n  style: {\n    width: 360,\n    height: 360,\n    // backgroundColor: \"rgba(0,0,0,.4)\",\n  },\n  serviceClasses: [InputMediaDevicesService],\n  view: ({ appServices }) => {\n    const mds = appServices[InputMediaDevicesService];\n\n    const captureFactories = mds.getCaptureFactories();\n    // const isCapturing = Boolean(captureFactories.length);\n\n    // TODO: Add labels / controls (or adapt this program to be something else\n    // entirely)\n\n    const mediaStreamTracks = captureFactories\n      .map(factory =>\n        factory\n          .getAudioTrackControllers()\n          .map(controller => controller.getOutputMediaStreamTrack())\n      )\n      .flat();\n\n    return (\n      <Layout>\n        <Content>\n          <Center canOverflow={true}>\n            <div>\n              <VULevelMeter mediaStreamTracks={mediaStreamTracks} />\n              <AudioLevelMeter\n                style={{ marginLeft: 20, height: 160, width: 40 }}\n                mediaStreamTracks={mediaStreamTracks}\n              />\n            </div>\n            {/*\n              <div>\n                <button\n                  onClick={() => {\n                    !isCapturing\n                      ? mds.captureDefaultAudioInputDevice()\n                      : captureFactories.forEach(factory => factory.destroy());\n                  }}\n                  style={{ backgroundColor: isCapturing ? \"red\" : null }}\n                >\n                  {!isCapturing ? \"Start Microphone\" : \"Stop Capturing\"}\n                </button>\n              </div>\n              */}\n          </Center>\n        </Content>\n        <Footer>\n          <Padding>\n            <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default VUMeterApp;\n","import VUMeterApp, { REGISTRATION_ID } from \"./VUMeterApp\";\n\nexport default VUMeterApp;\nexport { REGISTRATION_ID };\n","import React, { useEffect, useMemo, useState, useRef } from \"react\";\n\n/**\n * Represents audio or video element.\n *\n * TODO: Document and rename\n */\nexport default function AVBase({\n  mediaStreamTrack,\n  mediaType = \"video\",\n  onEl = el => null,\n  ...rest\n}) {\n  const [el, setEl] = useState(null);\n\n  const mediaStream = useMemo(\n    () => mediaStreamTrack && new MediaStream([mediaStreamTrack]),\n    [mediaStreamTrack]\n  );\n\n  // TODO: Document\n  // Contains internal fixes which help Firefox and iOS start playing media\n  // tracks\n  useEffect(() => {\n    if (!el) {\n      return;\n    }\n\n    // Fixes issue in Firefox where setting mediaStream to undefined would keep\n    // video on last frame\n    if (!mediaStream) {\n      el.srcObject = null;\n      return;\n    }\n\n    el.srcObject = mediaStream;\n\n    // TODO: Emit events when playing in order to perform \"read receipts\" for\n    // remote participants\n\n    el.play()\n      .then(() => (el.muted = false))\n      .catch(err => console.warn(\"Caught\", err));\n  }, [el, mediaStream]);\n\n  const refOnEl = useRef(onEl);\n\n  // TODO: Document\n  useEffect(() => {\n    const onEl = refOnEl.current;\n\n    if (el && typeof onEl === \"function\") {\n      onEl(el);\n    }\n  }, [el]);\n\n  return React.createElement(mediaType, {\n    ref: setEl,\n    autoPlay: false,\n    muted: true,\n    playsInline: true,\n    controls: false,\n    ...rest,\n  });\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./Video.module.css\";\n\nimport AVBase from \"./AVBase\";\n\n// NOTE: (jh) There is also an aspect-ratio CSS property:\n// @see https://css-tricks.com/almanac/properties/a/aspect-ratio/\n\n/**\n * Plays a single video MediaStreamTrack out the monitor.\n */\nexport default function Video({ className, ...rest }) {\n  return (\n    <AVBase className={classNames(styles[\"video\"], className)} {...rest} />\n  );\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport {\n  MediaStreamTrackControllerFactoryCollection,\n  utils,\n} from \"media-stream-track-controller\";\n\n// TODO: Build out; ensuring added children are media device controller factories\nclass ScreenCaptureFactoryCollection extends MediaStreamTrackControllerFactoryCollection {}\n\n// TODO: Document\nexport default class ScreenCapturerService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Screen Capturer Service\");\n\n    this.bindCollectionClass(ScreenCaptureFactoryCollection);\n  }\n\n  /**\n   * Determines if screen capture is supported in the browser.\n   *\n   * @return {boolean}\n   */\n  getIsScreenCaptureSupported() {\n    return utils.screen.getIsScreenCaptureSupported();\n  }\n\n  // TODO: Document\n  async startScreenCapture(constraints = {}, factoryOptions = {}) {\n    const factory = await utils.screen.captureScreen(\n      constraints,\n      factoryOptions\n    );\n\n    this.getCollectionInstance(\n      ScreenCaptureFactoryCollection\n    ).addTrackControllerFactory(factory);\n\n    return factory;\n  }\n\n  /**\n   * Returns all media stream tracks from all of the factories as a flat array.\n   *\n   * @return {MediaStreamTrack[]}\n   */\n  getMediaStreamTracks() {\n    return this.getCollectionInstance(ScreenCaptureFactoryCollection)\n      .getChildren()\n      .map(factory =>\n        factory\n          .getTrackControllers()\n          .map(controller => controller.getOutputMediaStreamTrack())\n      )\n      .flat();\n  }\n\n  // TODO: Document\n  getCaptureFactories() {\n    return this.getCollectionInstance(\n      ScreenCaptureFactoryCollection\n    ).getChildren();\n  }\n}\n","import { EVT_DESTROYED } from \"phantom-core\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\n\nimport Layout, { Content, Footer, Row, Column } from \"@components/Layout\";\nimport Cover from \"@components/Cover\";\nimport Center from \"@components/Center\";\nimport { Video } from \"@components/audioVideoRenderers\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport AudioLevelMeter from \"@components/audioMeters/AudioLevelMeter\";\n\nimport useGetIsUnmounting from \"@hooks/useGetIsUnmounting\";\n\nimport ScreenCapturerService from \"@services/ScreenCapturerService\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"../InputMediaDevicesApp\";\n\nexport const REGISTRATION_ID = \"screen-capture-window\";\n\n// TODO: Include ability to screen record and take arbitrary snapshot from video feed (separate from ScreenShot app which is a one-time deal)\n\n// TODO: Include ability to NOT show local screen capture monitor feedback\n\n// TODO: Include ability to open multiple windows with a unique capture per window\n\nconst ScreenCaptureApp = {\n  id: REGISTRATION_ID,\n  title: \"Screen Capture\",\n  style: {\n    width: 640 * 0.8,\n    height: 480 * 0.8,\n  },\n  serviceClasses: [ScreenCapturerService],\n  view: function View({ appServices, windowController }) {\n    const scs = appServices[ScreenCapturerService];\n\n    /**\n     * NOTE: This value is memoized because it shouldn't change during this\n     * browsing session.\n     *\n     * @type {boolean}\n     */\n    const isScreenCaptureSupported = useMemo(\n      () => scs.getIsScreenCaptureSupported(),\n      [scs]\n    );\n\n    // Automatically close the window after a short duration if screen sharing\n    // is not supported\n    useEffect(() => {\n      if (!isScreenCaptureSupported) {\n        const autoCloseTimeout = window.setTimeout(\n          windowController.destroy,\n          3000\n        );\n\n        windowController.once(EVT_DESTROYED, () =>\n          window.clearTimeout(autoCloseTimeout)\n        );\n      }\n    }, [isScreenCaptureSupported, windowController]);\n\n    const [screenCaptureFactory, setScreenCaptureFactory] = useState(null);\n\n    const getIsUnmounting = useGetIsUnmounting();\n\n    // TODO: Document\n    const handleStartScreenCapture = useCallback(\n      async (constraints = {}, factoryOptions = {}) => {\n        const factory = await scs.startScreenCapture(\n          constraints,\n          factoryOptions\n        );\n\n        setScreenCaptureFactory(factory);\n\n        factory.once(EVT_DESTROYED, () => {\n          // Unmounting check fixes an issue where memory-leak error is\n          // presented when closing the window with an active screen capture\n          if (!getIsUnmounting()) {\n            setScreenCaptureFactory(null);\n          }\n        });\n\n        return factory;\n      },\n      [scs, getIsUnmounting]\n    );\n\n    // Stop the screen capture on unmount\n    useEffect(() => {\n      if (screenCaptureFactory) {\n        return () => {\n          if (!screenCaptureFactory.getIsDestroying()) {\n            screenCaptureFactory.destroy();\n          }\n        };\n      }\n    }, [screenCaptureFactory]);\n\n    const videoTrack = screenCaptureFactory\n      ?.getVideoTrackControllers()[0]\n      ?.getOutputTrack();\n\n    const audioTrack = screenCaptureFactory\n      ?.getAudioTrackControllers()[0]\n      ?.getOutputTrack();\n\n    if (!isScreenCaptureSupported) {\n      return (\n        <Center>\n          <div style={{ fontWeight: \"bold\" }}>\n            Screen capture is not supported in this browser.\n          </div>\n        </Center>\n      );\n    }\n\n    return (\n      <Layout style={{ backgroundColor: \"#424242\", color: \"#999\" }}>\n        <Content>\n          <Row>\n            <Column>\n              <Video mediaStreamTrack={videoTrack} />\n              {!screenCaptureFactory && (\n                <Cover>\n                  <Center>\n                    <div>\n                      <button\n                        onClick={() => handleStartScreenCapture()}\n                        style={{\n                          backgroundColor: \"green\",\n                          width: 200,\n                          height: 200,\n                          borderRadius: 200,\n                          fontWeight: \"bold\",\n                          fontSize: \"1.4rem\",\n                          border: \"8px #ccc solid\",\n                        }}\n                      >\n                        Start Screen Capture\n                      </button>\n                    </div>\n                  </Center>\n                </Cover>\n              )}\n            </Column>\n            <Column style={{ width: 50, maxWidth: 50 }}>\n              {/**\n               * Audio level monitoring.\n               *\n               * FIXME: (jh) This was originally set up for two-channel\n               * support, with independent meters, and it will require the\n               * audio track to be split into independent tracks in order to\n               * function as desired.\n               *\n               * The current functionality should represent both channels as\n               * a mono representation.\n               */}\n              <Row style={{ textAlign: \"center\" }}>\n                <Column>\n                  <Layout>\n                    <Content>\n                      <AudioLevelMeter mediaStreamTrack={audioTrack} />\n                    </Content>\n                    <Footer>Audio</Footer>\n                  </Layout>\n                </Column>\n              </Row>\n            </Column>\n          </Row>\n        </Content>\n        <Footer>\n          <Padding>\n            <Row>\n              <Column>\n                <Center>\n                  <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n                </Center>\n              </Column>\n              <Column>\n                <Center>\n                  <button\n                    style={{\n                      backgroundColor: !screenCaptureFactory ? \"green\" : \"red\",\n                      whiteSpace: \"nowrap\",\n                    }}\n                    onClick={() => {\n                      if (\n                        screenCaptureFactory &&\n                        !screenCaptureFactory.getIsDestroying()\n                      ) {\n                        screenCaptureFactory.destroy();\n                      } else {\n                        handleStartScreenCapture();\n                      }\n                    }}\n                  >\n                    {!screenCaptureFactory ? \"Capture\" : \"Stop\"}\n                  </button>\n                </Center>\n              </Column>\n            </Row>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ScreenCaptureApp;\n","import { useCallback, useEffect, useRef } from \"react\";\n\n// TODO: Document\nexport default function useGetIsUnmounting() {\n  const refIsUnmounting = useRef(false);\n\n  useEffect(() => {\n    return function unmount() {\n      refIsUnmounting.current = true;\n    };\n  }, []);\n\n  const getIsUnmounting = useCallback(() => refIsUnmounting.current, []);\n\n  return getIsUnmounting;\n}\n","import ScreenCaptureApp, { REGISTRATION_ID } from \"./ScreenCaptureApp\";\n\nexport default ScreenCaptureApp;\nexport { REGISTRATION_ID };\n","import InputMediaDevicesService from \"@services/InputMediaDevicesService\";\n\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport InputMediaDevicesSelector from \"@components/InputMediaDevicesSelector\";\n\nimport { REGISTRATION_ID as VU_METER_REGISTRATION_ID } from \"../VUMeterApp\";\nimport { REGISTRATION_ID as SCREEN_CAPTURE_REGISTRATION_ID } from \"../ScreenCaptureApp\";\n\nexport const REGISTRATION_ID = \"input-media-devices\";\n\nconst InputMediaDevicesApp = {\n  id: REGISTRATION_ID,\n  title: \"Input Media Devices\",\n  style: {\n    width: 640,\n    height: 380,\n  },\n  serviceClasses: [InputMediaDevicesService],\n  view: function View({ appServices }) {\n    const mds = appServices[InputMediaDevicesService];\n\n    return (\n      <Padding>\n        <Layout>\n          <Content>\n            <InputMediaDevicesSelector />\n          </Content>\n          <Footer>\n            <button\n              onClick={() => mds.fetchInputMediaDevices(true)}\n              style={{ float: \"right\" }}\n            >\n              Refetch\n            </button>\n\n            <span className=\"button-group\">\n              <AppLinkButton id={VU_METER_REGISTRATION_ID} />\n              <AppLinkButton id={SCREEN_CAPTURE_REGISTRATION_ID} />\n            </span>\n          </Footer>\n        </Layout>\n      </Padding>\n    );\n  },\n};\n\nexport default InputMediaDevicesApp;\n","import InputMediaDevicesApp, { REGISTRATION_ID } from \"./InputMediaDevicesApp\";\n\nexport default InputMediaDevicesApp;\nexport { REGISTRATION_ID };\n","/**\n * String renderings for orders of magnitude of data.\n *\n * Using decimal bbreviations as specified in:\n * @see https://en.wikipedia.org/wiki/Megabyte\n *\n * Adapted from:\n * @see https://gist.github.com/lanqy/5193417\n *\n * @param {number} bytes\n * @return {string}\n */\nconst bytesToSize = bytes => {\n  const sizes = [\"bytes\", \"kB\", \"MB\", \"GB\", \"TB\"];\n  if (bytes === 0) return `0 ${sizes[0]}`;\n  const i = parseInt(\n    Math.floor(Math.log(Math.abs(bytes)) / Math.log(1024)),\n    10\n  );\n  if (i === 0) return `${bytes} ${sizes[i]}`;\n  return `${(bytes / 1024 ** i).toFixed(1)} ${sizes[i]}`;\n};\n\nexport default bytesToSize;\n","import MemoryInfoApp from \"./MemoryInfoApp\";\n\nexport default MemoryInfoApp;\n","import { useCallback, useEffect, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\n\nimport bytesToSize from \"@utils/bytesToSize\";\n\nconst MemoryInfoApp = {\n  id: \"memory-info\",\n  title: \"Memory Info\",\n  style: {\n    width: 280,\n    height: 150,\n  },\n  view: function View() {\n    const [\n      { jsHeapSizeLimit, totalJSHeapSize, usedJSHeapSize },\n      _setMemoryInfo,\n    ] = useState({\n      jsHeapSizeLimit: \"N/A\",\n      totalJSHeapSize: \"N/A\",\n      usedJSHeapSize: \"N/A\",\n    });\n\n    // TODO: Document\n    const fetchMemoryInfo = useCallback(() => {\n      if (!window.performance.memory) {\n        return;\n      }\n\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Performance/memory\n      const { jsHeapSizeLimit, totalJSHeapSize, usedJSHeapSize } =\n        window.performance.memory;\n\n      const memoryInfo = {\n        jsHeapSizeLimit: bytesToSize(jsHeapSizeLimit),\n        totalJSHeapSize: bytesToSize(totalJSHeapSize),\n        usedJSHeapSize: bytesToSize(usedJSHeapSize),\n      };\n\n      _setMemoryInfo(memoryInfo);\n\n      return memoryInfo;\n    }, []);\n\n    // Automatically refresh heap\n    useEffect(() => {\n      const initialFetch = fetchMemoryInfo();\n\n      if (initialFetch) {\n        const refetchInterval = setInterval(() => {\n          fetchMemoryInfo();\n        }, 1000);\n\n        return function unmount() {\n          clearInterval(refetchInterval);\n        };\n      }\n    }, [fetchMemoryInfo]);\n\n    // TODO: Incorporate graphing library\n\n    return (\n      <Layout style={{ backgroundColor: \"#424242\", color: \"#999\" }}>\n        <Content>\n          <Center>\n            <table style={{ display: \"inline-block\" }}>\n              <thead>\n                <tr>\n                  <td>Heap Size Limit</td>\n                  <td>Total Heap Size</td>\n                  <td>Used Heap Size</td>\n                </tr>\n              </thead>\n\n              <tbody>\n                <tr>\n                  {\n                    // TODO: Render as formatted strings (i.e. \"... GB\")\n                  }\n                  <td>{jsHeapSizeLimit}</td>\n                  <td>{totalJSHeapSize}</td>\n                  <td>{usedJSHeapSize}</td>\n                </tr>\n              </tbody>\n            </table>\n          </Center>\n        </Content>\n        <Footer style={{ fontSize: \".8rem\" }}>\n          <a\n            href=\"https://developer.mozilla.org/en-US/docs/Web/API/Performance/memory\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            style={{ float: \"left\" }}\n          >\n            MDN Documentation\n          </a>\n          <span style={{ float: \"right\" }}>\n            Only supported in Chromium-based browsers.\n          </span>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default MemoryInfoApp;\n","import LocalStorageItems from \"./LocalStorageItems\";\n\nexport default LocalStorageItems;\n","import Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\n\nimport useForceUpdate from \"@hooks/useForceUpdate\";\n\nexport default function LocalStorageItems({\n  keyStorageEngineMaps = [],\n  onGetValue,\n  onEmpty,\n  onNewItem,\n}) {\n  const forceUpdate = useForceUpdate();\n\n  if (!keyStorageEngineMaps.length) {\n    return (\n      <Center>\n        <Padding>\n          <Padding style={{ fontWeight: \"bold\" }}>No Key Vault items.</Padding>\n          <Padding className=\"note\">\n            These may be automatically managed by other applications as needed,\n            in order to perform key / value pair storage operations.\n          </Padding>\n          <Padding className=\"note\">\n            You have the ability to clear all local / session storage via this\n            utility.\n          </Padding>\n          <Padding>\n            <button onClick={onNewItem}>Add new item...</button>\n          </Padding>\n        </Padding>\n      </Center>\n    );\n  }\n\n  return (\n    <Layout>\n      <Content>\n        <Padding style={{ overflowY: \"auto\" }}>\n          <table style={{ width: \"100%\" }}>\n            <thead>\n              <tr>\n                <td></td>\n                <td>Key</td>\n                <td style={{ color: \"gray\" }}>Value</td>\n                {/*\n                    <td>Kind</td>\n                    */}\n                <td>Encryption</td>\n                <td>Storage Engine</td>\n              </tr>\n            </thead>\n            <tbody>\n              {keyStorageEngineMaps.map((keyMap, idx) => {\n                const { key, /* kind, */ storageEngine } = keyMap;\n\n                return (\n                  <tr key={idx}>\n                    <td className=\"center\">\n                      <input\n                        type=\"checkbox\"\n                        // TODO: Remove hard-coding\n                        disabled\n                      ></input>\n                    </td>\n                    <td>{key}</td>\n                    <td className=\"center\">\n                      <button\n                        onClick={() => onGetValue(key, storageEngine)}\n                        // TODO: Remove hard-coding\n                        disabled\n                      >\n                        Get\n                      </button>\n                    </td>\n                    {/*\n                        <td className=\"center\">{kind}</td>\n                        */}\n\n                    <td className=\"center\">\n                      {storageEngine.getEncryptionType() || \"None\"}\n                    </td>\n                    <td className=\"center\">{storageEngine.getTitle()}</td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </Padding>\n      </Content>\n      <Footer>\n        <Padding style={{ overflow: \"auto\" }}>\n          <button onClick={onEmpty}>Empty</button>\n\n          <button style={{ float: \"right\" }} onClick={forceUpdate}>\n            Reload\n          </button>\n        </Padding>\n      </Footer>\n    </Layout>\n  );\n}\n","/**\n * @param {HTMLFormElement} formElement\n * @return {Object}\n */\nexport default function getFormValues(formElement) {\n  const elements = formElement.elements;\n\n  const values = {};\n\n  for (const el of [...elements]) {\n    const key = el.name || el.id;\n\n    if (key) {\n      values[key] = el.value;\n    }\n  }\n\n  return values;\n}\n","import Form from \"./Form\";\n\nexport default Form;\n","import useFormController from \"./hooks/useFormController\";\n\n// TODO: Document and add prop-types\nexport default function Form({\n  children,\n  autoComplete = \"off\",\n  validator = formValues => null,\n  onChange = formValues => null,\n  onSubmit = formValues => null,\n  ...rest\n}) {\n  const {\n    setFormRef,\n    handleFormChange,\n    handleFormSubmit,\n    handleFormValidate,\n    errors,\n    isValid,\n  } = useFormController({\n    onSubmit,\n    onChange,\n    validator,\n  });\n\n  return (\n    <form\n      {...rest}\n      ref={setFormRef}\n      autoComplete={autoComplete}\n      onChange={handleFormChange}\n      onSubmit={handleFormSubmit}\n    >\n      {\n        // TODO: Modify so that non-functional children presents an error showing how to use.  Look for other examples for how other libraries do this and adapt accordingly.\n        children({\n          errors,\n          isValid,\n          submit: handleFormSubmit,\n          validate: handleFormValidate,\n        })\n      }\n    </form>\n  );\n}\n","import { useCallback, useEffect, useState } from \"react\";\n\nimport getFormValues from \"@utils/getFormValues\";\n\n// TODO: Track dirty state\n\n// TODO: Document\n// NOTE: This is supposed to be a simpler alternative to: https://react-hook-form.com/\n// Was struggling to make it easily work with onChange events in a clean way\nexport default function useFormController({\n  onSubmit,\n  onChange = () => null,\n  validator = () => null,\n}) {\n  const [formElement, setFormRef] = useState(null);\n\n  // Perform initial checks to help ensure field values can be obtained and\n  // that the form will not submit when the user doesn't expect it to\n  useEffect(() => {\n    if (formElement) {\n      // Ensure form values can be detected\n      if (!Object.values(getFormValues(formElement)).length) {\n        console.warn(\n          \"No form values detected for form element.  All input fields should have a name or id attribute.\",\n          formElement\n        );\n      }\n\n      // Ensure button elements have a type attribute\n      for (const el of formElement.elements) {\n        if (el.tagName.toUpperCase() === \"BUTTON\" && !el.getAttribute(\"type\")) {\n          console.warn(\n            `All button elements should have a type attribute specified or they will default to \"submit\"`,\n            el\n          );\n          break;\n        }\n      }\n    }\n  }, [formElement]);\n\n  const [isValid, setIsValid] = useState(false);\n  const [errors, setErrors] = useState({});\n\n  // TODO: Document\n  const handleFormValidate = useCallback(\n    formValues => {\n      let hasErrors = false;\n\n      const errors = Object.fromEntries(\n        Object.entries(validator(formValues) || {}).filter(predicate => {\n          const isError = Boolean(predicate[1]);\n\n          if (isError) {\n            hasErrors = true;\n          }\n\n          return isError;\n        })\n      );\n\n      const isValid = !hasErrors;\n      setIsValid(isValid);\n      setErrors(errors);\n      return isValid;\n    },\n    [validator]\n  );\n\n  // TODO: Document\n  const handleFormChange = useCallback(\n    evt => {\n      const formValues = getFormValues(formElement);\n      handleFormValidate(formValues);\n\n      onChange(formValues);\n    },\n    [handleFormValidate, formElement, onChange]\n  );\n\n  // TODO: Document\n  const handleFormSubmit = useCallback(\n    evt => {\n      evt.preventDefault();\n\n      const formValues = getFormValues(formElement);\n      const isValid = handleFormValidate(formValues);\n\n      if (isValid) {\n        onSubmit(formValues);\n      }\n    },\n    [handleFormValidate, formElement, onSubmit]\n  );\n\n  return {\n    isValid,\n    handleFormValidate,\n    handleFormChange,\n    handleFormSubmit,\n    errors,\n    setFormRef,\n  };\n}\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport Form from \"@components/Form\";\n\nexport default function KeyEditorForm({\n  initialKey,\n  initialValue,\n  initialStorageEngine,\n  storageEngines,\n  onSubmit,\n}) {\n  return (\n    <Center canOverflow={true}>\n      <Form\n        onSubmit={onSubmit}\n        validator={formValues => {\n          return {\n            // TODO: Refactor into KeyEditorForm\n            key:\n              formValues.key.length < 1 &&\n              \"Key must contain at least one character\",\n          };\n        }}\n      >\n        {({ errors, isValid }) => (\n          <>\n            <Padding>\n              <input\n                name=\"key\"\n                type=\"text\"\n                placeholder=\"Key\"\n                defaultValue={initialKey}\n                required\n              />\n            </Padding>\n\n            {errors?.key && (\n              <div className=\"note\" style={{ color: \"red\" }}>\n                {errors.key}\n              </div>\n            )}\n\n            <Padding>\n              <textarea\n                name=\"value\"\n                placeholder=\"Value\"\n                defaultValue={initialValue}\n              ></textarea>\n            </Padding>\n\n            <Padding style={{ marginTop: 20, textAlign: \"left\" }}>\n              <label>Storage Engine</label>\n              <select\n                name=\"storageEngineShortUUID\"\n                defaultValue={initialStorageEngine?.getShortUUID()}\n                required\n              >\n                {storageEngines.map(storageEngine => {\n                  const title = storageEngine.getTitle();\n                  const shortUUID = storageEngine.getShortUUID();\n\n                  return (\n                    <option key={title} value={shortUUID}>\n                      {title}\n                    </option>\n                  );\n                })}\n              </select>\n            </Padding>\n\n            <div>\n              <input\n                type=\"submit\"\n                value=\"Submit\"\n                style={{\n                  // TODO: Use color variable for highlighted elements\n                  backgroundColor: \"#347fe8\",\n                }}\n                disabled={!isValid}\n              />\n            </div>\n          </>\n        )}\n      </Form>\n    </Center>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`id0d6dd5d02e64b979154a770ab790dba-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","// TODO: Implement ability to see how much storage is used\n\n// TODO: Use for local user profiles\n// TODO: Use for optional backend for notes, etc. (anything which can save a file of a reasonably small size)\n\n// TODO: Implement ability to export / import local storage data\n\nimport { useCallback, useEffect, useState } from \"react\";\n\nimport Padding from \"@components/Padding\";\nimport Layout, { Header, Content } from \"@components/Layout\";\nimport LocalStorageItems from \"./views/LocalStorageItems\";\nimport KeyEditorForm from \"./views/KeyEditorForm\";\n\nimport BackArrowIcon from \"@icons/BackArrowIcon\";\n\nimport KeyVaultService from \"@services/KeyVaultService\";\nimport UIModalWidgetService from \"@services/UIModalWidgetService\";\n\nimport useKeyboardEvents from \"@hooks/useKeyboardEvents\";\n\nexport const REGISTRATION_ID = \"key-vault\";\n\nconst KeyVaultApp = {\n  id: REGISTRATION_ID,\n  title: \"Key Vault\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  serviceClasses: [KeyVaultService, UIModalWidgetService],\n  view: function View({ appServices }) {\n    const localDataPersistenceService = appServices[KeyVaultService];\n    const rawKeyStorageEngineMaps =\n      localDataPersistenceService.getKeyStorageEngineMaps();\n\n    const uiModalWidgetService = appServices[UIModalWidgetService];\n\n    const [keyStorageEngineMaps, setKeyStorageEngineMaps] = useState([]);\n\n    const [isCreatingNewKey, setIsCreatingNewKey] = useState(false);\n\n    // Auto-fetch\n    useEffect(() => {\n      (async () => {\n        const keyStorageEngineMaps = [];\n\n        for (const keyMap of rawKeyStorageEngineMaps) {\n          const key = keyMap[0];\n          const storageEngine = keyMap[1];\n          const value = await storageEngine.fetchItem(key);\n\n          // TODO: Move this detection into the service (consider automatically\n          // coercing primitive types:\n          // @see https://developer.mozilla.org/en-US/docs/Glossary/Primitive\n          // const kind = typeof value;\n\n          keyStorageEngineMaps.push({\n            key,\n            storageEngine,\n            value,\n            // kind,\n          });\n        }\n\n        setKeyStorageEngineMaps(keyStorageEngineMaps);\n      })();\n    }, [rawKeyStorageEngineMaps]);\n\n    /*\n    const handleGetValue = useCallback(async (key, storageEngine) => {\n      const value = await storageEngine.fetchItem(key);\n\n      // TODO: Implement\n\n      // TODO: Remove\n      console.log({ key, value });\n\n      // TODO: Remove\n      alert(\"TODO: Implement get value\");\n    }, []);\n    */\n\n    // TODO: Document\n    const handleKeyValueSubmit = useCallback(\n      formValues => {\n        const storageEngine =\n          localDataPersistenceService.getStorageEngineWithShortUUID(\n            formValues[\"storageEngineShortUUID\"]\n          );\n\n        storageEngine\n          .setItem(formValues[\"key\"], formValues[\"value\"])\n          .then(() => {\n            setIsCreatingNewKey(false);\n          });\n      },\n      [localDataPersistenceService]\n    );\n\n    // TODO: Document\n    const handleEmpty = useCallback(async () => {\n      // TODO: Replace w/ UIModal\n      if (\n        await uiModalWidgetService.confirm(\n          \"Are you sure you wish to empty the Key Vault?\"\n        )\n      ) {\n        localDataPersistenceService.clearAllStorageEngines();\n      }\n    }, [uiModalWidgetService, localDataPersistenceService]);\n\n    useKeyboardEvents(window, {\n      onEscape: () => setIsCreatingNewKey(false),\n    });\n\n    return (\n      <Layout>\n        <Header>\n          <Padding>\n            {/*\n              <button>Session Storage</button>\n            <button>IndexedDB</button>\n            <button>Key Vault</button>\n            <button>Memory</button>\n              */}\n            <button onClick={() => setIsCreatingNewKey(prev => !prev)}>\n              {!isCreatingNewKey ? (\n                <>(+) New Item</>\n              ) : (\n                <>\n                  <BackArrowIcon /> Back\n                </>\n              )}\n            </button>\n          </Padding>\n        </Header>\n        <Content>\n          {!isCreatingNewKey ? (\n            <LocalStorageItems\n              keyStorageEngineMaps={keyStorageEngineMaps}\n              // onGetValue={() => null}\n              onEmpty={handleEmpty}\n              // TODO: Move to callback\n              onNewItem={() => setIsCreatingNewKey(true)}\n            />\n          ) : (\n            <KeyEditorForm\n              storageEngines={localDataPersistenceService.getStorageEngines()}\n              onSubmit={handleKeyValueSubmit}\n            />\n          )}\n        </Content>\n      </Layout>\n    );\n  },\n};\n\nexport default KeyVaultApp;\n","import KeyVaultApp, { REGISTRATION_ID } from \"./KeyVaultApp\";\n\nexport default KeyVaultApp;\nexport { REGISTRATION_ID };\n","import { useCallback, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport ReactJson from \"react-json-view\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nexport const REGISTRATION_ID = \"app-registration-viewer\";\n\nconst AppRegistrationViewerApp = {\n  id: REGISTRATION_ID,\n  title: \"App Registration Viewer\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  view: function View() {\n    const { appRegistrations } = useAppOrchestrationContext();\n\n    const [registration, setRegistration] = useState(null);\n\n    const handleSetRegistration = useCallback(\n      registrationId => {\n        const matchedRegistration = appRegistrations.find(\n          predicate => predicate.getID() === registrationId\n        );\n\n        console.log({\n          matchedRegistration,\n        });\n\n        if (matchedRegistration) {\n          setRegistration(matchedRegistration.getAppDescriptor());\n        } else {\n          setRegistration(null);\n        }\n      },\n      [appRegistrations]\n    );\n\n    if (!registration) {\n      return (\n        <Center>\n          <AppRegistrationSelector\n            onRegistrationChange={handleSetRegistration}\n          />\n        </Center>\n      );\n    }\n\n    return (\n      <Layout>\n        <Content>\n          <div style={{ width: \"100%\", height: \"100%\", overflowY: \"auto\" }}>\n            <ReactJson\n              src={registration}\n              theme=\"monokai\"\n              style={{ width: \"100%\", height: \"100%\" }}\n            />\n          </div>\n        </Content>\n        <Footer>\n          <AppRegistrationSelector\n            onRegistrationChange={handleSetRegistration}\n          />\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nfunction AppRegistrationSelector({ onRegistrationChange }) {\n  const { appRegistrations } = useAppOrchestrationContext();\n\n  // TODO: Remove\n  console.log({ appRegistrations });\n\n  return (\n    <div>\n      <select onChange={evt => onRegistrationChange(evt.target.value)}>\n        <option value=\"\">Select app registration</option>\n        {appRegistrations.map(registration => (\n          <option key={registration.getUUID()} value={registration.getID()}>\n            {registration.getTitle()}\n          </option>\n        ))}\n      </select>\n    </div>\n  );\n}\n\nexport default AppRegistrationViewerApp;\n","import AppRegistrationViewerApp, {\n  REGISTRATION_ID,\n} from \"./AppRegistrationViewerApp\";\n\nexport default AppRegistrationViewerApp;\nexport { REGISTRATION_ID };\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport LED from \"@components/LED\";\nimport classNames from \"classnames\";\nimport styles from \"./LabeledLED.module.css\";\n\nLabeledLED.propTypes = {\n  label: PropTypes.string.isRequired,\n\n  /** The color of the LED */\n  color: PropTypes.string,\n};\n\nexport default function LabeledLED({\n  color,\n  className,\n  style,\n  label,\n  ...rest\n}) {\n  return (\n    <div className={classNames(styles[\"labeled-led\"], className)} style={style}>\n      <div className={styles[\"led-wrap\"]}>\n        <LED color={color} {...rest} />\n      </div>\n      <div className={styles[\"label-wrap\"]}>{label}</div>\n    </div>\n  );\n}\n","import ButtonGroup from \"./ButtonGroup\";\n\nexport default ButtonGroup;\n","import classNames from \"classnames\";\nimport styles from \"./ButtonGroup.module.css\";\n\n// TODO: Add prop-types\n// TODO: Document\n// Used for wrapping arbitrary <button> HTML button elements with \"global\" base\n// styling\nexport default function ButtonGroup({ children, className, ...rest }) {\n  return (\n    <div\n      {...rest}\n      className={classNames(\n        styles[\"button-group\"],\n        // \"Global\" styling from base-styles.css\n        \"button-group\",\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n","// import beep from \"@utils/beep\";\n\nimport { REGISTRATION_ID as APPLICATIONS_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/ApplicationsApp\";\n\nimport {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n  AUTO_DETECT_PARADIGM,\n} from \"@services/UIParadigmService\";\n\nconst REPOSITION_OFFSET = 300;\n\n// TODO: Make this more generic so that it can open any application by calling\n// it by name\nexport const CMD_OPEN_APPLICATIONS = {\n  id: \"open-applications\",\n  keywords: \"open applications\",\n  description: \"Open Applications app\",\n  action: (commander, { appOrchestrationService }) => {\n    appOrchestrationService.activateAppRegistrationWithID(\n      APPLICATIONS_REGISTRATION_ID\n    );\n  },\n};\n\n// FIXME: (jh) Safari doesn't like this and can throw an Unhandled Rejection\n// (NotAllowedError) if the user doesn't activate some sort of system sounds\n// prior to this command running. A workaround could be to try / catch and\n// present a UIModal asking the user if they wish to start sounds, should an\n// error be thrown. If accepted, a sound would be generated to start the\n// browser's sound engine.\n/*\nexport const CMD_ACTIVATE_NEXT_WINDOW = {\n  id: \"beep\",\n  keywords: \"beep system sound chime beeping tone\",\n  description: \"Generates a beep tone\",\n  example: \"Beep\"\n  action: (commander, params = {}) => beep(),\n};\n*/\n\n// TODO: Handle\n/*\nexport const CMD_ACTIVATE_NEXT_WINDOW = {\n  id: \"activate-next-window\",\n  keywords: \"cycle activate next window\",\n  description: \"Activate next window\",\n  action: (commander, params = {}) => null,\n};\n*/\n\n// TODO: Handle\n/*\nexport const CMD_ACTIVATE_PREVIOUS_WINDOW = {\n  id: \"activate-previous-window\",\n  keywords: \"cycle activate previous window\",\n  description: \"Activate previous window\",\n  action: (commander, params = {}) => null,\n};\n*/\n\nexport const CMD_MOVE_WINDOW_UP = {\n  id: \"move-window-up\",\n  keywords: \"reposition move window up\",\n  description: \"Move a window up\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x,\n        y: prevPosition.y - REPOSITION_OFFSET,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_UP_AND_RIGHT = {\n  id: \"move-window-up-and-right\",\n  keywords: \"reposition move window up and right\",\n  description: \"Move a window up and right\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x + REPOSITION_OFFSET,\n        y: prevPosition.y - REPOSITION_OFFSET,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_UP_AND_LEFT = {\n  id: \"move-window-up-and-left\",\n  keywords: \"reposition move window up and left\",\n  description: \"Move a window up and left\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x - REPOSITION_OFFSET,\n        y: prevPosition.y - REPOSITION_OFFSET,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_RIGHT = {\n  id: \"move-window-right\",\n  keywords: \"reposition move window right\",\n  description: \"Move a window right\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x + REPOSITION_OFFSET,\n        y: prevPosition.y,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_DOWN = {\n  id: \"move-window-down\",\n  keywords: \"reposition move window down\",\n  description: \"Move a window down\",\n  action: (commander, { windowController }) => {\n    const prevPosition = windowController.getPosition();\n\n    windowController.setPosition({\n      x: prevPosition.x,\n      y: prevPosition.y + REPOSITION_OFFSET,\n    });\n  },\n};\n\nexport const CMD_MOVE_WINDOW_DOWN_AND_RIGHT = {\n  id: \"move-window-down-and-right\",\n  keywords: \"reposition move window down and right\",\n  description: \"Move a window down and right\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x + REPOSITION_OFFSET,\n        y: prevPosition.y + REPOSITION_OFFSET,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_DOWN_AND_LEFT = {\n  id: \"move-window-down-and-left\",\n  keywords: \"reposition move window down and left\",\n  description: \"Move a window down and left\",\n  action: (commander, { windowController }) => {\n    const prevPosition = windowController.getPosition();\n\n    windowController.setPosition({\n      x: prevPosition.x - REPOSITION_OFFSET,\n      y: prevPosition.y + REPOSITION_OFFSET,\n    });\n  },\n};\n\nexport const CMD_MOVE_WINDOW_LEFT = {\n  id: \"move-window-left\",\n  keywords: \"reposition move window left\",\n  description: \"Move a window left\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x - REPOSITION_OFFSET,\n        y: prevPosition.y,\n      });\n    }\n  },\n};\n\nexport const CMD_CENTER_WINDOW = {\n  id: \"center-window\",\n  keywords: \"reposition center window\",\n  description: \"Center a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.center();\n    }\n  },\n};\n\nexport const CMD_CENTER_ALL_WINDOWS = {\n  id: \"center-all-windows\",\n  keywords: \"reposition center all windows\",\n  description: \"Center all windows\",\n  action: (commander, { appOrchestrationService }) => {\n    appOrchestrationService\n      .getWindowControllers()\n      .forEach(windowController => windowController.center());\n  },\n};\n\nexport const CMD_SCATTER_WINDOW = {\n  id: \"scatter-window\",\n  keywords: \"reposition scatter window\",\n  description: \"Scatter a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.scatter();\n    }\n  },\n};\n\nexport const CMD_SCATTER_ALL_WINDOWS = {\n  id: \"scatter-all-windows\",\n  keywords: \"reposition scatter all windows\",\n  description: \"Scatter all windows\",\n  action: (commander, { appOrchestrationService }) => {\n    appOrchestrationService\n      .getWindowControllers()\n      .forEach(controller => controller.scatter());\n  },\n};\n\nexport const CMD_MAXIMIZE_WINDOW = {\n  id: \"maximize-window\",\n  keywords: \"resize maximize window\",\n  description: \"Maximize a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.maximize();\n    }\n  },\n};\n\nexport const CMD_MINIMIZE_WINDOW = {\n  id: \"minimize-window\",\n  keywords: \"resize minimize window\",\n  description: \"Minimize a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.minimize();\n    }\n  },\n};\n\nexport const CMD_RESTORE_WINDOW = {\n  id: \"restore-window\",\n  keywords: \"resize restore window\",\n  description: \"Restore a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.restore();\n    }\n  },\n};\n\n// TODO: Handle\n/*\nexport const OPEN_APPLICATION = {\n  id: \"open-application\",\n  keywords: \"open application window\",\n  description: \"TODO: Make description\",\n  action: (commander, params = {}) => null,\n};\n*/\n\nexport const CLOSE_APPLICATION = {\n  id: \"close-application\",\n  keywords: \"close application window\",\n  description: \"Close an application window\",\n  action: async (commander, { windowController }) => {\n    if (windowController) {\n      await windowController.destroy();\n    }\n  },\n};\n\n// TODO: Handle\n/*\nexport const FOCUS_TEXT_FIELD = {\n  id: \"focus-text-field\",\n  keywords: \"focus input cursor text field\",\n  description: \"Focus an input field\",\n  action: (commander, params = {}) => null,\n};\n*/\n\n// TODO: Handle\n/*\nexport const TYPE_IN_TEXT_FIELD = {\n  id: \"type-in-text-field\",\n  keywords: \"input cursor type text field\",\n  description: \"Type in an input field\",\n  action: (commander, params = {}) => null,\n};\n*/\n\nexport const SWITCH_TO_DESKTOP_PARADIGM = {\n  id: \"desktop-paradigm\",\n  keywords: \"switch select desktop paradigm view display\",\n  description: \"Switch to desktop UI paradigm\",\n  action: async (commander, { uiParadigmService }) => {\n    uiParadigmService.setStaticUIParadigm(DESKTOP_PARADIGM);\n  },\n};\n\nexport const SWITCH_TO_MOBILE_PARADIGM = {\n  id: \"mobile-paradigm\",\n  keywords: \"switch select mobile paradigm view display\",\n  description: \"Switch to mobile UI paradigm\",\n  action: async (commander, { uiParadigmService }) => {\n    uiParadigmService.setStaticUIParadigm(MOBILE_PARADIGM);\n  },\n};\n\nexport const SWITCH_TO_AUTO_DETECT_PARADIGM = {\n  id: \"auto-detect-paradigm\",\n  keywords: \"switch select auto detect paradigm view display\",\n  description: \"Switch to auto detect UI paradigm\",\n  action: async (commander, { uiParadigmService }) => {\n    uiParadigmService.setStaticUIParadigm(AUTO_DETECT_PARADIGM);\n  },\n};\n","import { getUnixTime } from \"phantom-core\";\nimport UIServiceCore, { EVT_UPDATED } from \"@core/classes/UIServiceCore\";\n\nimport AppOrchestrationService from \"@services/AppOrchestrationService\";\nimport UIParadigmService from \"@services/UIParadigmService\";\n\nimport * as COMMANDS from \"./commands\";\n\nexport { EVT_UPDATED };\n\n// TODO: Document\n// TODO: Rename\n// TODO: Don't make extensible\nexport default class DesktopCommanderControllerService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Desktop Commander Controller Service\");\n\n    this.setState({\n      lastCommand: null,\n      lastCommandInvokeTime: null,\n    });\n\n    this._appOrchestrationService = this.useServiceClass(\n      AppOrchestrationService\n    );\n\n    this._uiParadigmService = this.useServiceClass(UIParadigmService);\n\n    // TODO: Use map instead?\n    this._commands = {};\n\n    // TODO: Iterate over commands and register each one\n    // TODO: Remove\n    for (const commandId of Object.keys(COMMANDS)) {\n      const command = COMMANDS[commandId];\n\n      this.registerCommand(command);\n    }\n  }\n\n  /**\n   * @return {Object}\n   */\n  getCommands() {\n    return this._commands;\n  }\n\n  // TODO: Document\n  registerCommand(command) {\n    // TODO: Ensure each command has a unique name\n\n    // TODO: Validate command structure\n\n    if (typeof command.keywords === \"string\") {\n      command.keywords = command.keywords.split(\" \");\n    }\n\n    this._commands[command.id] = command;\n  }\n\n  // TODO: Document\n  getCommandWithId(commandId) {\n    return this._commands[commandId];\n  }\n\n  // TODO: Document\n  getLastCommand() {\n    return this.getState().lastCommand;\n  }\n\n  /**\n   * Retrieves the UNIX time regarding when the most recent command was\n   * invoked.\n   *\n   * @return {number}\n   */\n  getLastCommandInvokeTime() {\n    return this.getState().lastCommandInvokeTime;\n  }\n\n  // TODO: Document\n  // TODO: This could be an async operation, so potentially treat it as so\n  async execCommand(command, params = {}) {\n    if (!params.windowController) {\n      params.windowController =\n        this._appOrchestrationService.getActiveWindowController();\n    }\n\n    params.appOrchestrationService = this._appOrchestrationService;\n    params.uiParadigmService = this._uiParadigmService;\n\n    // TODO: Handle condition where no active (in-front) window controller is\n    // present and there are running apps (should we show a UI notification?)\n\n    this.setState({\n      lastCommand: command,\n      lastCommandInvokeTime: getUnixTime(),\n    });\n\n    // Execute the command\n    return command.action(this, params);\n  }\n}\n","import DesktopCommanderControllerService, {\n  EVT_UPDATED,\n} from \"./DesktopCommanderControllerService\";\n\nexport default DesktopCommanderControllerService;\nexport { EVT_UPDATED };\n","import { useCallback, useEffect, useState } from \"react\";\nimport Center from \"@components/Center\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\n\nimport DesktopCommanderControllerService from \"@services/DesktopCommanderControllerService\";\nimport AppOrchestrationService from \"@services/AppOrchestrationService\";\n\nexport const REGISTRATION_ID = \"desktop-commander-debugger\";\n\nconst DesktopCommanderDebuggerApp = {\n  id: REGISTRATION_ID,\n  title: \"Desktop Commander Debugger\",\n  style: {\n    width: 1040,\n    height: 720,\n  },\n  serviceClasses: [DesktopCommanderControllerService, AppOrchestrationService],\n  view: function View({ appServices, windowController }) {\n    const [selectedWindowController, _setSelectedWindowController] =\n      useState(null);\n\n    const selectedWindowControllerUUID = selectedWindowController?.getUUID();\n\n    const commandService = appServices[DesktopCommanderControllerService];\n    const commands = commandService.getCommands();\n    const lastCommand = commandService.getLastCommand();\n\n    const appOrchestrationService = appServices[AppOrchestrationService];\n    const appRuntimes = appOrchestrationService.getAppRuntimes();\n    const appRuntimeWindowControllers = appRuntimes\n      .map(appRuntime => ({\n        appRuntime,\n        windowController: appRuntime.getWindowController(),\n      }))\n      .filter(obj => obj.windowController);\n\n    // TODO: Render command currently being activated\n\n    /**\n     * Invoked when the user manually changes the window controller selection\n     * in the dropdown menu.\n     *\n     * @return {void}\n     */\n    const handleSelectWindowControllerChange = useCallback(\n      evt => {\n        const uuid = evt.target.value;\n\n        const windowController =\n          appOrchestrationService.getWindowControllerWithUUID(uuid);\n\n        _setSelectedWindowController(windowController);\n      },\n      [appOrchestrationService]\n    );\n\n    const activeWindowController =\n      appOrchestrationService.getActiveWindowController();\n\n    // Automatically set selectedWindowController\n    useEffect(() => {\n      let selectedWindowController;\n\n      if (appRuntimeWindowControllers.length > 1) {\n        // Don't automatically set this window as the selected window\n        // controller if clicking on it (otherwise, it would be hard to control\n        // the other windows without jumping through hoops)\n        if (activeWindowController !== windowController) {\n          selectedWindowController = activeWindowController;\n        }\n      } else {\n        selectedWindowController = windowController;\n      }\n\n      if (selectedWindowController) {\n        _setSelectedWindowController(selectedWindowController);\n      }\n    }, [activeWindowController, windowController, appRuntimeWindowControllers]);\n\n    return (\n      <Layout>\n        <Content>\n          <Padding>\n            <Center canOverflow>\n              {Object.values(commands).map(command => (\n                <div\n                  key={command.id}\n                  style={{\n                    width: 250,\n                    height: 100,\n                    border: \"1px #999 solid\",\n                    borderRadius: 8,\n                    margin: 1,\n                    display: \"inline-block\",\n                    textAlign: \"left\",\n                    backgroundColor: command === lastCommand ? \"green\" : null,\n                  }}\n                >\n                  <Layout>\n                    <Content>\n                      <Padding style={{ overflowY: \"auto\" }}>\n                        <div>{command.description}</div>\n\n                        <div\n                          style={{\n                            fontStyle: \"italic\",\n                            fontSize: \".8em\",\n                            marginTop: 4,\n                          }}\n                        >\n                          {command.keywords.join(\" \")}\n                        </div>\n                      </Padding>\n                    </Content>\n                    <Footer style={{ textAlign: \"right\" }}>\n                      <button\n                        onClick={() =>\n                          commandService.execCommand(command, {\n                            windowController: selectedWindowController,\n                          })\n                        }\n                        style={{\n                          margin: 8,\n                        }}\n                      >\n                        {command.id}\n                      </button>\n                    </Footer>\n                  </Layout>\n                </div>\n              ))}\n            </Center>\n          </Padding>\n        </Content>\n        <Footer>\n          <hr />\n          <Padding>\n            <Center>\n              <label>Choose a window to send a command:</label>\n              <select\n                onChange={handleSelectWindowControllerChange}\n                value={selectedWindowControllerUUID}\n              >\n                {appRuntimeWindowControllers.map(\n                  ({ /* appRuntime, */ windowController }, idx) => (\n                    <option key={idx} value={windowController.getUUID()}>\n                      {windowController.getTitle()}\n                    </option>\n                  )\n                )}\n              </select>\n            </Center>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default DesktopCommanderDebuggerApp;\n","import DesktopCommanderDebuggerApp, {\n  REGISTRATION_ID,\n} from \"./DesktopCommanderDebuggerApp\";\n\nexport default DesktopCommanderDebuggerApp;\nexport { REGISTRATION_ID };\n","import PhantomCore, { EVT_BEFORE_DESTROY, EVT_DESTROYED } from \"phantom-core\";\n\nconst sdk = require(\"microsoft-cognitiveservices-speech-sdk\");\n\nexport const EVT_BEGIN_RECOGNIZE = \"begin-recognize\";\nexport const EVT_END_RECOGNIZE = \"end-recognize\";\n\n// Emits with the current text being recognized\nexport const EVT_TRANSCRIPTION_RECOGNIZING = \"transcription-recognizing\";\n\n// TODO: Document that this emits with text\nexport const EVT_TRANSCRIPTION_FINALIZED = \"transcription-finalized\";\n\nexport { EVT_BEFORE_DESTROY, EVT_DESTROYED };\n\n// Examples:\n// https://github.com/Azure-Samples/cognitive-services-speech-sdk/tree/master/quickstart/javascript/browser/from-microphone\n\n/**\n * Handles direct communication with Azure CognitiveService backend using the\n * microsoft-cognitiveservices-speech-sdk.\n *\n * Interfaces with npm library:\n * @see {@link https://www.npmjs.com/package/microsoft-cognitiveservices-speech-sdk}ß\n */\nexport default class MesaSpeechRecognizer extends PhantomCore {\n  /**\n   * @param {MediaStream} mediaStream\n   * @param {string} subscriptionKey\n   * @param {Object} options? [default = {}]\n   */\n  constructor(mediaStream, subscriptionKey, options) {\n    super(options);\n\n    this._isRecognizing = false;\n    this._isRecognized = false;\n\n    this._subscriptionKey = subscriptionKey;\n\n    // TODO: Replace hardcoding with config param\n    this._locationRegion = \"eastus\";\n    this._speechRecognitionLanguage = \"en-US\";\n\n    this._mediaStream = mediaStream;\n\n    // Automatically start recognizing\n    this._startRecognizing();\n  }\n\n  /**\n   * Retrieves the Mesa cloud service location region this recognizer is\n   * associated with.\n   *\n   * @return {string}\n   */\n  getLocationRegion() {\n    return this._locationRegion;\n  }\n\n  /**\n   * Retrieves the Mesa language code for this recognizer.\n   *\n   * @return {string}\n   */\n  getRecognitionLanguage() {\n    return this._recognitionLanguage;\n  }\n\n  /**\n   * Sets whether or not the speech is currently being recognized.\n   *\n   * @param {boolean} isRecognizing\n   * @emits EVT_BEGIN_RECOGNIZE\n   * @emits EVT_END_RECOGNIZE\n   * @return {void}\n   */\n  _setIsRecognizing(isRecognizing) {\n    this._isRecognizing = isRecognizing;\n\n    if (isRecognizing) {\n      this.emit(EVT_BEGIN_RECOGNIZE);\n    } else {\n      this.emit(EVT_END_RECOGNIZE);\n    }\n  }\n\n  /**\n   * Sets the finalized speech transcription.\n   *\n   * @param {string} text\n   * @emits EVT_TRANSCRIPTION_FINALIZED\n   * @return {void}\n   */\n  _setFinalizedTranscription(text) {\n    this._setIsRecognizing(false);\n\n    this.emit(EVT_TRANSCRIPTION_FINALIZED, text);\n  }\n\n  // TODO: Ensure this instance is automatically destructed if the speech\n  // service errors or has a network error\n  /**\n   * Starts the speech recognition processing, performs remote event binding to\n   * the class instance, and handles cleanup operations.\n   *\n   * @return {void}\n   */\n  _startRecognizing() {\n    const stream = this._mediaStream;\n\n    const speechConfig = sdk.SpeechConfig.fromSubscription(\n      this._subscriptionKey,\n      this._locationRegion\n    );\n\n    speechConfig.speechRecognitionLanguage = this._speechRecognitionLanguage;\n\n    let audioConfig = sdk.AudioConfig.fromStreamInput(stream);\n\n    // TODO: Make this a class property\n    let recognizer = new sdk.SpeechRecognizer(speechConfig, audioConfig);\n\n    // Stop recognizer before destruct cleanup happens\n    this.once(EVT_BEFORE_DESTROY, () => {\n      recognizer.stopContinuousRecognitionAsync();\n\n      recognizer.close();\n    });\n\n    // TODO: Ensure this automatically stops when the input stops or after a\n    // certain amount of time\n    //\n    // TODO: Refactor\n    (() => {\n      recognizer.recognizing = (s, e) => {\n        this._setIsRecognizing(true);\n\n        // TODO: Change to debug\n        console.log(`RECOGNIZING: Text=${e.result.text}`);\n\n        this.emit(EVT_TRANSCRIPTION_RECOGNIZING, e.result.text);\n      };\n\n      recognizer.recognized = (s, e) => {\n        if (e.result.reason === sdk.ResultReason.RecognizedSpeech) {\n          this._setFinalizedTranscription(e.result.text);\n\n          // TODO: Change to debug\n          console.log(`RECOGNIZED: Text=${e.result.text}`);\n        } else if (e.result.reason === sdk.ResultReason.NoMatch) {\n          this._setIsRecognizing(false);\n\n          // TODO: Change to debug\n          console.log(\"NOMATCH: Speech could not be recognized.\");\n        }\n      };\n\n      recognizer.canceled = async (s, e) => {\n        this._setIsRecognizing(false);\n\n        // TODO: Change to debug\n        console.log(`CANCELED: Reason=${e.reason}`);\n\n        if (e.reason === sdk.CancellationReason.Error) {\n          // TODO: Change to debug\n          console.log(`\"CANCELED: ErrorCode=${e.errorCode}`);\n          console.log(`\"CANCELED: ErrorDetails=${e.errorDetails}`);\n          console.log(\n            \"CANCELED: Did you update the key and location/region info?\"\n          );\n        }\n\n        // NOTE: This should be automatically stopped by the following\n        // operation, but as double insurance, let's stop it here\n        recognizer.stopContinuousRecognitionAsync();\n\n        // We can't do anything about cancellations, so just destruct the\n        // instance\n        return this.destroy();\n      };\n\n      recognizer.sessionStopped = (s, e) => {\n        this._setIsRecognizing(false);\n\n        // TODO: Change to debug\n        console.log(\"\\n    Session stopped event.\");\n        recognizer.stopContinuousRecognitionAsync();\n      };\n\n      // Start recognizing\n      recognizer.startContinuousRecognitionAsync();\n    })();\n  }\n}\n","import UIServiceCore, { EVT_UPDATED } from \"@core/classes/UIServiceCore\";\n\nimport KeyVaultService from \"@services/KeyVaultService\";\nimport UIModalWidgetService from \"@services/UIModalWidgetService\";\n\nconst KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY = \"mesa-sub-1\";\n\n// IMPORTANT: Never add a subscription key to client-side code. For advanced guidance on keeping sensitive subscription info secure, see the sample using a server-side auth token\n// Reference: https://github.com/Azure-Samples/cognitive-services-speech-sdk/tree/master/samples/js/browser\n\n/**\n * Manages the subscription key acquisition and usage for Mesa Azure.\n */\nexport default class MesaSubscriptionKeyManagementService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Mesa Subscription Key Management Service\");\n\n    this.setState({\n      hasCachedSubscriptionKey: false,\n    });\n\n    this._keyVaultService = this.useServiceClass(KeyVaultService);\n\n    // TODO: Document type\n    this._secureLocalStorageEngine =\n      this._keyVaultService.getSecureLocalStorageEngine();\n\n    // Perform initial state sync (internally will update\n    // hasCachedSubscriptionKey state if found)\n    this._fetchSecureLocalStorageSubscriptionKey();\n\n    // Refresh when Key Vault updates\n    //\n    // NOTE: This fixes issue where deleting store from KeyVault itself would\n    // not affect \"Speech Input Controller\" UI state.\n    this.proxyOn(this._keyVaultService, EVT_UPDATED, () => {\n      this._fetchSecureLocalStorageSubscriptionKey();\n    });\n  }\n\n  /**\n   * Caches the Azure subscription key to secure local storage.\n   *\n   * @param {string} subscriptionKey\n   * @return {Promise<void>}\n   */\n  async _setSecureLocalStorageSubscriptionKey(subscriptionKey) {\n    await this._secureLocalStorageEngine.setItem(\n      KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY,\n      subscriptionKey\n    );\n\n    this.setState({ hasCachedSubscriptionKey: Boolean(subscriptionKey) });\n  }\n\n  /**\n   * Retrieves the subscription key, if present, from secure local storage.\n   *\n   * NOTE: This also sets the service state for hasCachedSubscriptionKey.\n   *\n   * @return {Promise<string | void>}\n   */\n  async _fetchSecureLocalStorageSubscriptionKey() {\n    const cachedKey = await this._secureLocalStorageEngine.fetchItem(\n      KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY\n    );\n\n    // Sets the state\n    this.setState({ hasCachedSubscriptionKey: Boolean(cachedKey) });\n\n    return cachedKey;\n  }\n\n  /**\n   * @return {Promise<void>}\n   */\n  async deleteCachedSubscriptionKey() {\n    if (\n      !(await this.useServiceClass(UIModalWidgetService).confirm(\n        \"Are you sure you wish to delete the cached Azure Subscription Key?\"\n      ))\n    ) {\n      return;\n    }\n\n    await this._secureLocalStorageEngine.removeItem(\n      KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY\n    );\n\n    this.setState({ hasCachedSubscriptionKey: false });\n  }\n\n  /**\n   * Retrieves whether or not a cached subscription key is present.\n   *\n   * @return {boolean}\n   */\n  getHasCachedSubscriptionKey() {\n    return this.getState().hasCachedSubscriptionKey;\n  }\n\n  // TODO: Document\n  // NOTE: This is intentionally not setting the subscription key to the\n  // instance state\n  /**\n   *\n   * @return {string | null} A null value will be returned if the user cancels.\n   */\n  async acquireSubscriptionKey() {\n    // Try to obtain cached subscription key from secure local storage\n    let subscriptionKey = await this._fetchSecureLocalStorageSubscriptionKey();\n\n    // If found...\n    if (subscriptionKey) {\n      // ...return it\n      return subscriptionKey;\n    }\n\n    // Prompt user to input key\n    subscriptionKey = await this.useServiceClass(\n      UIModalWidgetService\n    ).showTextInputModal({\n      label: \"Enter Microsoft Azure Subscription Key\",\n    });\n\n    // TODO: Provide a graceful way out; an error is currently thrown as a\n    // cancellation signal\n    if (subscriptionKey === null) {\n      return null;\n    }\n\n    // TODO: Validate as necessary (i.e. w/ string length, etc.)\n\n    if (subscriptionKey) {\n      // Cache the subscription key\n      await this._setSecureLocalStorageSubscriptionKey(subscriptionKey);\n\n      return subscriptionKey;\n    } else {\n      // Try again\n      return this.acquireSubscriptionKey();\n    }\n  }\n}\n","import UIServiceCore, { EVT_UPDATED } from \"@core/classes/UIServiceCore\";\n\nimport MesaSpeechRecognizer, {\n  EVT_BEGIN_RECOGNIZE,\n  EVT_TRANSCRIPTION_RECOGNIZING,\n  EVT_END_RECOGNIZE,\n  EVT_TRANSCRIPTION_FINALIZED,\n} from \"./MesaSpeechRecognizer\";\n\nimport MesaSubscriptionKeyManagementService from \"../MesaSubscriptionKeyManagementService\";\n\nimport InputMediaDevicesService from \"@services/InputMediaDevicesService\";\nimport UIModalWidgetService from \"@services/UIModalWidgetService\";\n\nexport { EVT_UPDATED, EVT_TRANSCRIPTION_FINALIZED };\n\n/**\n * Manages the creation and destruction of MesaSpeechRecognizer instances.\n */\nexport default class MesaSpeechRecognizerService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Mesa Speech Recognizer Service\");\n\n    this.setState({\n      hasRecognizer: false,\n      isRecognizing: false,\n      realTimeTranscription: null,\n      finalizedTranscription: null,\n    });\n\n    // TODO: Auto-destruct after a certain amount of time after not retrieving\n    // a finalized transcription\n\n    /** @type {MesaSpeechRecognizer} */\n    this._recognizer = null;\n\n    this.registerCleanupHandler(async () => {\n      if (this._recognizer) {\n        await this._recognizer.destroy();\n      }\n    });\n\n    /** @type {InputMediaDevicesService} */\n    this._inputMediaDevicesService = this.useServiceClass(\n      InputMediaDevicesService\n    );\n\n    /** @type {MesaSubscriptionKeyManagementService} */\n    this._subscriptionKeyService = this.useServiceClass(\n      MesaSubscriptionKeyManagementService\n    );\n  }\n\n  /**\n   * Retrieves whether or not the MesaSpeechRecognizer is active.\n   *\n   * @return {boolean}\n   */\n  getHasRecognizer() {\n    return this.getState().hasRecognizer;\n  }\n\n  /**\n   * Retrieves the non-finalized speech transcription.\n   *\n   * NOTE: This will emit much faster than the finalized transcription and may\n   * automatically correct itself as words are spoken.\n   *\n   * @return {string | null}\n   */\n  getRealTimeTranscription() {\n    return this.getState().realTimeTranscription;\n  }\n\n  /**\n   * Retrieves the last finalized transcription received.\n   *\n   * @return {string | null}\n   */\n  getFinalizedTranscription() {\n    return this.getState().finalizedTranscription;\n  }\n\n  /**\n   * Retrieves whether or not the system is currently recognizing speech.\n   *\n   * @return {boolean}\n   */\n  getIsRecognizing() {\n    return this.getState().isRecognizing;\n  }\n\n  // TODO: Refactor\n  // TODO: Document\n  /**\n   * Starts the speech recognition system.\n   *\n   * @return {Promise<void>}\n   */\n  async startRecognizing() {\n    if (this._recognizer) {\n      await this._recognizer.destroy();\n    }\n\n    const subscriptionKey =\n      await this._subscriptionKeyService.acquireSubscriptionKey();\n\n    if (!subscriptionKey) {\n      return;\n    }\n\n    let inputCaptureFactories =\n      this._inputMediaDevicesService.getCaptureFactories();\n\n    // Present UIModal to start input\n    // TODO: Filter to only capturing audio\n    if (!inputCaptureFactories.length) {\n      await this.useServiceClass(\n        UIModalWidgetService\n      ).showInputMediaDevicesSelectionModal();\n    }\n\n    inputCaptureFactories =\n      this._inputMediaDevicesService.getCaptureFactories();\n\n    // FIXME: (jh) Handle more nicely?\n    // TODO: Ensure we're capturing audio\n    if (!inputCaptureFactories.length) {\n      throw new Error(\"Could not obtain input capture factories\");\n    }\n\n    // TODO; Refactor\n    const stream = inputCaptureFactories[0].getOutputMediaStream();\n\n    // TODO: If not able to instantiate based on subscription key issue, unset\n    // the key from the class property & secured local storage, and restart the\n    // subscription key acquisition process (would it be easier / better to\n    // create a separate service for subscription key handling?)\n    this._recognizer = new MesaSpeechRecognizer(stream, subscriptionKey);\n\n    this.setState({ hasRecognizer: true });\n\n    this._recognizer.registerCleanupHandler(() => {\n      // FIXME: (jh) Reset state once implemented\n      // Relevant issue: https://github.com/zenOSmosis/phantom-core/issues/112\n      this.setState({\n        hasRecognizer: false,\n        isRecognizing: false,\n        realTimeTranscription: null,\n        finalizedTranscription: null,\n      });\n    });\n\n    // Handle recognizer event binding\n    (() => {\n      this.proxyOn(this._recognizer, EVT_BEGIN_RECOGNIZE, () => {\n        this.setState({ isRecognizing: true });\n      });\n\n      this.proxyOn(this._recognizer, EVT_END_RECOGNIZE, () => {\n        this.setState({ isRecognizing: false });\n      });\n\n      this.proxyOn(this._recognizer, EVT_TRANSCRIPTION_RECOGNIZING, text => {\n        this.setState({ realTimeTranscription: text });\n      });\n\n      this.proxyOn(this._recognizer, EVT_TRANSCRIPTION_FINALIZED, text => {\n        this.setState({ finalizedTranscription: text });\n\n        // Re-emit\n        this.emit(EVT_TRANSCRIPTION_FINALIZED, text);\n      });\n    })();\n  }\n\n  /**\n   * Stops the speech recognition system.\n   *\n   * @return {Promise<void>}\n   */\n  async stopRecognizing() {\n    if (this._recognizer) {\n      await this._recognizer.destroy();\n    }\n  }\n}\n","import MesaSpeechRecognizerService, {\n  EVT_TRANSCRIPTION_FINALIZED,\n} from \"./MesaSpeechRecognizerService\";\n\nexport default MesaSpeechRecognizerService;\nexport { EVT_TRANSCRIPTION_FINALIZED };\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\n\nimport DesktopCommanderControllerService, {\n  EVT_UPDATED,\n} from \"@services/DesktopCommanderControllerService\";\n\nimport MesaSpeechRecognizerService, {\n  EVT_TRANSCRIPTION_FINALIZED,\n} from \"./MesaSpeechRecognizerService\";\n\nexport { EVT_UPDATED };\n\n// TODO: Document\n// IMPORTANT: Don't extend DesktopCommanderControllerService\nexport default class MesaSpeechDesktopControllerService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Mesa Speech Desktop Controller Service\");\n\n    this.setState({\n      // Enable by default, though is only active if speech recognition is\n      // enabled\n      isDesktopControlEnabled: true,\n    });\n\n    this._desktopControllerService = this.useServiceClass(\n      DesktopCommanderControllerService\n    );\n\n    this._speechRecognizerService = this.useServiceClass(\n      MesaSpeechRecognizerService\n    );\n\n    // Handle finalized transcription updates\n    (() => {\n      this.proxyOn(\n        this._speechRecognizerService,\n        EVT_TRANSCRIPTION_FINALIZED,\n        text => {\n          if (this.getIsDesktopControlEnabled()) {\n            this.extractCommandIntentFromText(text);\n          }\n        }\n      );\n    })();\n\n    // TODO: Tie in with speech recognizer service\n  }\n\n  /**\n   * Sets whether or not the controller should automatically interpret speech\n   * commands.\n   *\n   * @param {boolean} isDesktopControlEnabled\n   * @return {void}\n   */\n  setIsDesktopControlEnabled(isDesktopControlEnabled) {\n    this.setState({\n      isDesktopControlEnabled: Boolean(isDesktopControlEnabled),\n    });\n  }\n\n  /**\n   * Retrieves whether or not the controller should automatically interpret\n   * speech commands.\n   *\n   * @return {boolean}\n   */\n  getIsDesktopControlEnabled() {\n    // TODO: Return false if speech detection is not active\n    return this.getState().isDesktopControlEnabled;\n  }\n\n  // TODO: Document\n  // FIXME: (jh) This could be more efficient in terms of CPU usage\n  async extractCommandIntentFromText(text) {\n    // Lower-case and alpha-numeric\n    const normalizedText = text.toLowerCase().replace(/[^a-z0-9 ]/gi, \"\");\n\n    const words = normalizedText.split(\" \");\n\n    // Determine potential commands, and assign a \"strength\" rating; the higher\n    // the strength, the most likely it is the relevant command\n    const commandStrengths = Object.values(\n      this._desktopControllerService.getCommands()\n    )\n      .map(command => {\n        const matchedWords = words.filter(word =>\n          command.keywords.includes(word)\n        );\n\n        const strength = matchedWords.length;\n\n        return {\n          command,\n          strength,\n        };\n      })\n      .filter(({ strength }) => strength);\n\n    // Guess the best command, based on the highest strength rating\n    const bestMatchCommandStrength = commandStrengths.reduce((a, b) => {\n      if (!a || b.strength > a.strength) {\n        return b;\n      } else if (b.strength === a.strength) {\n        // If two strengths are the same, favor the one with the least keywords\n\n        if (b.command.keywords.length < a.command.keywords.length) {\n          return b;\n        } else {\n          return a;\n        }\n      } else {\n        return a;\n      }\n    }, null);\n\n    if (bestMatchCommandStrength) {\n      const command = bestMatchCommandStrength.command;\n\n      await this._desktopControllerService.execCommand(command);\n    }\n  }\n}\n","import Padding from \"@components/Padding\";\nimport Layout, {\n  Header,\n  Content,\n  Footer,\n  Row,\n  Column,\n} from \"@components/Layout\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport LabeledLED from \"@components/labeled/LabeledLED/LabeledLED\";\nimport ButtonGroup from \"@components/ButtonGroup\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/InputMediaDevicesApp\";\nimport { REGISTRATION_ID as KEY_VAULT_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/KeyVaultApp\";\nimport { REGISTRATION_ID as COMMAND_DEBUGGER_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/DesktopCommanderDebuggerApp\";\n\n// Local services\nimport MesaSpeechRecognizerService from \"../../services/MesaSpeechRecognizerService\";\nimport MesaSubscriptionKeyManagementService from \"../../services/MesaSubscriptionKeyManagementService\";\nimport MesaSpeechDesktopControllerService from \"../../services/MesaSpeechDesktopControllerService\";\n\n// TODO: Show input selector for which device to recognize from (if\n// there are more than one active audio input device)\n\n// TODO: Add push-to-talk support for speech recognizer?\n\nexport const REGISTRATION_ID = \"mesa-speech-recognition-debugger\";\n\nconst MesaSpeechRecognitionDebuggerApp = {\n  id: REGISTRATION_ID,\n  title: \"Mesa Speech Recognition Debugger\",\n  style: {\n    width: 640,\n    height: 320,\n  },\n  serviceClasses: [\n    MesaSpeechRecognizerService,\n    MesaSubscriptionKeyManagementService,\n    MesaSpeechDesktopControllerService,\n  ],\n  /*\n  titleBarView: function TitleBarView({ sharedState, setSharedState }) {\n  },\n  */\n  view: function View({ appServices }) {\n    const speechRecognizerService = appServices[MesaSpeechRecognizerService];\n    const hasRecognizer = speechRecognizerService.getHasRecognizer();\n    const finalizedTranscription =\n      speechRecognizerService.getFinalizedTranscription();\n    const isRecognizing = speechRecognizerService.getIsRecognizing();\n    const realTimeTranscription =\n      speechRecognizerService.getRealTimeTranscription();\n\n    const keyManagementService =\n      appServices[MesaSubscriptionKeyManagementService];\n    const hasSubscriptionKey =\n      keyManagementService.getHasCachedSubscriptionKey();\n\n    const desktopControllerService =\n      appServices[MesaSpeechDesktopControllerService];\n    const isDesktopControlEnabled =\n      desktopControllerService.getIsDesktopControlEnabled();\n\n    return (\n      <Layout>\n        <Header>\n          <Padding>\n            <button\n              onClick={() =>\n                hasRecognizer\n                  ? speechRecognizerService.stopRecognizing()\n                  : speechRecognizerService.startRecognizing()\n              }\n              style={{ backgroundColor: hasRecognizer ? \"red\" : \"green\" }}\n            >\n              {hasRecognizer ? \"Stop\" : \"Start\"} Recognizing\n            </button>\n\n            <button\n              onClick={keyManagementService.deleteCachedSubscriptionKey}\n              disabled={!hasSubscriptionKey}\n              style={{ float: \"right\", backgroundColor: \"red\" }}\n            >\n              Delete Cached Subscription Key\n            </button>\n          </Padding>\n        </Header>\n        <Content>\n          <Padding style={{ overflowY: \"auto\" }}>\n            <Row disableVerticalFill style={{ height: 80 }}>\n              <Column\n                style={{\n                  border: \"1px #999 solid\",\n                  borderRadius: 4,\n                  backgroundColor: \"rgba(0,0,0,.4)\",\n                }}\n              >\n                <Padding>\n                  <Layout>\n                    <Content>\n                      <div>{realTimeTranscription || \"N/A\"}</div>\n                    </Content>\n                    <Footer>\n                      <div\n                        style={{\n                          fontStyle: \"italic\",\n                          fontSize: \".9em\",\n                          color: \"gray\",\n                        }}\n                      >\n                        Real-time\n                      </div>\n                    </Footer>\n                  </Layout>\n                </Padding>\n              </Column>\n              <Column\n                style={{\n                  border: \"1px #999 solid\",\n                  borderRadius: 4,\n                  backgroundColor: \"rgba(0,0,0,.4)\",\n                }}\n              >\n                <Padding>\n                  <Layout>\n                    <Content>\n                      <div>{finalizedTranscription || \"N/A\"}</div>\n                    </Content>\n                    <Footer>\n                      <div\n                        style={{\n                          fontStyle: \"italic\",\n                          fontSize: \".9em\",\n                          color: \"gray\",\n                        }}\n                      >\n                        Finalized\n                      </div>\n                    </Footer>\n                  </Layout>\n                </Padding>\n              </Column>\n            </Row>\n\n            <div\n              style={{ overflow: \"auto\", textAlign: \"center\", marginTop: 20 }}\n            >\n              <Padding>\n                <Padding style={{ display: \"inline-block\" }}>\n                  <LabeledLED\n                    color={!isDesktopControlEnabled ? \"gray\" : \"green\"}\n                    label=\"Desktop Controller\"\n                  />\n                </Padding>\n\n                <Padding style={{ display: \"inline-block\" }}>\n                  <LabeledLED\n                    color={!hasSubscriptionKey ? \"gray\" : \"green\"}\n                    label=\"Subscription Key\"\n                  />\n                </Padding>\n\n                <Padding style={{ display: \"inline-block\" }}>\n                  <LabeledLED\n                    color={!hasRecognizer ? \"gray\" : \"green\"}\n                    label=\"Recognizer Engine\"\n                  />\n                </Padding>\n                <Padding style={{ display: \"inline-block\" }}>\n                  <LabeledLED\n                    color={\n                      !hasRecognizer ? \"gray\" : isRecognizing ? \"green\" : \"red\"\n                    }\n                    label=\"Speech Detection\"\n                  />\n                </Padding>\n              </Padding>\n            </div>\n          </Padding>\n        </Content>\n\n        <Footer>\n          <Padding style={{ textAlign: \"center\" }}>\n            <ButtonGroup>\n              <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n              <AppLinkButton id={KEY_VAULT_REGISTRATION_ID} />\n              <AppLinkButton id={COMMAND_DEBUGGER_REGISTRATION_ID} />\n            </ButtonGroup>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default MesaSpeechRecognitionDebuggerApp;\n","import MesaSpeechRecognitionDebuggerApp, {\n  REGISTRATION_ID,\n} from \"./MesaSpeechRecognitionDebuggerApp\";\n\nexport default MesaSpeechRecognitionDebuggerApp;\nexport { REGISTRATION_ID };\n","import Footer from \"./Footer\";\n\nexport default Footer;\n","import Padding from \"@components/Padding\";\nimport { Footer as LibFooter } from \"@components/Layout\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport ButtonGroup from \"@components/ButtonGroup\";\n\nimport { REGISTRATION_ID as MESA_SPEECH_RECOGNITION_TEST_APP_REGISTRATION_ID } from \"../../../MesaSpeechRecognitionDebuggerApp\";\n// import { REGISTRATION_ID as KEY_VAULT_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/KeyVaultApp\";\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/InputMediaDevicesApp\";\nimport { REGISTRATION_ID as COMMAND_DEBUGGER_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/DesktopCommanderDebuggerApp\";\n\nexport default function Footer() {\n  return (\n    <LibFooter>\n      <Padding style={{ textAlign: \"center\" }}>\n        <ButtonGroup>\n          <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n\n          <AppLinkButton\n            id={MESA_SPEECH_RECOGNITION_TEST_APP_REGISTRATION_ID}\n            title=\"Speech Debugger\"\n          />\n\n          <AppLinkButton\n            id={COMMAND_DEBUGGER_REGISTRATION_ID}\n            title=\"Command Debugger\"\n          />\n        </ButtonGroup>\n      </Padding>\n    </LibFooter>\n  );\n}\n","import WithoutRecognizer from \"./WithoutRecognizer\";\n\nexport default WithoutRecognizer;\n","import Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport MesaFooter from \"../../components/Footer\";\nimport Center from \"@components/Center\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { REGISTRATION_ID as KEY_VAULT_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/KeyVaultApp\";\n\nexport default function WithoutRecognizer({\n  speechRecognizerService,\n  hasCachedSubscriptionKey,\n  subscriptionKeyManagementService,\n}) {\n  return (\n    <Layout>\n      <Content>\n        <Padding>\n          <Layout>\n            <Content>\n              <Full style={{ overflowY: \"auto\" }}>\n                <Padding>\n                  <Padding\n                    style={{\n                      textAlign: \"center\",\n                      borderRadius: 4,\n                      backgroundColor: \"rgba(255, 255, 255, 0.1)\",\n                      border: \"1px rgba(255, 255, 255, 0.2) solid\",\n                    }}\n                  >\n                    <Center canOverflow={true}>\n                      <div>\n                        <button\n                          onClick={speechRecognizerService.startRecognizing}\n                          style={{\n                            // TODO: Use color variable for highlighted elements\n                            backgroundColor: \"#347fe8\",\n                          }}\n                        >\n                          Enable Speech Recognition\n                        </button>{\" \"}\n                        in order to control ReShell's desktop.\n                      </div>\n\n                      <hr style={{ width: \"90%\", marginTop: 20 }} />\n\n                      {!hasCachedSubscriptionKey ? (\n                        <>\n                          <p>\n                            You will be prompted to enter a Microsoft Azure\n                            Subscription Key in order to use this functionality.\n                          </p>\n                          <p>\n                            The Azure Subscription Key will be stored in local\n                            storage, accessible via the{\" \"}\n                            <AppLinkButton id={KEY_VAULT_REGISTRATION_ID} />.\n                          </p>\n                        </>\n                      ) : (\n                        <>\n                          <p style={{ fontWeight: \"bold\" }}>\n                            There is a cached Azure Subscription Key in local\n                            storage.\n                          </p>\n\n                          <p>\n                            <button\n                              onClick={\n                                subscriptionKeyManagementService.deleteCachedSubscriptionKey\n                              }\n                              style={{ backgroundColor: \"red\" }}\n                              disabled={!hasCachedSubscriptionKey}\n                            >\n                              Delete Cached Subscription Key\n                            </button>{\" \"}\n                            or open{\" \"}\n                            <AppLinkButton id={KEY_VAULT_REGISTRATION_ID} /> to\n                            manage your keys.\n                          </p>\n                        </>\n                      )}\n                    </Center>\n                  </Padding>\n                </Padding>\n              </Full>\n            </Content>\n            <Footer>\n              <Center></Center>\n            </Footer>\n          </Layout>\n        </Padding>\n      </Content>\n      <MesaFooter />\n    </Layout>\n  );\n}\n","import SpeechCommanderApp, { REGISTRATION_ID } from \"./SpeechCommanderApp\";\n\nexport default SpeechCommanderApp;\nexport { REGISTRATION_ID };\n","import Padding from \"@components/Padding\";\nimport Layout, { Header, Content } from \"@components/Layout\";\nimport MesaFooter from \"./components/Footer\";\nimport LabeledToggle from \"@components/labeled/LabeledToggle\";\nimport LabeledLED from \"@components/labeled/LabeledLED/LabeledLED\";\n\n// Local services\nimport MesaSpeechDesktopControllerService from \"../../services/MesaSpeechDesktopControllerService\";\nimport MesaSpeechRecognizerService from \"../../services/MesaSpeechRecognizerService\";\nimport MesaSubscriptionKeyManagementService from \"../../services/MesaSubscriptionKeyManagementService\";\n\nimport WithoutRecognizer from \"./views/WithoutRecognizer\";\n\nexport const REGISTRATION_ID = \"speech-commander\";\n\nconst SpeechCommanderApp = {\n  id: REGISTRATION_ID,\n  title: \"Speech Commander\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  isAutoStart: true,\n  serviceClasses: [\n    MesaSpeechDesktopControllerService,\n    MesaSpeechRecognizerService,\n    MesaSubscriptionKeyManagementService,\n  ],\n\n  titleBarView: function TitleBarView({ appServices }) {\n    const speechRecognizerService = appServices[MesaSpeechRecognizerService];\n    const hasRecognizer = speechRecognizerService.getHasRecognizer();\n    const isRecognizing = speechRecognizerService.getIsRecognizing();\n\n    const desktopControllerService =\n      appServices[MesaSpeechDesktopControllerService];\n    const isDesktopControlEnabled =\n      desktopControllerService.getIsDesktopControlEnabled();\n\n    return (\n      <div>\n        <LabeledToggle\n          masterLabel=\"Speech Recognition\"\n          isOn={hasRecognizer}\n          onChange={isActive => {\n            isActive\n              ? speechRecognizerService.startRecognizing()\n              : speechRecognizerService.stopRecognizing();\n          }}\n        />\n\n        <LabeledLED\n          color={!hasRecognizer ? \"gray\" : isRecognizing ? \"green\" : \"red\"}\n          style={{\n            marginLeft: 10,\n            // FIXME: (jh) Make all \"labeled\" components vertically aligned to\n            // bottom?\n            verticalAlign: \"bottom\",\n          }}\n          label=\"Talk Detection\"\n        />\n\n        <LabeledLED\n          color={\n            !hasRecognizer ? \"gray\" : isDesktopControlEnabled ? \"green\" : \"red\"\n          }\n          style={{\n            marginLeft: 10,\n            // FIXME: (jh) Make all \"labeled\" components vertically aligned to\n            // bottom?\n            verticalAlign: \"bottom\",\n          }}\n          label=\"Desktop Control\"\n        />\n      </div>\n    );\n  },\n\n  view: function View({ appServices, sharedState, setSharedState }) {\n    const subscriptionKeyManagementService =\n      appServices[MesaSubscriptionKeyManagementService];\n    const hasCachedSubscriptionKey =\n      subscriptionKeyManagementService.getHasCachedSubscriptionKey();\n\n    const speechRecognizerService = appServices[MesaSpeechRecognizerService];\n    const hasRecognizer = speechRecognizerService.getHasRecognizer();\n    // const finalizedTranscription =\n    speechRecognizerService.getFinalizedTranscription();\n    // const isRecognizing = speechRecognizerService.getIsRecognizing();\n\n    const desktopControllerService =\n      appServices[MesaSpeechDesktopControllerService];\n\n    // TODO: Use correct service\n    /*\n    const isDesktopControlEnabled =\n      desktopControllerService.getIsDesktopControlEnabled();\n    const lastCommand = desktopControllerService.getLastCommand();\n    */\n\n    if (!hasRecognizer) {\n      return (\n        <WithoutRecognizer\n          speechRecognizerService={speechRecognizerService}\n          hasCachedSubscriptionKey={hasCachedSubscriptionKey}\n          subscriptionKeyManagementService={subscriptionKeyManagementService}\n        />\n      );\n    } else {\n      return (\n        <Layout>\n          <Header>\n            <Padding style={{ textAlign: \"center\" }}>\n              <p>\n                Enable Desktop Speech Control to control ReShell with your\n                speech.\n              </p>\n              <LabeledToggle\n                isOn={desktopControllerService.getIsDesktopControlEnabled()}\n                onChange={desktopControllerService.setIsDesktopControlEnabled}\n                masterLabel=\"Desktop Speech Control\"\n              />\n            </Padding>\n          </Header>\n          <Content>\n            <Padding>\n              {/*\n                <p>TODO: Implement \"What can I say?\" feature</p>\n                <p>TODO: Show capture status</p>\n\n                <p>\n                  Last command: {lastCommand ? lastCommand.description : \"N/A\"}\n                </p>\n                */}\n            </Padding>\n          </Content>\n          <MesaFooter />\n        </Layout>\n      );\n    }\n  },\n};\n\nexport default SpeechCommanderApp;\n","import ReShellOrg from \"./ReShell.org\";\n\nexport default ReShellOrg;\n","import Desktop from \"@components/Desktop\";\n\nimport ApplicationsApp from \"./apps/ApplicationsApp\";\nimport ApplicationMonitorApp from \"../ExamplePortal/apps/ApplicationMonitorApp\";\nimport AboutReShellApp from \"./apps/AboutReShellApp\";\nimport CheckForUpdatesApp from \"../ExamplePortal/apps/CheckForUpdatesApp\";\nimport ColorAdjusterApp from \"../ExamplePortal/apps/ColorAdjusterApp\";\nimport EnvironmentApp from \"../ExamplePortal/apps/EnvironmentApp\";\nimport ServiceMonitorApp from \"../ExamplePortal/apps/ServiceMonitorApp\";\nimport SoftwareInfoApp from \"../ExamplePortal/apps/SoftwareInfoApp\";\nimport InputMediaDevicesApp from \"../ExamplePortal/apps/InputMediaDevicesApp\";\nimport ScreenCaptureApp from \"../ExamplePortal/apps/ScreenCaptureApp\";\nimport VUMeterApp from \"../ExamplePortal/apps/VUMeterApp\";\nimport MemoryInfoApp from \"../ExamplePortal/apps/MemoryInfoApp\";\nimport KeyVaultApp from \"../ExamplePortal/apps/KeyVaultApp\";\nimport AppRegistrationViewerApp from \"../ExamplePortal/apps/AppRegistrationViewerApp\";\n\n// Mesa Hackathon apps\nimport MesaSpeechRecognitionDebuggerApp from \"../HackathonPortal/apps/MesaSpeechRecognitionDebuggerApp\";\nimport SpeechCommanderApp from \"../HackathonPortal/apps/SpeechCommanderApp\";\nimport DesktopCommanderDebuggerApp from \"../ExamplePortal/apps/DesktopCommanderDebuggerApp\";\n\nexport default function ReShellOrgPortal() {\n  return (\n    <Desktop\n      appDescriptors={[\n        ApplicationsApp,\n        ApplicationMonitorApp,\n        AboutReShellApp,\n        CheckForUpdatesApp,\n        ColorAdjusterApp,\n        EnvironmentApp,\n        InputMediaDevicesApp,\n        MemoryInfoApp,\n        ScreenCaptureApp,\n        ServiceMonitorApp,\n        SoftwareInfoApp,\n        VUMeterApp,\n        KeyVaultApp,\n        AppRegistrationViewerApp,\n        //\n        MesaSpeechRecognitionDebuggerApp,\n        SpeechCommanderApp,\n        DesktopCommanderDebuggerApp,\n      ]}\n    />\n  );\n}\n"],"sourceRoot":""}