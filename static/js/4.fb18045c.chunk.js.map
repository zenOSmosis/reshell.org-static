{"version":3,"sources":["components/Layout/Layout.module.css","components/Window/Window.module.css","components/StackingContext/StackingContext.module.css","components/Full/Full.module.css","components/Cover/Cover.module.css","components/Layout/RowColumn/RowColumn.module.css","components/NoWrap/NoWrap.module.css","components/LED/LED.module.css","components/AutoScaler/AutoScaler.module.css","components/Padding/Padding.module.css","components/Animation/Animation.module.css","components/ButtonTransparent/ButtonTransparent.module.css","components/Notification/Notification.module.css","components/Notification/NotificationsStack/NotificationsStack.module.css","components/VirtualLink/VirtualLink.module.css","components/Center/Center.module.css","portals/ExamplePortal/apps/ColorAdjuster/ColorAdjuster.module.css","components/ObjectViewer/ObjectViewer.module.css","components/audioMeters/AudioLevelMeter/AudioLevelMeter.module.css","components/StaggeredWaveLoading/StaggeredWaveLoading.module.css","components/audioMeters/VUMeter/VUMeter.module.css","components/audioVideoRenderers/Video.module.css","hooks/useDesktopContext.js","hooks/useAppRuntimesContext.js","components/WindowManager/WindowManager.RouteProvider.jsx","components/StackingContext/index.jsx","components/StackingContext/StackingContext.jsx","components/Full/index.jsx","components/Full/Full.jsx","components/Cover/index.jsx","components/Cover/Cover.jsx","components/Window/classes/WindowController.js","components/Layout/Header.jsx","components/Layout/Content.jsx","components/Layout/Footer.jsx","components/Layout/RowColumn/RowColumn.jsx","components/Layout/index.jsx","components/Layout/Layout.jsx","components/Window/Window.Border.jsx","components/NoWrap/index.jsx","components/NoWrap/NoWrap.jsx","components/Window/Window.Titlebar/Window.Titlebar.Button/Window.Titlebar.Button.jsx","components/Window/Window.Titlebar/index.jsx","components/Window/Window.Titlebar/Window.Titlebar.jsx","utils/getElCenterPoint.js","utils/getElSize.js","hooks/useAnimation.js","components/Window/Window.View.jsx","components/Window/hooks/useWindowOpenAnimation.js","components/Window/hooks/useWindowAutoPositioner.js","components/Window/hooks/useWindowControls.js","components/Window/hooks/useWindowDragger.js","components/Window/hooks/useWindowDragResizer.js","components/Window/hooks/useWindowStyles.js","components/Window/index.jsx","components/Window/Window.jsx","components/Window/Window.Provider.jsx","hooks/useObjectState.js","hooks/useServicesContext.js","hooks/useAppRegistrationsContext.js","components/WindowManager/WindowManager.jsx","components/Window/hooks/useWindowContext.js","components/WindowManager/hooks/useRegistrationViewOnResized.js","components/WindowManager/index.jsx","components/LED/index.jsx","components/LED/LED.jsx","components/Dock/index.jsx","components/Dock/Dock.jsx","components/AutoScaler/AutoScaler.jsx","components/AutoScaler/index.jsx","components/_Menu.LibWrapper/index.jsx","hooks/useAppRegistrationLink.js","components/Padding/index.jsx","components/Padding/Padding.jsx","components/Timer/index.jsx","components/Timer/Timer.jsx","portals/ExamplePortal/apps/ServiceMonitor.jsx","hooks/usePreload.js","components/Animation/index.jsx","components/Animation/Animation.jsx","components/ButtonTransparent/ButtonTransparent.jsx","components/ButtonTransparent/index.jsx","components/Notification/Notification.jsx","components/Notification/NotificationsStack/index.jsx","components/Notification/NotificationsStack/NotificationsStack.jsx","components/Desktop/providers/NotificationsProvider.jsx","components/Desktop/index.jsx","components/Desktop/Desktop.jsx","components/VirtualLink/index.jsx","components/VirtualLink/VirtualLink.jsx","hooks/useOverflowDetection.js","components/Center/index.jsx","components/Center/Center.jsx","utils/consume.js","portals/ExamplePortal/apps/Applications/views/ApplicationSelector.jsx","portals/ExamplePortal/apps/Applications/views/PortalSelector.jsx","portals/ExamplePortal/apps/Applications/Applications.jsx","portals/ExamplePortal/apps/Applications/index.jsx","portals/ReShell.org/apps/Applications.jsx","portals/ExamplePortal/apps/ApplicationMonitor/AppRuntime.Table.Row.jsx","portals/ExamplePortal/apps/ApplicationMonitor/AppRuntime.Table.jsx","portals/ExamplePortal/apps/ApplicationMonitor/ApplicationMonitor.jsx","portals/ExamplePortal/apps/ApplicationMonitor/index.jsx","components/ButtonPanel/index.jsx","components/ButtonPanel/ButtonPanel.jsx","components/ExternalLink/index.jsx","components/ExternalLink/ExternalLink.jsx","components/VirtualLinkButton/index.jsx","components/VirtualLinkButton/VirtualLinkButton.jsx","components/ExternalLinkButton/index.jsx","components/ExternalLinkButton/ExternalLinkButton.jsx","portals/ExamplePortal/apps/AboutReShell/views/Details/Details.jsx","portals/ExamplePortal/apps/AboutReShell/views/Details/index.jsx","portals/ExamplePortal/apps/AboutReShell/views/Resources/Resources.jsx","portals/ExamplePortal/apps/AboutReShell/views/Resources/index.jsx","utils/getCopyright.js","portals/ExamplePortal/apps/AboutReShell/AboutReShell.jsx","portals/ExamplePortal/apps/AboutReShell/index.jsx","portals/ReShell.org/apps/AboutReShell.jsx","portals/ExamplePortal/apps/CheckForUpdates/CheckForUpdates.jsx","portals/ExamplePortal/apps/CheckForUpdates/index.jsx","portals/ExamplePortal/apps/ColorAdjuster/index.jsx","portals/ExamplePortal/apps/ColorAdjuster/ColorAdjuster.jsx","components/ObjectViewer/index.jsx","components/ObjectViewer/ObjectViewer.jsx","portals/ExamplePortal/apps/Environment/Environment.jsx","portals/ExamplePortal/apps/Environment/index.jsx","components/AppLinkButton/index.jsx","components/AppLinkButton/AppLinkButton.jsx","portals/ExamplePortal/apps/SoftwareInfo/SoftwareInfo.jsx","portals/ExamplePortal/apps/SoftwareInfo/index.jsx","services/MediaDevicesService.js","components/audioMeters/AudioLevelMeter/AudioLevelMeter.jsx","hooks/useArrayDiff.js","hooks/usePrevious.js","hooks/useAudioMediaStreamTrackLevelMonitor.js","components/audioMeters/AudioLevelMeter/AudioMediaStreamTrackLevelMeter.jsx","components/audioMeters/AudioLevelMeter/index.jsx","components/StaggeredWaveLoading/index.jsx","components/StaggeredWaveLoading/StaggeredWaveLoading.jsx","components/Preload/index.jsx","components/Preload/Preload.jsx","components/audioMeters/VUMeter/images/vu.png","components/audioMeters/VUMeter/images/needle.png","components/audioMeters/VUMeter/VUMeter.jsx","components/audioMeters/VUMeter/AudioMediaStreamTrackLevelVUMeter.jsx","components/audioMeters/VUMeter/index.jsx","portals/ExamplePortal/apps/VUMeter/VUMeter.jsx","portals/ExamplePortal/apps/VUMeter/index.jsx","components/audioVideoRenderers/AVBase.jsx","components/audioVideoRenderers/Video.jsx","services/ScreenCapturerService.js","portals/ExamplePortal/apps/ScreenCapture/ScreenCapture.jsx","portals/ExamplePortal/apps/ScreenCapture/index.jsx","hooks/useGetIsUnmounting.js","portals/ExamplePortal/apps/InputMediaDevices/InputMediaDevices.jsx","portals/ExamplePortal/apps/InputMediaDevices/index.jsx","utils/bytesToSize.js","portals/ExamplePortal/apps/MemoryInfo/MemoryInfo.jsx","portals/ExamplePortal/apps/KeyVault/views/LocalStorageItems/index.jsx","portals/ExamplePortal/apps/KeyVault/views/LocalStorageItems/LocalStorageItems.jsx","utils/getFormValues.js","components/Form/index.jsx","components/Form/Form.jsx","components/Form/hooks/useFormController.js","portals/ExamplePortal/apps/KeyVault/views/KeyEditorForm.jsx","components/icons/BackArrowIcon/index.jsx","components/icons/BackArrowIcon/DynamicIcon.jsx","portals/ExamplePortal/apps/KeyVault/index.jsx","portals/ExamplePortal/apps/KeyVault/KeyVault.jsx","portals/ReShell.org/index.jsx","portals/ReShell.org/ReShell.org.jsx"],"names":["module","exports","useDesktopContext","useContext","DesktopContext","useAppRuntimesContext","AppRuntimesContext","WindowManagerRouteContext","React","createContext","WindowManagerRouteProvider","children","location","useLocation","getAppRuntimesWithRegistrationID","useState","locationAppRuntimes","setLocationAppRuntimes","useEffect","locationRegistrationID","pathname","substring","desktopContextActiveWindowController","activeWindowController","activeRegistrationID","getAppRuntime","getRegistrationID","history","useHistory","push","Provider","value","StackingContext","className","isAccelerated","onMount","onDOMMatrix","rest","refOnMount","useRef","refOnDOMMatrix","refIsAccelerated","refEl","el","current","setTimeout","computedStyle","window","getComputedStyle","matrix","DOMMatrix","transform","is2D","console","warn","ref","classNames","styles","Full","render","this","props","Component","Cover","forwardRef","forwardedRef","isVisible","EVT_RENDER_PROFILED","EVT_RESIZED","WindowController","initialState","onBringToTop","DEFAULT_STATE","isMaximized","isMinimized","title","getTitle","_state","Object","seal","deepMerge","_appRuntime","_windowEl","_windowManagerEl","_handleBringToTop","_emitDebouncedResized","debounce","bind","_emitDebouncedMoved","_centerHandler","_scatterHandler","a","clear","destroy","__INTERNAL__setCenterHandler","centerHandler","center","__INTERNAL__setScatterHandler","scatterHandler","scatter","bringToTop","captureRenderProfile","arrRenderProfile","emit","attachWindowElement","attachWindowManagerElement","setAppRuntime","appRuntime","setTitle","getAppRegistration","runtime","getRegistration","setSize","width","height","windowEl","requestAnimationFrame","undefined","style","getSize","offsetWidth","offsetHeight","getWindowManagerSize","windowManagerEl","parseInt","setPosition","x","y","left","right","top","bottom","getPosition","offsetLeft","offsetTop","getIsBorderDisabled","getIsMaximized","getIsMinimized","setState","partialNextState","TypeError","EVT_UPDATED","getState","setIsMaximized","maximize","setIsMinimized","minimize","restore","PhantomCore","Header","Content","Footer","Row","Column","Layout","DIR_BORDER_SE","DIR_BORDER_SW","NoWrap","WindowTitlebarMaximizeButton","WindowTitlebarButton","WindowTitlebarMinimizeButton","WindowTitlebarCloseButton","WindowTitlebar","onElTitlebar","onRestoreOrMaximize","onMinimize","onClose","TitleBarView","titleBarView","onDoubleClick","onClick","getElCenterPoint","getElSize","useAnimation","domElement","animationName","animationDuration","animationDelay","onAnimationEnd","animationEngine","isDisabled","shouldRun","refOnAnimationEnd","classes","classList","visibility","BASE","contains","add","Error","addEventListener","unmount","removeEventListener","WindowView","elWindowManager","windowController","isActive","isProfiling","_setEl","isOpenAnimationEnded","useWindowOpenAnimation","_setIsOpenAnimationEnded","Boolean","useWindowAutoPositioner","elWindow","onInitialAutoPosition","refOnInitialAutoPosition","handleCenter","useCallback","winManCenter","winSize","handleScatter","winManSize","Math","floor","random","appRuntimes","refInitialAppRuntimes","length","elTitlebar","_setElTitlebar","zIndex","_setZIndex","_setTitle","isWindowBorderDisabled","_setIsWindowBorderDisabled","refIsWindowBorderDisabled","_setIsMaximized","_setIsMinimized","_handleWindowControllerUpdate","updatedState","stackingIndex","shouldWindowBorderBeDisabled","on","off","useWindowControls","useWindowDragger","refInitialDragPosition","refInitialWindowManagerSize","isUserDragging","setIsUserDragging","useDrag","isDragging","down","movement","mx","my","xy","event","target","tagName","toUpperCase","initialWindowManagerWidth","initialWindowManagerHeight","dragBind","useWindowDragResizer","refInitialDragSizePosition","isUserResizing","setIsUserResizing","direction","windowManagerWidth","windowManagerHeight","ReferenceError","diffX","diffY","handleBorderDrag","DynamicProfilingWrapper","useMemo","args","Profiler","id","getUUID","onRender","renderProfile","Fragment","useWindowStyles","outerBorderStyle","windowStyle","backgroundColor","bodyStyle","padding","Border","onBorderDrag","WindowBorder","borderWidth","bindNW","bindN","bindNE","bindE","bindSE","bindS","bindSW","bindW","maxHeight","maxWidth","cursor","Window","attachWindowController","useImperativeHandle","WindowContext","WindowProvider","initialSharedState","useObjectState","defaultState","state","_setMergedState","refState","JSON","parse","err","error","prevState","sharedState","setSharedState","useServicesContext","UIServicesContext","useAppRegistrationsContext","AppRegistrationsContext","WindowManagerView","appDescriptors","addOrUpdateAppRegistration","elBase","setElBase","forEach","descriptor","setDesktopContextActiveWindowController","setActiveWindowController","windowControllerMaps","setWindowControllerMaps","getWindowControllerMapWithKey","key","refDesktopContextActiveWindowController","handleSetActiveWindow","is","handleGetIsActiveWindow","startService","refHandleSetActiveWindow","_handleElBaseTouch","evt","passive","windows","map","getAppDescriptor","ViewComponent","view","serviceClasses","windowProps","isPinned","isPinnedToDock","isAutoStart","dataMap","appServices","serviceClass","service","onMouseDown","onTouchStart","setWindowController","prev","next","once","EVT_DESTROYED","filter","position","WrappedTitleBarView","WrappedView","forceUpdate","useForceUpdate","useWindowContext","_handleServiceUpdate","values","setResizeHandler","useRegistrationViewOnResized","refSetResizeHandler","handleResized","_handleExecResizedCallback","onResized","WindowManager","LED","color","Dock","runningRegistrations","bringToFrontOrStartAppRuntime","appRegistrations","dockRegistrations","Set","registration","getIsPinnedToDock","activeRegistration","textAlign","isolation","display","whiteSpace","overflowX","ResizeObserver","install","AutoScaler","elOuterWrap","setElOuterWrap","elInnerWrap","setElInnerWrap","outerWrapSize","innerWrapSize","ro","entries","entry","size","maxScaleX","maxScaleY","scale","min","observe","unobserve","COMMON_PROPS","overflow","Menu","applyHOC","portal","LibMenu","SubMenu","applyStatics","LibSubMenu","useAppRegistrationLink","appDescriptorID","getAppRegistrationTitle","switchToAppRegistrationID","link","Padding","setEl","hasSiblings","setHasSiblings","parentNode","Timer","secs","onTick","seconds","_setSeconds","getSeconds","handleUpdate","updateInterval","setInterval","clearInterval","Date","toISOString","substr","REGISTRATION_ID","ServiceMonitor","View","services","overflowY","getInstanceUptime","log","usePreload","resources","isPreloaded","_setIsPreloaded","progress","_setProgress","refResources","preload","Preload","onprogress","oncomplete","fetch","Animation","preloadResources","tag","inline","disabled","_setDomElement","ButtonTransparent","Notification","body","image","uuid","autoCloseTime","isClosing","setIsClosing","refOnClose","handleClose","stopPropagation","autoCloseTimeout","startTimeout","stopTimeout","Image","alt","src","MessageButton","onTouchEnd","onMouseUp","NotificationsStack","notifications","onNotificationClose","NotificationsContext","NotificationsProvider","activeNotificationsStack","setActiveNotificationsStack","showNotification","uuidv4","handleNotificationClose","prevUUID","isKept","Desktop","backgroundView","openServiceMonitor","SERVICE_MONITOR_REGISTRATION_ID","menuButton","label","sort","b","aTitle","bTitle","app","getIsPinned","getWindowController","confirm","ReShellCore","reload","fontWeight","fontStyle","fontSize","getPhantomCoreVersion","getPortalName","process","VirtualLink","Center","canOverflow","innerEl","setInnerEl","isOverflown","useOverflowDetection","element","isDetecting","refPrevIsOverflown","getIsOverflown","innerOffsetHeight","innerOffsetWidth","outerHeight","clientHeight","outerWidth","clientWidth","setIsOverflown","_isUnmounting","checkIsOverflown","prevIsOverflown","nextIsOverflown","consume","obj","ApplicationSelector","searchQuery","onResetSearchQuery","startAppRuntime","appRuntimeRegistrations","filteredRegistrations","includes","totalInstances","predicate","borderColor","Array","nonUsed","idx","margin","PortalSwitcher","getPortals","portalName","switchToPortal","LEN_PORTALS","keys","Applications","handleSetSearchQuery","handleDoubleClick","placeholder","onChange","isDisplayingPortals","setIsDisplayingPortals","handleResetSearchQuery","ApplicationsOverride","AppRuntimeTableRow","isTopMostWindowController","elProfilerPhase","setElProfilerPhase","elProfilerActualDuration","setElProfilerActualDuration","elProfilerBaseDuration","setElProfilerBaseDuration","elProfilerStartTime","setElProfilerStartTime","elProfilerCommitTime","setElProfilerCommitTime","elProfilerInteractions","setElProfilerInteractions","handleRenderProfile","phase","actualDuration","baseDuration","startTime","commitTime","interactions","innerHTML","parseFloat","toFixed","colSpan","environment","getEnvironment","AppRuntimeTable","rowSpan","ApplicationMonitor","getUptime","ButtonPanel","buttons","selectedIdx","button","isSelected","setSelectedIdx","refRenderIdx","content","ExternalLink","VirtualLinkButton","ExternalLinkButton","href","open","LINKS","LINK_BUTTON_STYLE","minHeight","Details","rel","gridTemplateColumns","urlOrAction","zenOSmosis","GitHub","Resources","name","url","FULL_YEAR","getFullYear","AboutReShell","screen","opacity","AboutReShellOverride","CheckForUpdates","isLatest","setIsLatest","isChecking","setIsChecking","isError","setIsError","lastCheckTime","setLastCheckTime","refIsChecking","handleCheckForUpdates","fetchIsLatestVersion","getTime","dayjs","format","ColorAdjuster","isGrayscale","setIsGrayscale","document","remove","borderRadius","ObjectViewer","theme","Environment","AppLinkButton","registrationTitle","packageJson","require","SoftwareInfo","float","version","CHECK_FOR_UPDATES_REGISTRATION_ID","ENVIRONMENT_REGISTRATION_ID","MediaDeviceFactoryCollection","PhantomCollection","MediaDevicesService","fetchAudioInputDevices","bindCollectionClass","isAggressive","utils","fetchMediaDevices","then","filterAudioInputDevices","devices","catch","getMediaDevices","getCaptureFactories","getCollectionInstance","getChildren","getIsAudioMediaDeviceBeingCaptured","mediaDeviceInfo","MediaStreamTrackControllerFactory","getFactoriesWithInputMediaDevice","constraints","factoryOptions","captureMediaDevice","factory","addChild","captureSpecificMediaDevice","uncaptureSpecificMediaDevice","UIServiceCore","AudioLevelMeter","percent","percents","renderedLevels","level","clipPath","WebkitClipPath","useArrayDiff","usePrevious","defaultPreviousValue","refPrev","added","removed","addedRemoved","_setAddedRemoved","isArray","getChildrenDiff","EVT_DEBOUNCED_PEAK_AUDIO_LEVEL_TICK","MultiAudioMediaStreamTrackLevelMonitorEvents","useAudioMediaStreamTrackLevelMonitor","mediaStreamTrackOrTracks","mediaStreamTracks","track","MediaStreamTrack","kind","mediaStreamMonitor","_setMediaStreamMonitor","_setPercent","MultiAudioMediaStreamTrackLevelMonitor","rms","addedMediaStreamTracks","removedMediaStreamTracks","addMediaStreamTrack","removeMediaStreamTrack","AudioMediaStreamTrackLevelMeter","mediaStreamTrack","StaggeredWaveLoading","onError","VUMeter","vu","setVu","needle","setNeedle","backgroundImage","vuBackground","backgroundPosition","backgroundRepeat","vuNeedle","AudioMediaStreamTrackLevelVUMeter","mds","captureFactories","isCapturing","getAudioTrackControllers","controller","getOutputMediaStreamTrack","flat","marginLeft","captureDefaultAudioInputDevice","INPUT_MEDIA_DEVICES_REGISTRATION_ID","AVBase","mediaType","onEl","mediaStream","MediaStream","srcObject","play","muted","refOnEl","createElement","autoPlay","playsInline","controls","Video","ScreenCaptureFactoryCollection","ScreenCapturerService","captureScreen","getMediaStreamTracks","getTrackControllers","ScreenCapture","scs","screenCaptureFactory","setScreenCaptureFactory","getIsUnmounting","useGetIsUnmounting","refIsUnmounting","handleStartScreenCapture","startScreenCapture","videoTrack","getVideoTrackControllers","getOutputTrack","border","InputMediaDevices","mediaDevices","device","uncaptureSpecificAudioInputDevice","captureSpecificAudioInputDevice","VU_METER_REGISTRATION_ID","SCREEN_CAPTURE_REGISTRATION_ID","bytesToSize","bytes","sizes","i","abs","MemoryInfo","jsHeapSizeLimit","totalJSHeapSize","usedJSHeapSize","_setMemoryInfo","fetchMemoryInfo","performance","memory","memoryInfo","refetchInterval","LocalStorageItems","keyStorageEngineMaps","onGetValue","onEmpty","onNewItem","keyMap","storageEngine","type","getFormValues","formElement","elements","Form","onSubmit","autoComplete","useFormController","validator","setFormRef","isValid","setIsValid","errors","setErrors","validate","formValues","hasErrors","fromEntries","handleFormChange","handleFormSubmit","preventDefault","KeyEditorForm","initialKey","initialValue","initialStorageEngine","storageEngines","defaultValue","required","marginTop","getShortUUID","shortUUID","DynamicIcon","propsRest","KeyVault","KeyVaultService","localDataPersistenceService","setKeyStorageEngineMaps","handleFetchKeyStorageEngineMaps","fetchKeyStorageEngineMaps","keyMaps","fetchItem","isCreatingNewKey","setIsCreatingNewKey","handleGetValue","alert","handleKeyValueSubmit","getStorageEngineWithShortUUID","setItem","handleEmpty","clearAllStorageEngines","BackArrowIcon","getStorageEngines","ReShellOrg","ReShellOrgPortal"],"mappings":"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","file":"static/js/4.fb18045c.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"layout\":\"Layout_layout__3PvPc\",\"header\":\"Layout_header__3EItT\",\"content\":\"Layout_content__1t8Hf\",\"footer\":\"Layout_footer__3EMQb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"window-outer-border\":\"Window_window-outer-border__3TebC\",\"hidden\":\"Window_hidden__3nppO\",\"maximized\":\"Window_maximized__1kLcW\",\"minimized\":\"Window_minimized__10t2-\",\"dragging\":\"Window_dragging__2Ctk1\",\"window\":\"Window_window__uDx5P\",\"active\":\"Window_active__eAyll\",\"titlebar\":\"Window_titlebar__yB8Zx\",\"title\":\"Window_title__3FnAS\",\"window-controls\":\"Window_window-controls__1ACD5\",\"maximize\":\"Window_maximize__2aW7z\",\"minimize\":\"Window_minimize__hemKn\",\"close\":\"Window_close__38hm-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"stacking-context\":\"StackingContext_stacking-context__3KDjJ\",\"accelerated\":\"StackingContext_accelerated__E4pfU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"full\":\"Full_full__3xUwm\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cover\":\"Cover_cover__3qNO7\",\"no-display\":\"Cover_no-display__vixgE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"RowColumn_row__2MIpa\",\"column\":\"RowColumn_column__3aAA3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"no-wrap\":\"NoWrap_no-wrap__2b0bc\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"led\":\"LED_led__1cyGI\",\"gray\":\"LED_gray__3hMZV\",\"grey\":\"LED_grey__1_Ool\",\"red\":\"LED_red__2O1gd\",\"orange\":\"LED_orange__1Asac\",\"yellow\":\"LED_yellow__H5_0O\",\"green\":\"LED_green__5BS9Y\",\"blue\":\"LED_blue__fOsqG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"auto-scaler\":\"AutoScaler_auto-scaler__zdzsp\",\"content-wrap\":\"AutoScaler_content-wrap__2tFDr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"padding\":\"Padding_padding__3cEtV\",\"no-siblings\":\"Padding_no-siblings__1nLrM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"animation\":\"Animation_animation__1HH_d\",\"inline\":\"Animation_inline__3Lb1U\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button-transparent\":\"ButtonTransparent_button-transparent__nu1PF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notification\":\"Notification_notification__1C7Ma\",\"main-image-wrap\":\"Notification_main-image-wrap__30_l1\",\"main-image\":\"Notification_main-image__fpW0x\",\"main-button\":\"Notification_main-button__3XiPY\",\"body-outer-wrap\":\"Notification_body-outer-wrap__2RNF3\",\"body-inner-wrap\":\"Notification_body-inner-wrap__2Kjzr\",\"body\":\"Notification_body__1iO2i\",\"title\":\"Notification_title__3IJtT\",\"close-button\":\"Notification_close-button__3j56e\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notifications-stack\":\"NotificationsStack_notifications-stack__1ecNs\",\"inner-wrap\":\"NotificationsStack_inner-wrap__2pUR5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"virtual-link\":\"VirtualLink_virtual-link__76t27\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"center\":\"Center_center__PZFg8\",\"inner-wrap\":\"Center_inner-wrap__2OIMV\",\"overflown\":\"Center_overflown__LMy0-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-adjuster\":\"ColorAdjuster_color-adjuster__J_S1V\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"object-viewer\":\"ObjectViewer_object-viewer__8k3ak\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"levels\":\"AudioLevelMeter_levels__3baNN\",\"level-container\":\"AudioLevelMeter_level-container__12piT\",\"level\":\"AudioLevelMeter_level__2fRqJ\",\"level-animation\":\"AudioLevelMeter_level-animation__251Dc\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-wrapper\":\"StaggeredWaveLoading_loading-wrapper__35kvv\",\"loading\":\"StaggeredWaveLoading_loading__9ah1x\",\"dot\":\"StaggeredWaveLoading_dot__1cWhz\",\"wave\":\"StaggeredWaveLoading_wave__Du7Gv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"vu\":\"VUMeter_vu__Xlt7R\",\"mask\":\"VUMeter_mask__2OXhL\",\"needle\":\"VUMeter_needle__AmMsB\",\"vu-label\":\"VUMeter_vu-label__3kDDJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"video\":\"Video_video__2GgL9\"};","import { useContext } from \"react\";\nimport { DesktopContext } from \"../core/BaseView/providers/DesktopProvider\";\n\nexport default function useDesktopContext() {\n  return useContext(DesktopContext);\n}\n","import { useContext } from \"react\";\nimport { AppRuntimesContext } from \"@core/BaseView/providers/AppRuntimesProvider\";\n\n// TODO: Move to @core/hooks\n\nexport default function useAppRuntimesContext() {\n  return useContext(AppRuntimesContext);\n}\n","import React, { useEffect, useState } from \"react\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\n\nimport useAppRuntimesContext from \"@hooks/useAppRuntimesContext\";\nimport { useHistory, useLocation } from \"react-router-dom\";\n\nexport const WindowManagerRouteContext = React.createContext({});\n\nexport default function WindowManagerRouteProvider({ children }) {\n  const location = useLocation();\n  const { getAppRuntimesWithRegistrationID } = useAppRuntimesContext();\n\n  const [locationAppRuntimes, setLocationAppRuntimes] = useState([]);\n\n  useEffect(() => {\n    // Remove leading forward slash (/) from location\n    const locationRegistrationID = location.pathname?.substring(1);\n\n    const locationAppRuntimes = getAppRuntimesWithRegistrationID(\n      locationRegistrationID\n    );\n\n    setLocationAppRuntimes(locationAppRuntimes);\n  }, [location, getAppRuntimesWithRegistrationID]);\n\n  const {\n    activeWindowController: desktopContextActiveWindowController,\n    // setActiveWindowController: setDesktopContextActiveWindowController,\n  } = useDesktopContext();\n\n  const activeRegistrationID = desktopContextActiveWindowController\n    ?.getAppRuntime()\n    ?.getRegistrationID();\n\n  const history = useHistory();\n\n  // Update URL when active registration changes\n  useEffect(() => {\n    history.push(activeRegistrationID ? `/${activeRegistrationID}` : \"/\");\n  }, [activeRegistrationID, history]);\n\n  return (\n    <WindowManagerRouteContext.Provider value={{ locationAppRuntimes }}>\n      {children}\n    </WindowManagerRouteContext.Provider>\n  );\n}\n","import StackingContext from \"./StackingContext\";\n\nexport default StackingContext;\n","import React, { useEffect, useRef } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./StackingContext.module.css\";\n\n// TODO: Document\n// Also see: https://tiffanybbrown.com/2015/09/css-stacking-contexts-wtf/index.html\nconst StackingContext = ({\n  className,\n  children,\n  isAccelerated = false,\n  onMount = () => null,\n  onDOMMatrix = () => null,\n  ...rest\n}) => {\n  const refOnMount = useRef(onMount);\n  const refOnDOMMatrix = useRef(onDOMMatrix);\n  const refIsAccelerated = useRef(isAccelerated);\n\n  const refEl = useRef(null);\n\n  // Handle onMount and onDOMMatrix callbacks\n  useEffect(() => {\n    const el = refEl.current;\n\n    if (el) {\n      const onMount = refOnMount.current;\n      const onDOMMatrix = refOnDOMMatrix.current;\n      const isAccelerated = refIsAccelerated.current;\n\n      if (isAccelerated) {\n        // Handle 3D space detection and onDOMMatrix callback\n        //\n        // IMPORTANT: Use of setTimeout is to ensure we run this detection on\n        // the next event loop cycle.  Usage of requestAnimationFrame does not\n        // accurately detect 3D matrix.\n        setTimeout(() => {\n          const computedStyle = window.getComputedStyle(el);\n\n          /** @see https://developer.mozilla.org/en-US/docs/Web/API/DOMMatrix */\n          const matrix = new DOMMatrix(computedStyle.transform);\n\n          /**\n           * NOTE: Each matrix value will be a string, not a number\n           *\n           * @see https://zellwk.com/blog/css-translate-values-in-javascript/\n           **/\n          /*\n            const matrixValues = computedStyle.transform\n              .match(/matrix.*\\((.+)\\)/)[1]\n              .split(\", \");*/\n\n          // NOTE: (jh) It seems that the matrix can be 3D and still not be\n          // accelerated, so some further considerations may need to be made\n\n          if (matrix.is2D /* || matrixValues[14] === undefined*/) {\n            console.warn(\n              \"Unable to apply, or detect, added 3D space to accelerated element\",\n              el\n            );\n          }\n\n          onDOMMatrix(matrix);\n        });\n      }\n\n      onMount(el);\n    }\n  }, []);\n\n  return (\n    <div\n      ref={refEl}\n      {...rest}\n      className={classNames(\n        styles[\"stacking-context\"],\n        isAccelerated && styles[\"accelerated\"],\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n};\n\nexport default StackingContext;\n","import Full from './Full';\n\nexport default Full;","import React, { Component } from \"react\";\nimport StackingContext from \"../StackingContext\";\nimport classNames from \"classnames\";\nimport styles from \"./Full.module.css\";\n\nclass Full extends Component {\n  render() {\n    const { children, className, ...rest } = this.props;\n\n    return (\n      <StackingContext\n        {...rest}\n        className={classNames(styles[\"full\"], className)}\n      >\n        {children}\n      </StackingContext>\n    );\n  }\n}\n\nexport default Full;\n","import Cover from './Cover';\n\nexport default Cover;","import React from \"react\";\nimport Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Cover.module.css\";\n\nexport default React.forwardRef(function Cover(\n  { isVisible = true, children, className, ...rest },\n  forwardedRef\n) {\n  return (\n    <Full\n      ref={forwardedRef}\n      {...rest}\n      className={classNames(\n        styles[\"cover\"],\n        !isVisible ? styles[\"no-display\"] : \"\"\n      )}\n    >\n      {children}\n    </Full>\n  );\n});\n","import PhantomCore, {\n  EVT_UPDATED,\n  EVT_DESTROYED,\n  deepMerge,\n} from \"phantom-core\";\nimport { debounce } from \"debounce\";\n\nexport { EVT_UPDATED, EVT_DESTROYED };\n\n// @see https://reactjs.org/docs/profiler.html\nexport const EVT_RENDER_PROFILED = \"render-profile\";\n\nexport const EVT_RESIZED = \"resized\";\nexport const EVT_MOVED = \"moved\";\n\n// TODO: Implement ability to take snapshot (i.e. save to png, etc) for window previewing\n\n// TODO: Move into core directory?\n// TODO: Document\nexport default class WindowController extends PhantomCore {\n  // TODO: Document\n  constructor(initialState = {}, { onBringToTop }) {\n    super();\n\n    const DEFAULT_STATE = {\n      isMaximized: false,\n      isMinimized: false,\n      title: this.getTitle(),\n      // isActive: false,\n    };\n\n    this._state = Object.seal(deepMerge(DEFAULT_STATE, initialState));\n\n    this._appRuntime = null;\n\n    this._windowEl = null;\n    this._windowManagerEl = null;\n\n    this._handleBringToTop = onBringToTop;\n\n    this._emitDebouncedResized = debounce(\n      this._emitDebouncedResized.bind(this),\n      500\n    );\n\n    this._emitDebouncedMoved = debounce(\n      this._emitDebouncedMoved.bind(this),\n      500\n    );\n\n    // TODO: Retain last size / moved and enable reverting back to previous settings\n    // TODO: Enable percentage calculation and adjust when resizing viewport (this should prevent windows from being able to leave the viewport)\n\n    // TODO: Ensure these are unbound when controller is destructed (related issue: https://github.com/zenOSmosis/phantom-core/issues/68)\n    // (For manually triggering Chrome's built-in Garbage Collector, see: https://github.com/facebook/react/issues/22471)\n    this._centerHandler = null;\n    this._scatterHandler = null;\n  }\n\n  /**\n   * @return {Promise<void>}\n   */\n  async destroy() {\n    // Clear any currently scheduled resize executions\n    this._emitDebouncedResized.clear();\n\n    // TODO: Determine if in dirty state, prior to closing\n    // if (\n    // window.confirm(`Are you sure you wish to close \"${this.getTitle()}\"?`)\n    // ) {\n\n    if (this._appRuntime) {\n      await this._appRuntime.destroy();\n    }\n\n    this._state = {};\n    this._appRuntime = null;\n    this._windowEl = null;\n    this._windowManagerEl = null;\n\n    return super.destroy();\n    //}\n  }\n\n  // TODO: Document\n  __INTERNAL__setCenterHandler(centerHandler) {\n    this._centerHandler = centerHandler;\n  }\n\n  // TODO: Document\n  center() {\n    return this._centerHandler();\n  }\n\n  // TODO: Document\n  __INTERNAL__setScatterHandler(scatterHandler) {\n    this._scatterHandler = scatterHandler;\n  }\n\n  // TODO: Document\n  scatter() {\n    return this._scatterHandler();\n  }\n\n  // TODO: Document\n  bringToTop() {\n    this._handleBringToTop(this);\n  }\n\n  // TODO: Document\n  /*\n  __INTERNAL__setIsActive(isActive) {\n    if (isActive !== this.getIsActive()) {\n      this.setState({ isActive });\n    }\n  }\n  */\n\n  // TODO: Document\n  /*\n  getIsActive() {\n    return this.getState().isActive;\n  }\n  */\n\n  // TODO: Document\n  // @see https://reactjs.org/docs/profiler.html\n  captureRenderProfile(arrRenderProfile) {\n    this.emit(EVT_RENDER_PROFILED, arrRenderProfile);\n  }\n\n  // TODO: Document\n  attachWindowElement(el) {\n    this._windowEl = el;\n  }\n\n  // TODO: Document\n  attachWindowManagerElement(el) {\n    this._windowManagerEl = el;\n  }\n\n  /**\n   * Associates an AppRuntime instance with this window controller.\n   *\n   * @param {AppRuntime} appRuntime\n   * @return {void}\n   */\n  setAppRuntime(appRuntime) {\n    // TODO: Ensure appRuntime is an AppRuntime instance\n\n    this._appRuntime = appRuntime;\n\n    // TODO: Refactor title to app runtime passing (ensure it can work both ways)\n    this._appRuntime.setTitle(this.getTitle());\n  }\n\n  /**\n   * Retrieves the associated AppRuntime for this window controller.\n   *\n   * @return {AppRuntime | void}\n   */\n  getAppRuntime() {\n    return this._appRuntime;\n  }\n\n  // TODO: Document\n  getAppRegistration() {\n    const runtime = this.getAppRuntime();\n\n    if (runtime) {\n      return runtime.getRegistration();\n    }\n  }\n\n  // TODO: Document\n  setSize({ width, height }) {\n    // IMPORTANT!: Do not update state on each iteration (if at all) because that would cause excessive re-rendering\n    const windowEl = this._windowEl;\n    if (windowEl) {\n      // FIXME: (jh) Can these be applied as a single reflow?\n      // @see https://www.sitepoint.com/10-ways-minimize-reflows-improve-performance/\n\n      window.requestAnimationFrame(() => {\n        if (width !== undefined) {\n          windowEl.style.width = `${width}px`;\n        }\n        if (height !== undefined) {\n          windowEl.style.height = `${height}px`;\n        }\n\n        // Emit debounced EVT_RESIZED event\n        this._emitDebouncedResized();\n      });\n    }\n  }\n\n  // TODO: Document\n  _emitDebouncedResized() {\n    this.emit(EVT_RESIZED);\n  }\n\n  // TODO: Document\n  getSize() {\n    const windowEl = this._windowEl;\n    if (windowEl) {\n      return {\n        width: windowEl.offsetWidth,\n        height: windowEl.offsetHeight,\n      };\n    } else {\n      console.warn(\"Unable to acquire windowEl\");\n    }\n  }\n\n  // TODO: Document\n  getWindowManagerSize() {\n    const windowManagerEl = this._windowManagerEl;\n    if (windowManagerEl) {\n      return {\n        width: parseInt(windowManagerEl.offsetWidth, 10),\n        height: parseInt(windowManagerEl.offsetHeight, 10),\n      };\n    } else {\n      console.warn(\"Unable to acquire windowManagerEl\");\n    }\n  }\n\n  // TODO: Document\n  setPosition({ x, y }) {\n    const windowEl = this._windowEl;\n    if (windowEl) {\n      /**\n       * FIXME: (jh) While using translate would be better here, it is buggier\n       * to use with some of the window animations (open / minimize / restore)\n       *\n       * However, if able to tie directly into matrix operations provided by\n       * accelerated StackingContext, it might improve acceleration even\n       * further\n       *\n       * Additional reading:\n       *    - [will-change] https://developer.mozilla.org/en-US/docs/Web/CSS/will-change\n       *    - [animating the box model]: https://whistlr.info/2021/box-model-animation\n       */\n\n      window.requestAnimationFrame(() => {\n        if (x !== undefined) {\n          windowEl.style.left = `${x}px`;\n\n          // Delete opposing right style\n          delete windowEl.style.right;\n        }\n        if (y !== undefined) {\n          windowEl.style.top = `${y}px`;\n\n          // Delete opposing bottom style\n          delete windowEl.style.bottom;\n        }\n\n        // IMPORTANT!: Do not update state on each iteration (if at all)\n        // because that would cause excessive re-rendering\n        this._emitDebouncedMoved();\n      });\n    }\n  }\n\n  // TODO: Document\n  _emitDebouncedMoved() {\n    this.emit(EVT_MOVED);\n  }\n\n  // TODO: Document\n  getPosition() {\n    const windowEl = this._windowEl;\n\n    if (windowEl) {\n      return {\n        x: parseInt(windowEl.offsetLeft, 10),\n        y: parseInt(windowEl.offsetTop, 10),\n      };\n    }\n  }\n\n  // TODO: Document\n  getIsBorderDisabled() {\n    return this.getIsMaximized() || this.getIsMinimized();\n  }\n\n  /**\n   * Sets a partial next state for this window controller.\n   *\n   * TODO: States are currently deep-merged but may become shallow merged\n   * instead.\n   *\n   * @param {Object} partialNextState\n   * @emits EVT_UPDATED\n   * @return {void}\n   */\n  setState(partialNextState) {\n    if (typeof partialNextState !== \"object\") {\n      throw new TypeError(\"partialNextState is not an object\");\n    }\n\n    // TODO: Refactor title to app runtime passing (ensure it can work both ways)\n    if (partialNextState.title !== undefined && this._appRuntime) {\n      this._appRuntime.setTitle(partialNextState.title);\n    }\n\n    // Potentially reset polar-opposite states\n    if (partialNextState.isMaximized) {\n      partialNextState.isMinimized = false;\n    } else if (partialNextState.isMinimized) {\n      partialNextState.isMaximized = false;\n    }\n\n    this._state = deepMerge(this._state, partialNextState);\n\n    this.emit(EVT_UPDATED, partialNextState);\n  }\n\n  /**\n   * @param {string} title\n   * @return {void}\n   */\n  setTitle(title) {\n    // Fixes issue where title does not render in window\n    this.setState({ title });\n\n    super.setTitle(title);\n  }\n\n  /**\n   * @return {Object}\n   */\n  getState() {\n    return this._state;\n  }\n\n  /**\n   * @param {boolean} isMaximized\n   * @return {void}\n   */\n  setIsMaximized(isMaximized) {\n    return this.setState({ isMaximized });\n  }\n\n  // TODO: Document\n  maximize() {\n    return this.setIsMaximized(true);\n  }\n\n  /**\n   * Retrieves whether or not the window is maximized.\n   *\n   * @returns {boolean}\n   */\n  getIsMaximized() {\n    return this._state.isMaximized;\n  }\n\n  /**\n   * Sets whether or not the window is minimized.\n   *\n   * @param {boolean} isMinimized\n   * @return {void}\n   */\n  setIsMinimized(isMinimized) {\n    return this.setState({ isMinimized });\n  }\n\n  // TODO: Document\n  minimize() {\n    return this.setIsMinimized(true);\n  }\n\n  /**\n   * Retrieves whether or not the window is minimized.\n   *\n   * @return {boolean}\n   */\n  getIsMinimized() {\n    return this._state.isMinimized;\n  }\n\n  // TODO: Document\n  restore() {\n    // IMPORTANT: The maximized / minimized states need to be set at the same\n    // time here; don't call the individual methods directly\n    this.setState({\n      isMaximized: false,\n      isMinimized: false,\n    });\n  }\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Header({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"header\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Content({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"content\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Footer({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"footer\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./RowColumn.module.css\";\n// import PropTypes from \"prop-types\";\n\n// @see https://dev.to/drews256/ridiculously-easy-row-and-column-layouts-with-flexbox-1k01\n\n// TODO: Implement prop-types\nfunction Row({ children, className, ...rest }) {\n  // TODO: Enforce that only Column components are direct children of this\n\n  return (\n    <div {...rest} className={classNames(styles[\"row\"], className)}>\n      {children}\n    </div>\n  );\n}\n\n// TODO: Implement prop-types\n/**\n * Evenly-sized column.\n */\nfunction Column({ children, className, ...rest }) {\n  // TODO: Enforce that only Row component is direct parent of this\n\n  return (\n    <div {...rest} className={classNames(styles[\"column\"], className)}>\n      {children}\n    </div>\n  );\n}\n\nexport { Row, Column };\n","import Layout, { Header, Content, Footer, Row, Column } from \"./Layout\";\n\nexport default Layout;\nexport { Header, Content, Footer, Row, Column };\n","import React from \"react\";\nimport Full from \"../Full\";\nimport Header from \"./Header\";\nimport Content from \"./Content\";\nimport Footer from \"./Footer\";\nimport { Row, Column } from \"./RowColumn\";\nimport styles from \"./Layout.module.css\";\nimport classNames from \"classnames\";\n\n// TODO: Add prop-types\n// TODO: Consider renaming; there are unrelated components that deal with Layout as well\nexport default function Layout({ className, children, ...rest }) {\n  return (\n    <Full {...rest} className={classNames(styles[\"layout\"], className)}>\n      {children}\n    </Full>\n  );\n}\n\nexport { Header, Content, Footer, Row, Column };\n","import Layout, { Header, Content, Footer, Row, Column } from \"../Layout\";\nimport { useDrag } from \"react-use-gesture\";\n\n// TODO: Height and width are synonymous\n\n// TODO: Resizable element for touch displays: https://csslayout.io/patterns/resizable-element\n\nexport const DIR_BORDER_NW = \"NW\";\nexport const DIR_BORDER_N = \"N\";\nexport const DIR_BORDER_NE = \"NE\";\nexport const DIR_BORDER_E = \"E\";\nexport const DIR_BORDER_SE = \"SE\";\nexport const DIR_BORDER_S = \"S\";\nexport const DIR_BORDER_SW = \"SW\";\nexport const DIR_BORDER_W = \"W\";\n\n// TODO: Use prop-types\n// TODO: Document\nexport default function WindowBorder({\n  children,\n  onBorderDrag,\n  borderWidth = 3,\n  isDisabled = false,\n  ...rest\n}) {\n  // @see https://use-gesture.netlify.app/docs/#simple-example\n  const bindNW = useDrag(({ down: isDragging, movement: [mx, my] }) => {\n    onBorderDrag(DIR_BORDER_NW, { mx, my, isDragging });\n  });\n\n  const bindN = useDrag(({ down: isDragging, movement: [mx, my] }) => {\n    onBorderDrag(DIR_BORDER_N, { mx, my, isDragging });\n  });\n\n  const bindNE = useDrag(({ down: isDragging, movement: [mx, my] }) => {\n    onBorderDrag(DIR_BORDER_NE, { mx, my, isDragging });\n  });\n\n  const bindE = useDrag(({ down: isDragging, movement: [mx, my] }) => {\n    onBorderDrag(DIR_BORDER_E, { mx, my, isDragging });\n  });\n\n  const bindSE = useDrag(({ down: isDragging, movement: [mx, my] }) => {\n    onBorderDrag(DIR_BORDER_SE, { mx, my, isDragging });\n  });\n\n  const bindS = useDrag(({ down: isDragging, movement: [mx, my] }) => {\n    onBorderDrag(DIR_BORDER_S, { mx, my, isDragging });\n  });\n\n  const bindSW = useDrag(({ down: isDragging, movement: [mx, my] }) => {\n    onBorderDrag(DIR_BORDER_SW, { mx, my, isDragging });\n  });\n\n  const bindW = useDrag(({ down: isDragging, movement: [mx, my] }) => {\n    onBorderDrag(DIR_BORDER_W, { mx, my, isDragging });\n  });\n\n  return (\n    // TODO: Enable merge-able styles / classNames\n    // TODO: Extract classes to module.css\n    <Layout {...rest}>\n      <Header>\n        {!isDisabled && (\n          <Row style={{ maxHeight: borderWidth, height: borderWidth }}>\n            <Column\n              {...bindNW()}\n              style={{ maxWidth: borderWidth, cursor: \"nwse-resize\" }}\n            ></Column>\n            <Column {...bindN()} style={{ cursor: \"ns-resize\" }}></Column>\n            <Column\n              {...bindNE()}\n              style={{ maxWidth: borderWidth, cursor: \"nesw-resize\" }}\n            ></Column>\n          </Row>\n        )}\n      </Header>\n      <Content>\n        <Row>\n          {!isDisabled && (\n            <Column\n              {...bindW()}\n              style={{ maxWidth: borderWidth, cursor: \"ew-resize\" }}\n            ></Column>\n          )}\n\n          <Column>\n            {\n              // TODO: Use layout to wrap the child in a frame, w/ diagonal positions included\n            }\n            {children}\n          </Column>\n          {!isDisabled && (\n            <Column\n              {...bindE()}\n              style={{ maxWidth: borderWidth, cursor: \"ew-resize\" }}\n            ></Column>\n          )}\n        </Row>\n      </Content>\n      <Footer>\n        {!isDisabled && (\n          <Row style={{ maxHeight: borderWidth, height: borderWidth }}>\n            <Column\n              {...bindSW()}\n              style={{ maxWidth: borderWidth, cursor: \"nesw-resize\" }}\n            ></Column>\n            <Column {...bindS()} style={{ cursor: \"ns-resize\" }}></Column>\n            <Column\n              {...bindSE()}\n              style={{ maxWidth: borderWidth, cursor: \"nwse-resize\" }}\n            ></Column>\n          </Row>\n        )}\n      </Footer>\n    </Layout>\n  );\n}\n","import NoWrap from \"./NoWrap\";\n\nexport default NoWrap;\n","import classNames from \"classnames\";\nimport styles from \"./NoWrap.module.css\";\n\nexport default function NoWrap({ children, className, ...rest }) {\n  return (\n    <span {...rest} className={classNames(styles[\"no-wrap\"], className)}>\n      {children}\n    </span>\n  );\n}\n","import styles from \"../../Window.module.css\";\n\nexport function WindowTitlebarMaximizeButton({ ...rest }) {\n  return <WindowTitlebarButton {...rest} className={styles[\"maximize\"]} />;\n}\n\nexport function WindowTitlebarMinimizeButton({ ...rest }) {\n  return <WindowTitlebarButton {...rest} className={styles[\"minimize\"]} />;\n}\n\nexport function WindowTitlebarCloseButton({ ...rest }) {\n  return <WindowTitlebarButton {...rest} className={styles[\"close\"]} />;\n}\n\nfunction WindowTitlebarButton({ ...rest }) {\n  // TODO: Compose with specific buttons for \"green\", \"yellow\", and \"red\".\n\n  return <button {...rest}></button>;\n}\n","import WindowTitlebar from \"./Window.Titlebar\";\n\nexport default WindowTitlebar;\n","import NoWrap from \"@components/NoWrap\";\nimport Full from \"@components/Full\";\n\nimport styles from \"../Window.module.css\";\n\nimport {\n  WindowTitlebarMaximizeButton,\n  WindowTitlebarMinimizeButton,\n  WindowTitlebarCloseButton,\n} from \"./Window.Titlebar.Button\";\n\nexport default function WindowTitlebar({\n  onElTitlebar,\n  title,\n  onRestoreOrMaximize,\n  onMinimize,\n  onClose,\n  titleBarView: TitleBarView,\n}) {\n  // onDoubleClick={handleToggleRestoreOrMaximize})\n\n  return (\n    <div\n      ref={onElTitlebar}\n      className={styles[\"titlebar\"]}\n      onDoubleClick={onRestoreOrMaximize}\n    >\n      {TitleBarView ? (\n        <Full>{TitleBarView}</Full>\n      ) : (\n        <>\n          <NoWrap\n            style={{\n              // Offset width of window-controls in order to make the title centered\n              width: 80,\n            }}\n          />\n          <NoWrap className={styles[\"title\"]}>{title}</NoWrap>\n        </>\n      )}\n\n      <NoWrap className={styles[\"window-controls\"]}>\n        <WindowTitlebarMaximizeButton onClick={onRestoreOrMaximize} />\n        <WindowTitlebarMinimizeButton onClick={onMinimize} />\n        <WindowTitlebarCloseButton onClick={onClose} />\n      </NoWrap>\n    </div>\n  );\n}\n","/**\n * TODO: Document\n *\n * @see https://stackoverflow.com/a/46921780\n *\n * @param {DOMElement} el\n * @return {Object} // TODO: Document more thoroughly\n */\nexport default function getElCenterPoint(el) {\n  const x = el.offsetLeft + el.offsetWidth / 2;\n  const y = el.offsetTop + el.offsetHeight / 2;\n\n  return {\n    x,\n    y,\n  };\n}\n","/**\n * TODO: Document\n *\n * @param {DOMElement} el\n * @return {Object} // TODO: Document more thoroughly\n */\nexport default function getElSize(el) {\n  const width = el.offsetWidth;\n  const height = el.offsetHeight;\n\n  return {\n    width,\n    height,\n  };\n}\n","import { useEffect, useRef } from \"react\";\nimport \"animate.css\";\n\n// TODO: Document\nexport default function useAnimation({\n  domElement,\n  animationName,\n  // FIXME: Duration and delay are currently passed as strings because that's\n  // what the underlying CSS requires, but they should probably also accept\n  // integers representing milliseconds.\n  animationDuration = \"1s\",\n  animationDelay = \"0s\",\n  // TODO: Ensure onAnimationEnd is triggered on Windows if animations are turned off\n  onAnimationEnd,\n  animationEngine = \"animate.css\",\n  isDisabled = false,\n  shouldRun = true,\n}) {\n  if (typeof animationDuration !== \"string\") {\n    console.warn('animationDuration should be a string (i.e. \"1s\")');\n  }\n\n  if (typeof animationDelay !== \"string\") {\n    console.warn('animationDelay should be a string (i.e. \"0s\")');\n  }\n\n  const refOnAnimationEnd = useRef(onAnimationEnd);\n\n  useEffect(() => {\n    if (shouldRun && domElement) {\n      if (isDisabled) {\n        // TODO: Can this be used as an exported property instead of directly\n        // manipulating here?\n        domElement.style.visibility = \"visible\";\n      } else {\n        const classes = domElement.classList;\n\n        // Unhide the element\n        //\n        // IMPORTANT: This fixes an issue where text might appear to pop before\n        // transition is applied. It should be used in conjunction with opacity\n        // being set to 0, initially, as the Animation component does.\n        //\n        // TODO: Can this be used as an exported property instead of directly\n        // manipulating here?\n        domElement.style.visibility = \"visible\";\n\n        domElement.style.animationDuration = animationDuration;\n        domElement.style.animationDelay = animationDelay;\n\n        switch (animationEngine) {\n          /**\n           * @see https://animate.style animate.css\n           */\n          case \"animate.css\":\n            (() => {\n              // TODO: Implement optional animation engine\n              // animate.css\n              const BASE = \"animate__animated\";\n\n              if (!classes.contains(BASE)) {\n                domElement.classList.add(BASE);\n              }\n\n              if (!classes.contains(\"animate__\" + animationName)) {\n                domElement.classList.add(\"animate__\" + animationName);\n              }\n            })();\n            break;\n\n          default:\n            throw new Error(`Unsupported animation engine: ${animationEngine}`);\n        }\n\n        const onAnimationEnd = refOnAnimationEnd.current;\n\n        // TODO: Also handle removing of effect from class list, so we can re-use it, if necessary\n        domElement.addEventListener(\"animationend\", onAnimationEnd);\n\n        return function unmount() {\n          domElement.removeEventListener(\"animationend\", onAnimationEnd);\n        };\n      }\n    }\n  }, [\n    animationEngine,\n    animationName,\n    animationDuration,\n    animationDelay,\n    domElement,\n    isDisabled,\n    shouldRun,\n  ]);\n}\n","import { EVT_UPDATED } from \"./classes/WindowController\";\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport StackingContext from \"../StackingContext\";\nimport Full from \"../Full\";\nimport Layout, { Header, Content } from \"../Layout\";\n\nimport WindowBorder from \"./Window.Border\";\nimport WindowTitlebar from \"./Window.Titlebar\";\n\nimport styles from \"./Window.module.css\";\nimport classNames from \"classnames\";\n\nimport useWindowStyles from \"./hooks/useWindowStyles\";\nimport useWindowAutoPositioner from \"./hooks/useWindowAutoPositioner\";\nimport useWindowDragger from \"./hooks/useWindowDragger\";\nimport useWindowDragResizer from \"./hooks/useWindowDragResizer\";\nimport useWindowOpenAnimation from \"./hooks/useWindowOpenAnimation\";\nimport useWindowControls from \"./hooks/useWindowControls\";\n\n// TODO: Apply considerations from Apple's Human Interface Guidelines:\n// https://developer.apple.com/design/human-interface-guidelines/macos/windows-and-views/window-anatomy/\n\n// TODO: Consider adjusting tabindex for non-active windows dynamically so that\n// tabbing will stay within constraints of the active window\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex\n\n// TODO: Add prop-types\n// TODO: Document\n// TODO: Include option to be able to drag the window from within the window body (i.e. like a widget)\nconst WindowView = ({\n  children,\n  elWindowManager,\n\n  windowController,\n\n  // TODO: Obtain via windowController instead?\n  isActive,\n\n  // TODO: Obtain via windowController\n  isProfiling = true,\n\n  titleBarView = null,\n\n  style = {},\n  ...rest\n}) => {\n  /** @type {DOMElement} */\n  const [el, _setEl] = useState(null);\n\n  // TODO: Document\n  const { isOpenAnimationEnded } = useWindowOpenAnimation(el);\n\n  // TODO: Document\n  useWindowAutoPositioner(elWindowManager, el, windowController);\n\n  const [elTitlebar, _setElTitlebar] = useState(null);\n\n  const [zIndex, _setZIndex] = useState(0);\n  const [title, _setTitle] = useState(null);\n\n  // Associate window element with window controller\n  // TODO: Refactor into useWindowController hook\n  useEffect(() => {\n    if (windowController && el) {\n      windowController.attachWindowElement(el);\n    }\n  }, [windowController, el]);\n\n  /** @type {boolean} */\n  const [isWindowBorderDisabled, _setIsWindowBorderDisabled] = useState(false);\n  const refIsWindowBorderDisabled = useRef(null);\n  refIsWindowBorderDisabled.current = isWindowBorderDisabled;\n\n  const [isMaximized, _setIsMaximized] = useState(false);\n  const [isMinimized, _setIsMinimized] = useState(false);\n\n  // TODO: Document\n  // TODO: Refactor into useWindowController hook\n  useEffect(() => {\n    if (windowController) {\n      const _handleWindowControllerUpdate = updatedState => {\n        if (!updatedState) {\n          updatedState = windowController.getState() || {};\n        }\n\n        // Only apply view state change when necessary\n        if (\n          updatedState.title !== undefined &&\n          // TODO: Rather than checking dep value here, create conditionally-setting useState wrapper\n          updatedState.title !== title\n        ) {\n          _setTitle(updatedState.title);\n        }\n\n        // Only apply view state change when necessary\n        if (\n          updatedState.stackingIndex !== undefined &&\n          // TODO: Rather than checking dep value here, create conditionally-setting useState wrapper\n          updatedState.stackingIndex !== zIndex\n        ) {\n          _setZIndex(updatedState.stackingIndex);\n        }\n\n        if (updatedState.isMaximized !== undefined) {\n          _setIsMaximized(updatedState.isMaximized);\n        }\n\n        if (updatedState.isMinimized !== undefined) {\n          _setIsMinimized(updatedState.isMinimized);\n        }\n\n        const shouldWindowBorderBeDisabled =\n          windowController.getIsBorderDisabled();\n        if (\n          refIsWindowBorderDisabled.current !== shouldWindowBorderBeDisabled\n        ) {\n          _setIsWindowBorderDisabled(shouldWindowBorderBeDisabled);\n        }\n      };\n\n      // Perform initial update sync\n      _handleWindowControllerUpdate();\n\n      windowController.on(EVT_UPDATED, _handleWindowControllerUpdate);\n\n      return function unmount() {\n        windowController.off(EVT_UPDATED, _handleWindowControllerUpdate);\n      };\n    }\n  }, [windowController, title, zIndex]);\n\n  const { onRestoreOrMaximize, onMinimize, onClose } =\n    useWindowControls(windowController);\n\n  // Binds window dragging functionality\n  const [dragBind, isUserDragging] = useWindowDragger({\n    windowController,\n    elTitlebar,\n    isDisabled: isWindowBorderDisabled,\n  });\n\n  // Binds border resizing functionality\n  const [handleBorderDrag, isUserResizing] = useWindowDragResizer({\n    windowController,\n  });\n\n  // TODO: Document\n  const DynamicProfilingWrapper = useMemo(\n    () =>\n      ({ ...args }) =>\n        isProfiling ? (\n          // @see https://reactjs.org/docs/profiler.html\n          <React.Profiler\n            {...args}\n            id={windowController.getUUID()}\n            onRender={(...renderProfile) =>\n              windowController.captureRenderProfile(renderProfile)\n            }\n          />\n        ) : (\n          <React.Fragment {...args} />\n        ),\n    [isProfiling, windowController]\n  );\n\n  // Delegate style properties to their respective sub-components\n  const { outerBorderStyle, windowStyle, bodyStyle } = useWindowStyles({\n    style,\n    isMaximized,\n    isMinimized,\n  });\n\n  return (\n    <DynamicProfilingWrapper>\n      <StackingContext\n        onMount={_setEl}\n        {...rest}\n        style={{ ...outerBorderStyle, zIndex }}\n        className={classNames(\n          styles[\"window-outer-border\"],\n\n          // Prevents \"popping\" of window before open animation ends\n          !isOpenAnimationEnded && styles[\"hidden\"],\n\n          isActive && styles[\"active\"],\n          isMaximized && styles[\"maximized\"],\n          isMinimized && styles[\"minimized\"],\n          (isUserDragging || isUserResizing) && styles[\"dragging\"]\n        )}\n        // Enable hardware acceleration of window stacking context\n        isAccelerated={true}\n      >\n        <WindowView.Border\n          isDisabled={isWindowBorderDisabled}\n          onBorderDrag={handleBorderDrag}\n        >\n          <Full\n            {...dragBind()}\n            className={classNames(\n              styles[\"window\"],\n              isActive && styles[\"active\"],\n              // NOTE: This check intentionally is not taking resizing into\n              // consideration\n              isUserDragging && styles[\"dragging\"]\n            )}\n            style={windowStyle}\n          >\n            <Layout>\n              <Header>\n                <WindowTitlebar\n                  onElTitlebar={_setElTitlebar}\n                  title={title}\n                  onRestoreOrMaximize={onRestoreOrMaximize}\n                  onMinimize={onMinimize}\n                  onClose={onClose}\n                  titleBarView={titleBarView}\n                />\n              </Header>\n              <Content className={styles[\"body\"]} style={bodyStyle}>\n                {children}\n              </Content>\n            </Layout>\n          </Full>\n        </WindowView.Border>\n      </StackingContext>\n    </DynamicProfilingWrapper>\n  );\n};\n\nWindowView.Border = WindowBorder;\n\nexport default WindowView;\n","import { useState } from \"react\";\nimport useAnimation from \"@hooks/useAnimation\";\n\n// TODO: Apply animations to open, close, minimize, maximize, restore, etc.\n// @see https://animate.style/\n// @see https://github.com/miniMAC/magic (what is \"magic / puffin\"?) (TODO: Create test app to try these libs?)\n// # mac minimize genie effect warp\n\n// TODO: Document\nexport default function useWindowOpenAnimation(el) {\n  //const [phase, setPhase] = useState(\"transition-in\");\n\n  const [isOpenAnimationEnded, _setIsOpenAnimationEnded] = useState(false);\n\n  // Window opening transition\n  useAnimation({\n    domElement: el,\n    animationName: \"zoomInUp\",\n    animationDuration: \".5s\",\n    shouldRun: Boolean(el),\n    onAnimationEnd: () => _setIsOpenAnimationEnded(true),\n  });\n\n  return { isOpenAnimationEnded };\n}\n","import { useCallback, useEffect, useRef } from \"react\";\nimport getElCenterPoint from \"@utils/getElCenterPoint\";\nimport getElSize from \"@utils/getElSize\";\n\nimport useAppRuntimesContext from \"@hooks/useAppRuntimesContext\";\n\n// TODO: Document\nexport default function useWindowAutoPositioner(\n  elWindowManager,\n  elWindow,\n  windowController,\n  onInitialAutoPosition = () => null\n) {\n  const refOnInitialAutoPosition = useRef(null);\n  if (elWindow) {\n    refOnInitialAutoPosition.current = onInitialAutoPosition;\n  }\n\n  // TODO: Document\n  const handleCenter = useCallback(() => {\n    const winManCenter = getElCenterPoint(elWindowManager);\n    const winSize = getElSize(elWindow);\n\n    const x = winManCenter.x - winSize.width / 2;\n    const y = winManCenter.y - winSize.height / 2;\n\n    windowController.setPosition({\n      x,\n      y,\n    });\n  }, [elWindowManager, elWindow, windowController]);\n\n  // TODO: Document\n  const handleScatter = useCallback(() => {\n    if (windowController) {\n      const winManSize = getElSize(elWindowManager);\n      const winSize = getElSize(elWindow);\n\n      // Randomly position, but try to keep full window in viewport\n      const x = Math.floor(Math.random() * (winManSize.width - winSize.width));\n      const y = Math.floor(\n        Math.random() * (winManSize.height - winSize.height)\n      );\n\n      windowController.setPosition({ x, y });\n    }\n    // TODO:Implement\n  }, [elWindowManager, elWindow, windowController]);\n\n  // TODO: Refactor; Determine current app runtimes so we can determine if we're going to center or scatter new windows\n  const { appRuntimes } = useAppRuntimesContext();\n  const refInitialAppRuntimes = useRef(appRuntimes);\n\n  // Apply initial auto-position\n  useEffect(() => {\n    if (elWindowManager && elWindow && windowController) {\n      // Apply center handler to window controller so it can be called externally\n      windowController.__INTERNAL__setCenterHandler(handleCenter);\n      windowController.__INTERNAL__setScatterHandler(handleScatter);\n\n      // IMPORTANT: This must be called asynchronously or it will not set\n      requestAnimationFrame(() => {\n        // Determine initial window position\n        // TODO: Obtain previous value from local storage, or from window registration\n        if (refInitialAppRuntimes.current.length < 2) {\n          // If first window\n          handleCenter();\n        } else {\n          handleScatter();\n        }\n\n        // IMPORTANT: This must be called in a subsequent asynchronous call or\n        // it may execute before the previous\n        requestAnimationFrame(() => {\n          refOnInitialAutoPosition.current();\n        });\n      });\n    }\n  }, [\n    elWindowManager,\n    elWindow,\n    windowController,\n    handleCenter,\n    handleScatter,\n  ]);\n}\n","import { useCallback } from \"react\";\n\n// TODO: Document\nexport default function useWindowControls(windowController) {\n  // TODO: Document\n  // TODO: Implement\n  const handleRestoreOrMaximize = useCallback(() => {\n    if (windowController.getIsMaximized()) {\n      windowController.restore();\n    } else {\n      windowController.maximize();\n    }\n  }, [windowController]);\n\n  // TODO: Document\n  // TODO: Implement\n  const handleMinimize = useCallback(() => {\n    windowController.minimize();\n  }, [windowController]);\n\n  // TODO: Document\n  // TODO: Implement\n  const handleClose = useCallback(() => {\n    windowController.destroy();\n  }, [windowController]);\n\n  return {\n    onRestoreOrMaximize: handleRestoreOrMaximize,\n    onMinimize: handleMinimize,\n    onClose: handleClose,\n  };\n}\n","import { useRef, useState } from \"react\";\nimport { useDrag } from \"react-use-gesture\";\n\nexport const TOP_THRESHOLD = 0;\nexport const BOTTOM_THRESHOLD = 58;\nexport const LEFT_THRESHOLD = 0;\nexport const RIGHT_THRESHOLD = 0;\n\n// TODO: Document\nexport default function useWindowDragger({\n  windowController,\n  elTitlebar,\n  isDisabled,\n}) {\n  const refInitialDragPosition = useRef(null);\n  const refInitialWindowManagerSize = useRef(null);\n\n  const [isUserDragging, setIsUserDragging] = useState(false);\n\n  // @see https://use-gesture.netlify.app/docs/#simple-example\n  const bind = useDrag(\n    ({ down: isDragging, movement: [mx, my], xy, event }) => {\n      if (isDisabled || event.target.tagName.toUpperCase() === \"BUTTON\") {\n        return;\n      }\n\n      if (isDragging !== isUserDragging) {\n        setIsUserDragging(isDragging);\n      }\n\n      if (!elTitlebar.contains(event.target)) {\n        return;\n      }\n\n      if (isDragging) {\n        if (!refInitialDragPosition.current) {\n          refInitialDragPosition.current = windowController.getPosition();\n        }\n\n        if (!refInitialWindowManagerSize.current) {\n          refInitialWindowManagerSize.current =\n            windowController.getWindowManagerSize();\n        }\n\n        let x = refInitialDragPosition.current.x + mx;\n        let y = refInitialDragPosition.current.y + my;\n\n        const initialWindowManagerWidth =\n          refInitialWindowManagerSize.current.width;\n        const initialWindowManagerHeight =\n          refInitialWindowManagerSize.current.height;\n\n        // Prevent window from being dragged above top threshold\n        if (y < TOP_THRESHOLD) {\n          y = TOP_THRESHOLD;\n        }\n\n        // Prevent window from being dragged below bottom threshold\n        if (y > initialWindowManagerHeight - BOTTOM_THRESHOLD) {\n          y = initialWindowManagerHeight - BOTTOM_THRESHOLD;\n        }\n\n        // Prevent window from being dragged left of left threshold\n        if (xy[0] < LEFT_THRESHOLD) {\n          x = null;\n        }\n\n        // Prevent window from being dragged right of right threshold\n        if (xy[0] > initialWindowManagerWidth - RIGHT_THRESHOLD) {\n          x = null;\n        }\n\n        windowController.setPosition({\n          x,\n          y,\n        });\n      } else {\n        // Reset initial drag position\n        refInitialDragPosition.current = null;\n        refInitialWindowManagerSize.current = null;\n      }\n    }\n  );\n\n  return [bind, isUserDragging];\n}\n","import { useCallback, useRef, useState } from \"react\";\n\nimport {\n  DIR_BORDER_NW,\n  DIR_BORDER_N,\n  DIR_BORDER_NE,\n  DIR_BORDER_E,\n  DIR_BORDER_SE,\n  DIR_BORDER_S,\n  DIR_BORDER_SW,\n  DIR_BORDER_W,\n} from \"../Window.Border\";\n\nimport { BOTTOM_THRESHOLD } from \"./useWindowDragger\";\n\n// TODO: Document\n// TODO: Implement ability to turn off dragging\nexport default function useWindowDragResizer({ windowController }) {\n  const refInitialDragSizePosition = useRef(null);\n  const refInitialWindowManagerSize = useRef(null);\n\n  const [isUserResizing, setIsUserResizing] = useState(false);\n\n  const handleBorderDrag = useCallback(\n    (direction, { mx, my, isDragging }) => {\n      if (isDragging !== isUserResizing) {\n        setIsUserResizing(isDragging);\n      }\n\n      if (isDragging) {\n        if (!refInitialDragSizePosition.current) {\n          refInitialDragSizePosition.current = {\n            ...windowController.getSize(),\n            ...windowController.getPosition(),\n          };\n        }\n\n        if (!refInitialWindowManagerSize.current) {\n          refInitialWindowManagerSize.current =\n            windowController.getWindowManagerSize();\n        }\n\n        let width = refInitialDragSizePosition.current.width;\n        let height = refInitialDragSizePosition.current.height;\n        let x = refInitialDragSizePosition.current.x;\n        let y = refInitialDragSizePosition.current.y;\n\n        let windowManagerWidth = refInitialWindowManagerSize.current.width;\n        let windowManagerHeight = refInitialWindowManagerSize.current.height;\n\n        switch (direction) {\n          case DIR_BORDER_NW:\n            width = width - mx;\n            height = height - my;\n\n            x = x + mx;\n            y = y + my;\n\n            break;\n\n          case DIR_BORDER_N:\n            height = height - my;\n            y = y + my;\n            break;\n\n          case DIR_BORDER_NE:\n            height = height - my;\n            width = width + mx;\n\n            y = y + my;\n            break;\n\n          case DIR_BORDER_E:\n            width = width + mx;\n            break;\n\n          case DIR_BORDER_SE:\n            width = width + mx;\n            height = height + my;\n            break;\n\n          case DIR_BORDER_S:\n            height = height + my;\n            break;\n\n          case DIR_BORDER_SW:\n            width = width - mx;\n            height = height + my;\n\n            x = x + mx;\n            break;\n\n          case DIR_BORDER_W:\n            width = width - mx;\n\n            x = x + mx;\n            break;\n\n          default:\n            throw new ReferenceError(`Unknown direction: ${direction}`);\n        }\n\n        // TODO: Handle min width / height\n\n        // Prevent left resize from extending left of left threshold\n        if (x < 0) {\n          // This affects window height calculations when cursor is left of\n          // left threshold\n          const diffX = 0 - x;\n          x = 0;\n          width = width - diffX;\n        }\n\n        // Prevent top resize from extending above top threshold\n        if (y < 0) {\n          // IMPORTANT: Order of operations is important here; diffY comes\n          // before y\n          const diffY = 0 - y;\n          y = 0;\n          height = height - diffY;\n        }\n\n        // Prevent right resize from extending right of right threshold\n        if (width + x > windowManagerWidth) {\n          width = windowManagerWidth - x;\n          x = null;\n        }\n\n        // Prevent bottom resize from extending below bottom threshold\n        if (height + y > windowManagerHeight) {\n          if (\n            // Fix issue where resizing windows from the top, which extended\n            // below the bottom threshold, would move the bottom edge up\n            direction === DIR_BORDER_S ||\n            direction === DIR_BORDER_SE ||\n            direction === DIR_BORDER_SW\n          ) {\n            height = windowManagerHeight - y;\n            y = null;\n          }\n        }\n\n        // Prevent drags from the top to be able to drag below bottom threshold\n        if (windowManagerHeight - y < BOTTOM_THRESHOLD) {\n          return;\n        }\n\n        windowController.setSize({ width, height });\n        windowController.setPosition({ x, y });\n      } else {\n        refInitialDragSizePosition.current = null;\n        refInitialWindowManagerSize.current = null;\n      }\n    },\n    [windowController, isUserResizing]\n  );\n\n  return [handleBorderDrag, isUserResizing];\n}\n","import { useMemo } from \"react\";\n\n// TODO: Document\nexport default function useWindowStyles({ style, isMaximized, isMinimized }) {\n  // Conditionally overrides style property when window is maximized or\n  // minimized so that they do not conflict with the CSS classes\n  const outerBorderStyle = useMemo(() => {\n    if (isMaximized || isMinimized) {\n      return {};\n    } else {\n      return {\n        width: style.width,\n        height: style.height,\n      };\n    }\n  }, [style.width, style.height, isMaximized, isMinimized]);\n\n  const windowStyle = useMemo(() => {\n    return {\n      backgroundColor: style.backgroundColor,\n    };\n  }, [style.backgroundColor]);\n\n  const bodyStyle = useMemo(() => {\n    return {\n      padding: style.padding,\n    };\n  }, [style.padding]);\n\n  return {\n    outerBorderStyle,\n    windowStyle,\n    bodyStyle,\n  };\n}\n","import Window from \"./Window\";\n\nexport default Window;\n","import React, { useImperativeHandle, useState } from \"react\";\n\nimport WindowView from \"./Window.View\";\n\n// TODO: Implement CodeSandbox support for development / debugging:  https://codesandbox.io/docs/embedding#embed-options\n// TODO: See https://csslayout.io/patterns\n\n// TODO: Add prop-types\n// TODO: Document\n// TODO: Include option to be able to drag the window from within the window body (i.e. like a widget)\nconst Window = React.forwardRef(\n  (\n    {\n      children,\n      elWindowManager,\n\n      // TODO: Obtain via windowController instead?\n      isActive,\n\n      titleBarView,\n\n      style = {},\n      ...rest\n    },\n    ref\n  ) => {\n    const [windowController, attachWindowController] = useState(null);\n\n    // These are exposed to the WindowManager\n    useImperativeHandle(ref, () => ({\n      // windowSymbol: Symbol(\"window\"),\n      attachWindowController,\n    }));\n\n    // The windowController should already be supplied by WindowManager before\n    // rendering is even attempted\n    if (!windowController) {\n      return null;\n    }\n\n    // TODO: Implement error boundary here\n\n    return (\n      <WindowView\n        {...rest}\n        style={style}\n        elWindowManager={elWindowManager}\n        windowController={windowController}\n        isActive={isActive}\n        titleBarView={titleBarView}\n      >\n        {children}\n      </WindowView>\n    );\n  }\n);\n\nexport default Window;\n","import React from \"react\";\n\nimport useObjectState from \"@hooks/useObjectState\";\n\nexport const WindowContext = React.createContext({});\n\n// TODO: Document (per-window WindowProvider)\n// TODO: Use prop-types\nexport default function WindowProvider({ children, initialSharedState = {} }) {\n  const [sharedState, setSharedState] = useObjectState(initialSharedState);\n\n  return (\n    <WindowContext.Provider\n      value={{\n        setSharedState,\n        sharedState,\n      }}\n    >\n      {children}\n    </WindowContext.Provider>\n  );\n}\n","import { useCallback, useRef, useState } from \"react\";\n\n// TODO: See other implementation here (might be more performant): https://thoughtspile.github.io/2021/10/11/usestate-object-vs-multiple/?utm_campaign=thisweekinreact&utm_medium=email&utm_source=Revue%20newsletter\n\n/**\n * Applies a shallow-merge strategy to object updates so that setState() calls\n * don't completely overwrite previous object state.\n *\n * Maintains backwards-compatibility for class-based components which have been\n * migrated to hook versions, without having to write a bunch of useState\n * references for every state property.\n *\n * @param {Object} defaultState\n * @return {[state: Object, setState: function, changeIdx: number]} Merged state\n */\nexport default function useObjectState(defaultState = {}) {\n  const [state, _setMergedState] = useState(defaultState);\n\n  const refState = useRef(state);\n  refState.current = state;\n\n  /**\n   * @param {Object | string} updatedState If passed as a string, it will try\n   * to JSON parse into an object.\n   */\n  const setState = useCallback(updatedState => {\n    // Check type validity / apply type coercion, etc.\n    switch (typeof updatedState) {\n      case \"string\":\n        try {\n          updatedState = JSON.parse(updatedState);\n        } catch (err) {\n          console.error(\n            \"Unable to parse string.  Did you forget to use an Object when setting object state?\",\n            {\n              err,\n            }\n          );\n        }\n\n        break;\n\n      case \"function\":\n        updatedState = updatedState(refState.current);\n        break;\n\n      case \"object\":\n        // Objects are okay the way they are\n        break;\n\n      default:\n        // TODO: Eventually throw this error once we know it doesn't raise a\n        // bunch of warnings in the app as it is (August 6, 2021)\n        console.warn(`Unhandled updatedState type: ${typeof updatedState}`);\n        break;\n    }\n\n    return _setMergedState(prevState => ({ ...prevState, ...updatedState }));\n  }, []);\n\n  return [state, setState];\n}\n","import { useContext } from \"react\";\nimport { UIServicesContext } from \"../core/BaseView/providers/UIServicesProvider\";\n\n// TODO: Move to @core/hooks\n\nexport default function useServicesContext() {\n  return useContext(UIServicesContext);\n}\n","import { useContext } from \"react\";\nimport { AppRegistrationsContext } from \"@core/BaseView/providers/AppRegistrationsProvider\";\n\n// TODO: Move to @core/hooks\n\nexport default function useAppRegistrationsContext() {\n  return useContext(AppRegistrationsContext);\n}\n","// TODO: Move into core, named WindowManagerProvider\n\nimport { EVT_UPDATED, EVT_DESTROYED } from \"phantom-core\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport WindowManagerRouteProvider from \"./WindowManager.RouteProvider\"; // WindowManagerRouteContext,\nimport Cover from \"../Cover\";\nimport Window from \"../Window\";\n\nimport WindowProvider from \"../Window/Window.Provider\";\nimport useWindowContext from \"../Window/hooks/useWindowContext\";\n\nimport useServicesContext from \"@hooks/useServicesContext\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useAppRegistrationsContext from \"@hooks/useAppRegistrationsContext\";\nimport useAppRuntimesContext from \"@hooks/useAppRuntimesContext\";\nimport useForceUpdate from \"@hooks/useForceUpdate\";\n\nimport useRegistrationViewOnResized from \"./hooks/useRegistrationViewOnResized\";\n\nimport WindowController from \"../Window/classes/WindowController\";\n\n// TODO: Incorporate react-router for window routes?\n\n// TODO: Add hotkey listener service and map to active window\n\n// TODO: Refactor (shared across all windows to determine relevant zIndexes)\nlet stackingIndex = 0;\n\n// TODO: Document\n// TODO: Use prop-types\nexport default function WindowManager({ appDescriptors = [], children }) {\n  return (\n    <WindowManagerRouteProvider>\n      <WindowManagerView appDescriptors={appDescriptors}>\n        {children}\n      </WindowManagerView>\n    </WindowManagerRouteProvider>\n  );\n}\n\nfunction WindowManagerView({ appDescriptors = [], children }) {\n  // const { locationAppRuntimes } = React.useContext(WindowManagerRouteContext);\n\n  const { addOrUpdateAppRegistration } = useAppRegistrationsContext();\n  const { appRuntimes } = useAppRuntimesContext();\n\n  const [elBase, setElBase] = useState(null);\n\n  // TODO: Refactor outside of window manager?\n  useEffect(() => {\n    appDescriptors.forEach(descriptor =>\n      addOrUpdateAppRegistration(descriptor)\n    );\n\n    // TODO: Add or update these descriptors in the appropriate provider\n  }, [appDescriptors, addOrUpdateAppRegistration]);\n\n  const {\n    activeWindowController: desktopContextActiveWindowController,\n    setActiveWindowController: setDesktopContextActiveWindowController,\n  } = useDesktopContext();\n\n  // TODO: Document\n  const [windowControllerMaps, setWindowControllerMaps] = useState({});\n\n  /**\n   * @param {number | string } key\n   * @return {Object | void} // TODO: Document structure\n   */\n  const getWindowControllerMapWithKey = useCallback(\n    key => {\n      const map = windowControllerMaps[key];\n\n      return map;\n    },\n    [windowControllerMaps]\n  );\n\n  // IMPORTANT: Prevents infinite loop of handleSetActiveWindow when used as dependency\n  const refDesktopContextActiveWindowController = useRef(null);\n  refDesktopContextActiveWindowController.current =\n    desktopContextActiveWindowController;\n\n  /**\n   * @param {WindowController | null} windowController?\n   * @return {void}\n   */\n  const handleSetActiveWindow = useCallback(\n    windowController => {\n      // Restore minimized windows\n      // IMPORTANT: This should come before the is-current-window determination\n      // so that the Dock (and other activators) can un-minimize, regardless of\n      // the active window\n      if (windowController?.getIsMinimized()) {\n        windowController.setIsMinimized(false);\n      }\n\n      if (\n        !Object.is(\n          windowController,\n          refDesktopContextActiveWindowController.current\n        )\n      ) {\n        setDesktopContextActiveWindowController(windowController);\n\n        if (windowController) {\n          // TODO: Don't bring to front if already in front (i.e. is already the active window)\n          windowController.setState({ stackingIndex: ++stackingIndex });\n        }\n      }\n    },\n    [setDesktopContextActiveWindowController]\n  );\n\n  // TODO: Document\n  const handleGetIsActiveWindow = useCallback(\n    windowController =>\n      Object.is(desktopContextActiveWindowController, windowController),\n    [desktopContextActiveWindowController]\n  );\n\n  // Handle setting of active window based on locationAppRuntimes\n  // TODO: Fix; currently buggy w/ Safari\n  // TODO: Implement deep linking\n  /*\n  useEffect(() => {\n    const to = setTimeout(() => {\n      const windowControllers = locationAppRuntimes.map((appRuntime) =>\n        appRuntime.getWindowController()\n      );\n\n      if (\n        !windowControllers.includes(\n          refDesktopContextActiveWindowController.current\n        )\n      ) {\n        for (const windowController of windowControllers) {\n          if (windowController) {\n            // Iterate through all locationAppRuntimes and set active window\n            handleSetActiveWindow(windowController);\n          }\n        }\n      }\n    });\n\n    return function unmount() {\n      clearTimeout(to);\n    };\n  }, [locationAppRuntimes, handleSetActiveWindow]);\n  */\n\n  const { startService } = useServicesContext();\n\n  // Handle when window manager is clicked on directly (no window interacted with directly)\n  const refHandleSetActiveWindow = useRef(handleSetActiveWindow);\n  refHandleSetActiveWindow.current = handleSetActiveWindow;\n  useEffect(() => {\n    if (elBase) {\n      const _handleElBaseTouch = evt => {\n        // Deselect active window if desktop base is touched\n        if (evt.target === elBase) {\n          refHandleSetActiveWindow.current(null);\n        }\n      };\n\n      elBase.addEventListener(\"mousedown\", _handleElBaseTouch);\n      elBase.addEventListener(\"touchstart\", _handleElBaseTouch, {\n        // @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n        passive: true,\n      });\n\n      return function unmount() {\n        elBase.removeEventListener(\"mousedown\", _handleElBaseTouch);\n        elBase.removeEventListener(\"touchstart\", _handleElBaseTouch, {\n          // FIXME: (jh) I'm not positive if this should be on the\n          // removeEventListener (I think not, but erroring on the side of\n          // caution)\n          // @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n          // @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener\n          passive: true,\n        });\n      };\n    }\n  }, [elBase]);\n\n  /**\n   * Determines which windows are rendered to the screen at any given time, as\n   * \\well as controls instantiation and association of window controllers with\n   * their respective views.\n   *\n   * @type {React.Component[]}\n   */\n  // TODO: Can this be memoized again even w/ hooks running in window\n  // descriptors?\n  // TODO: Fix issue where every window will re-render when another window\n  // actively goes on top (not sure if it's a huge deal, but is seemingly\n  // unnecessary)\n  //\n  // TODO: Somehow figure out support for reparenting if needing to change\n  // window manager layouts: https://github.com/facebook/react/issues/3965\n  // (maybe this? https://www.npmjs.com/package/react-reverse-portal)\n  const windows = appRuntimes\n    .map(appRuntime => {\n      // TODO: Ensure key is unique across the map\n      const key = appRuntime.getUUID();\n\n      // NOTE: The variables absorbed by this decompositor (except for\n      // windowProps) are NOT passed down to the underlying DOM element of the\n      // window\n      //\n      // FIXME: (jh) Perhaps this logic should be refactored and most props not\n      // utilized on every single render (maybe the complete wrapped window\n      // could be a separate component instead of re-calcuating all of this\n      // stuff on every render)\n      const {\n        view: ViewComponent,\n        titleBarView,\n        initialSharedState,\n\n        // This one is tricky, don't pass up registration ID as DOM element ID\n        id,\n\n        title,\n        serviceClasses = [],\n        isPinned,\n        isPinnedToDock,\n        isAutoStart,\n        ...windowProps\n      } = appRuntime.getAppDescriptor();\n\n      if (!ViewComponent) {\n        return null;\n      }\n\n      // TODO: Re-active previously focused element when bringing new window to\n      // top\n\n      // TODO: (mostly for development), determine changed descriptor window\n      // title and update the window controller w/ new values\n\n      // TODO: Document\n      const dataMap = getWindowControllerMapWithKey(key);\n\n      /** @type {WindowController | void} */\n      const windowController = dataMap && dataMap.windowController;\n\n      // TODO: Fix issues with rendering errors related to the usage of this\n      /*\n      if (windowController) {\n        windowController.__INTERNAL__setIsActive(\n          handleGetIsActiveWindow(windowController)\n        );\n      }\n      */\n\n      // If we previously had a window controller running with this id\n      //\n      // TODO: Implement ability to flush this and restart a window with the same id?\n      if (dataMap && !dataMap.windowController) {\n        return null;\n      }\n\n      // TODO: Memoize this handling\n      // TODO: Attach services to window controller so other UI utilities can\n      // reference what is specific to this window\n      // TODO: Rename to appServices?\n      const appServices = {};\n      for (const serviceClass of serviceClasses) {\n        const service = startService(serviceClass);\n\n        appServices[serviceClass] = service;\n      }\n\n      // TODO: Memoize this component, when refactoring outer map\n      return (\n        <WindowProvider key={key} initialSharedState={initialSharedState}>\n          <Window\n            {...windowProps}\n            elWindowManager={elBase}\n            // TODO: Remove isActive and pass in from WindowController to the window\n            isActive={handleGetIsActiveWindow(windowController)}\n            onMouseDown={() => handleSetActiveWindow(windowController)}\n            onTouchStart={() => handleSetActiveWindow(windowController)}\n            titleBarView={\n              titleBarView ? (\n                <WrappedTitleBarView\n                  titleBarView={titleBarView}\n                  appServices={appServices}\n                  windowController={windowController}\n                  appRuntime={appRuntime}\n                />\n              ) : null\n            }\n            ref={ref => {\n              if (ref && !windowController) {\n                // Begin process of attaching window controller to rendered view\n                // and setting up event bindings\n\n                const windowController = new WindowController(\n                  {},\n                  {\n                    onBringToTop: handleSetActiveWindow,\n                  }\n                );\n                windowController.setTitle(title);\n\n                windowController.attachWindowManagerElement(elBase);\n\n                // Link app runtime to window controller (so that when the window\n                // controller is destructed it will take down the app runtime)\n                windowController.setAppRuntime(appRuntime);\n                appRuntime.setWindowController(windowController);\n\n                // Attach the view controller to the window\n                ref.attachWindowController(windowController);\n\n                setWindowControllerMaps(prev => {\n                  const next = { ...prev };\n                  next[key] = {\n                    windowController,\n                    key,\n                    // windowSymbol: ref.windowSymbol,\n                  };\n\n                  return next;\n                });\n\n                windowController.once(EVT_DESTROYED, () => {\n                  setWindowControllerMaps(prev => {\n                    const next = { ...prev };\n\n                    next[key].windowController = null;\n\n                    return next;\n                  });\n                });\n\n                // Set this new window as the active window\n                handleSetActiveWindow(windowController);\n              }\n            }}\n          >\n            {\n              // Wrap the view so that it updates when a bound service updates\n              // NOTE: (jh) I originally tried wrapping the window itself, but\n              // it didn't work, and it's a better idea to only update what's\n              // necessary anyway\n            }\n            {windowController && (\n              <WrappedView\n                appServices={appServices}\n                windowController={windowController}\n                appRuntime={appRuntime}\n                view={ViewComponent}\n              />\n            )}\n          </Window>\n        </WindowProvider>\n      );\n    })\n    .filter(window => Boolean(window));\n\n  return (\n    <Cover>\n      {\n        // TODO: Bind touch event to this element, and if directly touching it,\n        // make currently active window not active (if cursor is in another\n        // window, ensure it is removed as well)\n        //\n        // setActiveWindowController(null)\n      }\n      <div\n        ref={setElBase}\n        style={{ width: \"100%\", height: \"100%\", position: \"relative\" }}\n      >\n        {children}\n\n        {windows}\n      </div>\n    </Cover>\n  );\n}\n\n// TODO: Document\nconst WrappedTitleBarView = function ({ titleBarView, ...rest }) {\n  return <WrappedView {...rest} view={titleBarView} />;\n};\n\n// TODO: Implement Svelte lifecycle methods, to avoid users having to deal with\n// hooks (keep hooks as more of a low-level thing instead, if possible)\n// - https://svelte.dev/tutorial/onmount\n// - https://svelte.dev/tutorial/ondestroy\n// - https://svelte.dev/tutorial/update\n// - https://svelte.dev/tutorial/tick\n// Maybe we can say, \"we built a rendering engine on top of React, so that\n// React components can be used, without the complexity of dealing with React\n// hook dependencies, in order to reduce excessive rendering, or stale states,\n// caused by improper user of hook dependencies\".... could also smooth the\n// transition over to Svelte or any other rendering engine for apps created on\n// top of one of them.\n//\n// TODO: Document; rename? (NOTE: this wrapped view was designed to make it\n// easier to make the wrapping view render out-of-sequence with the containing\n// view, such as when a service updates, etc.)\nconst WrappedView = function WrappedView({\n  appServices,\n  windowController,\n  appRuntime,\n  view: ViewComponent,\n}) {\n  const forceUpdate = useForceUpdate();\n\n  const { sharedState, setSharedState } = useWindowContext();\n\n  // Re-render window when a service updates\n  useEffect(() => {\n    const _handleServiceUpdate = () => {\n      forceUpdate();\n    };\n\n    for (const service of Object.values(appServices)) {\n      // TODO: Make this channel-specific (i.e. EVT_MAIN_STATE_UPDATED)?\n      service.on(EVT_UPDATED, _handleServiceUpdate);\n    }\n\n    return function unmount() {\n      for (const service of Object.values(appServices)) {\n        // TODO: Make this channel-specific (i.e. EVT_MAIN_STATE_UPDATED)?\n        service.off(EVT_UPDATED, _handleServiceUpdate);\n      }\n    };\n  }, [appServices, forceUpdate]);\n\n  // TODO: Document\n  const setResizeHandler = useRegistrationViewOnResized(windowController);\n\n  return (\n    <ViewComponent\n      windowController={windowController}\n      appServices={appServices}\n      appRuntime={appRuntime}\n      setResizeHandler={setResizeHandler}\n      sharedState={sharedState}\n      setSharedState={setSharedState}\n    />\n  );\n};\n","import { useContext } from \"react\";\nimport { WindowContext } from \"../Window.Provider\";\n\n// TODO: Document (per-window useWindowContext)\nexport default function useWindowContext() {\n  return useContext(WindowContext);\n}\n","import { useCallback, useEffect, useRef } from \"react\";\nimport WindowController, {\n  EVT_RESIZED,\n} from \"@components/Window/classes/WindowController\";\n\n/**\n * Handles automatic invocation of AppRegistration view's setResizeHandler when\n * the relevant window resizes.\n *\n * @param {WindowController} windowController\n * @return {function}\n */\nexport default function useRegistrationViewOnResized(windowController) {\n  const refSetResizeHandler = useRef(null);\n\n  /**\n   * @param {function | void} setResizeHandler Passed up from AppRegistration view\n   * properties.\n   */\n  const handleResized = useCallback((setResizeHandler) => {\n    /**\n     * onResized is passed from view, and is executed by the WindowManager when\n     * the WindowController emits EVT_RESIZED event.\n     */\n    refSetResizeHandler.current = setResizeHandler;\n  }, []);\n\n  useEffect(() => {\n    if (windowController) {\n      if (!(windowController instanceof WindowController)) {\n        throw new TypeError(\"windowController is not a WindowController\");\n      }\n\n      const _handleExecResizedCallback = () => {\n        const onResized = refSetResizeHandler.current;\n\n        // AppRegistration view might not set an onResized handler\n        if (typeof onResized === \"function\") {\n          onResized();\n        }\n      };\n\n      windowController.on(EVT_RESIZED, _handleExecResizedCallback);\n\n      return function unmount() {\n        windowController.off(EVT_RESIZED, _handleExecResizedCallback);\n      };\n    }\n  }, [windowController]);\n\n  return handleResized;\n}\n","import WindowManager from \"./WindowManager\";\n\nexport default WindowManager;\n","import LED from \"./LED\";\n\nexport default LED;\n","import React from \"react\";\nimport styles from \"./LED.module.css\";\nimport classNames from \"classnames\";\nimport PropTypes from \"prop-types\";\n\nLED.propTypes = {\n  /** The color of the LED */\n  color: PropTypes.string,\n};\n\n/**\n * @see https://github.com/aus/led.css\n * @see http://jsfiddle.net/XrHcA/\n */\nexport default function LED({ color = null, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"led\"], styles[color])}></div>\n  );\n}\n","import Dock from \"./Dock\";\n\nexport default Dock;\n","import { useMemo } from \"react\";\n// import LED from \"@components/LED\";\n\nimport useAppRegistrationsContext from \"@hooks/useAppRegistrationsContext\";\nimport useAppRuntimesContext from \"@hooks/useAppRuntimesContext\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\n\n// TODO: Incorporate this logic\n// \"The user can also click an app’s Dock icon to bring all of that app’s windows forward; the most recently accessed app window becomes the key window.\"\n// (Ref. \"Activating Windows\": https://developer.apple.com/design/human-interface-guidelines/macos/windows-and-views/window-anatomy/)\n\n// TODO: Document\nexport default function Dock() {\n  const { activeWindowController } = useDesktopContext();\n  const { runningRegistrations, bringToFrontOrStartAppRuntime } =\n    useAppRuntimesContext();\n  const { appRegistrations } = useAppRegistrationsContext();\n\n  // TODO: Import type definition\n  /** @type {AppRegistration[]} */\n  const dockRegistrations = useMemo(\n    () => [\n      ...new Set([\n        ...appRegistrations.filter(registration =>\n          registration.getIsPinnedToDock()\n        ),\n        ...runningRegistrations,\n      ]),\n    ],\n    [appRegistrations, runningRegistrations]\n  );\n\n  // TODO: Import type definition\n  /** @type {AppRegistration | void} */\n  const activeRegistration = useMemo(\n    () => activeWindowController?.getAppRegistration(),\n    [activeWindowController]\n  );\n\n  return (\n    <div\n      // TODO: Move to module.css\n      style={{\n        position: \"absolute\",\n        bottom: 0,\n        left: 0,\n        width: \"100%\",\n        textAlign: \"center\",\n        isolation: \"isolate\",\n        // TODO: Handle different?\n        zIndex: 99999999,\n      }}\n    >\n      {\n        // TODO: Add tooltip functionality\n        // - https://www.npmjs.com/package/rc-tooltip\n        // - https://www.npmjs.com/package/react-tooltip\n        // - Note: Original Shell's Antd theme used rc-tooltip as the base (https://github.com/zenOSmosis/js-shell/blob/master/frontend/src/components/Desktop/Dock/DockItem.jsx)\n        //\n        // TODO: Add button menu\n        // - See original Shell implementation: https://github.com/zenOSmosis/js-shell/blob/master/frontend/src/components/Desktop/Dock/DockItem.jsx\n      }\n      <div\n        style={{\n          display: \"inline-block\",\n          color: \"black\",\n          whiteSpace: \"nowrap\",\n          maxWidth: \"100%\",\n          overflowX: \"auto\",\n        }}\n        className=\"button-group\"\n      >\n        {dockRegistrations.map(registration => (\n          <button\n            style={\n              registration === activeRegistration\n                ? {\n                    backgroundColor: \"rgba(38, 157, 255, .8)\",\n                    color: \"#000\",\n                  }\n                : { backgroundColor: \"#000\" }\n            }\n            key={registration.getUUID()}\n            onClick={() => bringToFrontOrStartAppRuntime(registration)}\n          >\n            {registration.getTitle()} {/* <LED color=\"gray\" /> */}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./AutoScaler.module.css\";\n\n/**\n * Fix issue on iOS 13 where ResizeObserver isn't available.\n */\nimport { install } from \"resize-observer\";\nif (!window.ResizeObserver) {\n  install();\n}\n\n/**\n * Automatically applies CSS transform scaling to children to fill parent node,\n * while preserving aspect ratio.\n *\n * Useful for videos and canvases, where the resolution is a fixed size and\n * should not change.\n */\nexport default function AutoScaler({ children, className, ...rest }) {\n  const [elOuterWrap, setElOuterWrap] = useState(null);\n  const [elInnerWrap, setElInnerWrap] = useState(null);\n\n  // Handle scaling\n  useEffect(() => {\n    if (elOuterWrap && elInnerWrap) {\n      let outerWrapSize = {\n        width: 0,\n        height: 0,\n      };\n      let innerWrapSize = {\n        width: 0,\n        height: 0,\n      };\n\n      // This is uesd w/ visibility below to try to reduce position defects\n      // when first rendering\n      elInnerWrap.style.visibility = \"hidden\";\n\n      const ro = new ResizeObserver(entries => {\n        requestAnimationFrame(() => {\n          for (const entry of entries) {\n            const size = {\n              width: entry.target.offsetWidth,\n              height: entry.target.offsetHeight,\n            };\n\n            if (entry.target === elOuterWrap) {\n              outerWrapSize = size;\n            } else {\n              innerWrapSize = size;\n            }\n          }\n\n          // Determine against all available space\n          const maxScaleX = outerWrapSize.width / innerWrapSize.width;\n          const maxScaleY = outerWrapSize.height / innerWrapSize.height;\n\n          const scale = Math.min(maxScaleX, maxScaleY);\n\n          elInnerWrap.style.transform = `scale(${scale}, ${scale})`;\n\n          if (elInnerWrap.style.visibility === \"hidden\") {\n            setTimeout(() => {\n              elInnerWrap.style.visibility = \"visible\";\n            }, 4);\n          }\n        });\n      });\n\n      ro.observe(elOuterWrap);\n      ro.observe(elInnerWrap);\n\n      return function unmount() {\n        ro.unobserve(elOuterWrap);\n        ro.unobserve(elInnerWrap);\n      };\n    }\n  }, [elOuterWrap, elInnerWrap]);\n\n  return (\n    <div\n      {...rest}\n      ref={setElOuterWrap}\n      className={classNames(styles[\"auto-scaler\"], className)}\n    >\n      <div ref={setElInnerWrap} className={styles[\"content-wrap\"]}>\n        {children}\n      </div>\n    </div>\n  );\n}\n","import AutoScaler from \"./AutoScaler\";\n\nexport default AutoScaler;\n","// @see https://szhsin.github.io/react-menu/#basic-menu\nimport {\n  Menu as LibMenu,\n  MenuItem,\n  MenuButton,\n  MenuHeader,\n  MenuDivider,\n  SubMenu as LibSubMenu,\n  applyHOC,\n  applyStatics,\n} from \"@szhsin/react-menu\";\nimport \"@szhsin/react-menu/dist/index.css\";\nimport \"@szhsin/react-menu/dist/transitions/slide.css\";\nimport \"./Menu.css\";\n\n// TODO: Close menu when screen size changes (menu can go offscreen)\n\nconst COMMON_PROPS = {\n  // Enable menu items to overflow in case they overextend the viewport\n  overflow: \"auto\",\n};\n\nconst Menu = applyHOC(function Menu({ ...rest }) {\n  return <LibMenu {...rest} portal={true} {...COMMON_PROPS} />;\n}, LibMenu);\n\nconst SubMenu = applyStatics(LibSubMenu)(function SubMenu({ ...rest }) {\n  return <LibSubMenu {...rest} {...COMMON_PROPS} />;\n});\n\n// TODO: Apply HOC and adjust styling as necessary (overflow=\"auto\" prop works\n// on Menu & SubMenu outside of styling)\n// @see https://szhsin.github.io/react-menu/#styles-prop for managing menu\n// styles (maybe not necessary to override CSS manually)\n// @see [HOC example] https://codesandbox.io/s/0bipn\n\n// TODO: Implement keyboard accessibility across menu bar: https://szhsin.github.io/react-menu/docs#keyboard\n\n// Controlled menu: https://szhsin.github.io/react-menu/docs#controlled-menu\n// (look into unmountOnClose and using it for dynamic opening / closing of\n// menus when mouse scrolls over menu buttons in menu bar)\n\n// useMenuStateHook: https://szhsin.github.io/react-menu/docs#use-menu-state\n\nexport default Menu;\nexport { MenuItem, MenuButton, MenuHeader, MenuDivider, SubMenu };\n","import { useCallback, useMemo } from \"react\";\nimport useAppRegistrationsContext from \"./useAppRegistrationsContext\";\nimport useAppRuntimesContext from \"./useAppRuntimesContext\";\n\n// TODO: Move to @core/hooks\n\n// TODO: Document\nexport default function useAppRegistrationLink(appDescriptorID) {\n  const { getAppRegistrationTitle } = useAppRegistrationsContext();\n  const { switchToAppRegistrationID } = useAppRuntimesContext();\n\n  const title = useMemo(\n    () => getAppRegistrationTitle(appDescriptorID),\n    [getAppRegistrationTitle, appDescriptorID]\n  );\n  const link = useCallback(\n    () => switchToAppRegistrationID(appDescriptorID),\n    [switchToAppRegistrationID, appDescriptorID]\n  );\n\n  return {\n    title,\n    link,\n  };\n}\n","import Padding from \"./Padding\";\n\nexport default Padding;\n","import { useEffect, useState } from \"react\";\n\nimport styles from \"./Padding.module.css\";\nimport classNames from \"classnames\";\n\nexport default function Padding({ children, className, ...rest }) {\n  const [el, setEl] = useState(null);\n  const [hasSiblings, setHasSiblings] = useState(false);\n\n  // Auto-determine if the element has siblings\n  useEffect(() => {\n    if (el) {\n      const hasSiblings = Boolean([...el.parentNode.children].length > 1);\n\n      setHasSiblings(hasSiblings);\n    }\n  }, [el]);\n\n  return (\n    <div\n      {...rest}\n      ref={setEl}\n      className={classNames(\n        styles[\"padding\"],\n        !hasSiblings && styles[\"no-siblings\"],\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n","import Timer from \"./Timer\";\n\nexport default Timer;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport NoWrap from \"../NoWrap\";\n\nimport PropTypes from \"prop-types\";\n\nTimer.propTypes = {\n  onTick: PropTypes.func.isRequired,\n};\n\n// TODO: Document\nexport default function Timer({ onTick, className, ...rest }) {\n  const [seconds, _setSeconds] = useState(onTick());\n\n  const getSeconds = useCallback(() => {\n    const seconds = onTick();\n\n    return seconds;\n  }, [onTick]);\n\n  useEffect(() => {\n    const handleUpdate = () => _setSeconds(getSeconds());\n\n    // Perform initial render\n    handleUpdate();\n\n    const updateInterval = setInterval(handleUpdate, 1000);\n\n    return function unmount() {\n      clearInterval(updateInterval);\n    };\n  }, [getSeconds]);\n\n  return <NoWrap {...rest}>{getSecondsToHHMMSS(seconds)}</NoWrap>;\n}\n\n// TODO: Refactor\n/**\n * @see https://stackoverflow.com/questions/1322732/convert-seconds-to-hh-mm-ss-with-javascript\n *\n * @param {number} seconds\n * @return {string} hh:mm:ss format\n */\nfunction getSecondsToHHMMSS(secs) {\n  // Note: This version should handle seconds if length is longer than one day\n  return new Date((secs % (60 * 60 * 24)) * 1000).toISOString().substr(11, 8);\n}\n","// NOTE: No hook is wrapped directly around this because the goal is to not\n// make it easy to expose services to windows which don't directly use said\n// service\nimport { useContext } from \"react\";\nimport { UIServicesContext } from \"@core/BaseView/providers/UIServicesProvider\";\n\n// TODO: Include (either here, or elsewhere,) ability to monitor running\n// PhantomCore instances (use WeakRef here or there, as well)?\n\n// TODO: Include ability to render service reporters, once functionality is\n// integrated\n\n// TODO: Include ability to monitor React providers exposed by the service\n\nimport Padding from \"@components/Padding\";\nimport Timer from \"@components/Timer\";\nimport NoWrap from \"@components/NoWrap\";\n\nexport const REGISTRATION_ID = \"service-monitor\";\n\nconst ServiceMonitor = {\n  id: REGISTRATION_ID,\n  title: \"Service Monitor\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  isPinned: true,\n  view: function View() {\n    const { services } = useContext(UIServicesContext);\n\n    // TODO: Group by runtime\n\n    return (\n      <Padding style={{ overflowY: \"auto\" }}>\n        <table style={{ width: \"100%\" }}>\n          <thead>\n            <tr>\n              <td>Service Name</td>\n              <td>Uptime</td>\n              <td>f(x)</td>\n              {/**\n              <td>\n                Active\n                <br />\n                App Runtimes\n              </td>\n              <td>\n                Dynamically\n                <br />\n                Linked Providers\n              </td>  \n               */}\n            </tr>\n          </thead>\n          <tbody>\n            {services.map(service => (\n              <tr key={service.getUUID()}>\n                <td>{service.getTitle() || \"[Untitled]\"}</td>\n                <td className=\"center\">\n                  <Timer onTick={() => service.getInstanceUptime()} />\n                </td>\n                {/*\n                  <td className=\"center\">N/A</td>\n                  <td className=\"center\">N/A</td>\n                  */}\n                {/*\n              <td>\n                <button\n                  onClick={() => service.destroy()}\n                  style={{ width: \"100%\" }}\n                >\n                  Close\n                </button>\n              </td>\n                */}\n                <td className=\"center\">\n                  {\n                    // TODO: Remove\n                  }\n                  <button onClick={() => service.log(service.getState())}>\n                    <NoWrap>log(state)</NoWrap>\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </Padding>\n    );\n  },\n};\n\nexport default ServiceMonitor;\n","import { useEffect, useRef, useState } from \"react\";\nimport Preload from \"preload-it\";\n\n/**\n * Pre-loads resources, as a React hook.\n *\n * @param {string[]} resources An array of URLs to preload. Note that these are\n * cached and the list cannot be changed without re-instantiating the hook.\n * @return {Object}\n */\nexport default function usePreload(resources) {\n  const [isPreloaded, _setIsPreloaded] = useState(false);\n  const [progress, _setProgress] = useState(0);\n\n  // Cache the resources; This fixes an issue where passing in a non-memoized\n  // array could cause the following useEffect to trigger more than once.\n  //\n  // Issue was discovered when images would preload multiple times in Firefox.\n  const refResources = useRef(resources);\n\n  useEffect(() => {\n    const resources = refResources;\n\n    if (resources.length) {\n      const preload = new Preload();\n\n      preload.onprogress = evt => {\n        _setProgress(evt.progress);\n      };\n\n      preload.oncomplete = (/* items */) => {\n        _setIsPreloaded(true);\n      };\n\n      preload.fetch(resources);\n    } else {\n      _setIsPreloaded(true);\n      _setProgress(100);\n    }\n  }, []);\n\n  return {\n    isPreloaded,\n    progress,\n  };\n}\n","import Animation from \"./Animation\";\n\nexport default Animation;\n","import React, { useMemo, useState } from \"react\";\nimport usePreload from \"@hooks/usePreload\";\nimport useAnimation from \"@hooks/useAnimation\";\nimport classNames from \"classnames\";\nimport styles from \"./Animation.module.css\";\n\nexport default function Animation({\n  className,\n  children,\n\n  // TODO: Rename to effect name\n  animationName,\n  animationDuration,\n  animationDelay,\n\n  animationEngine = \"animate.css\",\n  preloadResources = [],\n  onAnimationEnd = () => null,\n  tag = \"div\",\n  inline = false,\n\n  disabled = false,\n  ...rest\n}) {\n  const [domElement, _setDomElement] = useState(null);\n\n  const { isPreloaded } = usePreload(preloadResources);\n\n  useAnimation({\n    domElement,\n    animationName,\n    animationDuration,\n    animationDelay,\n    animationEngine,\n    onAnimationEnd,\n\n    // NOTE (jh): I don't really like this, but the alternative is putting\n    // isDisabled property on <Animation disabled /> and I don't like that\n    // either\n    isDisabled: disabled,\n  });\n\n  const View = useMemo(() => tag, [tag]);\n\n  if (!isPreloaded) {\n    return null;\n  }\n\n  return (\n    <View\n      {...rest}\n      ref={_setDomElement}\n      className={classNames(\n        styles[\"animation\"],\n        inline ? styles[\"inline\"] : null,\n        className\n      )}\n    >\n      {children}\n    </View>\n  );\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./ButtonTransparent.module.css\";\n\n// TODO: Rename to ButtonUnstyled?\nfunction ButtonTransparent({ children, className, ...rest }) {\n  return (\n    <button\n      className={classNames(styles[\"button-transparent\"], className)}\n      {...rest}\n    >\n      {children}\n    </button>\n  );\n}\n\nexport default ButtonTransparent;\n","import ButtonTransparent from './ButtonTransparent';\n\nexport default ButtonTransparent;","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport Animation from \"../Animation\";\nimport ButtonTransparent from \"../ButtonTransparent\";\n\nimport styles from \"./Notification.module.css\";\n\n// TODO: Add PropTypes\n// TODO: Document\nexport default function Notification({\n  body,\n  image,\n  title,\n  uuid,\n  onClose,\n  onClick,\n  // In milliseconds\n  autoCloseTime = 4000,\n  ...rest\n}) {\n  // TODO: Should this state be managed from the outside?\n  const [isClosing, setIsClosing] = useState(false);\n\n  // IMPORTANT: refOnClose is memoized to fix an issue where generating new\n  // notifications would restart the internal timer\n  const refOnClose = useRef(onClose);\n  const handleClose = useCallback(\n    (evt) => {\n      if (evt) {\n        evt.stopPropagation();\n      }\n\n      setIsClosing(true);\n\n      // NOTE (jh): We could also listen for Animation ended event, but decided\n      // to do the easy route at first.\n      setTimeout(\n        () => {\n          refOnClose.current(uuid);\n        },\n        // TODO: Make this value dynamic?\n        500\n      );\n    },\n    [uuid]\n  );\n\n  const [el, setEl] = useState(null);\n\n  // TODO: Document\n  useEffect(() => {\n    if (el) {\n      let autoCloseTimeout = null;\n\n      const startTimeout = () => {\n        autoCloseTimeout = setTimeout(handleClose, autoCloseTime);\n      };\n\n      startTimeout();\n\n      const stopTimeout = () => {\n        clearInterval(autoCloseTimeout);\n      };\n\n      el.addEventListener(\"mouseover\", stopTimeout, { passive: true });\n      el.addEventListener(\"mouseout\", startTimeout, { passive: true });\n      el.addEventListener(\"touchstart\", stopTimeout, { passive: true });\n\n      return function unmount() {\n        el.removeEventListener(\"mouseover\", stopTimeout, { passive: true });\n        el.removeEventListener(\"mouseout\", startTimeout, { passive: true });\n        el.removeEventListener(\"touchstart\", stopTimeout, { passive: true });\n\n        stopTimeout();\n      };\n    }\n  }, [el, autoCloseTime, handleClose]);\n\n  // TODO: Refactor into Image component?\n  const Image = useMemo(\n    () => () => {\n      switch (typeof image) {\n        case \"string\":\n          return (\n            <img alt={title} src={image} className={styles[\"main-image\"]} />\n          );\n\n        case \"function\":\n          return image();\n\n        default:\n          return image || null;\n      }\n    },\n    [image, title]\n  );\n\n  /**\n   * Note: Exports a button only if an onClick handler has been defined for\n   * the notification.\n   */\n  const MessageButton = useMemo(\n    () =>\n      ({ ...rest }) =>\n        typeof onClick === \"function\" ? (\n          <ButtonTransparent\n            {...rest}\n            onClick={onClick}\n            className={styles[\"main-button\"]}\n          />\n        ) : (\n          <React.Fragment {...rest} />\n        ),\n    [onClick]\n  );\n\n  return (\n    <div\n      ref={setEl}\n      onTouchEnd={handleClose}\n      onMouseUp={handleClose}\n      className={styles[\"notification\"]}\n      {...rest}\n    >\n      <Animation\n        animationName={!isClosing ? \"slideInRight\" : \"slideOutRight\"}\n        animationDuration=\".5s\"\n      >\n        <div className={styles[\"body-outer-wrap\"]}>\n          <MessageButton>\n            <div className={styles[\"body-inner-wrap\"]}>\n              <div className={styles[\"title\"]}>{title}</div>\n\n              <div className={styles[\"main-image-wrap\"]}>\n                <Image />\n              </div>\n\n              <div className={styles[\"body\"]}>{body}</div>\n            </div>\n          </MessageButton>\n          <ButtonTransparent\n            onClick={handleClose}\n            className={styles[\"close-button\"]}\n          >\n            X\n          </ButtonTransparent>\n        </div>\n      </Animation>\n    </div>\n  );\n}\n","import NotificationsStack from \"./NotificationsStack\";\n\nexport default NotificationsStack;\n","import React from \"react\";\n\nimport styles from \"./NotificationsStack.module.css\";\n\nimport Notification from \"../Notification\";\n\n// TODO: Document\n// Handles multiple-rendered notifications\nexport default function NotificationsStack({\n  notifications = [],\n  onNotificationClose,\n}) {\n  return (\n    <div className={styles[\"notifications-stack\"]}>\n      {\n        // NOTE: The inner-wrap enables too many UI notifications to be\n        // scrollable\n      }\n      <div className={styles[\"inner-wrap\"]}>\n        {\n          // IMPORTANT: onClose is not mapped from the data object because it is\n          // handled internally by the provider\n          notifications.map(({ body, image, onClick, title, uuid }) => {\n            return (\n              <div key={uuid}>\n                <Notification\n                  body={body}\n                  image={image}\n                  onClick={onClick}\n                  title={title}\n                  uuid={uuid}\n                  onClose={() => onNotificationClose(uuid)}\n                />\n              </div>\n            );\n          })\n        }\n      </div>\n    </div>\n  );\n}\n","import React, { useCallback, useState } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport { NotificationsStack } from \"@components/Notification\";\n\nexport const NotificationsContext = React.createContext({});\n\n// TODO: Document\n// TODO: Borrow API logic from https://www.npmjs.com/package/react-notifications\nexport default function NotificationsProvider({ children }) {\n  const [activeNotificationsStack, setActiveNotificationsStack] = useState([]);\n\n  // TODO: Document\n  // TODO: Borrow API from Apple: // TODO: Borrow API from Apple: https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/DisplayNotifications.html#//apple_ref/doc/uid/TP40016239-CH61-SW1\n  const showNotification = useCallback(\n    ({ image, title, body, onClick, onClose = () => null }) => {\n      setActiveNotificationsStack(\n        // Add new notifications to end of stack\n        prev => [\n          ...prev,\n          { image, title, body, uuid: uuidv4(), onClick, onClose },\n        ]\n      );\n    },\n    []\n  );\n\n  // TODO: Document\n  const handleNotificationClose = useCallback(uuid => {\n    setActiveNotificationsStack(prev =>\n      prev.filter(({ uuid: prevUUID, onClose }) => {\n        const isKept = uuid !== prevUUID;\n\n        if (!isKept) {\n          // Call the onClose handler passed to showNotification\n          onClose();\n        }\n\n        return isKept;\n      })\n    );\n  }, []);\n\n  return (\n    <NotificationsContext.Provider\n      value={{\n        showNotification,\n      }}\n    >\n      {children}\n\n      <NotificationsStack\n        notifications={activeNotificationsStack}\n        onNotificationClose={handleNotificationClose}\n      />\n    </NotificationsContext.Provider>\n  );\n}\n","import Desktop from \"./Desktop\";\n\nexport default Desktop;\n","import PhantomCore from \"phantom-core\";\n\nimport WindowManager from \"../WindowManager\";\nimport Cover from \"../Cover\";\nimport Layout, { Header, Content, Row, Column } from \"../Layout\";\nimport LED from \"../LED\";\nimport Dock from \"../Dock\";\nimport AutoScaler from \"../AutoScaler\";\n\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nimport ReShellCore from \"@core\";\n\n// TODO: Change this to use data-driven Menubar\nimport Menu, {\n  MenuButton,\n  MenuItem,\n  MenuHeader,\n  MenuDivider,\n  SubMenu,\n} from \"../_Menu.LibWrapper\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useServicesContext from \"@hooks/useServicesContext\";\nimport useAppRegistrationsContext from \"@hooks/useAppRegistrationsContext\";\nimport useAppRuntimesContext from \"@hooks/useAppRuntimesContext\";\nimport useAppRegistrationLink from \"@hooks/useAppRegistrationLink\";\n\nimport { REGISTRATION_ID as SERVICE_MONITOR_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/ServiceMonitor\";\n\nimport NotificationsProvider from \"./providers/NotificationsProvider\";\n\n// import { useEffect } from \"react\";\n\n// TODO: Implement top menu-bar\n// @see https://headlessui.dev/react/menu\n// or (better?) https://szhsin.github.io/react-menu\n\n// TODO: Implement context menu\n// @see https://szhsin.github.io/react-menu/#context-menu\n\n// TODO: Backgrounds?\n// @see https://coolbackgrounds.io (particles: https://github.com/marcbruederlin/particles.js)\n// @see [Unsplash 3D renders] https://unsplash.com/blog/unsplash-library-now-accepts-3d-renders/?utm_source=vero&utm_medium=email&utm_content=control&utm_campaign=Unsplash%20Awards%20Announcement&utm_term=Newsletter&vero_id=6421463&vero_conv=PmNPLiUVlfrNjJJhv6nsCKDC_PNDDxf0FWY02n1x7jyPWwq0KgHl-nQmk0Pq6aTzRvvwjcixMGRPZlAmMwIqQz72F0DGURijjA%3D%3D\n\n// TODO: Use prop-types\nexport default function Desktop({\n  backgroundView = <div style={{ backgroundColor: \"#ccc\" }} />,\n  appDescriptors,\n}) {\n  const { link: openServiceMonitor } = useAppRegistrationLink(\n    SERVICE_MONITOR_REGISTRATION_ID\n  );\n\n  const { services } = useServicesContext();\n  const { activeWindowController /* addBackgroundAsset */ } =\n    useDesktopContext();\n  const { appRegistrations } = useAppRegistrationsContext();\n  const { bringToFrontOrStartAppRuntime, appRuntimes } =\n    useAppRuntimesContext();\n\n  // TODO: Implement after PhantomWrapper (or equiv.; assets need to be wrapped in\n  // PhantomCore instances in order to be added to background collection)\n  /*\n  useEffect(() => {\n    if (backgroundView) {\n      addBackgroundAsset(backgroundView);\n    }\n  }, [backgroundView, addBackgroundAsset]);\n  */\n\n  return (\n    // NOTE: Typically this would take up the entire viewport\n    <Router>\n      {\n        // IMPORTANT: Using NotificationsProvider directly on the BaseView does\n        // not apply CSS module styling\n      }\n      <NotificationsProvider>\n        <Cover>\n          {\n            // TODO: Refactor\n          }\n          {backgroundView}\n        </Cover>\n        <Cover>\n          <Layout>\n            <Header\n              style={{\n                // borderBottom: \"1px #ccc solid\",\n                whiteSpace: \"nowrap\",\n                backgroundColor: \"rgba(0,0,0,.5)\",\n              }}\n            >\n              <Row>\n                <Column style={{ width: \"100%\" }}>\n                  {\n                    // TODO: Replace menu with data-driven Menubar component\n                  }\n                  <div>\n                    <Menu\n                      menuButton={\n                        <MenuButton>\n                          {\n                            // TODO: Make this string configurable\n                          }\n                          Desktop\n                        </MenuButton>\n                      }\n                    >\n                      {\n                        // TODO: Show divider\n                      }\n                      <SubMenu label=\"Applications\">\n                        {appRegistrations\n                          .sort((a, b) => {\n                            const aTitle = a.getTitle();\n                            const bTitle = b.getTitle();\n\n                            if (aTitle < bTitle) {\n                              return -1;\n                            } else if (bTitle > aTitle) {\n                              return 1;\n                            } else {\n                              return 0;\n                            }\n                          })\n                          .map(app => (\n                            <MenuItem\n                              key={app.getUUID()}\n                              onClick={() => bringToFrontOrStartAppRuntime(app)}\n                            >\n                              {app.getTitle()}\n                            </MenuItem>\n                          ))}\n                      </SubMenu>\n                      {\n                        // TODO: Include LED to show state of application (i.e. \"green\" for \"open\" / \"gray\" for \"close\")\n                      }\n                      {appRegistrations\n                        .filter(app => app.getIsPinned())\n                        .map(app => (\n                          <MenuItem\n                            key={app.getUUID()}\n                            onClick={() => bringToFrontOrStartAppRuntime(app)}\n                          >\n                            {app.getTitle()}\n                          </MenuItem>\n                        ))}\n                      <MenuDivider />\n                      <MenuHeader>Global Window Management</MenuHeader>\n                      <MenuItem\n                        // TODO: Refactor\n                        onClick={() =>\n                          appRuntimes.forEach(runtime => {\n                            const windowController =\n                              runtime.getWindowController();\n\n                            if (windowController) {\n                              windowController.scatter();\n                            }\n                          })\n                        }\n                      >\n                        Scatter Windows\n                      </MenuItem>\n                      <MenuItem\n                        // TODO: Refactor\n                        onClick={() =>\n                          appRuntimes.forEach(runtime => {\n                            const windowController =\n                              runtime.getWindowController();\n\n                            if (windowController) {\n                              windowController.center();\n                            }\n                          })\n                        }\n                      >\n                        Center Windows\n                      </MenuItem>\n                      <MenuDivider />\n                      <MenuHeader>Desktop Operations</MenuHeader>\n                      <MenuItem\n                        onClick={() =>\n                          window.confirm(\n                            \"Are you sure you wish to close the desktop?\"\n                          ) && ReShellCore.destroy()\n                        }\n                      >\n                        Close\n                      </MenuItem>\n                      <MenuItem\n                        onClick={() =>\n                          window.confirm(\"Are you sure you wish to reload?\") &&\n                          ReShellCore.reload()\n                        }\n                      >\n                        Reload\n                      </MenuItem>\n                    </Menu>\n                    {activeWindowController && (\n                      <>\n                        {\n                          // TODO: Implement quadrant snapping here\n                        }\n                        <Menu\n                          portal={true}\n                          menuButton={\n                            <MenuButton>\n                              <span style={{ fontWeight: \"bold\" }}>\n                                {activeWindowController.getTitle()}\n                              </span>\n                            </MenuButton>\n                          }\n                        >\n                          <MenuItem\n                            onClick={() => activeWindowController.destroy()}\n                          >\n                            Close\n                          </MenuItem>\n                        </Menu>\n                        <Menu\n                          portal={true}\n                          menuButton={<MenuButton>Window</MenuButton>}\n                        >\n                          {\n                            // TODO: Refresh items when activeWindowController updates\n                          }\n                          <MenuItem\n                            onClick={() =>\n                              activeWindowController.setIsMinimized(true)\n                            }\n                            // disabled={activeWindowController?.getIsMinimized()}\n                          >\n                            Minimize\n                          </MenuItem>\n                          <MenuItem\n                            onClick={() =>\n                              activeWindowController.setIsMaximized(true)\n                            }\n                            // disabled={activeWindowController?.getIsMaximized()}\n                          >\n                            Maximize\n                          </MenuItem>\n                          <MenuItem\n                            onClick={() => activeWindowController.restore()}\n                            // disabled={}\n                          >\n                            Restore\n                          </MenuItem>\n                          <MenuDivider />\n                          <MenuItem\n                            onClick={() => activeWindowController.center()}\n                          >\n                            Center\n                          </MenuItem>\n                          <MenuItem\n                            onClick={() => activeWindowController.scatter()}\n                          >\n                            Scatter\n                          </MenuItem>\n                        </Menu>\n                      </>\n                    )}\n                  </div>\n                </Column>\n                <Column\n                  style={{\n                    // TODO: Rework so column width expands according to content\n                    maxWidth: 110,\n                  }}\n                >\n                  <div style={{ textAlign: \"right\" }}>\n                    <Menu\n                      portal={true}\n                      menuButton={\n                        <MenuButton>\n                          Service Core{\" \"}\n                          <LED color={services.length > 0 ? \"green\" : \"gray\"} />\n                        </MenuButton>\n                      }\n                    >\n                      {services.length === 0 ? (\n                        <MenuItem>\n                          <span style={{ fontStyle: \"italic\" }}>\n                            No running services\n                          </span>\n                        </MenuItem>\n                      ) : (\n                        services.map(service => (\n                          <MenuItem\n                            key={service.getUUID()}\n                            // TODO: Open direct service in service monitor\n                            onClick={openServiceMonitor}\n                          >\n                            {service.getTitle()}\n                          </MenuItem>\n                        ))\n                      )}\n                    </Menu>\n                  </div>\n                </Column>\n              </Row>\n            </Header>\n            <Content>\n              {\n                // TODO: Allow videos to play on background\n              }\n\n              {\n                // TODO: Refactor into a version component\n              }\n              <div\n                style={{\n                  maxWidth: \"50%\",\n                  position: \"absolute\",\n                  bottom: 28,\n                  right: 10,\n                  color: \"rgba(255,255,255,.2)\",\n                  fontSize: \"2rem\",\n                }}\n              >\n                {\n                  // TODO: Read from package.json\n                  // @see https://stackoverflow.com/questions/48609931/how-can-i-reference-package-version-in-npm-script/48619640\n                  // (i.e. REACT_APP_VERSION=$npm_package_version)\n                  //\n                  // TODO: If wanting to overlay completely on top of all other windows, and ignore mouse, etc:\n                  // use CSS [pointer-events: none]\n                }\n                <AutoScaler style={{ whiteSpace: \"nowrap\" }}>\n                  <div style={{ textAlign: \"left\", fontSize: \".7em\" }}>\n                    <div>ReShell 0.0.1-alpha</div>\n                    <div>PhantomCore {PhantomCore.getPhantomCoreVersion()}</div>\n                    <div>Portal: {ReShellCore.getPortalName()}</div>\n                    <div>Env: {process.env.NODE_ENV}</div>\n                  </div>\n                </AutoScaler>\n              </div>\n              <WindowManager appDescriptors={appDescriptors}>\n                <Dock />\n              </WindowManager>\n            </Content>\n          </Layout>\n        </Cover>\n      </NotificationsProvider>\n    </Router>\n  );\n}\n","import VirtualLink from \"./VirtualLink\";\n\nexport default VirtualLink;\n","import ButtonTransparent from \"../ButtonTransparent\";\n\nimport styles from \"./VirtualLink.module.css\";\nimport classNames from \"classnames\";\n\n/**\n * NOTE: Fake links need to be a button, so this button is designed to look\n * like a real link, for the most part.\n */\nexport default function VirtualLink({ children, className, onClick, ...rest }) {\n  return (\n    <ButtonTransparent\n      {...rest}\n      // IMPORTANT: The seemingly double link styles are placed on purpose (one\n      // is the normal CSS, and the other is the module.css override)\n      className={classNames(\"link\", styles[\"virtual-link\"], className)}\n      onClick={onClick}\n    >\n      {children}\n    </ButtonTransparent>\n  );\n}\n","import { useCallback, useEffect, useRef, useState } from \"react\";\n\n/**\n * Fix issue on iOS 13 where ResizeObserver isn't available.\n */\nimport { install } from \"resize-observer\";\nif (!window.ResizeObserver) {\n  install();\n}\n\n/**\n * Determines if the given element is overflowing its container.\n *\n * Note: Some ideas were taken from these links, however the final solution\n * was not found within.\n * @see https://stackoverflow.com/questions/9333379/check-if-an-elements-content-is-overflowing\n * @see https://github.com/wojtekmaj/detect-element-overflow/blob/main/src/index.js\n *\n * @param {HTMLElement} element\n * @param {Object} isDetecting? [optional; default = true] Whether or not the\n * hook should detect overflow.\n * @return {boolean}\n */\nexport default function useOverflowDetection(element, isDetecting = true) {\n  const refPrevIsOverflown = useRef(null);\n\n  /**\n   * @return {boolean} Whether or not the element is overflowing its parent.\n   */\n  const getIsOverflown = useCallback(() => {\n    if (element) {\n      // Height / width of the inner element, including padding and borders\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetHeight\n      const innerOffsetHeight = element.offsetHeight;\n      const innerOffsetWidth = element.offsetWidth;\n\n      const parentNode = element.parentNode;\n\n      // Height / width of the outer element, including padding but excluding\n      // borders, margins, and scrollbars\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Element/clientHeight\n      const outerHeight = parentNode?.clientHeight;\n      const outerWidth = parentNode?.clientWidth;\n\n      if (outerHeight < innerOffsetHeight || outerWidth < innerOffsetWidth) {\n        return true;\n      } else {\n        return false;\n      }\n    } else {\n      return false;\n    }\n  }, [element]);\n\n  const [isOverflown, setIsOverflown] = useState(() => getIsOverflown());\n\n  refPrevIsOverflown.current = isOverflown;\n\n  useEffect(() => {\n    if (isDetecting && element) {\n      let _isUnmounting = false;\n\n      /**\n       * Handles checking of overflown, comparing it with previous state, and\n       * determining if the hook state should be updated.\n       *\n       * Sets hook state once detection has been performed.\n       *\n       * @return {void}\n       */\n      const checkIsOverflown = () => {\n        if (_isUnmounting) {\n          return;\n        }\n\n        const prevIsOverflown = refPrevIsOverflown.current;\n\n        const nextIsOverflown = getIsOverflown();\n\n        if (prevIsOverflown !== nextIsOverflown) {\n          setIsOverflown(nextIsOverflown);\n        }\n      };\n\n      const ro = new ResizeObserver((/* entries */) => {\n        /**\n         * IMPORTANT: requestAnimationFrame is used here to prevent possible\n         * \"resize-observer loop limit exceeded error.\"\n         *\n         * \"This error means that ResizeObserver was not able to deliver all\n         * observations within a single animation frame. It is benign (your site\n         * will not break).\"\n         *\n         * @see https://stackoverflow.com/questions/49384120/resizeobserver-loop-limit-exceeded\n         */\n        window.requestAnimationFrame(checkIsOverflown);\n      });\n\n      ro.observe(element);\n      ro.observe(element.parentNode);\n\n      /*\n      const mo = new MutationObserver(() => {\n        window.requestAnimationFrame(checkIsOverflown);\n      });\n      */\n\n      // FIXME: (jh) Re-enable?\n      /*\n      mo.observe(element, {\n        childList: true,\n        subtree: true,\n      });\n      */\n\n      return function unmount() {\n        _isUnmounting = true;\n\n        ro.observe(element);\n        ro.unobserve(element.parentNode);\n        // mo.disconnect();\n      };\n    }\n  }, [isDetecting, element, getIsOverflown]);\n\n  return isOverflown;\n}\n","import Center from \"./Center\";\n\nexport default Center;\n","import React, { useState } from \"react\";\n\nimport classNames from \"classnames\";\nimport styles from \"./Center.module.css\";\n\nimport useOverflowDetection from \"@hooks/useOverflowDetection\";\n\nimport PropTypes from \"prop-types\";\n\nCenter.propTypes = {\n  /**\n   * Whether or not content can overflow when the Center content overflows it\n   * outer wrapper.\n   */\n  canOverflow: PropTypes.bool,\n};\n\nexport default function Center({\n  children,\n  className,\n  canOverflow = false,\n  ...rest\n}) {\n  const [innerEl, setInnerEl] = useState(null);\n\n  const isOverflown = useOverflowDetection(innerEl, canOverflow);\n\n  return (\n    <div\n      className={classNames(\n        styles[\"center\"],\n        canOverflow && isOverflown && styles[\"overflown\"],\n        className\n      )}\n    >\n      <div ref={setInnerEl} {...rest} className={styles[\"inner-wrap\"]}>\n        {children}\n      </div>\n    </div>\n  );\n}\n","/**\n * Consumes a variable without using it.\n *\n * @param {any} obj\n * @return {null}\n */\nexport default function consume(obj) {\n  return Boolean(obj) ? null : null;\n}\n","import { useMemo } from \"react\";\nimport Center from \"@components/Center\";\nimport LED from \"@components/LED\";\nimport Padding from \"@components/Padding\";\n\nimport useAppRegistrationsContext from \"@hooks/useAppRegistrationsContext\";\nimport useAppRuntimesContext from \"@hooks/useAppRuntimesContext\";\n\nimport consume from \"@utils/consume\";\n\nexport default function ApplicationSelector({\n  searchQuery = \"\",\n  onResetSearchQuery,\n}) {\n  const { appRegistrations } = useAppRegistrationsContext();\n  const {\n    appRuntimes,\n    // TODO: Change alias after deciding how to merge these in AppRuntimesProvider\n    bringToFrontOrStartAppRuntime: startAppRuntime,\n  } = useAppRuntimesContext();\n\n  const appRuntimeRegistrations = useMemo(\n    () => appRuntimes.map(runtime => runtime.getRegistration()),\n    [appRuntimes]\n  );\n\n  // TODO: Move application search into a service and implement keyword-based\n  // searching, other criteria\n  const filteredRegistrations = useMemo(\n    () =>\n      appRegistrations.filter(registration =>\n        !Boolean(searchQuery)\n          ? true\n          : registration\n              .getTitle()\n              .toUpperCase()\n              .includes(searchQuery.toUpperCase())\n      ),\n    [appRegistrations, searchQuery]\n  );\n\n  if (searchQuery?.length && !filteredRegistrations.length) {\n    return (\n      <Center>\n        <Padding style={{ fontWeight: \"bold\" }}>\n          No applications found for search.\n        </Padding>\n        <Padding>\n          <button onClick={onResetSearchQuery}>Reset Search Query</button>\n        </Padding>\n      </Center>\n    );\n  }\n\n  return (\n    <Center canOverflow={true}>\n      <Padding>\n        {filteredRegistrations.map(registration => {\n          // const isRunning = appRuntimeRegistrations.includes(registration);\n          const totalInstances = appRuntimeRegistrations.filter(\n            predicate => predicate === registration\n          ).length;\n\n          return (\n            <button\n              key={registration.getUUID()}\n              // TODO: Extract to module.css\n              style={{\n                width: 100,\n                height: 100,\n                overflow: \"hidden\",\n                backgroundColor: \"transparent\",\n                borderColor: totalInstances > 0 ? \"green\" : \"\",\n              }}\n              onClick={() => startAppRuntime(registration)}\n            >\n              {registration.getTitle()}\n              <div style={{ position: \"absolute\", bottom: 0, right: 0 }}>\n                {[...new Array(totalInstances)].map((nonUsed, idx) => {\n                  consume(nonUsed);\n\n                  return (\n                    <LED\n                      key={idx}\n                      color={totalInstances > 0 ? \"green\" : \"gray\"}\n                      // TODO: Extract to module.css\n                      style={{ margin: \"0px 2px\" }}\n                    />\n                  );\n                })}\n              </div>\n            </button>\n          );\n        })}\n      </Padding>\n    </Center>\n  );\n}\n","import Center from \"@components/Center\";\n\nimport ReShellCore from \"@core\";\n\nexport default function PortalSwitcher() {\n  return (\n    <Center canOverflow={true}>\n      {Object.entries(ReShellCore.getPortals()).map(([portalName]) => (\n        <button\n          key={portalName}\n          onClick={() => ReShellCore.switchToPortal(portalName)}\n        >\n          {portalName}\n        </button>\n      ))}\n    </Center>\n  );\n}\n","import ReShellCore from \"@core\";\n\nimport { useCallback, useEffect, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\nimport VirtualLink from \"@components/VirtualLink\";\n\nimport ApplicationSelector from \"./views/ApplicationSelector\";\nimport PortalSwitcher from \"./views/PortalSelector\";\n\nconst LEN_PORTALS = Object.keys(ReShellCore.getPortals()).length;\n\nconst DEFAULT_SEARCH_QUERY = \"\";\n\nconst Applications = {\n  id: \"applications\",\n  title: \"Applications\",\n  style: {\n    width: 640,\n    height: 400,\n  },\n  isAutoStart: true,\n  isPinnedToDock: true,\n  initialSharedState: {\n    searchQuery: DEFAULT_SEARCH_QUERY,\n  },\n  // TODO: Implement the ability to set control handlers which can be driven by the menu\n  /*\n  controlMethods: {\n    // [ROLE_WINDOW_MENU_SUBITEM]\n    setIsDisplayingPortals: ({...samePropsAsView, etc.}) => {\n    }\n  },\n  */\n  // TODO: Implement custom menu functionality\n  /**\n  menu: {\n    window: [\n      {\n        role: 'view-switch'\n        getIsShown: ({sharedState}) => !sharedState.isShowingApplications\n        title: 'Show Applications',\n        onClick: ({controlMethods}) => ...\n      },\n      {\n        role: 'view-switch'\n        getIsShown: ({sharedState}) => sharedState.isShowingApplications\n        title: 'Show Portals',\n        onClick: ({controlMethods}) => ...\n      },\n  ]\n  }\n  */\n  titleBarView: function TitleBarView({ sharedState, setSharedState }) {\n    const handleSetSearchQuery = useCallback(\n      evt => setSharedState({ searchQuery: evt.target.value }),\n      [setSharedState]\n    );\n\n    const handleDoubleClick = useCallback(\n      evt => {\n        // Prevent double-clicks from resizing the window if there is text in\n        // the search bar\n        if (Boolean(sharedState.searchQuery)) {\n          evt.stopPropagation();\n        }\n      },\n      [sharedState]\n    );\n\n    return (\n      <Padding>\n        {\n          // TODO: Automatically focus when window is activated (unless on mobile)\n          // TODO: Switch to Applications view on change\n        }\n        <input\n          placeholder=\"Search Applications\"\n          onChange={handleSetSearchQuery}\n          value={sharedState.searchQuery}\n          style={{ width: \"100%\" }}\n          onDoubleClick={handleDoubleClick}\n        />\n      </Padding>\n    );\n  },\n  view: function View({ windowController, sharedState, setSharedState }) {\n    const [isDisplayingPortals, setIsDisplayingPortals] = useState(false);\n\n    // Auto-switch window title depending on \"Applications\" or \"Portals\" mode\n    useEffect(() => {\n      windowController.setTitle(\n        !isDisplayingPortals ? \"Applications\" : \"Portals\"\n      );\n    }, [windowController, isDisplayingPortals]);\n\n    const searchQuery = sharedState?.searchQuery;\n\n    const handleResetSearchQuery = useCallback(\n      () => setSharedState({ searchQuery: DEFAULT_SEARCH_QUERY }),\n      [setSharedState]\n    );\n\n    return (\n      <Layout>\n        <Content>\n          {!isDisplayingPortals ? (\n            <ApplicationSelector\n              searchQuery={searchQuery}\n              onResetSearchQuery={handleResetSearchQuery}\n            />\n          ) : (\n            <PortalSwitcher />\n          )}\n        </Content>\n        {Boolean(LEN_PORTALS > 1) && (\n          <Footer>\n            <Padding>\n              <button onClick={() => setIsDisplayingPortals(prev => !prev)}>\n                {!isDisplayingPortals ? \"Portals\" : \"Applications\"}\n              </button>{\" \"}\n              <span className=\"note\">\n                {!isDisplayingPortals ? (\n                  <>\n                    Other applications may be available in{\" \"}\n                    <VirtualLink onClick={() => setIsDisplayingPortals(true)}>\n                      another portal\n                    </VirtualLink>\n                    .\n                  </>\n                ) : (\n                  <>\n                    Return to{\" \"}\n                    <VirtualLink onClick={() => setIsDisplayingPortals(false)}>\n                      application list\n                    </VirtualLink>\n                    .\n                  </>\n                )}\n              </span>\n            </Padding>\n          </Footer>\n        )}\n      </Layout>\n    );\n  },\n};\n\nexport default Applications;\n","import Applications from \"./Applications\";\n\nexport default Applications;\n","import Applications from \"../../ExamplePortal/apps/Applications\";\n\nconst ApplicationsOverride = {\n  ...Applications,\n  isAutoStart: false,\n};\n\nexport default ApplicationsOverride;\n","import consume from \"@utils/consume\";\nimport { useEffect, useState } from \"react\";\nimport Timer from \"@components/Timer\";\nimport { EVT_RENDER_PROFILED } from \"@components/Window/classes/WindowController\";\nimport LED from \"@components/LED\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\n\nexport default function AppRuntimeTableRow({ appRuntime }) {\n  const { activeWindowController } = useDesktopContext();\n\n  const windowController = appRuntime.getWindowController();\n\n  const isTopMostWindowController =\n    !windowController || windowController === activeWindowController;\n\n  const [elProfilerPhase, setElProfilerPhase] = useState(null);\n  const [elProfilerActualDuration, setElProfilerActualDuration] =\n    useState(null);\n  const [elProfilerBaseDuration, setElProfilerBaseDuration] = useState(null);\n  const [elProfilerStartTime, setElProfilerStartTime] = useState(null);\n  const [elProfilerCommitTime, setElProfilerCommitTime] = useState(null);\n  const [elProfilerInteractions, setElProfilerInteractions] = useState(null);\n\n  useEffect(() => {\n    if (windowController && elProfilerPhase) {\n      // @see https://reactjs.org/docs/profiler.html\n      const handleRenderProfile = arrRenderProfile => {\n        // IMPORTANT: (jh) This was not cast to an Object because I'm not\n        // positive if that would induce a lot of extra overhead over time;\n        // React defines this as an array, so maybe it's best just leaving it\n        // the way it is\n        const [\n          id, // the \"id\" prop of the Profiler tree that has just committed\n          phase, // either \"mount\" (if the tree just mounted) or \"update\" (if it re-rendered)\n          actualDuration, // time spent rendering the committed update\n          baseDuration, // estimated time to render the entire subtree without memoization\n          startTime, // when React began rendering this update\n          commitTime, // when React committed this update\n          interactions, // the Set of interactions belonging to this update\n        ] = arrRenderProfile;\n\n        // We're not doing anything w/ id, but if we remove it from the array,\n        // the other variable names are out of sync\n        consume(id);\n\n        // We have to skip setting these as state or we'll run into an infinite loop\n        elProfilerPhase.innerHTML = phase;\n        elProfilerActualDuration.innerHTML =\n          parseFloat(actualDuration).toFixed(2);\n        elProfilerBaseDuration.innerHTML = parseFloat(baseDuration).toFixed(2);\n        elProfilerStartTime.innerHTML = parseFloat(startTime / 1000).toFixed(2);\n        elProfilerCommitTime.innerHTML = parseFloat(commitTime / 1000).toFixed(\n          2\n        );\n        elProfilerInteractions.innerHTML = Object.values(interactions).length;\n      };\n\n      windowController.on(EVT_RENDER_PROFILED, handleRenderProfile);\n\n      return function unmount() {\n        windowController.off(EVT_RENDER_PROFILED, handleRenderProfile);\n      };\n    }\n  }, [\n    windowController,\n    elProfilerPhase,\n    elProfilerActualDuration,\n    elProfilerBaseDuration,\n    elProfilerStartTime,\n    elProfilerCommitTime,\n    elProfilerInteractions,\n  ]);\n\n  return (\n    <>\n      <tr key={appRuntime.getUUID()} style={{ textAlign: \"center\" }}>\n        <td>{appRuntime.getTitle() || \"[Untitled]\"}</td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerPhase}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerActualDuration}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerBaseDuration}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerStartTime}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerCommitTime}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerInteractions}>N/A</span>\n        </td>\n      </tr>\n      <tr style={{ textAlign: \"center\" }}>\n        <td style={{ fontStyle: \"italic\" }}>\n          Uptime: <Timer onTick={() => appRuntime.getInstanceUptime()} />\n        </td>\n        <td colSpan=\"3\">\n          <button\n            // TODO: Implement alternate handling\n            onClick={() => console.log({ appRuntime })}\n            disabled\n          >\n            Process\n          </button>\n          <span> | </span>\n          <button\n            // TODO: Implement alternate handling\n            onClick={() =>\n              console.log({ environment: appRuntime.getEnvironment() })\n            }\n            disabled\n          >\n            Environment\n          </button>\n        </td>\n        <td>\n          <LED color={isTopMostWindowController ? \"green\" : \"gray\"} />\n        </td>\n        <td colSpan=\"2\">\n          <button\n            onClick={() => windowController.bringToTop()}\n            style={{ backgroundColor: \"blue\" }}\n            disabled={isTopMostWindowController}\n          >\n            Bring to Top\n          </button>\n          <span> | </span>\n          <button\n            onClick={() => appRuntime.destroy()}\n            style={{ backgroundColor: \"red\" }}\n          >\n            Close\n          </button>\n        </td>\n      </tr>\n      <tr>\n        <td colSpan=\"7\" style={{ backgroundColor: \"gray\", height: 4 }}></td>\n      </tr>\n    </>\n  );\n}\n","import AppRuntimeTableRow from \"./AppRuntime.Table.Row\";\n\n// TODO: Document\nexport default function AppRuntimeTable({ appRuntimes }) {\n  return (\n    <table style={{ width: \"100%\" }}>\n      <thead>\n        <tr>\n          <td rowSpan=\"2\">Name</td>\n          <td colSpan=\"6\" style={{ backgroundColor: \"purple\" }}>\n            Profiler\n          </td>\n          <td colSpan=\"2\"></td>\n        </tr>\n        <tr>\n          <td style={{ backgroundColor: \"purple\" }}>Phase</td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Actual\n            <br />\n            Duration\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Base\n            <br />\n            Duration\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Start\n            <br />\n            Time\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Commit\n            <br />\n            Time\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>Interactions</td>\n        </tr>\n      </thead>\n      <tbody>\n        {appRuntimes.map((runtime) => (\n          <AppRuntimeTableRow key={runtime.getUUID()} appRuntime={runtime} />\n        ))}\n      </tbody>\n    </table>\n  );\n}\n","import PhantomCore from \"phantom-core\";\n\nimport Padding from \"@components/Padding\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport AppRuntimeTable from \"./AppRuntime.Table\";\nimport Timer from \"@components/Timer\";\n\nimport useAppRuntimesContext from \"@hooks/useAppRuntimesContext\";\n\nconst ApplicationMonitor = {\n  id: \"application-monitor\",\n  title: \"Application Monitor\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  isPinned: true,\n  view: function View() {\n    const { appRuntimes } = useAppRuntimesContext();\n\n    // TODO: Determine if profiler is available in the current environment\n\n    // TODO: Group by registration\n    // TODO: Show attached services, per application\n    // TODO: Show last render time / frequency / graph?\n    // TODO: Implement ability to record render profile intervals, with the ability to show them in a graph (per application; use legend)\n    // TODO: Implement ability to show how linked services affect render profiles; capture in recordings\n    // TODO: Implement ability to do call stack tracing (only when recording)\n\n    return (\n      <Layout>\n        <Content>\n          <Padding style={{ overflowY: \"auto\" }}>\n            <AppRuntimeTable appRuntimes={appRuntimes} />\n          </Padding>\n        </Content>\n        <Footer style={{ fontSize: \".8rem\" }}>\n          <Padding>\n            Phantom Core uptime:{\" \"}\n            <Timer onTick={() => PhantomCore.getUptime()} />\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ApplicationMonitor;\n","import ApplicationMonitor from \"./ApplicationMonitor\";\n\nexport default ApplicationMonitor;\n","import ButtonPanel from \"./ButtonPanel\";\n\nexport default ButtonPanel;\n","import React, { useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\n\nButtonPanel.propTypes = {\n  buttons: PropTypes.arrayOf(\n    PropTypes.shape({\n      // TODO: Require to be React component (or any?)\n      // TODO: Rename to view, or label\n      content: PropTypes.any.isRequired,\n\n      onClick: PropTypes.func.isRequired,\n\n      disabled: PropTypes.bool,\n\n      // Optional style override\n      style: PropTypes.string,\n\n      // Optional style override\n      className: PropTypes.string,\n\n      /** If set to true, this acts as the default button */\n      isSelected: PropTypes.bool,\n    })\n  ),\n};\n\nexport default function ButtonPanel({ buttons, className, ...rest }) {\n  const [selectedIdx, setSelectedIdx] = useState(() => {\n    let selectedIdx = 0;\n\n    buttons.forEach((button, idx) => {\n      if (button.isSelected) {\n        selectedIdx = idx;\n      }\n    });\n\n    return selectedIdx;\n  });\n\n  // TODO: Document\n  const refRenderIdx = useRef(-1);\n  ++refRenderIdx.current;\n\n  return (\n    <div className={classNames(\"button-group\", className)} {...rest}>\n      {buttons.map(\n        (\n          {\n            content: Content,\n            onClick,\n            disabled,\n            isSelected,\n            style,\n            className,\n            ...args\n          },\n          idx\n        ) => {\n          // If first render, and we're at the defaultSelectedIdx, call the onClick handler\n          // TODO: Detect if first render of React after page updates\n          if (refRenderIdx.current === 0 && selectedIdx === idx) {\n            // Fixes issue:  Cannot update a component (`X`) while rendering a\n            // different component (`Y`).\n            setTimeout(() => {\n              onClick();\n            });\n          }\n\n          return (\n            <button\n              {...args}\n              key={idx}\n              onClick={() => {\n                setSelectedIdx(idx);\n\n                onClick();\n              }}\n              disabled={disabled}\n              style={style}\n              className={classNames([\n                selectedIdx === idx && \"active\",\n                className,\n              ])}\n            >\n              {\n                // TODO: Refactor\n                typeof Content === \"string\" ? (\n                  Content\n                ) : typeof Content === \"function\" ? (\n                  <Content />\n                ) : (\n                  { Content }\n                )\n              }\n            </button>\n          );\n        }\n      )}\n    </div>\n  );\n}\n","import ExternalLink from \"./ExternalLink\";\n\nexport default ExternalLink;\n","export default function ExternalLink({ children, target = \"_blank\", ...rest }) {\n  return (\n    <a {...rest} target={target}>\n      {children}\n    </a>\n  );\n}\n","import VirtualLinkButton from \"./VirtualLinkButton\";\n\nexport default VirtualLinkButton;\n","/**\n * NOTE: Fake links need to be a button, so this button is designed to look\n * like a real link, for the most part.\n */\nexport default function VirtualLinkButton({\n  children,\n  className,\n  onClick,\n  ...rest\n}) {\n  return (\n    <button {...rest} onClick={onClick}>\n      {children}\n    </button>\n  );\n}\n","import ExternalLinkButton from \"./ExternalLinkButton\";\n\nexport default ExternalLinkButton;\n","import VirtualLinkButton from \"../VirtualLinkButton\";\n\n// TODO: Document w/ prop-types\nexport default function ExternalLinkButton({\n  href,\n  target = \"_blank\",\n  ...rest\n}) {\n  return (\n    <VirtualLinkButton\n      {...rest}\n      // TODO: Refactor to useCallback\n      onClick={() => window.open(href, target)}\n    />\n  );\n}\n","import Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport ExternalLink from \"@components/ExternalLink\";\nimport ExternalLinkButton from \"@components/ExternalLinkButton\";\nimport VirtualLinkButton from \"@components/VirtualLinkButton\";\n\nconst LINKS = {\n  \"Phantom Core\": \"https://github.com/zenOSmosis/phantom-core\",\n  \"Phantom Collection\":\n    \"https://github.com/zenOSmosis/phantom-core/tree/main/src/PhantomCollection\",\n\n  \"ReShell Core\": \"https://github.com/zenOSmosis/reshell.org-static\",\n\n  \"Sync Object\": \"https://github.com/zenOSmosis/sync-object\",\n  \"MediaStream Controller\":\n    \"https://github.com/zenOSmosis/media-stream-track-controller\",\n  \"webrtc-peer\": \"https://github.com/zenOSmosis/webrtc-peer\",\n};\n\n// TODO: Refactor\nconst LINK_BUTTON_STYLE = {\n  minHeight: \"4em\",\n  whiteSpace: \"wrap\",\n  width: \"100%\",\n  height: \"100%\",\n};\n\nexport default function Details() {\n  return (\n    <Full style={{ overflowY: \"auto\" }}>\n      <p>\n        ReShell is a browser-based layout framework and UI services engine\n        composed of various{\" \"}\n        <a\n          href=\"https://github.com/zenosmosis\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          open-source components\n        </a>\n        .\n      </p>\n      <p>\n        It is currently in an alpha phase, and other builds may have other\n        built-in applications.\n      </p>\n      <p>\n        Leveraged off of the core code for{\" \"}\n        <ExternalLink href=\"https://speaker.app\">Speaker.app</ExternalLink> and\n        other{\" \"}\n        <ExternalLink href=\"https://zenosmosis.com\">zenOSmosis</ExternalLink>{\" \"}\n        projects based on{\" \"}\n        <ExternalLink href=\"https://github.com/zenOSmosis/phantom-core\">\n          PhantomCore\n        </ExternalLink>\n        , a library for managing the JavaScript application lifecycle.\n      </p>\n\n      <p style={{ fontWeight: \"bold\" }}>Some included technologies:</p>\n\n      <div style={{ textAlign: \"center\" }}>\n        <div\n          style={{ display: \"inline-grid\", gridTemplateColumns: \"1fr 1fr 1fr\" }}\n        >\n          {Object.entries(LINKS).map(([title, urlOrAction], idx) => {\n            return (\n              <Padding key={idx}>\n                {typeof urlOrAction === \"string\" ? (\n                  <ExternalLinkButton\n                    href={urlOrAction}\n                    style={LINK_BUTTON_STYLE}\n                  >\n                    {title}\n                  </ExternalLinkButton>\n                ) : (\n                  <VirtualLinkButton\n                    onClick={urlOrAction}\n                    style={LINK_BUTTON_STYLE}\n                  >\n                    {title}\n                  </VirtualLinkButton>\n                )}\n              </Padding>\n            );\n          })}\n        </div>\n      </div>\n    </Full>\n  );\n}\n","import Details from \"./Details\";\n\nexport default Details;\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport ExternalLink from \"@components/ExternalLink\";\n\nconst LINKS = {\n  zenOSmosis: \"https://zenOSmosis.com\",\n  GitHub: \"https://github.com/zenosmosis\",\n  \"Speaker.app\": \"https://speaker.app\",\n};\n\nexport default function Resources() {\n  return (\n    <Center canOverflow={true}>\n      <p style={{ fontWeight: \"bold\" }}>Additional resources:</p>\n      <div style={{ display: \"inline-block\", textAlign: \"left\" }}>\n        {Object.entries(LINKS).map(([name, url], idx) => (\n          <Padding key={idx}>\n            {name}:{\" \"}\n            {\n              // TODO: Use ExternalLink component for this\n            }\n            <ExternalLink href={url}>{url}</ExternalLink>\n          </Padding>\n        ))}\n      </div>\n\n      <hr />\n\n      <p>\n        To contact us directly, email:{\" \"}\n        <ExternalLink href=\"mailto:info@zenosmosis.com\">\n          info@zenosmosis.com\n        </ExternalLink>\n        .\n      </p>\n    </Center>\n  );\n}\n","import Resources from \"./Resources\";\n\nexport default Resources;\n","const FULL_YEAR = new Date().getFullYear();\n\n/**\n * @return {string}\n */\nexport default function getCopyright() {\n  return `Copyright © 2010 - ${FULL_YEAR} zenOSmosis. All rights reserved.`;\n}\n","import Padding from \"@components/Padding\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport AutoScaler from \"@components/AutoScaler\";\nimport ButtonPanel from \"@components/ButtonPanel\";\nimport VirtualLink from \"@components/VirtualLink\";\nimport NoWrap from \"@components/NoWrap\";\n\nimport Details from \"./views/Details\";\nimport Resources from \"./views/Resources\";\n\nimport getCopyright from \"@utils/getCopyright\";\n\n// TODO: Include ReShell documentation here, as well as architecture overview\n\n// TODO: Include property for \"about\" view (per app), where its rendered HTML can be utilized for SEO purposes\n\n// TODO: Include license link type: https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types\n\n// TODO: Include links to PhantomCore, MediaStreamController, Speaker.app, zenOSmosis, GitHub, etc.\n\n// TODO: Include \"declarative API\" (it is React, but the components themselves\n// do their base to abstract away logic w/ their opinionated internal handling,\n// while trying to stay very performant themselves)\n\nexport const REGISTRATION_ID = \"about-reshell\";\n\nconst AboutReShell = {\n  id: REGISTRATION_ID,\n  title: \"About ReShell\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  initialSharedState: {\n    screen: \"overview\",\n  },\n  titleBarView: function TitleBarView({ sharedState, setSharedState }) {\n    /*\n    const handleSetSearchQuery = useCallback(\n      evt => setSharedState({ searchQuery: evt.target.value }),\n      [setSharedState]\n    );\n\n    const handleDoubleClick = useCallback(\n      evt => {\n        // Prevent double-clicks from resizing the window if there is text in\n        // the search bar\n        if (Boolean(sharedState.searchQuery)) {\n          evt.stopPropagation();\n        }\n      },\n      [sharedState]\n    );\n    */\n\n    return (\n      <Padding className=\"button-group\">\n        <ButtonPanel\n          // Force update if the screen changes\n          key={sharedState.screen}\n          buttons={[\n            {\n              content: \"Overview\",\n              onClick: () => setSharedState({ screen: \"overview\" }),\n              isSelected: sharedState.screen === \"overview\",\n            },\n            {\n              content: \"Details\",\n              onClick: () => setSharedState({ screen: \"details\" }),\n              isSelected: sharedState.screen === \"details\",\n            },\n            {\n              content: \"Resources\",\n              onClick: () => setSharedState({ screen: \"resources\" }),\n              isSelected: sharedState.screen === \"resources\",\n            },\n          ]}\n        />\n      </Padding>\n    );\n  },\n  view: function View({ sharedState, setSharedState }) {\n    return (\n      <Padding>\n        <Layout>\n          <Content>\n            {sharedState.screen === \"overview\" && (\n              <AutoScaler>\n                <Center>\n                  <div style={{ fontSize: \"8rem\", fontStyle: \"italic\" }}>\n                    ReShell\n                  </div>\n                  <NoWrap style={{ fontSize: \"1.5rem\" }}>\n                    App layout framework and UI services engine\n                  </NoWrap>\n                </Center>\n              </AutoScaler>\n            )}\n\n            {sharedState.screen === \"details\" && <Details />}\n\n            {sharedState.screen === \"resources\" && <Resources />}\n          </Content>\n          <Footer style={{ textAlign: \"center\" }}>\n            {sharedState.screen === \"overview\" && (\n              <p>\n                <VirtualLink\n                  onClick={() => setSharedState({ screen: \"details\" })}\n                >\n                  Details\n                </VirtualLink>{\" \"}\n                |{\" \"}\n                <VirtualLink\n                  onClick={() => setSharedState({ screen: \"resources\" })}\n                >\n                  Resources\n                </VirtualLink>\n              </p>\n            )}\n\n            <div style={{ opacity: 0.5 }}>{getCopyright()}</div>\n\n            {/*\n              <div style={{ padding: 4 }}>\n               Get\n              started with{\" \"}\n              {\n                // TODO: Make link\n              }\n              <span style={{ color: \"orange\", textDecoration: \"underline\" }}>\n                wrapping your app with ReShell\n              </span>\n              .\n            </div>\n              */}\n          </Footer>\n        </Layout>\n      </Padding>\n    );\n  },\n};\n\nexport default AboutReShell;\n","import AboutReShell, { REGISTRATION_ID } from \"./AboutReShell\";\n\nexport default AboutReShell;\nexport { REGISTRATION_ID };\n","import AboutReShell from \"../../ExamplePortal/apps/AboutReShell\";\n\nconst AboutReShellOverride = {\n  ...AboutReShell,\n  isAutoStart: true,\n};\n\nexport default AboutReShellOverride;\n","import ReShellCore from \"@core\";\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport Center from \"@components/Center\";\nimport Layout, { Header, Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\n\nimport fetchIsLatestVersion from \"@utils/fetchIsLatestVersion\";\n\nimport dayjs from \"dayjs\";\n\nexport const REGISTRATION_ID = \"check-for-updates\";\n\nconst CheckForUpdates = {\n  id: REGISTRATION_ID,\n  title: \"Check for Updates\",\n  style: {\n    width: 320,\n    height: 240,\n  },\n  isPinned: true,\n  view: function View() {\n    const [isLatest, setIsLatest] = useState(true);\n    const [isChecking, setIsChecking] = useState(false);\n    const [isError, setIsError] = useState(false);\n    const [lastCheckTime, setLastCheckTime] = useState(null);\n\n    const refIsChecking = useRef(null);\n    refIsChecking.current = isChecking;\n\n    // TODO: Refactor into service\n    const handleCheckForUpdates = useCallback(async () => {\n      const isChecking = refIsChecking.current;\n\n      if (isChecking) {\n        return;\n      }\n\n      try {\n        setIsError(false);\n        setIsChecking(true);\n\n        const isLatest = await fetchIsLatestVersion();\n\n        setIsLatest(isLatest);\n      } catch (err) {\n        console.error(err);\n\n        setIsError(true);\n        setIsLatest(false);\n      } finally {\n        setIsChecking(false);\n        setLastCheckTime(new Date().getTime());\n      }\n    }, []);\n\n    // Automatically check for updates when app starts\n    useEffect(() => {\n      handleCheckForUpdates();\n    }, [handleCheckForUpdates]);\n\n    return (\n      <Layout>\n        <Header>\n          <Padding style={{ textAlign: \"center\" }}>\n            <button onClick={handleCheckForUpdates} disabled={isChecking}>\n              Check for Updates\n            </button>\n          </Padding>\n        </Header>\n        <Content>\n          <Center canOverflow={true}>\n            {isError ? (\n              <>\n                <p>\n                  There was an error checking for updates.{\" \"}\n                  <button onClick={handleCheckForUpdates}>Try again?</button>\n                </p>\n              </>\n            ) : isLatest ? (\n              <p>You appear to be running the latest version of ReShell.</p>\n            ) : (\n              <>\n                <p>\n                  Your version of ReShell appears out of date.{\" \"}\n                  <button onClick={() => ReShellCore.forceUpdate()}>\n                    Refresh?\n                  </button>\n                </p>\n              </>\n            )}\n          </Center>\n        </Content>\n        <Footer>\n          <Padding>\n            <div className=\"note\">\n              Last checked:{\" \"}\n              {lastCheckTime ? dayjs(lastCheckTime).format(\"LLL\") : \"N/A\"}\n            </div>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default CheckForUpdates;\n","import CheckForUpdates, { REGISTRATION_ID } from \"./CheckForUpdates\";\n\nexport default CheckForUpdates;\nexport { REGISTRATION_ID };\n","import ColorAdjuster from \"./ColorAdjuster\";\n\nexport default ColorAdjuster;\n","import { useState, useEffect } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\n\nimport styles from \"./ColorAdjuster.module.css\";\n\nconst ColorAdjuster = {\n  id: \"color-adjuster\",\n  title: \"Color Adjuster\",\n  style: {\n    width: 640,\n    height: 400,\n  },\n  // serviceClasses: [],\n  view: function View({ windowController, appServices }) {\n    // TODO: Add service state; fix issue where if choosing grayscale, closing, then re-opening disables grayscale\n    const [isGrayscale, setIsGrayscale] = useState(false);\n\n    useEffect(() => {\n      if (isGrayscale) {\n        document.body.classList.add(\"grayscale\");\n      } else {\n        document.body.classList.remove(\"grayscale\");\n      }\n    }, [isGrayscale]);\n\n    return (\n      <Layout className={styles[\"color-adjuster\"]}>\n        <Content>\n          <Center>\n            <button onClick={() => setIsGrayscale(prev => !prev)}>\n              {isGrayscale ? \"Disable\" : \"Enable\"} Grayscale\n            </button>\n          </Center>\n        </Content>\n        <Footer>\n          {\n            // @see https://color.adobe.com/create/color-wheel\n\n            [\"#B04628\", \"#B9FC6D\", \"#FC7853\", \"#3A65FC\", \"#314EB0\"].map(\n              (color, idx) => (\n                <div\n                  key={idx}\n                  style={{\n                    backgroundColor: color,\n                    height: 100,\n                    width: \"20%\",\n                    display: \"inline-block\",\n                  }}\n                >\n                  <Center>\n                    <span\n                      style={{\n                        padding: 4,\n                        backgroundColor: \"rgba(0,0,0,.4)\",\n                        borderRadius: 4,\n                      }}\n                    >\n                      {color}\n                    </span>\n                  </Center>\n                </div>\n              )\n            )\n          }\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ColorAdjuster;\n","import ObjectViewer from \"./ObjectViewer\";\n\nexport default ObjectViewer;\n","import Full from \"../Full\";\nimport ReactJson from \"react-json-view\";\nimport classNames from \"classnames\";\nimport styles from \"./ObjectViewer.module.css\";\nimport PropTypes from \"prop-types\";\n\nObjectViewer.propTypes = {\n  src: PropTypes.object.isRequired,\n};\n\nexport default function ObjectViewer({ className, src, ...rest }) {\n  return (\n    <Full {...rest} className={classNames(styles[\"object-viewer\"], className)}>\n      <ReactJson\n        src={src}\n        theme=\"monokai\"\n        // NOTE: className appears to be unsupported here\n        style={{ width: \"100%\", height: \"100%\" }}\n      />\n    </Full>\n  );\n}\n","import Layout, { Content /* Footer */ } from \"@components/Layout\";\nimport ObjectViewer from \"@components/ObjectViewer\";\n\n// TODO: Include ability to show environment of any given AppRuntime?\n\nexport const REGISTRATION_ID = \"environment\";\n\nconst Environment = {\n  id: REGISTRATION_ID,\n  title: \"Environment\",\n  style: {\n    width: 640 * 0.8,\n    height: 480 * 0.8,\n  },\n  view: function View() {\n    return (\n      <Layout>\n        <Content>\n          <ObjectViewer src={process.env} />\n        </Content>\n      </Layout>\n    );\n  },\n};\n\nexport default Environment;\n","import Environment, { REGISTRATION_ID } from \"./Environment\";\n\nexport default Environment;\nexport { REGISTRATION_ID };\n","import AppLinkButton from \"./AppLinkButton\";\n\nexport default AppLinkButton;\n","import useAppRegistrationLink from \"@hooks/useAppRegistrationLink\";\nimport VirtualLinkButton from \"../VirtualLinkButton\";\n\n// TODO: Apply \"active\" class to button whenever registration is active?\n\n// TODO: Document\nexport default function AppLinkButton({ id, title = null, ...rest }) {\n  const { title: registrationTitle, link } = useAppRegistrationLink(id);\n\n  if (!link) {\n    return null;\n  }\n\n  return (\n    <VirtualLinkButton\n      // IMPORTANT: ...rest is moved before onClick handler so the internal\n      // onClick handler will not be overridden\n      {...rest}\n      onClick={link}\n    >\n      {title || registrationTitle}\n    </VirtualLinkButton>\n  );\n}\n","import ReShellCore from \"@core\";\nimport PhantomCore from \"phantom-core\";\n\nimport Layout, {\n  Header,\n  Content,\n  Footer,\n  Row,\n  Column,\n} from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport ObjectViewer from \"@components/ObjectViewer\";\n\nimport { REGISTRATION_ID as ENVIRONMENT_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/Environment\";\nimport { REGISTRATION_ID as CHECK_FOR_UPDATES_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/CheckForUpdates\";\n\nconst packageJson = require(\"@root/package.json\");\n\nexport const REGISTRATION_ID = \"software-info\";\n\nconst SoftwareInfo = {\n  id: REGISTRATION_ID,\n  title: \"Software Info\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  view: function View() {\n    return (\n      <Layout>\n        <Header>\n          <Padding>Package.json content</Padding>\n        </Header>\n        <Content>\n          <ObjectViewer src={packageJson} />\n        </Content>\n        <Footer>\n          <Padding>\n            <Row>\n              <Column>\n                <Center>\n                  <div\n                    style={{ float: \"left\", textAlign: \"left\" }}\n                    className=\"note\"\n                  >\n                    ReShell version: {packageJson.version}\n                    <br />\n                    Phantom Core version: {PhantomCore.getPhantomCoreVersion()}\n                    <br />\n                    Portal: {ReShellCore.getPortalName()}\n                  </div>\n                </Center>\n              </Column>\n              <Column>\n                <Center style={{ textAlign: \"right\" }}>\n                  <AppLinkButton id={CHECK_FOR_UPDATES_REGISTRATION_ID} />{\" \"}\n                  <AppLinkButton id={ENVIRONMENT_REGISTRATION_ID} />\n                </Center>\n              </Column>\n            </Row>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default SoftwareInfo;\n","import SoftwareInfo, { REGISTRATION_ID } from \"./SoftwareInfo\";\n\nexport default SoftwareInfo;\nexport { REGISTRATION_ID };\n","import { PhantomCollection } from \"phantom-core\";\nimport UIServiceCore from \"@core/classes/UIServiceCore\";\nimport {\n  MediaStreamTrackControllerFactory,\n  utils,\n} from \"media-stream-track-controller\";\n\n// TODO: Build out; ensuring added children are media device controller factories\nclass MediaDeviceFactoryCollection extends PhantomCollection {}\n\nexport default class MediaDevicesService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Media Devices Service\");\n\n    // TODO: Re-run when devices have been changed\n    this.fetchAudioInputDevices();\n\n    this.bindCollectionClass(MediaDeviceFactoryCollection);\n  }\n\n  // TODO: Document\n  fetchAudioInputDevices(isAggressive) {\n    utils\n      .fetchMediaDevices(isAggressive)\n      .then(utils.fetchMediaDevices.filterAudioInputDevices)\n      .then(devices => this.setState({ devices }))\n      // TODO: Route error to service; make it pipe out UI; etc.\n      .catch(err => console.error(err));\n  }\n\n  // TODO: Document\n  getMediaDevices() {\n    const { devices } = this.getState();\n\n    return devices || [];\n  }\n\n  // TODO: Document\n  getCaptureFactories() {\n    return this.getCollectionInstance(\n      MediaDeviceFactoryCollection\n    ).getChildren();\n  }\n\n  // TODO: Document\n  getIsAudioMediaDeviceBeingCaptured(mediaDeviceInfo) {\n    return Boolean(\n      MediaStreamTrackControllerFactory.getFactoriesWithInputMediaDevice(\n        mediaDeviceInfo,\n        \"audio\"\n      ).length\n    );\n  }\n\n  // TODO: Document\n  async captureDefaultAudioInputDevice(constraints = {}, factoryOptions = {}) {\n    const factory = await utils.captureMediaDevice(constraints, factoryOptions);\n\n    this.getCollectionInstance(MediaDeviceFactoryCollection).addChild(factory);\n\n    return factory;\n  }\n\n  // TODO: Document\n  async captureSpecificAudioInputDevice(\n    mediaDeviceInfo,\n    constraints = {},\n    factoryOptions = {}\n  ) {\n    // TODO: Fix issue in media-stream-controller where constraint may look like '0: \"a\", 2: \"u\"'\n    /*\n    const specificConstraints =\n      utils.constraints.getSpecificDeviceCaptureConstraints(\n        mediaDeviceInfo,\n        \"audio\",\n        constraints\n      );\n\n    // TODO: Handle\n    console.log({ mediaDeviceInfo, specificConstraints });\n    */\n\n    const factory = await utils.captureMediaDevice.captureSpecificMediaDevice(\n      mediaDeviceInfo,\n      constraints,\n      factoryOptions\n    );\n\n    this.getCollectionInstance(MediaDeviceFactoryCollection).addChild(factory);\n\n    return factory;\n  }\n\n  async uncaptureSpecificAudioInputDevice(mediaDeviceInfo) {\n    return utils.captureMediaDevice.uncaptureSpecificMediaDevice(\n      mediaDeviceInfo\n    );\n  }\n}\n","import React, { useMemo } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./AudioLevelMeter.module.css\";\n\n/**\n * Note: This component can render multiple audio levels together as a single unit, side-by-side.\n *\n * @see https://codepen.io/snart1/pen/rRvwwr\n */\nexport default function AudioLevelMeter({\n  className,\n  percent,\n  percents = [],\n  ...rest\n}) {\n  const renderedLevels = useMemo(() => {\n    let renderedLevels = [...percents];\n\n    if (percent !== undefined) {\n      renderedLevels.push(percent);\n    }\n\n    renderedLevels = renderedLevels.map(level => 100 - level);\n\n    return renderedLevels;\n  }, [percent, percents]);\n\n  return (\n    <div className={classNames(styles[\"levels\"], className)} {...rest}>\n      {renderedLevels.map((percent, idx) => (\n        <div key={idx} className={styles[\"level-container\"]}>\n          <div\n            className={styles[\"level\"]}\n            style={{\n              clipPath: `inset(${percent}% 0 0 0)`,\n              WebkitClipPath: `inset(${percent}% 0 0 0)`,\n            }}\n          ></div>\n        </div>\n      ))}\n    </div>\n  );\n}\n","import { PhantomCollection } from \"phantom-core\";\nimport { useEffect, useState } from \"react\";\nimport usePrevious from \"./usePrevious\";\n\n/**\n * @typedef {Object} ArrayDiff\n * @property {any[]} added Elements added since last change\n * @property {any[]} removed Elements removed since last change\n *\n * @param {any[]} next\n * @return {ArrayDiff}\n */\nexport default function useArrayDiff(next) {\n  // IMPORTANT: Using empty array for previous default value\n  const prev = usePrevious(next, []);\n\n  const [addedRemoved, _setAddedRemoved] = useState({ added: [], removed: [] });\n\n  useEffect(() => {\n    // NOTE: This check is inside the useEffect so it is not re-run more often\n    // than it should\n    if (!Array.isArray(next)) {\n      throw new Error(\"next should be an array\");\n    }\n\n    const { added, removed } = PhantomCollection.getChildrenDiff(prev, next);\n\n    if (added.length || removed.length) {\n      _setAddedRemoved({\n        added,\n        removed,\n      });\n    }\n  }, [prev, next]);\n\n  return {\n    added: addedRemoved.added,\n    removed: addedRemoved.removed,\n  };\n}\n","import { useEffect, useRef } from \"react\";\n\nconst DEFAULT_REF_VALUE = null;\n\n/**\n * Adapted from:\n * @see https://usehooks.com/usePrevious\n *\n * getPreviousValue, a memoized callback with no dependencies, was added so\n * that the value could be obtained from within a hook without the value being\n * called as a dependency, which could cause an additional render.\n *\n * @param {any} value The current value\n * @param {boolean} defaultPreviousValue? [default = null]\n * @return {any} The previous value\n */\nexport default function usePrevious(\n  value,\n  defaultPreviousValue = DEFAULT_REF_VALUE\n) {\n  // The ref object is a generic container whose \"current\" property is mutable\n  // and can hold any value, similar to an instance property on a class\n  const refPrev = useRef(defaultPreviousValue);\n\n  // Store current value in ref\n  // Only re-run if value changes\n  useEffect(() => {\n    refPrev.current = value;\n  }, [value]);\n\n  // Return previous value (happens before update in useEffect above)\n  return refPrev.current;\n}\n","import { useEffect, useMemo, useState } from \"react\";\nimport {\n  MultiAudioMediaStreamTrackLevelMonitor,\n  MultiAudioMediaStreamTrackLevelMonitorEvents,\n} from \"media-stream-track-controller\";\nimport useArrayDiff from \"./useArrayDiff\";\n\nconst { EVT_DEBOUNCED_PEAK_AUDIO_LEVEL_TICK } =\n  MultiAudioMediaStreamTrackLevelMonitorEvents;\n\n/**\n * Utilizes a MultiAudioMediaStreamTrackLevelMonitor as a React hook.\n *\n * @param {MediaStreamTrack | MediaStreamTrack[] | null} mediaStreamTrackOrTracks?\n * [default = []] A single track, or an array of tracks.  It is made optional\n * because rendered audio level meters may not already have an associated\n * MediaStreamTrack.\n * @return {number} The average percent of all of the input tracks.\n */\nexport default function useAudioMediaStreamTrackLevelMonitor(\n  mediaStreamTrackOrTracks = []\n) {\n  // TODO: This needs optimization; something about this monitor causes an infinite loop cycle\n\n  /**\n   * @type {MediaStreamTrack[]}\n   */\n  const mediaStreamTracks = useMemo(\n    () =>\n      (!mediaStreamTrackOrTracks\n        ? []\n        : Array.isArray(mediaStreamTrackOrTracks)\n        ? mediaStreamTrackOrTracks\n        : [mediaStreamTrackOrTracks]\n      ).filter(\n        (track) => track instanceof MediaStreamTrack && track.kind === \"audio\"\n      ),\n    [mediaStreamTrackOrTracks]\n  );\n\n  const [mediaStreamMonitor, _setMediaStreamMonitor] = useState(null);\n\n  const [percent, _setPercent] = useState(null);\n\n  useEffect(() => {\n    const mediaStreamMonitor = new MultiAudioMediaStreamTrackLevelMonitor();\n\n    // NOTE: This event handler will automatically be unbound once the class\n    // destructs\n    mediaStreamMonitor.on(EVT_DEBOUNCED_PEAK_AUDIO_LEVEL_TICK, ({ rms }) => {\n      // FIXME: This is probably not supposed to be RMS, but it's close\n      // enough for prototyping\n      _setPercent(rms * 0.8);\n    });\n\n    _setMediaStreamMonitor(mediaStreamMonitor);\n\n    return function unmount() {\n      mediaStreamMonitor.destroy();\n    };\n  }, []);\n\n  const { added: addedMediaStreamTracks, removed: removedMediaStreamTracks } =\n    useArrayDiff(mediaStreamTracks);\n\n  // Sync hook's media stream tracks with the audio monitor instance\n  useEffect(() => {\n    if (mediaStreamMonitor) {\n      // Handle added / existing tracks\n      for (const track of addedMediaStreamTracks) {\n        mediaStreamMonitor.addMediaStreamTrack(track);\n      }\n\n      // Handle removed tracks\n      for (const track of removedMediaStreamTracks) {\n        mediaStreamMonitor.removeMediaStreamTrack(track);\n      }\n    }\n  }, [mediaStreamMonitor, addedMediaStreamTracks, removedMediaStreamTracks]);\n\n  return percent;\n}\n","import React from \"react\";\nimport AudioLevelMeter from \"./AudioLevelMeter\";\n\nimport PropTypes from \"prop-types\";\n\nimport useAudioMediaStreamTrackLevelMonitor from \"@hooks/useAudioMediaStreamTrackLevelMonitor\";\n\nAudioMediaStreamTrackLevelMeter.propTypes = {\n  /** When multiple audio tracks may be used together */\n  mediaStreamTracks: PropTypes.arrayOf(PropTypes.instanceOf(MediaStreamTrack)),\n\n  /** When only a single track is used */\n  mediaStreamTrack: PropTypes.instanceOf(MediaStreamTrack),\n};\n\nexport default function AudioMediaStreamTrackLevelMeter({\n  mediaStreamTracks,\n  mediaStreamTrack,\n  ...rest\n}) {\n  const percent = useAudioMediaStreamTrackLevelMonitor(\n    mediaStreamTrack || mediaStreamTracks\n  );\n\n  return <AudioLevelMeter percent={percent} {...rest} />;\n}\n","import AudioLevelMeter from \"./AudioLevelMeter\";\nimport AudioMediaStreamTrackLevelMeter from \"./AudioMediaStreamTrackLevelMeter\";\n\nexport default AudioLevelMeter;\nexport { AudioMediaStreamTrackLevelMeter };\n","import StaggeredWaveLoading from \"./StaggeredWaveLoading\";\n\nexport default StaggeredWaveLoading;\n","import React from \"react\";\nimport styles from \"./StaggeredWaveLoading.module.css\";\n\n// @see https://codepen.io/alphardex/pen/XWWWBmQ\nexport default function StaggeredWaveLoading({ ...rest }) {\n  return (\n    <div className={styles[\"loading-wrapper\"]} {...rest}>\n      <div className={styles[\"loading\"]}>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n      </div>\n    </div>\n  );\n}\n","import Preload from \"./Preload\";\n\nexport default Preload;\n","import React from \"react\";\nimport StaggeredWaveLoading from \"../StaggeredWaveLoading\";\nimport PropTypes from \"prop-types\";\n\nimport usePreload from \"@hooks/usePreload\";\n\nPreload.propTypes = {\n  /**\n   * @type {string[]} A list of URLs to preload.\n   */\n  preloadResources: PropTypes.arrayOf(PropTypes.string.isRequired).isRequired,\n\n  onError: PropTypes.func,\n};\n\nexport default function Preload({\n  children,\n  preloadResources,\n  onError = err => console.warn(\"Caught\", err),\n  ...rest\n}) {\n  const { isPreloaded /* progress */ } = usePreload(preloadResources);\n\n  if (!isPreloaded) {\n    return (\n      <div {...rest}>\n        <StaggeredWaveLoading />\n      </div>\n    );\n  } else {\n    return <React.Fragment>{children}</React.Fragment>;\n  }\n}\n","export default __webpack_public_path__ + \"static/media/vu.8cb21748.png\";","export default \"data:image/png;base64,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\"","import React, { useEffect, useState } from \"react\";\nimport Preload from \"@components/Preload\";\n\nimport classNames from \"classnames\";\nimport styles from \"./VUMeter.module.css\";\n\nimport vuBackground from \"./images/vu.png\";\nimport vuNeedle from \"./images/needle.png\";\n\nexport default function VUMeter({\n  label = \"Mono\",\n  percent = 0,\n  className,\n  ...rest\n}) {\n  if (percent < 0) percent = 0;\n  if (percent > 100) percent = 100;\n\n  const [vu, setVu] = useState(null);\n  const [needle, setNeedle] = useState(null);\n\n  useEffect(() => {\n    if (vu && needle) {\n      vu.style.backgroundImage = `url(${vuBackground})`;\n      vu.style.backgroundPosition = \"top left\";\n      vu.style.backgroundRepeat = \"no-repeat\";\n\n      needle.style.backgroundImage = `url(${vuNeedle})`;\n      needle.style.backgroundPosition = \"top left\";\n      needle.style.backgroundRepeat = \"no-repeat\";\n    }\n  }, [vu, needle]);\n\n  useEffect(() => {\n    if (needle) {\n      needle.style.transform = `rotateZ(${Math.min(87 * (percent / 100))}deg)`;\n    }\n  }, [needle, percent]);\n\n  return (\n    <Preload preloadResources={[vuBackground, vuNeedle]}>\n      <div\n        ref={setVu}\n        className={classNames(styles[\"vu\"], className)}\n        {...rest}\n      >\n        <div className={styles[\"mask\"]}>\n          <div\n            ref={setNeedle}\n            className={styles[\"needle\"]}\n            style={{ transform: \"rotateZ(0deg)\" }}\n          ></div>\n        </div>\n        <p className={styles[\"vu-label\"]}>{label}</p>\n      </div>\n    </Preload>\n  );\n}\n","import React from \"react\";\nimport VUMeter from \"./VUMeter\";\n\nimport PropTypes from \"prop-types\";\n\nimport useAudioMediaStreamTrackLevelMonitor from \"@hooks/useAudioMediaStreamTrackLevelMonitor\";\n\nAudioMediaStreamTrackLevelVUMeter.propTypes = {\n  /** When multiple audio tracks may be used together */\n  mediaStreamTracks: PropTypes.arrayOf(PropTypes.instanceOf(MediaStreamTrack)),\n\n  /** When only a single track is used */\n  mediaStreamTrack: PropTypes.instanceOf(MediaStreamTrack),\n};\n\nexport default function AudioMediaStreamTrackLevelVUMeter({\n  mediaStreamTracks,\n  mediaStreamTrack,\n  ...rest\n}) {\n  const percent = useAudioMediaStreamTrackLevelMonitor(\n    mediaStreamTrack || mediaStreamTracks\n  );\n\n  return <VUMeter percent={percent} {...rest} />;\n}\n","import VUMeter from \"./VUMeter\";\nimport AudioMediaStreamTrackLevelVUMeter from \"./AudioMediaStreamTrackLevelVUMeter\";\n\nexport default VUMeter;\nexport { AudioMediaStreamTrackLevelVUMeter };\n","import MediaDevicesService from \"@services/MediaDevicesService\";\n\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport { AudioMediaStreamTrackLevelMeter } from \"@components/audioMeters/AudioLevelMeter\";\nimport { AudioMediaStreamTrackLevelVUMeter } from \"@components/audioMeters/VUMeter\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"../InputMediaDevices\";\n\nexport const REGISTRATION_ID = \"vu-meter\";\n\nconst VUMeter = {\n  id: REGISTRATION_ID,\n  title: \"VU Meter\",\n  style: {\n    width: 360,\n    height: 360,\n    backgroundColor: \"rgba(0,0,0,.4)\",\n  },\n  serviceClasses: [MediaDevicesService],\n  view: ({ appServices }) => {\n    const mds = appServices[MediaDevicesService];\n\n    const captureFactories = mds.getCaptureFactories();\n    const isCapturing = Boolean(captureFactories.length);\n\n    const mediaStreamTracks = captureFactories\n      .map(factory =>\n        factory\n          .getAudioTrackControllers()\n          .map(controller => controller.getOutputMediaStreamTrack())\n      )\n      .flat();\n\n    return (\n      <Layout>\n        <Content>\n          <Center canOverflow={true}>\n            <div>\n              <AudioMediaStreamTrackLevelVUMeter\n                mediaStreamTracks={mediaStreamTracks}\n              />\n              <AudioMediaStreamTrackLevelMeter\n                style={{ marginLeft: 20, height: 160, width: 40 }}\n                mediaStreamTracks={mediaStreamTracks}\n              />\n            </div>\n            <div>\n              <button\n                onClick={() => {\n                  !isCapturing\n                    ? mds.captureDefaultAudioInputDevice()\n                    : captureFactories.forEach(factory => factory.destroy());\n                }}\n                style={{ backgroundColor: isCapturing ? \"red\" : null }}\n              >\n                {!isCapturing ? \"Start Microphone\" : \"Stop Capturing\"}\n              </button>\n            </div>\n          </Center>\n        </Content>\n        <Footer>\n          <Padding>\n            <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default VUMeter;\n","import VUMeter, { REGISTRATION_ID } from \"./VUMeter\";\n\nexport default VUMeter;\nexport { REGISTRATION_ID };\n","import React, { useEffect, useMemo, useState, useRef } from \"react\";\n\n/**\n * Represents audio or video element.\n *\n * TODO: Document and rename\n */\nexport default function AVBase({\n  mediaStreamTrack,\n  mediaType = \"video\",\n  onEl = el => null,\n  ...rest\n}) {\n  const [el, setEl] = useState(null);\n\n  const mediaStream = useMemo(\n    () => mediaStreamTrack && new MediaStream([mediaStreamTrack]),\n    [mediaStreamTrack]\n  );\n\n  // TODO: Document\n  useEffect(() => {\n    if (!el) {\n      return;\n    }\n\n    // Fixes issue in Firefox where setting mediaStream to undefined would keep\n    // video on last frame\n    if (!mediaStream) {\n      el.srcObject = null;\n      return;\n    }\n\n    el.srcObject = mediaStream;\n\n    // TODO: Emit events when playing in order to perform \"read receipts\" for remote participants\n\n    el.play()\n      .then(() => (el.muted = false))\n      .catch(err => console.warn(\"Caught\", err));\n  }, [el, mediaStream]);\n\n  const refOnEl = useRef(onEl);\n\n  // TODO: Document\n  useEffect(() => {\n    const onEl = refOnEl.current;\n\n    if (el && typeof onEl === \"function\") {\n      onEl(el);\n    }\n  }, [el]);\n\n  return React.createElement(mediaType, {\n    ref: setEl,\n    autoPlay: false,\n    muted: true,\n    playsInline: true,\n    controls: false,\n    ...rest,\n  });\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./Video.module.css\";\n\nimport AVBase from \"./AVBase\";\n\n/**\n * Plays a single video MediaStreamTrack out the monitor.\n */\nexport default function Video({ className, ...rest }) {\n  return (\n    <AVBase className={classNames(styles[\"video\"], className)} {...rest} />\n  );\n}\n","import { PhantomCollection } from \"phantom-core\";\nimport UIServiceCore from \"@core/classes/UIServiceCore\";\nimport { utils } from \"media-stream-track-controller\";\n\n// TODO: Build out; ensuring added children are media device controller factories\nclass ScreenCaptureFactoryCollection extends PhantomCollection {}\n\n// TODO: Document\nexport default class ScreenCapturerService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Screen Capturer Service\");\n\n    this.bindCollectionClass(ScreenCaptureFactoryCollection);\n  }\n\n  // TODO: Document\n  async startScreenCapture(constraints = {}, factoryOptions = {}) {\n    const factory = await utils.captureScreen(constraints, factoryOptions);\n\n    this.getCollectionInstance(ScreenCaptureFactoryCollection).addChild(\n      factory\n    );\n\n    return factory;\n  }\n\n  /**\n   * Returns all media stream tracks from all of the factories as a flat array.\n   *\n   * @return {MediaStreamTrack[]}\n   */\n  getMediaStreamTracks() {\n    return this.getCollectionInstance(ScreenCaptureFactoryCollection)\n      .getChildren()\n      .map(factory =>\n        factory\n          .getTrackControllers()\n          .map(controller => controller.getOutputMediaStreamTrack())\n      )\n      .flat();\n  }\n}\n","import { EVT_DESTROYED } from \"phantom-core\";\nimport { useCallback, useEffect, useState } from \"react\";\n\nimport Layout, { Content, Footer, Row, Column } from \"@components/Layout\";\nimport Cover from \"@components/Cover\";\nimport Center from \"@components/Center\";\nimport { Video } from \"@components/audioVideoRenderers\";\nimport LED from \"@components/LED\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport useGetIsUnmounting from \"@hooks/useGetIsUnmounting\";\n\nimport ScreenCapturerService from \"@services/ScreenCapturerService\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"../InputMediaDevices\";\n\nexport const REGISTRATION_ID = \"screen-capture-window\";\n\n// TODO: Include ability to screen record and take arbitrary snapshot from video feed (separate from ScreenShot app which is a one-time deal)\n\nconst ScreenCaptureWindow = {\n  id: REGISTRATION_ID,\n  title: \"Screen Capture\",\n  style: {\n    width: 640 * 0.8,\n    height: 480 * 0.8,\n  },\n  serviceClasses: [ScreenCapturerService],\n  view: function View({ appServices }) {\n    const scs = appServices[ScreenCapturerService];\n\n    const [screenCaptureFactory, setScreenCaptureFactory] = useState(null);\n\n    const getIsUnmounting = useGetIsUnmounting();\n\n    // TODO: Document\n    const handleStartScreenCapture = useCallback(\n      async (constraints = {}, factoryOptions = {}) => {\n        const factory = await scs.startScreenCapture(\n          constraints,\n          factoryOptions\n        );\n\n        setScreenCaptureFactory(factory);\n\n        factory.once(EVT_DESTROYED, () => {\n          // Unmounting check fixes an issue where memory-leak error is\n          // presented when closing the window with an active screen capture\n          if (!getIsUnmounting()) {\n            setScreenCaptureFactory(null);\n          }\n        });\n\n        return factory;\n      },\n      [scs, getIsUnmounting]\n    );\n\n    // Stop the screen capture on unmount\n    useEffect(() => {\n      if (screenCaptureFactory) {\n        return () => {\n          screenCaptureFactory.destroy();\n        };\n      }\n    }, [screenCaptureFactory]);\n\n    const videoTrack = screenCaptureFactory\n      ?.getVideoTrackControllers()[0]\n      ?.getOutputTrack();\n\n    return (\n      <Layout style={{ backgroundColor: \"#424242\", color: \"#999\" }}>\n        <Content>\n          <Video mediaStreamTrack={videoTrack} />\n          {!screenCaptureFactory && (\n            <Cover>\n              <Center>\n                <div>\n                  <button\n                    onClick={() => handleStartScreenCapture()}\n                    style={{\n                      backgroundColor: \"green\",\n                      width: 200,\n                      height: 200,\n                      borderRadius: 200,\n                      fontWeight: \"bold\",\n                      fontSize: \"1.4rem\",\n                      border: \"8px #ccc solid\",\n                    }}\n                  >\n                    Start Screen Capture\n                  </button>\n                </div>\n              </Center>\n            </Cover>\n          )}\n        </Content>\n        <Footer>\n          <Padding>\n            <Row>\n              <Column>\n                <Center>\n                  <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n                </Center>\n              </Column>\n              <Column>\n                <Center>\n                  <button\n                    style={{\n                      backgroundColor: !screenCaptureFactory ? \"green\" : \"red\",\n                      whiteSpace: \"nowrap\",\n                    }}\n                    onClick={() => {\n                      if (screenCaptureFactory) {\n                        screenCaptureFactory.destroy();\n                      } else {\n                        handleStartScreenCapture();\n                      }\n                    }}\n                  >\n                    {!screenCaptureFactory ? \"Capture\" : \"Stop\"}\n                  </button>\n                </Center>\n              </Column>\n              <Column>\n                <Row>\n                  <Column>\n                    <Center>\n                      <LED\n                        color={screenCaptureFactory ? \"green\" : \"gray\"}\n                        style={{ float: \"left\", marginLeft: 8 }}\n                      />\n                    </Center>\n                  </Column>\n                  <Column>\n                    <Center>\n                      <button disabled style={{ whiteSpace: \"nowrap\" }}>\n                        Video Stats\n                      </button>\n                    </Center>\n                  </Column>\n                </Row>\n              </Column>\n            </Row>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ScreenCaptureWindow;\n","import ScreenCapture, { REGISTRATION_ID } from \"./ScreenCapture\";\n\nexport default ScreenCapture;\nexport { REGISTRATION_ID };\n","import { useCallback, useEffect, useRef } from \"react\";\n\n// TODO: Document\nexport default function useGetIsUnmounting() {\n  const refIsUnmounting = useRef(false);\n\n  useEffect(() => {\n    return function unmount() {\n      refIsUnmounting.current = true;\n    };\n  }, []);\n\n  const getIsUnmounting = useCallback(() => refIsUnmounting.current, []);\n\n  return getIsUnmounting;\n}\n","import MediaDevicesService from \"@services/MediaDevicesService\";\n\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport LED from \"@components/LED\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { REGISTRATION_ID as VU_METER_REGISTRATION_ID } from \"../VUMeter\";\nimport { REGISTRATION_ID as SCREEN_CAPTURE_REGISTRATION_ID } from \"../ScreenCapture\";\n\nexport const REGISTRATION_ID = \"input-media-devices\";\n\nconst InputMediaDevices = {\n  id: REGISTRATION_ID,\n  title: \"Input Media Devices\",\n  style: {\n    width: 640,\n    height: 300,\n  },\n  serviceClasses: [MediaDevicesService],\n  view: function View({ appServices }) {\n    const mds = appServices[MediaDevicesService];\n\n    const mediaDevices = mds.getMediaDevices();\n\n    return (\n      <Padding>\n        <Layout>\n          <Content>\n            <div style={{ width: \"100%\", height: \"100%\", overflowY: \"auto\" }}>\n              <table style={{ width: \"100%\" }}>\n                <thead>\n                  <tr>\n                    <td>Label</td>\n                    <td>Kind</td>\n                    <td>f(x)</td>\n                    <td>State</td>\n                  </tr>\n                </thead>\n                <tbody>\n                  {mediaDevices.map((device, idx) => {\n                    const isCapturing =\n                      mds.getIsAudioMediaDeviceBeingCaptured(device);\n\n                    return (\n                      <tr key={idx}>\n                        <td>{device.label || `[Unknown Label]`}</td>\n                        <td className=\"center\">{device.kind}</td>\n                        <td className=\"center\">\n                          <button\n                            onClick={() =>\n                              !isCapturing\n                                ? mds.captureSpecificAudioInputDevice(device)\n                                : mds.uncaptureSpecificAudioInputDevice(device)\n                            }\n                            style={{\n                              backgroundColor: isCapturing ? \"red\" : \"green\",\n                              width: \"100%\",\n                            }}\n                          >\n                            {isCapturing ? \"Stop\" : \"Start\"}\n                          </button>\n                        </td>\n                        <td className=\"center\">\n                          <LED color={isCapturing ? \"green\" : \"gray\"} />{\" \"}\n                          {isCapturing ? \"on\" : \"off\"}\n                        </td>\n                      </tr>\n                    );\n                  })}\n                </tbody>\n              </table>\n            </div>\n          </Content>\n          <Footer>\n            <button\n              onClick={() => mds.fetchAudioInputDevices(true)}\n              style={{ float: \"right\" }}\n            >\n              Refetch\n            </button>\n\n            <span className=\"button-group\">\n              <AppLinkButton id={VU_METER_REGISTRATION_ID} />\n              <AppLinkButton id={SCREEN_CAPTURE_REGISTRATION_ID} />\n            </span>\n          </Footer>\n        </Layout>\n      </Padding>\n    );\n  },\n};\n\nexport default InputMediaDevices;\n","import InputMediaDevices, { REGISTRATION_ID } from \"./InputMediaDevices\";\n\nexport default InputMediaDevices;\nexport { REGISTRATION_ID };\n","/**\n * String renderings for orders of magnitude of data.\n *\n * Using decimal bbreviations as specified in:\n * @see https://en.wikipedia.org/wiki/Megabyte\n *\n * Adapted from:\n * @see https://gist.github.com/lanqy/5193417\n *\n * @param {number} bytes\n * @return {string}\n */\nconst bytesToSize = (bytes) => {\n  const sizes = [\"bytes\", \"kB\", \"MB\", \"GB\", \"TB\"];\n  if (bytes === 0) return `0 ${sizes[0]}`;\n  const i = parseInt(\n    Math.floor(Math.log(Math.abs(bytes)) / Math.log(1024)),\n    10\n  );\n  if (i === 0) return `${bytes} ${sizes[i]}`;\n  return `${(bytes / 1024 ** i).toFixed(1)} ${sizes[i]}`;\n};\n\nexport default bytesToSize;\n","import { useCallback, useEffect, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\n\nimport bytesToSize from \"@utils/bytesToSize\";\n\nconst MemoryInfo = {\n  id: \"memory-info\",\n  title: \"Memory Info\",\n  style: {\n    width: 280,\n    height: 150,\n  },\n  view: function View() {\n    const [\n      { jsHeapSizeLimit, totalJSHeapSize, usedJSHeapSize },\n      _setMemoryInfo,\n    ] = useState({\n      jsHeapSizeLimit: \"N/A\",\n      totalJSHeapSize: \"N/A\",\n      usedJSHeapSize: \"N/A\",\n    });\n\n    // TODO: Document\n    const fetchMemoryInfo = useCallback(() => {\n      if (!window.performance.memory) {\n        return;\n      }\n\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Performance/memory\n      const { jsHeapSizeLimit, totalJSHeapSize, usedJSHeapSize } =\n        window.performance.memory;\n\n      const memoryInfo = {\n        jsHeapSizeLimit: bytesToSize(jsHeapSizeLimit),\n        totalJSHeapSize: bytesToSize(totalJSHeapSize),\n        usedJSHeapSize: bytesToSize(usedJSHeapSize),\n      };\n\n      _setMemoryInfo(memoryInfo);\n\n      return memoryInfo;\n    }, []);\n\n    // Automatically refresh heap\n    useEffect(() => {\n      const initialFetch = fetchMemoryInfo();\n\n      if (initialFetch) {\n        const refetchInterval = setInterval(() => {\n          fetchMemoryInfo();\n        }, 1000);\n\n        return function unmount() {\n          clearInterval(refetchInterval);\n        };\n      }\n    }, [fetchMemoryInfo]);\n\n    // TODO: Incorporate graphing library\n\n    return (\n      <Layout style={{ backgroundColor: \"#424242\", color: \"#999\" }}>\n        <Content>\n          <Center>\n            <table style={{ display: \"inline-block\" }}>\n              <thead>\n                <tr>\n                  <td>Heap Size Limit</td>\n                  <td>Total Heap Size</td>\n                  <td>Used Heap Size</td>\n                </tr>\n              </thead>\n\n              <tbody>\n                <tr>\n                  {\n                    // TODO: Render as formatted strings (i.e. \"... GB\")\n                  }\n                  <td>{jsHeapSizeLimit}</td>\n                  <td>{totalJSHeapSize}</td>\n                  <td>{usedJSHeapSize}</td>\n                </tr>\n              </tbody>\n            </table>\n          </Center>\n        </Content>\n        <Footer style={{ fontSize: \".8rem\" }}>\n          <a\n            href=\"https://developer.mozilla.org/en-US/docs/Web/API/Performance/memory\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            style={{ float: \"left\" }}\n          >\n            MDN Documentation\n          </a>\n          <span style={{ float: \"right\" }}>\n            Only supported in Chromium-based browsers.\n          </span>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default MemoryInfo;\n","import LocalStorageItems from \"./LocalStorageItems\";\n\nexport default LocalStorageItems;\n","import Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\n\nexport default function LocalStorageItems({\n  keyStorageEngineMaps = [],\n  onGetValue,\n  onEmpty,\n  onNewItem,\n}) {\n  if (!keyStorageEngineMaps.length) {\n    return (\n      <Center>\n        <Padding>\n          <Padding style={{ fontWeight: \"bold\" }}>No Key Vault items.</Padding>\n          <Padding className=\"note\">\n            These may be automatically managed by other applications as needed,\n            in order to perform key / value pair storage operations.\n          </Padding>\n          <Padding className=\"note\">\n            You have the ability to clear all local / session storage via this\n            utility.\n          </Padding>\n          <Padding>\n            <button onClick={onNewItem}>Add new item...</button>\n          </Padding>\n        </Padding>\n      </Center>\n    );\n  }\n\n  return (\n    <Padding>\n      <Layout>\n        <Content>\n          <Padding style={{ overflowY: \"auto\" }}>\n            <table style={{ width: \"100%\" }}>\n              <thead>\n                <tr>\n                  <td></td>\n                  <td>Key</td>\n                  <td>Value</td>\n                  <td>Kind</td>\n                  <td>Encryption</td>\n                  <td>Storage Engine</td>\n                </tr>\n              </thead>\n              <tbody>\n                {keyStorageEngineMaps.map((keyMap, idx) => {\n                  const { key, kind, storageEngine } = keyMap;\n\n                  return (\n                    <tr key={idx}>\n                      <td className=\"center\">\n                        <input type=\"checkbox\"></input>\n                      </td>\n                      <td>{key}</td>\n                      <td className=\"center\">\n                        <button onClick={() => onGetValue(key, storageEngine)}>\n                          Get\n                        </button>\n                      </td>\n                      <td>{kind}</td>\n                      <td>Not Encrypted</td>\n                      <td>{storageEngine.getTitle()}</td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </Padding>\n        </Content>\n        <Footer>\n          <Padding>\n            <button onClick={onEmpty}>Empty</button>\n          </Padding>\n        </Footer>\n      </Layout>\n    </Padding>\n  );\n}\n","/**\n * @param {HTMLFormElement} formElement\n * @return {Object}\n */\nexport default function getFormValues(formElement) {\n  const elements = formElement.elements;\n\n  const values = {};\n\n  for (const el of [...elements]) {\n    const key = el.name || el.id;\n\n    if (key) {\n      values[key] = el.value;\n    }\n  }\n\n  return values;\n}\n","import Form from \"./Form\";\n\nexport default Form;\n","import useFormController from \"./hooks/useFormController\";\n\n// TODO: Document\nexport default function Form({\n  children,\n  onSubmit,\n  onChange = () => null,\n  autoComplete = \"off\",\n  ...rest\n}) {\n  const { setFormRef, handleFormChange, handleFormSubmit, errors, isValid } =\n    useFormController({\n      onSubmit,\n      onChange,\n      validator: formValues => {\n        return {\n          key:\n            formValues.key.length < 1 &&\n            \"Key must contain at least one character\",\n        };\n      },\n    });\n\n  return (\n    <form\n      {...rest}\n      ref={setFormRef}\n      autoComplete={autoComplete}\n      onChange={handleFormChange}\n      onSubmit={handleFormSubmit}\n    >\n      {children({ errors, isValid })}\n    </form>\n  );\n}\n","import { useCallback, useState } from \"react\";\n\nimport getFormValues from \"@utils/getFormValues\";\n\n// TODO: Track dirty state\n\n// TODO: Document\n// NOTE: This is supposed to be a simpler alternative to: https://react-hook-form.com/\n// Was struggling to make it easily work with onChange events in a clean way\nexport default function useFormController({\n  onSubmit,\n  onChange = () => null,\n  validator = () => null,\n}) {\n  const [formElement, setFormRef] = useState(null);\n\n  const [isValid, setIsValid] = useState(false);\n  const [errors, setErrors] = useState({});\n\n  // TODO: Document\n  const validate = useCallback(\n    formValues => {\n      let hasErrors = false;\n\n      const errors = Object.fromEntries(\n        Object.entries(validator(formValues) || {}).filter(predicate => {\n          const isError = Boolean(predicate[1]);\n\n          if (isError) {\n            hasErrors = true;\n          }\n\n          return isError;\n        })\n      );\n\n      const isValid = !hasErrors;\n      setIsValid(isValid);\n      setErrors(errors);\n      return isValid;\n    },\n    [validator]\n  );\n\n  // TODO: Document\n  const handleFormChange = useCallback(\n    evt => {\n      const formValues = getFormValues(formElement);\n      validate(formValues);\n\n      onChange();\n    },\n    [validate, formElement, onChange]\n  );\n\n  // TODO: Document\n  const handleFormSubmit = useCallback(\n    evt => {\n      evt.preventDefault();\n\n      const formValues = getFormValues(formElement);\n      const isValid = validate(formValues);\n\n      if (isValid) {\n        onSubmit(formValues);\n      }\n    },\n    [validate, formElement, onSubmit]\n  );\n\n  return {\n    isValid,\n    validate,\n    handleFormChange,\n    handleFormSubmit,\n    errors,\n    setFormRef,\n  };\n}\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport Form from \"@components/Form\";\n\nexport default function KeyEditorForm({\n  initialKey,\n  initialValue,\n  initialStorageEngine,\n  storageEngines,\n  onSubmit,\n}) {\n  return (\n    <Center canOverflow={true}>\n      <Form onSubmit={onSubmit}>\n        {({ errors, isValid }) => (\n          <>\n            <Padding>\n              <input\n                name=\"key\"\n                type=\"text\"\n                placeholder=\"Key\"\n                defaultValue={initialKey}\n                required\n              />\n            </Padding>\n\n            {errors?.key && (\n              <div className=\"note\" style={{ color: \"red\" }}>\n                {errors.key}\n              </div>\n            )}\n\n            <Padding>\n              <textarea\n                name=\"value\"\n                placeholder=\"Value\"\n                defaultValue={initialValue}\n              ></textarea>\n            </Padding>\n\n            <Padding style={{ marginTop: 20, textAlign: \"left\" }}>\n              <label>Storage Engine</label>\n              <select\n                name=\"storageEngineShortUUID\"\n                defaultValue={initialStorageEngine?.getShortUUID()}\n                required\n              >\n                {storageEngines.map(storageEngine => {\n                  const title = storageEngine.getTitle();\n                  const shortUUID = storageEngine.getShortUUID();\n\n                  return (\n                    <option key={title} value={shortUUID}>\n                      {title}\n                    </option>\n                  );\n                })}\n              </select>\n            </Padding>\n\n            <div>\n              <input type=\"submit\" value=\"Submit\" disabled={!isValid} />\n            </div>\n          </>\n        )}\n      </Form>\n    </Center>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`id0d6dd5d02e64b979154a770ab790dba-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import KeyVault from \"./KeyVault\";\n\nexport default KeyVault;\n","// TODO: Implement ability to see how much storage is used\n\n// TODO: Use for local user profiles\n// TODO: Use for optional backend for notes, etc. (anything which can save a file of a reasonably small size)\n\n// TODO: Implement ability to export / import local storage data\n\nimport { useCallback, useEffect, useState } from \"react\";\n\nimport Padding from \"@components/Padding\";\nimport Layout, { Header, Content } from \"@components/Layout\";\nimport LocalStorageItems from \"./views/LocalStorageItems\";\nimport KeyEditorForm from \"./views/KeyEditorForm\";\n\nimport BackArrowIcon from \"@icons/BackArrowIcon\";\n\nimport KeyVaultService from \"@services/KeyVaultService\";\n\nconst KeyVault = {\n  id: \"local-storage-vault\",\n  title: \"Key Vault\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  serviceClasses: [KeyVaultService],\n  view: function View({ appServices }) {\n    const localDataPersistenceService = appServices[KeyVaultService];\n\n    const [keyStorageEngineMaps, setKeyStorageEngineMaps] = useState([]);\n\n    const handleFetchKeyStorageEngineMaps = useCallback(async () => {\n      const keyMaps =\n        await localDataPersistenceService.fetchKeyStorageEngineMaps();\n\n      const keyStorageEngineMaps = [];\n\n      for (const keyMap of keyMaps) {\n        const key = keyMap[0];\n        const storageEngine = keyMap[1];\n        const value = await storageEngine.fetchItem(key);\n\n        // TODO: Move this detection into the service (consider automatically\n        // coercing primitive types:\n        // @see https://developer.mozilla.org/en-US/docs/Glossary/Primitive\n        const kind = typeof value;\n\n        keyStorageEngineMaps.push({\n          key,\n          storageEngine,\n          value,\n          kind,\n        });\n      }\n\n      setKeyStorageEngineMaps(keyStorageEngineMaps);\n    }, [localDataPersistenceService]);\n\n    const [isCreatingNewKey, setIsCreatingNewKey] = useState(false);\n\n    // Auto-fetch\n    useEffect(() => {\n      handleFetchKeyStorageEngineMaps();\n    }, [handleFetchKeyStorageEngineMaps]);\n\n    const handleGetValue = useCallback(async (key, storageEngine) => {\n      const value = await storageEngine.fetchItem(key);\n\n      // TODO: Implement\n\n      // TODO: Remove\n      console.log({ key, value });\n\n      // TODO: Remove\n      alert(\"TODO: Implement get value\");\n    }, []);\n\n    // TODO: Document\n    const handleKeyValueSubmit = useCallback(\n      formValues => {\n        const storageEngine =\n          localDataPersistenceService.getStorageEngineWithShortUUID(\n            formValues[\"storageEngineShortUUID\"]\n          );\n\n        storageEngine\n          .setItem(formValues[\"key\"], formValues[\"value\"])\n          .then(() => {\n            handleFetchKeyStorageEngineMaps();\n\n            setIsCreatingNewKey(false);\n          });\n      },\n      [localDataPersistenceService, handleFetchKeyStorageEngineMaps]\n    );\n\n    // TODO: Document\n    const handleEmpty = useCallback(() => {\n      // TODO: Replace window.confirm w/ an async prompt\n      if (window.confirm(\"Are you sure you wish to empty the Key Vault?\")) {\n        localDataPersistenceService\n          .clearAllStorageEngines()\n          .then(handleFetchKeyStorageEngineMaps);\n      }\n    }, [localDataPersistenceService, handleFetchKeyStorageEngineMaps]);\n\n    return (\n      <Layout>\n        <Header>\n          <Padding>\n            {/*\n              <button>Session Storage</button>\n            <button>IndexedDB</button>\n            <button>Key Vault</button>\n            <button>Memory</button>\n              */}\n            <button onClick={() => setIsCreatingNewKey(prev => !prev)}>\n              {!isCreatingNewKey ? (\n                <>(+) New Item</>\n              ) : (\n                <>\n                  <BackArrowIcon /> Back\n                </>\n              )}\n            </button>\n          </Padding>\n        </Header>\n        <Content>\n          {!isCreatingNewKey ? (\n            <LocalStorageItems\n              keyStorageEngineMaps={keyStorageEngineMaps}\n              onGetValue={handleGetValue}\n              onEmpty={handleEmpty}\n              // TODO: Move to callback\n              onNewItem={() => setIsCreatingNewKey(true)}\n            />\n          ) : (\n            <KeyEditorForm\n              storageEngines={localDataPersistenceService.getStorageEngines()}\n              onSubmit={handleKeyValueSubmit}\n            />\n          )}\n        </Content>\n      </Layout>\n    );\n  },\n};\n\nexport default KeyVault;\n","import ReShellOrg from \"./ReShell.org\";\n\nexport default ReShellOrg;\n","import Desktop from \"@components/Desktop\";\n\nimport Applications from \"./apps/Applications\";\nimport ApplicationMonitor from \"../ExamplePortal/apps/ApplicationMonitor\";\nimport AboutReShell from \"./apps/AboutReShell\";\nimport CheckForUpdates from \"../ExamplePortal/apps/CheckForUpdates\";\nimport ColorAdjuster from \"../ExamplePortal/apps/ColorAdjuster\";\nimport Environment from \"../ExamplePortal/apps/Environment\";\nimport ServiceMonitor from \"../ExamplePortal/apps/ServiceMonitor\";\nimport SoftwareInfo from \"../ExamplePortal/apps/SoftwareInfo\";\nimport InputMediaDevices from \"../ExamplePortal/apps/InputMediaDevices\";\nimport ScreenCapture from \"../ExamplePortal/apps/ScreenCapture\";\nimport VUMeter from \"../ExamplePortal/apps/VUMeter\";\nimport MemoryInfo from \"../ExamplePortal/apps/MemoryInfo/MemoryInfo\";\nimport KeyVault from \"../ExamplePortal/apps/KeyVault\";\n\n// import WindowAPIDiscovererWindow from \"./apps/WindowAPIDiscovererWindow\";\n\n// import InputMediaDeviceSelectorView from \"./views/InputMediaDeviceSelectorView\";\n\nexport default function ReShellOrgPortal() {\n  return (\n    <Desktop\n      appDescriptors={[\n        Applications,\n        ApplicationMonitor,\n        AboutReShell,\n        CheckForUpdates,\n        ColorAdjuster,\n        Environment,\n        InputMediaDevices,\n        MemoryInfo,\n        ScreenCapture,\n        ServiceMonitor,\n        SoftwareInfo,\n        VUMeter,\n        KeyVault,\n      ]}\n    />\n  );\n}\n"],"sourceRoot":""}