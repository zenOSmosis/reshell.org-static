{"version":3,"sources":["portals/HackathonPortal/services/speechRecognition/__common__/SpeechRecognizerBase.js","components/Layout/Layout.module.css","components/Window/Window.module.css","components/Desktop/Desktop.Dock/Dock.module.css","components/Layout/RowColumn/RowColumn.module.css","components/NoWrap/NoWrap.module.css","components/Menu/Menu.jsx","components/Menu/_Menu.LibWrapper/index.jsx","components/Padding/Padding.module.css","components/modals/SystemModal/SystemModal.module.css","components/ButtonTransparent/ButtonTransparent.module.css","components/audioMeters/AudioLevelMeter/AudioLevelMeter.module.css","components/FullViewport/FullViewport.jsx","components/FullViewport/FullViewport.module.css","components/AutoScaler/AutoScaler.module.css","components/Desktop/providers/NotificationProvider/views/NotificationStack/NotificationStack.module.css","components/Desktop/providers/NotificationProvider/views/Notification/Notification.module.css","components/VirtualLink/VirtualLink.module.css","components/LED/LED.module.css","components/StickyTable/StickyTable.module.css","components/Toggle/Toggle.module.css","components/labeled/LabeledToggle/LabeledToggle.module.css","portals/ExamplePortal/apps/ColorAdjusterApp/ColorAdjuster.module.css","components/ObjectViewer/ObjectViewer.module.css","components/StaggeredWaveLoading/StaggeredWaveLoading.module.css","components/audioMeters/VUMeter/VUMeter.module.css","components/audioVideoRenderers/Video.module.css","components/labeled/LabeledLED/LabeledLED.module.css","components/ButtonGroup/ButtonGroup.module.css","components/Layout/Header.jsx","components/Layout/Content.jsx","components/Layout/Footer.jsx","components/Layout/RowColumn/RowColumn.jsx","components/Layout/index.jsx","components/Layout/Layout.jsx","components/Window/Window.Border.jsx","components/NoWrap/index.jsx","components/NoWrap/NoWrap.jsx","hooks/useDesktopContext.js","hooks/useUIParadigm.js","components/Window/Window.TitleBar/Window.TitleBar.Button/Window.TitleBar.Button.jsx","components/Window/Window.TitleBar/index.jsx","components/Window/Window.TitleBar/Window.TitleBar.jsx","hooks/useObjectState.js","hooks/useAppOrchestrationContext.js","components/Window/hooks/useWindowAutoPositioner/index.js","components/Window/hooks/useWindowAutoPositioner/useWindowAutoPositioner.js","components/Window/hooks/useWindowAutoPositioner/useWindowOutOfBoundsPositionCorrection.js","components/Window/hooks/__window_hook_constants__.js","utils/getElCenterPoint.js","components/Window/Window.View.jsx","components/Window/hooks/useWindowOpenAnimation.js","components/Window/hooks/useWindowAutoSizer.js","components/Window/hooks/useWindowControls.js","components/Window/hooks/useWindowDragger.js","components/Window/hooks/useWindowDragResizer.js","components/Window/hooks/useWindowStyles.js","components/Window/index.jsx","components/Window/Window.jsx","components/Window/Window.Provider.jsx","components/Desktop/Desktop.WindowManager/WindowManager.RouteProvider.jsx","components/Desktop/Desktop.WindowManager/WindowManager.jsx","components/Window/hooks/useWindowContext.js","components/Desktop/Desktop.WindowManager/hooks/useRegistrationViewOnResized.js","components/Desktop/Desktop.WindowManager/index.jsx","components/Menu/index.jsx","components/MenuBar/index.jsx","components/MenuBar/MenuBar.jsx","services/UIModalService.js","components/Padding/index.jsx","components/Padding/Padding.jsx","components/icons/CloseIcon/index.jsx","components/icons/CloseIcon/DynamicIcon.jsx","hooks/useKeyboardEvents.js","components/modals/SystemModal/SystemModal.jsx","components/modals/SystemModal/index.jsx","hooks/useViewportSize.js","components/modals/ConfirmModal/index.jsx","components/modals/ConfirmModal/ConfirmModal.jsx","components/icons/RCACableIcon/index.jsx","components/icons/RCACableIcon/DynamicIcon.jsx","components/ButtonTransparent/ButtonTransparent.jsx","components/ButtonTransparent/index.jsx","hooks/useArrayDiff.js","hooks/usePrevious.js","hooks/useMultiAudioMediaStreamTrackLevelMonitor.js","components/audioMeters/AudioLevelMeter/index.jsx","components/audioMeters/AudioLevelMeter/AudioLevelMeter.jsx","components/icons/MicrophoneIcon/index.jsx","components/icons/MicrophoneIcon/DynamicIcon.jsx","components/InputMediaDevicesSelector/subComponents/AudioInputDeviceTableRow.js","services/MediaDeviceCachingService.js","services/InputMediaDevicesService.js","components/InputMediaDevicesSelector/subHooks/useInputMediaDevicesSelectorState.js","components/InputMediaDevicesSelector/index.jsx","components/InputMediaDevicesSelector/InputMediaDevicesSelector.jsx","components/modals/InputDeviceSelectorModal/index.jsx","components/modals/InputDeviceSelectorModal/InputDeviceSelectorModal.jsx","hooks/useUUID.js","components/modals/TextInputModal/index.jsx","components/modals/TextInputModal/TextInputModal.jsx","services/UIModalWidgetService.js","components/Desktop/Desktop.TopBar/Desktop.TopBar.MenuBar/index.jsx","components/Desktop/Desktop.TopBar/Desktop.TopBar.MenuBar/DesktopMenuBar.jsx","components/Desktop/Desktop.TopBar/index.jsx","components/Desktop/Desktop.TopBar/TopBar.jsx","components/Desktop/Desktop.Dock/DockItem.jsx","components/Desktop/Desktop.Dock/index.jsx","components/Desktop/Desktop.Dock/Dock.jsx","components/FullViewport/index.jsx","components/AutoScaler/AutoScaler.jsx","components/AutoScaler/index.jsx","components/icons/InfoIcon/index.jsx","components/icons/InfoIcon/DynamicIcon.jsx","components/Desktop/providers/NotificationProvider/views/Notification/index.jsx","components/Desktop/providers/NotificationProvider/views/Notification/Notification.jsx","components/Desktop/providers/NotificationProvider/views/NotificationStack/index.jsx","components/Desktop/providers/NotificationProvider/views/NotificationStack/NotificationStack.jsx","components/Desktop/providers/NotificationProvider/NotificationProvider.jsx","components/Desktop/providers/NotificationProvider/index.jsx","components/Desktop/providers/ModalProvider/views/Modal/index.jsx","components/Desktop/providers/ModalProvider/views/Modal/Modal.jsx","components/Desktop/providers/ModalProvider/views/ModalStack/index.jsx","components/Desktop/providers/ModalProvider/views/ModalStack/ModalStack.jsx","components/Desktop/providers/ModalProvider/ModalProvider.jsx","components/Desktop/providers/ModalProvider/index.jsx","components/Desktop/index.jsx","components/Desktop/Desktop.jsx","components/VirtualLink/index.jsx","components/VirtualLink/VirtualLink.jsx","components/LED/index.jsx","components/LED/LED.jsx","portals/ExamplePortal/apps/ApplicationsApp/views/ApplicationSelector.jsx","portals/ExamplePortal/apps/ApplicationsApp/views/PortalSelector.jsx","portals/ExamplePortal/apps/ApplicationsApp/ApplicationsApp.jsx","portals/ExamplePortal/apps/ApplicationsApp/index.jsx","portals/ReShell.org/apps/ApplicationsApp.jsx","components/StickyTable/index.jsx","components/StickyTable/StickyTable.jsx","components/Timer/index.jsx","components/Timer/Timer.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/AppRuntime.Table.Row.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/AppRuntime.Table.jsx","components/AppLinkButton/index.jsx","components/AppLinkButton/AppLinkButton.jsx","hooks/useAppRegistrationLink.js","portals/ExamplePortal/apps/ServiceMonitorApp.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/ApplicationMonitorApp.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/index.jsx","components/ButtonPanel/index.jsx","components/ButtonPanel/ButtonPanel.jsx","components/Toggle/index.jsx","components/Toggle/Toggle.jsx","components/labeled/LabeledToggle/index.jsx","components/labeled/LabeledToggle/LabeledToggle.jsx","components/ExternalLink/index.jsx","components/ExternalLink/ExternalLink.jsx","components/ExternalLinkButton/index.jsx","components/ExternalLinkButton/ExternalLinkButton.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Details/Details.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Details/index.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Resources/Resources.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Resources/index.jsx","utils/getCopyright.js","portals/ExamplePortal/apps/AboutReShellApp/AboutReShellApp.jsx","portals/ExamplePortal/apps/AboutReShellApp/index.jsx","portals/ReShell.org/apps/AboutReShellApp.jsx","portals/ExamplePortal/apps/CheckForUpdatesApp/CheckForUpdatesApp.jsx","portals/ExamplePortal/apps/CheckForUpdatesApp/index.jsx","portals/ExamplePortal/apps/ColorAdjusterApp/index.jsx","portals/ExamplePortal/apps/ColorAdjusterApp/ColorAdjusterApp.jsx","components/ObjectViewer/index.jsx","components/ObjectViewer/ObjectViewer.jsx","portals/ExamplePortal/apps/EnvironmentApp/EnvironmentApp.jsx","portals/ExamplePortal/apps/EnvironmentApp/index.jsx","portals/ExamplePortal/apps/SoftwareInfoApp/SoftwareInfoApp.jsx","portals/ExamplePortal/apps/SoftwareInfoApp/index.jsx","components/StaggeredWaveLoading/index.jsx","components/StaggeredWaveLoading/StaggeredWaveLoading.jsx","components/Preload/index.jsx","components/Preload/Preload.jsx","components/audioMeters/VUMeter/images/vu.png","components/audioMeters/VUMeter/images/needle.png","components/audioMeters/VUMeter/index.jsx","components/audioMeters/VUMeter/VUMeter.jsx","portals/ExamplePortal/apps/VUMeterApp/VUMeterApp.jsx","portals/ExamplePortal/apps/VUMeterApp/index.jsx","components/audioVideoRenderers/AVBase.jsx","components/audioVideoRenderers/Video.jsx","services/ScreenCapturerService.js","portals/ExamplePortal/apps/ScreenCaptureApp/ScreenCaptureApp.jsx","hooks/useGetIsUnmounting.js","portals/ExamplePortal/apps/ScreenCaptureApp/index.jsx","portals/ExamplePortal/apps/InputMediaDevicesApp/InputMediaDevicesApp.jsx","portals/ExamplePortal/apps/InputMediaDevicesApp/index.jsx","utils/bytesToSize.js","portals/ExamplePortal/apps/MemoryInfoApp/index.jsx","portals/ExamplePortal/apps/MemoryInfoApp/MemoryInfoApp.jsx","portals/ExamplePortal/apps/KeyVaultApp/views/LocalStorageItems/index.jsx","portals/ExamplePortal/apps/KeyVaultApp/views/LocalStorageItems/LocalStorageItems.jsx","utils/getFormValues.js","components/Form/index.jsx","components/Form/Form.jsx","components/Form/hooks/useFormController.js","portals/ExamplePortal/apps/KeyVaultApp/views/KeyEditorForm.jsx","components/icons/BackArrowIcon/index.jsx","components/icons/BackArrowIcon/DynamicIcon.jsx","portals/ExamplePortal/apps/KeyVaultApp/index.jsx","portals/ExamplePortal/apps/KeyVaultApp/KeyVaultApp.jsx","portals/ExamplePortal/apps/AppRegistrationViewerApp/AppRegistrationViewerApp.jsx","portals/ExamplePortal/apps/AppRegistrationViewerApp/index.jsx","components/Section/index.jsx","components/Section/Section.jsx","components/labeled/LabeledLED/index.jsx","components/labeled/LabeledLED/LabeledLED.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/components/SpeechActivityTable/index.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/components/SpeechActivityTable/SpeechActivityTable.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/components/SpeechRecognizerSection/index.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/components/SpeechRecognizerSection/SpeechRecognizerSection.jsx","components/ButtonGroup/index.jsx","components/ButtonGroup/ButtonGroup.jsx","services/DesktopCommanderControllerService/commands.js","services/DesktopCommanderControllerService/DesktopCommanderControllerService.js","services/DesktopCommanderControllerService/index.js","portals/ExamplePortal/apps/DesktopCommanderDebuggerApp/DesktopCommanderDebuggerApp.jsx","portals/ExamplePortal/apps/DesktopCommanderDebuggerApp/index.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/components/SpeechCommanderApp.Footer/index.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/components/SpeechCommanderApp.Footer/SpeechCommanderApp.Footer.jsx","service.cores/ExternalAPIKeyManagementServiceCore.js","portals/HackathonPortal/services/speechRecognition/__common__/SpeechRecognizerServiceCore.js","portals/HackathonPortal/services/speechRecognition/SpeechRecognizerCollectionService/SpeechRecognizerServiceCollection.js","portals/HackathonPortal/services/speechRecognition/provider/Mesa/MesaSpeechRecognizerService/MesaSpeechRecognizer.js","portals/HackathonPortal/services/speechRecognition/provider/Mesa/MesaSubscriptionKeyManagementService.js","portals/HackathonPortal/services/speechRecognition/provider/Mesa/MesaSpeechRecognizerService/MesaSpeechRecognizerService.js","portals/HackathonPortal/services/speechRecognition/provider/Mesa/MesaSpeechRecognizerService/index.js","portals/HackathonPortal/services/speechRecognition/provider/Deepgram/DeepgramSpeechRecognizerService/DeepgramSpeechRecognizer.js","portals/HackathonPortal/services/speechRecognition/provider/Deepgram/DeepgramAPIKeyManagementService.js","portals/HackathonPortal/services/speechRecognition/provider/Deepgram/DeepgramSpeechRecognizerService/DeepgramSpeechRecognizerService.js","portals/HackathonPortal/services/speechRecognition/provider/Deepgram/DeepgramSpeechRecognizerService/index.js","portals/HackathonPortal/services/speechRecognition/SpeechRecognizerCollectionService/SpeechRecognizerCollectionService.js","portals/HackathonPortal/services/speechRecognition/SpeechRecognizerCollectionService/index.js","portals/HackathonPortal/services/speechRecognition/SpeechInputDesktopControllerService.js","portals/HackathonPortal/apps/SpeechCommanderApp/index.jsx","portals/HackathonPortal/apps/SpeechCommanderApp/SpeechCommanderApp.jsx","utils/getContactURL.js","portals/ReShell.org/index.jsx","portals/ReShell.org/ReShell.org.jsx"],"names":["EVT_CONNECTING","EVT_CONNECTED","EVT_DISCONNECTED","EVT_BEGIN_RECOGNIZE","EVT_END_RECOGNIZE","EVT_TRANSCRIPTION_RECOGNIZING","EVT_TRANSCRIPTION_FINALIZED","SpeechRecognizerBase","mediaStream","options","_isConnecting","_isConnected","_isRecognizing","_mediaStream","setImmediate","_startRecognizing","registerCleanupHandler","_stopRecognizing","a","Error","_setIsConnecting","isConnecting","Boolean","this","emit","getIsConnecting","_setIsConnected","isConnected","getIsConnected","_setIsRecognizing","isRecognizing","getIsRecognizing","_setRealTimeTranscription","text","_setFinalizedTranscription","PhantomCore","module","exports","Menu","menuStructure","opened","onOpen","onClose","rest","refAnchor","useRef","useEffect","window","addEventListener","removeEventListener","ref","className","classNames","onMouseDown","disabled","label","role","anchorRef","state","current","portal","xChildren","children","submenu","item","type","push","length","onClick","click","checked","COMMON_PROPS","overflow","ControlledMenu","applyHOC","LibControlledMenu","SubMenu","applyStatics","LibSubMenu","FullViewport","useState","elContainer","setElContainer","document","documentElement","classList","add","styles","body","handleResize","style","height","innerHeight","scrollTop","remove","Header","Full","Content","Footer","Row","disableVerticalFill","Column","Layout","DIR_BORDER_NW","DIR_BORDER_NE","DIR_BORDER_E","DIR_BORDER_SE","DIR_BORDER_SW","DIR_BORDER_W","useDirectionalDragger","direction","onBorderDrag","useDrag","isDragging","down","movement","mx","my","pointer","touch","NoWrap","useDesktopContext","useContext","DesktopServiceContext","useUIParadigm","uiParadigm","isUIParadigmAutoSet","setStaticUIParadigm","WindowTitleBarMaximizeButton","WindowTitleBarButton","WindowTitleBarMinimizeButton","WindowTitleBarCloseButton","WindowTitleBar","title","onRestoreOrMaximize","onMinimize","TitleBarView","titleBarView","refElTitleBar","shouldDisplay","DESKTOP_PARADIGM","dynamicProps","useMemo","onDoubleClick","evt","target","tagName","useObjectState","initialState","_setMergedState","refState","setState","useCallback","updatedState","JSON","parse","err","console","error","TypeError","prevState","nextState","Object","keys","diff","useAppOrchestrationContext","AppOrchestrationServiceContext","useWindowAutoPositioner","elWindow","elWindowManager","windowController","onInitialAutoPosition","refOnInitialAutoPosition","outOfBoundsCorrectionPosition","useWindowOutOfBoundsPositionCorrection","x","y","correctionPosition","_setCorrectionPosition","getOutOfBoundsPositionCorrection","winManSize","getElSize","winSize","winPosition","getElPosition","winTL","winTR","width","correctedPosition","_handleResizeOrMove","debounce","getIsMinimized","nextCorrectionPosition","on","EVT_RESIZED","EVT_MOVED","unmount","off","currentPosition","getPosition","nextPosition","setPosition","handleCenter","winManCenter","getElCenterPoint","el","offsetLeft","offsetWidth","offsetTop","offsetHeight","handleScatter","Math","floor","random","appRuntimes","refInitialAppRuntimes","__INTERNAL__setCenterHandler","__INTERNAL__setScatterHandler","requestAnimationFrame","WindowView","isActive","_setElWindow","useWindowOpenAnimation","isOpenAnimationEnded","_setIsOpenAnimationEnded","useAnimation","domElement","animationName","animationDuration","shouldRun","onAnimationEnd","useWindowAutoSizer","MOBILE_PARADIGM","maximize","restore","zIndex","_setZIndex","_setTitle","refTitle","__INTERNAL__attachWindowElement","isWindowBorderDisabled","_setIsWindowBorderDisabled","refIsWindowBorderDisabled","isMaximized","_setIsMaximized","isMinimized","_setIsMinimized","_handleWindowControllerUpdate","getState","windowTitle","getTitle","undefined","stackingIndex","shouldWindowBorderBeDisabled","getIsBorderDisabled","EVT_UPDATED","useWindowControls","getIsMaximized","minimize","getIsDestroying","destroy","useWindowDragger","isDisabled","refInitialDragPosition","refInitialWindowManagerSize","isUserDragging","setIsUserDragging","xy","event","getWindowManagerSize","initialWindowManagerWidth","initialWindowManagerHeight","dragBind","useWindowDragResizer","refInitialDragSizePosition","isUserResizing","setIsUserResizing","getSize","windowManagerWidth","windowManagerHeight","ReferenceError","includes","diffX","diffY","setSize","handleBorderDrag","isProfiling","DynamicProfilingWrapper","args","Profiler","id","getUUID","onRender","renderProfile","captureRenderProfile","Fragment","useWindowStyles","outerBorderStyle","windowStyle","backgroundColor","bodyStyle","padding","StackingContext","onMount","isAccelerated","Border","WindowBorder","borderWidth","bindNW","bindN","bindNE","bindE","bindSE","bindS","bindSW","bindW","maxHeight","maxWidth","cursor","Window","React","forwardRef","attachWindowController","useImperativeHandle","WindowContext","createContext","WindowProvider","initialSharedState","sharedState","setSharedState","Provider","value","WindowManagerRouteContext","WindowManagerRouteProvider","getAppRuntimesWithRegistrationID","activateAppRegistrationWithID","activeWindowController","setActiveWindowController","locationAppRegistrationID","useLocationAppRegistrationID","activeRegistrationID","getAppRuntime","getRegistrationID","history","useHistory","handleRegistrationOrLocationChange","clear","WindowManagerView","elBase","setElBase","desktopContextActiveWindowController","setDesktopContextActiveWindowController","windowControllerMaps","setWindowControllerMaps","getWindowControllerMapWithKey","key","refDesktopContextActiveWindowController","handleSetActiveWindow","setIsMinimized","is","handleGetIsActiveWindow","startServiceClass","useServicesContext","refHandleSetActiveWindow","_handleElBaseTouch","passive","windows","map","appRuntime","appDescriptor","getAppDescriptor","ViewComponent","view","serviceClasses","windowProps","isPinned","isPinnedToDock","isAutoStart","dataMap","appServices","serviceClass","service","onTouchStart","WindowController","onBringToTop","setTitle","__INTERNAL__attachWindowManagerElement","setAppRuntime","__INTERNAL__setWindowController","prev","next","once","EVT_DESTROYED","WrappedWindowView","filter","Cover","position","WrappedTitleBarView","forceUpdate","useForceUpdate","useWindowContext","_handleServiceUpdate","values","setResizeHandler","useRegistrationViewOnResized","refSetResizeHandler","handleResized","_handleExecResizedCallback","onResized","WindowManager","appDescriptors","addOrUpdateAppRegistration","forEach","descriptor","MenuBar","menuStructures","openedIndexes","_setOpenedIndexes","_setIsActive","nextIsActive","idx","Set","pred","onMouseOver","UIModalService","modals","showModal","uuid","uuidv4","timeout","_handleClose","clearTimeout","closeModalWithUUID","onCancel","duration","setTimeout","nextModals","prevUUID","UIServiceCore","Padding","setEl","hasSiblings","setHasSiblings","parentNode","DynamicIcon","propsRest","DEFAULT_PROPS","onKeyDown","keyCode","onKeyUp","onEnter","onEscape","isEnabled","useKeyboardEvents","domNode","props","_handleKeyDown","repeat","which","_handleKeyUp","preventDefault","_prevIsSmallViewport","SystemModal","headerView","footerView","textAlign","CloseIcon","isSmallViewport","_setIsSmallViewport","useViewportSize","onChange","debounceTime","_getViewportSize","innerWidth","refOnChange","_handleViewportSize","ConfirmModal","display","Center","canOverflow","fontWeight","ButtonTransparent","useArrayDiff","usePrevious","defaultPreviousValue","refPrev","added","removed","addedRemoved","_setAddedRemoved","Array","isArray","PhantomCollection","getChildrenDiff","EVT_AUDIO_LEVEL_UPDATED","MultiAudioMediaStreamTrackLevelMonitor","useMultiAudioMediaStreamTrackLevelMonitor","mediaStreamTrackOrTracks","onAudioLevelChange","mediaStreamTracks","track","MediaStreamTrack","kind","mediaStreamMonitor","_setMediaStreamMonitor","refOnAudioLevelChange","audioLevel","addedMediaStreamTracks","removedMediaStreamTracks","addMediaStreamTrack","removeMediaStreamTrack","AudioLevelMeter","mediaStreamTrack","elAudioLevel","setElAudioLevel","handleAudioLevelChange","requestSkippableAnimationFrame","inset","clipPath","WebkitClipPath","AudioInputDeviceTableRow","device","isCapturing","onToggleCapture","isMuted","onToggleMute","audioQualityPresets","audioQualityPresetName","onChangeAudioQualityPresetName","marginTop","fontSize","minWidth","color","float","preset","presetName","name","MicrophoneIcon","KEY_STORAGE_ENGINE_MEDIA_DEVICES","KEY_DMETA_USER_METADATA","MediaDeviceCachingService","devicesWithUserMetadata","_storageEngine","useServiceClass","KeyVaultService","getSecureLocalStorageEngine","_fetchCachedMediaDeviceUserMetadata","then","userMetadata","update","isMatch","utils","mediaDevice","getIsSameMediaDevice","deepMerge","filteredCache","setItem","fetchItem","cache","getMediaDeviceUserMetadata","cachedDevice","find","InputMediaDeviceFactoryCollection","MediaStreamTrackControllerFactoryCollection","InputMediaDevicesService","isFetchingMediaDevices","isAudioContextStarted","devices","_mediaDeviceCachingService","_inputMediaDeviceFactoryCollection","bindCollectionClass","fetchInputMediaDevices","isAggressive","untilAudioContextResumed","catch","finally","inputMediaDevices","audioContext","getIsFetchingMediaDevices","getInputMediaDevices","getAudioInputMediaDevices","predicate","getCaptureFactories","getTrackControllerFactories","getIsAudioMediaDeviceBeingCaptured","mediaDeviceInfo","MediaStreamTrackControllerFactory","getFactoriesWithInputMediaDevice","getMediaDeviceCaptureFactory","factories","userConstraints","factoryOptions","captureSpecificMediaDevice","factory","addTrackControllerFactory","uncaptureSpecificMediaDevice","getIsCapturingAnyAudio","getAudioTrackControllers","getIsAllAudioMuted","getIsAudioMuted","setIsAllAudioMuted","isAllAudioMuted","setIsAudioMuted","muteAllAudio","muteAudio","unmuteAllAudio","unmuteAudio","constraints","DEFAULT_AUDIO_QUALITY_PRESET","AUDIO_QUALITY_PRESET_TALK_RADIO","InputMediaDevicesSelector","onDeviceCapture","onDeviceUncapture","useInputMediaDevicesSelectorState","inputMediaDevicesService","serviceInstance","mediaDevicesCachingService","setDevicePreferredAudioQualityPresetName","warn","audioQualityPreset","getAudioQualityPresetWithName","setMediaDeviceUserMetadata","deviceUserMetadata","preferredConstraints","getAudioQualityPresetConstraints","getDevicePreferredAudioQualityPresetName","toggleSpecificAudioInputDevice","audioInputDevices","capturedAudioInputDevices","lenAudioInputDevices","isFetching","lenCapturedAudioInputDevices","border","borderRadius","deviceCaptureFactory","getOutputMediaStream","getTracks","getIsMuted","toggleMute","minHeight","RCACableIcon","marginLeft","InputDeviceSelectorModal","handleDeviceCapture","useUUID","TextInputModal","placeholder","elInput","setElInput","setValue","handleChange","handleClose","handleSubmit","elInputId","htmlFor","borderTopRightRadius","borderBottomRightRadius","borderTopLeftRadius","borderBottomLeftRadius","UIModalWidgetService","_uiModalService","Promise","resolve","reject","consume","selection","DesktopMenuBar","uiModalWidgetService","appRegistrations","activateAppRegistration","runningAppRegistrations","applicationsMenuData","app","getID","pinnedAppsMenuData","pinnedApps","registration","getIsPinned","hasOpenedWindows","DESKTOP_MENU_STRUCTURE","AUTO_DETECT_PARADIGM","runtime","getWindowController","scatter","center","confirm","ReShellCore","reload","activeWindowTitle","ACTIVE_APP_MENU_STRUCTURE","ACTIVE_WINDOW_MENU_STRUCTURE","TopBar","DockItem","appRegistration","isActiveRegistration","elDock","elDockItem","_setElDockItem","scrollTo","top","left","behavior","Dock","_setElDock","elContentWrapper","_setElContentWrapper","isOverflown","useOverflowDetection","handleDockScroll","scroll","scrollLeft","deltaY","dockRegistrations","getIsPinnedToDock","activeRegistration","getAppRegistration","onWheel","ResizeObserver","install","AutoScaler","elOuterWrap","setElOuterWrap","elInnerWrap","setElInnerWrap","outerWrapSize","innerWrapSize","visibility","ro","entries","entry","size","maxScaleX","maxScaleY","scale","min","transform","observe","unobserve","Notification","image","autoCloseTime","isClosing","setIsClosing","refOnClose","stopPropagation","autoCloseTimeout","startTimeout","stopTimeout","Image","alt","src","InfoIcon","MessageButton","onTouchEnd","onMouseUp","Animation","NotificationStack","notifications","onNotificationClose","NotificationContext","NotificationProvider","UINotificationService","serviceState","showNotification","notification","closeNotificationWithUUID","Modal","View","ModalStack","ModalContext","ModalProvider","modal","Desktop","backgroundView","whiteSpace","bottom","right","pointerEvents","getReShellVersion","getPhantomCoreVersion","process","VirtualLink","LED","ApplicationSelector","searchQuery","onResetSearchQuery","appRuntimeRegistrations","getRegistration","filteredRegistrations","toUpperCase","totalInstances","borderColor","nonUsed","margin","PortalSwitcher","getPortals","portalName","switchToPortal","LEN_PORTALS","REGISTRATION_ID","ApplicationsApp","elSearch","setElSearch","handleSetSearchQuery","handleDoubleClick","isDisplayingPortals","setIsDisplayingPortals","handleResetSearchQuery","ApplicationsOverrideApp","StickyTable","Timer","secs","onTick","seconds","_setSeconds","getSeconds","handleUpdate","updateInterval","setInterval","clearInterval","Date","toISOString","substr","AppRuntimeTableRow","isTopMostWindowController","elProfilerPhase","setElProfilerPhase","elProfilerActualDuration","setElProfilerActualDuration","elProfilerBaseDuration","setElProfilerBaseDuration","elProfilerStartTime","setElProfilerStartTime","elProfilerCommitTime","setElProfilerCommitTime","elProfilerInteractions","setElProfilerInteractions","handleRenderProfile","arrRenderProfile","phase","actualDuration","baseDuration","startTime","commitTime","interactions","innerHTML","parseFloat","toFixed","EVT_RENDER_PROFILED","fontStyle","getInstanceUptime","colSpan","log","environment","getEnvironment","bringToTop","AppRuntimeTable","rowSpan","AppLinkButton","useAppRegistrationLink","appDescriptorID","getAppRegistrationTitleWithID","link","registrationTitle","ButtonView","ServiceMonitorApp","services","UIServicesContext","overflowY","getUptime","APPLICATION_MONITOR_REGISTRATION_ID","verticalAlign","ApplicationMonitorApp","setIsProfiling","SERVICE_MONITOR_REGISTRATION_ID","ButtonPanel","buttons","selectedIdx","button","isSelected","setSelectedIdx","refRenderIdx","content","Toggle","isOn","domId","LabeledToggle","labelOff","labelOn","masterLabel","lenLabelOff","lenLabelOn","longestLength","diffOff","diffOn","paddingLeft","paddingRight","ExternalLink","rel","ExternalLinkButton","href","open","LINKS","SyncObject","MediaStreamController","WebRTCPeer","LINK_BUTTON_STYLE","Details","urlOrAction","zenOSmosis","GitHub","Resources","url","FULL_YEAR","getFullYear","AboutReShellApp","screen","uuidAutoDetectCheckbox","isDesktop","opacity","AboutReShellOverrideApp","CheckForUpdatesApp","isLatest","setIsLatest","isChecking","setIsChecking","isError","setIsError","lastCheckTime","setLastCheckTime","refIsChecking","handleCheckForUpdates","fetchIsLatestVersion","getTime","dayjs","format","ColorAdjusterApp","isGrayscale","setIsGrayscale","ObjectViewer","theme","EnvironmentApp","packageJson","require","SoftwareInfoApp","getPortalName","CHECK_FOR_UPDATES_REGISTRATION_ID","ENVIRONMENT_REGISTRATION_ID","StaggeredWaveLoading","Preload","preloadResources","disabledLoadingIndicator","onError","usePreload","isPreloaded","VUMeter","elVU","setElVU","elNeedle","setElNeedle","backgroundImage","vuBackground","backgroundPosition","backgroundRepeat","vuNeedle","VUMeterApp","controller","getOutputMediaStreamTrack","flat","INPUT_MEDIA_DEVICES_REGISTRATION_ID","AVBase","mediaType","onEl","MediaStream","srcObject","play","muted","refOnEl","createElement","autoPlay","playsInline","controls","Video","ScreenCaptureFactoryCollection","ScreenCapturerService","getIsScreenCaptureSupported","captureScreen","getCollectionInstance","getMediaStreamTracks","getChildren","getTrackControllers","ScreenCaptureApp","scs","isScreenCaptureSupported","screenCaptureFactory","setScreenCaptureFactory","getIsUnmounting","useGetIsUnmounting","refIsUnmounting","handleStartScreenCapture","startScreenCapture","videoTrack","getVideoTrackControllers","getOutputTrack","audioTrack","InputMediaDevicesApp","mds","VU_METER_REGISTRATION_ID","SCREEN_CAPTURE_REGISTRATION_ID","bytesToSize","bytes","sizes","i","parseInt","abs","MemoryInfoApp","jsHeapSizeLimit","totalJSHeapSize","usedJSHeapSize","_setMemoryInfo","fetchMemoryInfo","performance","memory","memoryInfo","refetchInterval","LocalStorageItems","keyStorageEngineMaps","onGetValue","onEmpty","onNewItem","keyMap","storageEngine","getEncryptionType","getFormValues","formElement","elements","Form","autoComplete","validator","formValues","onSubmit","useFormController","setFormRef","getAttribute","isValid","setIsValid","errors","setErrors","handleFormValidate","hasErrors","fromEntries","handleFormChange","handleFormSubmit","submit","validate","KeyEditorForm","initialKey","initialValue","initialStorageEngine","storageEngines","defaultValue","required","getShortUUID","shortUUID","KeyVaultApp","localDataPersistenceService","rawKeyStorageEngineMaps","getKeyStorageEngineMaps","setKeyStorageEngineMaps","isCreatingNewKey","setIsCreatingNewKey","handleKeyValueSubmit","getStorageEngineWithShortUUID","handleEmpty","clearAllStorageEngines","BackArrowIcon","getStorageEngines","AppRegistrationSelector","onRegistrationChange","AppRegistrationViewerApp","setRegistration","handleSetRegistration","registrationId","matchedRegistration","Section","LabeledLED","SpeechActivityTable","realTimeTranscription","finalizedTranscription","SpeechRecognizerSection","speechProvider","speechRecognizerService","apiKeyManagementService","getRecognizerUptime","active","status","getHasRecognizer","startRecognizing","stopRecognizing","getIsControllingDesktop","setIsControllingDesktop","getRealTimeTranscription","getFinalizedTranscription","requiresAPIKey","acquireAPIKey","getHasCachedAPIKey","deleteCachedAPIKey","serviceProviderURL","ButtonGroup","REPOSITION_OFFSET","CMD_OPEN_APPLICATIONS","keywords","description","action","commander","appOrchestrationService","APPLICATIONS_REGISTRATION_ID","CMD_ACTIVATE_NEXT_WINDOW","windowControllers","getWindowControllers","idxCurrent","indexOf","nextWindowController","CMD_ACTIVATE_PREVIOUS_WINDOW","prevWindowController","CMD_MOVE_WINDOW_UP","prevPosition","CMD_MOVE_WINDOW_UP_AND_RIGHT","CMD_MOVE_WINDOW_UP_AND_LEFT","CMD_MOVE_WINDOW_RIGHT","CMD_MOVE_WINDOW_DOWN","CMD_MOVE_WINDOW_DOWN_AND_RIGHT","CMD_MOVE_WINDOW_DOWN_AND_LEFT","CMD_MOVE_WINDOW_LEFT","CMD_CENTER_WINDOW","CMD_CENTER_ALL_WINDOWS","CMD_SCATTER_WINDOW","CMD_SCATTER_ALL_WINDOWS","CMD_MAXIMIZE_WINDOW","CMD_MINIMIZE_WINDOW","CMD_RESTORE_WINDOW","CLOSE_APPLICATION","SWITCH_TO_DESKTOP_PARADIGM","uiParadigmService","SWITCH_TO_MOBILE_PARADIGM","SWITCH_TO_AUTO_DETECT_PARADIGM","DesktopCommanderControllerService","lastCommand","lastCommandInvokeTime","_appOrchestrationService","AppOrchestrationService","_uiParadigmService","UIParadigmService","_commands","COMMANDS","commandId","command","registerCommand","getCommands","split","getCommandWithId","getLastCommand","getLastCommandInvokeTime","params","getActiveWindowController","getUnixTime","DesktopCommanderDebuggerApp","elCurrentCommand","_setElCurrentCommand","selectedWindowController","_setSelectedWindowController","selectedWindowControllerUUID","commandService","commands","appRuntimeWindowControllers","getAppRuntimes","obj","handleSelectWindowControllerChange","getWindowControllerWithUUID","isCurrentCommand","join","execCommand","COMMAND_DEBUGGER_REGISTRATION_ID","LABEL_KEY_ACQUIRE","LABEL_KEY_CONFIRM_DELETE","STATE_KEY_HAS_CACHED_API_KEY","ExternalAPIKeyManagementServiceCore","secureLocalStorageKey","keyNickname","LABELS","_secureLocalStorageKey","_labels","_keyVaultService","_secureLocalStorageEngine","_fetchCachedAPIKey","proxyOn","apiKey","cachedKey","showTextInputModal","_cacheAPIKey","removeItem","SpeechRecognizerServiceCore","ExternalAPIKeyManagementServiceClass","_apiKeyManagementService","data","hasRecognizer","isControllingDesktop","_recognizer","_handleConnectStateChange","_inputMediaDevicesService","getAPIKeyManagementService","getServiceProviderURL","recognizerParams","inputCaptureFactories","showInputMediaDevicesSelectionModal","stream","_createRecognizer","SpeechRecognizerServiceCollection","destroyAllChildren","addChild","addSpeechRecognizerServiceInstance","getSpeechRecognizerServices","sdk","MesaSpeechRecognizer","subscriptionKey","_subscriptionKey","_locationRegion","_speechRecognitionLanguage","getLocationRegion","getRecognitionLanguage","_recognitionLanguage","stopContinuousRecognitionAsync","close","speechConfig","SpeechConfig","fromSubscription","speechRecognitionLanguage","audioConfig","AudioConfig","fromStreamInput","recognizer","SpeechRecognizer","recognizing","s","e","debug","result","recognized","reason","ResultReason","RecognizedSpeech","NoMatch","canceled","CancellationReason","errorCode","errorDetails","sessionStopped","startContinuousRecognitionAsync","KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY","MesaSubscriptionKeyManagementService","MesaSpeechRecognizerService","DeepgramSpeechRecognizer","_apiKey","_deepgramSocket","_mediaRecorder","stop","WebSocket","MediaRecorder","mimeType","readyState","send","start","message","received","transcript","channel","alternatives","is_final","DeepgramAPIKeyManagementService","DeepgramSpeechRecognizerService","SpeechRecognizerCollectionService","_speechRecognizerServiceCollection","useSpeechRecognizerServiceClass","SpeechRecognizerServiceClass","speechRecognizerServiceInstance","SpeechDesktopControllerService","_desktopControllerService","_speechRecognizerCollectionService","extractCommandIntentFromText","normalizedText","toLowerCase","replace","words","commandStrengths","strength","word","bestMatchCommandStrength","reduce","b","SpeechCommanderApp","SpeechInputDesktopControllerService","speechRecognitionServices","speechRecognitionProviders","providers","provider","ReShellOrg","ReShellOrgPortal"],"mappings":"icAEaA,EAAiB,aACjBC,EAAgB,YAChBC,EAAmB,eAEnBC,EAAsB,kBACtBC,EAAoB,gBAIpBC,EAAgC,4BAGhCC,EAA8B,0BAOtBC,E,wFAOnB,8BAAYC,EAAaC,GAAU,IAAD,iDAChC,cAAMA,IAODC,eAAgB,EAOrB,EAAKC,cAAe,EAQpB,EAAKC,gBAAiB,EAItB,EAAKC,aAAeL,EAGpBM,GAAa,WACX,EAAKC,uBAGP,EAAKC,wBAAuB,kBAAM,EAAKC,sBAlCP,E,+GA2ClC,4BAAAC,EAAA,qEACQ,IAAIC,MAAM,wCADlB,iD,6IAUA,6BAAAD,EAAA,sEACQ,IAAIC,MAAM,wCADlB,kD,qGASA,SAAAC,iBAAiBC,GACfA,EAAeC,QAAQD,GAEnBE,KAAKb,gBAAkBW,IACzBE,KAAKb,cAAgBW,EAEjBA,GACFE,KAAKC,KAAKxB,M,6BAUhB,SAAAyB,kBACE,OAAOF,KAAKb,gB,6BAWd,SAAAgB,gBAAgBC,GACdA,EAAcL,QAAQK,GAElBJ,KAAKZ,eAAiBgB,IACxBJ,KAAKH,kBAAiB,GAEtBG,KAAKZ,aAAegB,EAEhBA,EACFJ,KAAKC,KAAKvB,GAEVsB,KAAKC,KAAKtB,M,4BAUhB,SAAA0B,iBACE,OAAOL,KAAKZ,e,+BAYd,SAAAkB,kBAAkBC,GAChBA,EAAgBR,QAAQQ,GAEpBP,KAAKX,iBAAmBkB,IAC1BP,KAAKX,eAAiBkB,EAElBA,EACFP,KAAKC,KAAKrB,GAEVoB,KAAKC,KAAKpB,M,8BAWhB,SAAA2B,mBACE,OAAOR,KAAKX,iB,uCASd,SAAAoB,0BAA0BC,GAGxBV,KAAKG,iBAAgB,GAErBH,KAAKM,mBAAkB,GAEvBN,KAAKC,KAAKnB,EAA+B4B,K,wCAU3C,SAAAC,2BAA2BD,GACzBV,KAAKM,mBAAkB,GAEvBN,KAAKC,KAAKlB,EAA6B2B,O,6BAtLOE,K,oDCpBlDC,EAAOC,QAAU,CAAC,OAAS,uBAAuB,OAAS,uBAAuB,QAAU,wBAAwB,OAAS,yB,oBCA7HD,EAAOC,QAAU,CAAC,sBAAsB,oCAAoC,OAAS,uBAAuB,UAAY,0BAA0B,UAAY,0BAA0B,SAAW,yBAAyB,OAAS,uBAAuB,OAAS,uBAAuB,YAAY,0BAA0B,MAAQ,sBAAsB,kBAAkB,gCAAgC,SAAW,yBAAyB,SAAW,yBAAyB,MAAQ,wB,oBCAleD,EAAOC,QAAU,CAAC,KAAO,mBAAmB,UAAY,wBAAwB,yBAAyB,qCAAqC,kBAAkB,8BAA8B,YAAY,wBAAwB,OAAS,uB,oBCA3OD,EAAOC,QAAU,CAAC,IAAM,uBAAuB,wBAAwB,yCAAyC,OAAS,4B,oBCAzHD,EAAOC,QAAU,CAAC,UAAU,0B,2MC4Cb,SAASC,KAAT,GAMX,IALFC,EAKC,EALDA,cAKC,IAJDC,cAIC,aAHDC,cAGC,MAHQ,kBAAM,MAGd,MAFDC,eAEC,MAFS,kBAAM,MAEf,EADEC,EACF,iBAEKC,EAAYC,iBAAO,MAazB,OATAC,qBAAU,WAIR,OAFAC,OAAOC,iBAAiB,SAAUN,GAE3B,WACLK,OAAOE,oBAAoB,SAAUP,MAEtC,CAACA,IAGF,qCACE,gDACEQ,IAAKN,GACDD,GAFN,IAIEQ,UAAWC,IACT,kBACAZ,GAAU,yBAKZa,YAAa,uBAKXvC,GAAa,WACX0B,EAASE,IAAYD,QAGzBa,SAAUf,EAAce,SApB1B,SAyBGf,EAAcgB,OAAShB,EAAciB,QAOxC,cAAC,IAAD,CACEC,UAAWb,EAMXc,MAAOd,EAAUe,SAAWnB,EAAS,OAAS,SAE9CE,QAASA,EACTkB,QAAQ,EAVV,SAYGC,UAAUtB,QAiBnB,SAASsB,UAAUtB,GACjB,IADgC,EAC1BuB,EAAW,GADe,cAIbvB,EAAcwB,SAJD,IAIhC,2BAA0C,CAAC,IAAhCC,EAA+B,QACtB,cAAdA,EAAKC,MACPH,EAASI,KAAK,cAAC,IAAD,GAAqBJ,EAASK,SAExCH,EAAKT,OACPO,EAASI,KACP,cAAC,IAAD,UAAsCF,EAAKT,OAAvBO,EAASK,UAI7BH,EAAKD,QACPD,EAASI,KACP,cAAC,IAAD,CAAkCX,MAAOS,EAAKT,MAA9C,SACGM,UAAUG,IADIF,EAASK,SAS5BL,EAASI,KACP,cAAC,IAAD,CAEEE,QAASJ,EAAKK,MACdf,SAAUU,EAAKV,SACfgB,QAASN,EAAKM,QAIdL,KAAMD,EAAKC,KARb,SAaGD,EAAKR,MAAQQ,EAAKT,OAZdO,EAASK,UA3BQ,8BA8ChC,OAAOL,K,0TC7JHS,EAAe,CAEnBC,SAAU,QAGNC,EAAiBC,aAAS,SAASpC,KAAT,GAA4B,IAATK,EAAQ,oBACzD,OAAO,cAAC,IAAD,2BAAuBA,GAAvB,IAA6BiB,QAAQ,GAAUW,MACrDI,KAEGC,EAAUC,YAAaC,IAAbD,EAAyB,SAASD,QAAT,GAA+B,IAATjC,EAAQ,oBACrE,OAAO,cAAC,IAAD,2BAAgBA,GAAU4B,OASpBE,O,0CCpCfrC,EAAOC,QAAU,CAAC,QAAU,yBAAyB,cAAc,+B,0CCAnED,EAAOC,QAAU,CAAC,eAAe,kCAAkC,aAAa,gCAAgC,aAAa,gCAAgC,iBAAiB,oCAAoC,OAAS,8B,0CCA3ND,EAAOC,QAAU,CAAC,qBAAqB,gD,oBCAvCD,EAAOC,QAAU,CAAC,OAAS,gCAAgC,kBAAkB,yCAAyC,MAAQ,iC,8NCM/G,SAAS0C,aAAT,GAAyD,IAAjC5B,EAAgC,EAAhCA,UAAWW,EAAqB,EAArBA,SAAanB,EAAQ,iBACrE,EAAsCqC,mBAAS,MAA/C,mBAAOC,EAAP,KAAoBC,EAApB,KA6CA,OA3CApC,qBAAU,WACR,GAAImC,EAAa,CAEfE,SAASC,gBAAgBC,UAAUC,IAAIC,IAAO,uBAC9CJ,SAASK,KAAKH,UAAUC,IAAIC,IAAO,uBAEnC,IAAME,EAAe,SAAfA,eAKJ3E,GAAa,WACXmE,EAAYS,MAAMC,OAAS5C,OAAO6C,YAAc,KAGhDT,SAASK,KAAKK,UAAY,MAc9B,OATAJ,IAIA1C,OAAOC,iBAAiB,SAAUyC,GAK3B,WAELN,SAASC,gBAAgBC,UAAUS,OAAOP,IAAO,uBACjDJ,SAASK,KAAKH,UAAUS,OAAOP,IAAO,uBAGtCxC,OAAOE,oBAAoB,SAAUwC,OAMxC,CAACR,IAGF,+CACMtC,GADN,IAEEO,IAAKgC,EACL/B,UAAWC,IAAWmC,IAAO,iBAAkBpC,GAHjD,SAKGW,Q,oDC1DP1B,EAAOC,QAAU,CAAC,qBAAqB,yCAAyC,qBAAqB,yCAAyC,gBAAgB,sC,oBCA9JD,EAAOC,QAAU,CAAC,cAAc,gCAAgC,eAAe,mC,oBCA/ED,EAAOC,QAAU,CAAC,qBAAqB,8CAA8C,aAAa,wC,0CCAlGD,EAAOC,QAAU,CAAC,aAAe,mCAAmC,OAAS,6BAA6B,kBAAkB,sCAAsC,aAAa,iCAAiC,MAAQ,4BAA4B,kBAAkB,sCAAsC,KAAO,2BAA2B,MAAQ,8B,oBCAtVD,EAAOC,QAAU,CAAC,eAAe,oC,oBCAjCD,EAAOC,QAAU,CAAC,IAAM,iBAAiB,KAAO,kBAAkB,KAAO,kBAAkB,IAAM,iBAAiB,OAAS,oBAAoB,OAAS,oBAAoB,MAAQ,mBAAmB,KAAO,oB,oBCA9MD,EAAOC,QAAU,CAAC,OAAS,8B,oBCA3BD,EAAOC,QAAU,CAAC,iBAAiB,+BAA+B,SAAW,yBAAyB,OAAS,uBAAuB,SAAW,2B,oBCAjJD,EAAOC,QAAU,CAAC,iBAAiB,sCAAsC,SAAW,gCAAgC,KAAO,4BAA4B,MAAQ,6BAA6B,OAAS,8BAA8B,KAAO,4BAA4B,cAAc,mCAAmC,YAAY,mC,oBCAnUD,EAAOC,QAAU,CAAC,iBAAiB,wC,oBCAnCD,EAAOC,QAAU,CAAC,gBAAgB,sC,oBCAlCD,EAAOC,QAAU,CAAC,kBAAkB,8CAA8C,QAAU,sCAAsC,IAAM,kCAAkC,KAAO,qC,oBCAjLD,EAAOC,QAAU,CAAC,GAAK,oBAAoB,KAAO,sBAAsB,OAAS,wBAAwB,WAAW,4B,oBCApHD,EAAOC,QAAU,CAAC,MAAQ,uB,0CCA1BD,EAAOC,QAAU,CAAC,cAAc,gCAAgC,WAAW,6BAA6B,aAAa,+BAA+B,SAAW,+B,oBCA/JD,EAAOC,QAAU,CAAC,eAAe,oC,wnDCGlB,SAAS0D,OAAT,GAAmD,IAAjC5C,EAAgC,EAAhCA,UAAWW,EAAqB,EAArBA,SAAanB,EAAQ,iBAC/D,OACE,+CAASA,GAAT,IAAeQ,UAAWC,IAAWmC,IAAM,OAAYpC,GAAvD,SACE,cAAC6C,EAAA,EAAD,UAAOlC,O,+BCHE,SAASmC,gBAAT,GAAoD,IAAjC9C,EAAgC,EAAhCA,UAAWW,EAAqB,EAArBA,SAAanB,EAAQ,iBAChE,OACE,+CAASA,GAAT,IAAeQ,UAAWC,IAAWmC,IAAM,QAAapC,GAAxD,SACE,cAAC6C,EAAA,EAAD,UAAOlC,O,+BCHE,SAASoC,OAAT,GAAmD,IAAjC/C,EAAgC,EAAhCA,UAAWW,EAAqB,EAArBA,SAAanB,EAAQ,iBAC/D,OACE,+CAASA,GAAT,IAAeQ,UAAWC,IAAWmC,IAAM,OAAYpC,GAAvD,SACE,cAAC6C,EAAA,EAAD,UAAOlC,O,kGCYb,SAASqC,IAAT,GAA6E,IAA9DrC,EAA6D,EAA7DA,SAAUX,EAAmD,EAAnDA,UAAmD,IAAxCiD,2BAAwC,SAARzD,EAAQ,iBAG1E,OACE,+CACMA,GADN,IAEEQ,UAAWC,IACTmC,IAAM,IACNa,GAAuBb,IAAO,yBAC9BpC,GALJ,SAQGW,KASP,SAASuC,OAAT,GAAmD,IAAjCvC,EAAgC,EAAhCA,SAAUX,EAAsB,EAAtBA,UAAcR,EAAQ,iBAGhD,OACE,+CAASA,GAAT,IAAeQ,UAAWC,IAAWmC,IAAM,OAAYpC,GAAvD,SACGW,K,+BC3CQwC,MCSA,SAASA,OAAT,GAAmD,IAAjCnD,EAAgC,EAAhCA,UAAWW,EAAqB,EAArBA,SAAanB,EAAQ,iBAC/D,OACE,cAACqD,EAAA,EAAD,2BAAUrD,GAAV,IAAgBQ,UAAWC,IAAWmC,IAAM,OAAYpC,GAAxD,SACGW,M,kECTMyC,EAAgB,KAEhBC,EAAgB,KAChBC,EAAe,IACfC,EAAgB,KAEhBC,EAAgB,KAChBC,EAAe,IAGtBC,EAAwB,SAAxBA,sBAAkCC,EAAWC,GACjD,OAAOC,mBACL,YAA+C,IAAtCC,EAAqC,EAA3CC,KAA2C,gBAAzBC,SAAyB,GAAdC,EAAc,KAAVC,EAAU,KAC5CN,EAAaD,EAAW,CAAEM,KAAIC,KAAIJ,iBAEpC,CACEK,QAAS,CAIPC,OAAO,M,iDCvBAC,MCEA,SAASA,OAAT,GAAmD,IAAjC1D,EAAgC,EAAhCA,SAAUX,EAAsB,EAAtBA,UAAcR,EAAQ,iBAC/D,OACE,+CAASA,GAAT,IAAeQ,UAAWC,IAAWmC,IAAO,WAAYpC,GAAxD,SACGW,M,2BCJQ,SAAS2D,oBACtB,OAAOC,qBAAWC,K,aCeL,SAASC,gBAOtB,MACEH,oBAEF,MAAO,CACLI,WAJF,EAAQA,WAKNC,oBALF,EAAoBA,oBAMlBC,oBANF,EAAyCA,qBCxBpC,SAASC,6BAAT,GAAoD,IAATrF,EAAQ,oBACxD,OAAO,cAACsF,qBAAD,2BAA0BtF,GAA1B,IAAgCQ,UAAWoC,IAAM,YAGnD,SAAS2C,6BAAT,GAAoD,IAATvF,EAAQ,oBACxD,OAAO,cAACsF,qBAAD,2BAA0BtF,GAA1B,IAAgCQ,UAAWoC,IAAM,YAGnD,SAAS4C,0BAAT,GAAiD,IAATxF,EAAQ,oBACrD,OAAO,cAACsF,qBAAD,2BAA0BtF,GAA1B,IAAgCQ,UAAWoC,IAAM,SAG1D,SAAS0C,qBAAT,GAA4C,IAATtF,EAAQ,oBAGzC,OAAO,sCAAYA,I,4ECfNyF,MCcA,SAASA,eAAT,GAOX,IANFC,EAMC,EANDA,MACAC,EAKC,EALDA,oBACAC,EAIC,EAJDA,WACA7F,EAGC,EAHDA,QACc8F,EAEb,EAFDC,aACG9F,EACF,iBACK+F,EAAgB7F,iBAAO,MAErBgF,EAAeD,gBAAfC,WAGFc,EAAgBd,IAAee,KAAoBJ,EAQnDK,EAAeC,mBAAQ,WAC3B,OAAIjB,IAAee,IACV,CACLG,cAAe,uBAAAC,GAIc,QAAvBA,EAAIC,OAAOC,SACbZ,EAAoBU,KAKnB,KAER,CAACnB,EAAYS,IAEhB,OAAKK,EAKH,4DACMhG,GADN,IAEEO,IAAKwF,EACLvF,UAAWoC,IAAO,cACdsD,GAJN,cAMGL,EACC,cAACxC,EAAA,EAAD,UAAOwC,IAEP,cAAC,EAAD,CAAQrF,UAAWoC,IAAM,MAAzB,SAAqC8C,IAGtCR,IAAee,KACd,eAAC,EAAD,CAAQzF,UAAWoC,IAAO,mBAA1B,UACE,cAACyC,6BAAD,CAA8B5D,QAASkE,IACvC,cAACJ,6BAAD,CAA8B9D,QAASmE,IACvC,cAACJ,0BAAD,CAA2B/D,QAAS1B,WApBnC,M,kDClCI,SAASyG,iBAAmC,IAApBC,EAAmB,uDAAJ,GACpD,EAAiCpE,mBAASoE,GAA1C,mBAAO1F,EAAP,KAAc2F,EAAd,KAEMC,EAAWzG,iBAAOa,GACxB4F,EAAS3F,QAAUD,EAOnB,IAAM6F,EAAWC,uBAAY,SAAAC,GAE3B,cAAeA,GACb,IAAK,SACH,IACEA,EAAeC,KAAKC,MAAMF,GAC1B,MAAOG,GAKP,MAJAC,QAAQC,MACN,iGAGIF,EAER,MAEF,IAAK,WAEHH,EAAeA,EAAaH,EAAS3F,SACrC,MAEF,IAAK,SAEH,MAEF,QACE,MAAM,IAAIoG,UAAJ,gDACqCN,IAI/CJ,GAAgB,SAAAW,GACd,IAAMC,EAAS,2BAAQD,GAAcP,GAErC,OAAIS,OAAOC,KAAKC,aAAKJ,EAAWC,IAAY9F,OAEnC8F,EAOAD,OAGV,IAEH,MAAO,CAACtG,EAAO6F,G,cC5EF,SAASc,6BACtB,OAAO3C,qBAAW4C,MCFLC,OCeA,SAASA,wBAAT,GAKX,IAJFC,EAIC,EAJDA,SACAC,EAGC,EAHDA,gBACAC,EAEC,EAFDA,iBAEC,IADDC,6BACC,MADuB,kBAAM,MAC7B,EACKC,EAA2B/H,iBAAO,MACpC2H,IACFI,EAAyBjH,QAAUgH,GAGrC,IAAME,ECGO,SAASC,uCAAT,GAIX,IAHFN,EAGC,EAHDA,SACAC,EAEC,EAFDA,gBACAC,EACC,EADDA,iBAEA,EAAqDvB,eAAe,CAClE4B,EAAG,KACHC,EAAG,OAFL,mBAAOC,EAAP,KAA2BC,EAA3B,KASMC,EAAmC3B,uBACvC,SAACgB,EAAUC,GAET,IAAMW,EAAaC,YAAUZ,GACvBa,EAAUD,YAAUb,GACpBe,EAAcC,YAAchB,GAE5BiB,EACDF,EAAYR,EADXU,EAEDF,EAAYP,EAGXU,EACDH,EAAYR,EAAIO,EAAQK,MADvBD,EAEDH,EAAYP,EAGXY,EAAoB,CACxBb,EAAG,KACHC,EAAG,MA4BL,OAxBIU,ECtDwC,KDuD1CE,EAAkBb,ECvDwB,GDwDHO,EAAQK,OAI7CD,EC/DuC,IDgEzCE,EAAkBZ,EChEuB,GDqEvCS,EAAUL,EAAWO,MCpEoB,KDqE3CC,EAAkBb,EAChBK,EAAWO,MCtE8B,ID2EzCF,EAAUL,EAAWzF,OC1EqB,KD2E5CiG,EAAkBZ,EAChBI,EAAWzF,OC5E+B,ID+EvCiG,IAET,IAGM/D,EAAeD,gBAAfC,WA8DR,OA3DA/E,qBAAU,WACR,GAEE+E,IAAee,KACf4B,GACAC,GACAC,EACA,CAGA,IAAMmB,EAAsBC,KAC1B,WAIE,IAAIpB,EAAiBqB,iBAArB,CAIA,IAAMC,EAAyBb,EAC7BX,EACAC,GAKFS,EAAuBc,MAGzB,KAEA,GAYF,OATAtB,EAAiBuB,GAAGC,IAAaL,GACjCnB,EAAiBuB,GAAGE,IAAWN,GAG/B9I,OAAOC,iBAAiB,SAAU6I,GAGlCA,IAEO,SAASO,UACd1B,EAAiB2B,IAAIH,IAAaL,GAClCnB,EAAiB2B,IAAIF,IAAWN,GAEhC9I,OAAOE,oBAAoB,SAAU4I,OAGxC,CACDhE,EACA2C,EACAC,EACAC,EACAS,EACAD,IAGKD,EDnI+BH,CAAuC,CAC3EN,WACAC,kBACAC,qBAKF5H,qBAAU,WACR,GAAI4H,IAEoC,OAApCG,EAA8BE,GACM,OAApCF,EAA8BG,GAC9B,CACA,IAAMsB,EAAkB5B,EAAiB6B,cAEnCC,EAAe,CACnBzB,EACsC,OAApCF,EAA8BE,EAC1BF,EAA8BE,EAC9BuB,EAAgBvB,EACtBC,EACsC,OAApCH,EAA8BG,EAC1BH,EAA8BG,EAC9BsB,EAAgBtB,GAGxBN,EAAiB+B,YAAYD,MAGhC,CAAC9B,EAAkBG,IAOtB,IAAM6B,EAAelD,uBAAY,WAC/B,IAAMmD,EG1DK,SAASC,iBAAiBC,GAIvC,MAAO,CACL9B,EAJQ8B,EAAGC,WAAaD,EAAGE,YAAc,EAKzC/B,EAJQ6B,EAAGG,UAAYH,EAAGI,aAAe,GHwDpBL,CAAiBnC,GAChCa,EAAUD,YAAUb,GAEpBO,EAAI4B,EAAa5B,EAAIO,EAAQK,MAAQ,EACrCX,EAAI2B,EAAa3B,EAAIM,EAAQ3F,OAAS,EAE5C+E,EAAiB+B,YAAY,CAC3B1B,IACAC,QAED,CAACP,EAAiBD,EAAUE,IAOzBwC,EAAgB1D,uBAAY,WAChC,GAAIkB,EAAkB,CACpB,IAAMU,EAAaC,YAAUZ,GACvBa,EAAUD,YAAUb,GAGpBO,EAAIoC,KAAKC,MAAMD,KAAKE,UAAYjC,EAAWO,MAAQL,EAAQK,QAC3DX,EAAImC,KAAKC,MACbD,KAAKE,UAAYjC,EAAWzF,OAAS2F,EAAQ3F,SAG/C+E,EAAiB+B,YAAY,CAAE1B,IAAGC,SAEnC,CAACP,EAAiBD,EAAUE,IAIvB4C,EAAgBjD,6BAAhBiD,YACFC,EAAwB1K,iBAAOyK,GAGrCxK,qBAAU,WACJ2H,GAAmBD,GAAYE,IAGjCA,EAAiB8C,6BAA6Bd,GAC9ChC,EAAiB+C,8BAA8BP,GAG/CnK,OAAO2K,uBAAsB,WAOvBH,EAAsB5J,QAAQQ,OAAS,EAEzCuI,IAGAQ,IAQFnK,OAAO2K,uBAAsB,WAC3B9C,EAAyBjH,mBAI9B,CACD8G,EACAD,EACAE,EACAgC,EACAQ,K,yGI9GES,GAAa,SAAbA,WAAc,GAab,IAZL7J,EAYI,EAZJA,SACA2G,EAWI,EAXJA,gBAEAC,EASI,EATJA,iBAGAkD,EAMI,EANJA,SAMI,IAJJnF,oBAII,MAJW,KAIX,MAFJ/C,aAEI,MAFI,GAEJ,EADD/C,EACC,kBAEJ,EAAiCqC,mBAAS,MAA1C,mBAAOwF,EAAP,KAAiBqD,EAAjB,KAGA,ECjCa,SAASC,uBAAuBtD,GAG7C,MAAyDxF,oBAAS,GAAlE,mBAAO+I,EAAP,KAA6BC,EAA7B,KAWA,OARAC,aAAa,CACXC,WAAY1D,EACZ2D,cAAe,WACfC,kBAAmB,MACnBC,UAAW/M,QAAQkJ,GACnB8D,eAAgB,iCAAMN,GAAyB,MAG1C,CAAED,wBDmBwBD,CAAuBtD,GAAhDuD,EAAR,EAAQA,qBAGRxD,GAAwB,CAAEC,WAAUC,kBAAiBC,qBEtCxC,SAAS6D,mBAAT,GAAmD,IAArB7D,EAAoB,EAApBA,iBACnC7C,EAAeD,gBAAfC,WAGR/E,qBAAU,WACR,GAAI4H,IACGA,EAAiBqB,iBACpB,OAAQlE,GACN,KAAK2G,IAEH9D,EAAiB+D,WACjB,MAEF,KAAK7F,IAEH8B,EAAiBgE,aAQxB,CAAChE,EAAkB7C,IFkBtB0G,CAAmB,CAAE7D,qBAErB,MAA6B1F,mBAAS,GAAtC,mBAAO2J,EAAP,KAAeC,EAAf,KACA,EAA2B5J,mBAAS,MAApC,mBAAOqD,EAAP,KAAcwG,EAAd,KACMC,EAAWjM,iBAAO,MACxBiM,EAASnL,QAAU0E,EAInBvF,qBAAU,WACJ4H,GAAoBF,GACtBE,EAAiBqE,gCAAgCvE,KAElD,CAACE,EAAkBF,IAGtB,MAA6DxF,oBAAS,GAAtE,mBAAOgK,EAAP,KAA+BC,EAA/B,KACMC,EAA4BrM,iBAAO,MACzCqM,EAA0BvL,QAAUqL,EAEpC,MAAuChK,oBAAS,GAAhD,mBAAOmK,EAAP,KAAoBC,GAApB,KACA,GAAuCpK,oBAAS,GAAhD,qBAAOqK,GAAP,MAAoBC,GAApB,MAKAxM,qBAAU,WACR,GAAI4H,EAAkB,CACpB,IAAM6E,EAAgC,SAAhCA,8BAAgC9F,GAC/BA,IACHA,EAAeiB,EAAiB8E,YAAc,IAIhD,IAAMC,EAAc/E,EAAiBgF,WACjCD,IAAgBX,EAASnL,SAC3BkL,EAAUY,QAKqBE,IAA/BlG,EAAamG,eAEbnG,EAAamG,gBAAkBjB,GAE/BC,EAAWnF,EAAamG,oBAGOD,IAA7BlG,EAAa0F,aACfC,GAAgB3F,EAAa0F,kBAGEQ,IAA7BlG,EAAa4F,aACfC,GAAgB7F,EAAa4F,aAG/B,IAAMQ,EACJnF,EAAiBoF,sBAEjBZ,EAA0BvL,UAAYkM,GAEtCZ,EAA2BY,IAS/B,OAJAN,IAEA7E,EAAiBuB,GAAG8D,IAAaR,GAE1B,SAASnD,UACd1B,EAAiB2B,IAAI0D,IAAaR,OAGrC,CAAC7E,EAAkBrC,EAAOsG,IAE7B,OG1Ha,SAASqB,kBAAT,GAAkD,IAArBtF,EAAoB,EAApBA,iBAmC1C,MAAO,CACLpC,oBA7B8BkB,uBAAY,WACtCkB,EAAiBuF,iBACnBvF,EAAiBgE,UAEjBhE,EAAiB+D,aAElB,CAAC/D,IAwBFnC,WAjBqBiB,uBAAY,WACjCkB,EAAiBwF,aAChB,CAACxF,IAgBFhI,QATkB8G,uBAAY,WACzBkB,EAAiByF,mBACpBzF,EAAiB0F,YAElB,CAAC1F,KHyFiDsF,CAAkB,CACrEtF,qBADMpC,GAAR,GAAQA,oBAAqBC,GAA7B,GAA6BA,WAAY7F,GAAzC,GAAyCA,QAKzC,GIvHa,SAAS2N,iBAAT,GAA6D,IAAjC3F,EAAgC,EAAhCA,iBAAkB4F,EAAc,EAAdA,WACrDC,EAAyB1N,iBAAO,MAChC2N,EAA8B3N,iBAAO,MAE3C,EAA4CmC,oBAAS,GAArD,mBAAOyL,EAAP,KAAuBC,EAAvB,KAwEA,MAAO,CArEM1J,mBACX,YAA0D,IAAjDC,EAAgD,EAAtDC,KAAsD,gBAApCC,SAAoC,GAAzBC,EAAyB,KAArBC,EAAqB,KAAhBsJ,EAAgB,EAAhBA,GACvC,GADuD,EAAZC,MACvCN,EACEG,GACFC,GAAkB,QAStB,GAJIzJ,IAAewJ,GACjBC,EAAkBzJ,GAGhBA,EAAY,CACTsJ,EAAuB5M,UAC1B4M,EAAuB5M,QAAU+G,EAAiB6B,eAG/CiE,EAA4B7M,UAC/B6M,EAA4B7M,QAC1B+G,EAAiBmG,wBAGrB,IAAI9F,EAAIwF,EAAuB5M,QAAQoH,EAAI3D,EACvC4D,EAAIuF,EAAuB5M,QAAQqH,EAAI3D,EAErCyJ,EACJN,EAA4B7M,QAAQgI,MAChCoF,EACJP,EAA4B7M,QAAQgC,OAGlCqF,ENtDqC,IMuDvCA,ENvDuC,GM4DvCA,EACA+F,EN3D0C,KM6D1C/F,EAAI+F,EN7DsC,IMiExCJ,EAAG,GNhEmC,IMiExC5F,EAAI,MAKJ4F,EAAG,GACHG,ENzEyC,IM2EzC/F,EAAI,MAGNL,EAAiB+B,YAAY,CAC3B1B,IACAC,WAIFuF,EAAuB5M,QAAU,KACjC6M,EAA4B7M,QAAU,QAK9B8M,GJ2CqBJ,CAAiB,CAClD3F,mBACA4F,WAAYtB,IAFd,qBAAOgC,GAAP,MAAiBP,GAAjB,MAMA,GKvHa,SAASQ,qBAAT,GAAqD,IAArBvG,EAAoB,EAApBA,iBACvCwG,EAA6BrO,iBAAO,MACpC2N,EAA8B3N,iBAAO,MAE3C,EAA4CmC,oBAAS,GAArD,mBAAOmM,EAAP,KAAuBC,EAAvB,KAkJA,MAAO,CAhJkB5H,uBACvB,SAAC1C,EAAD,GAAwC,IAA1BM,EAAyB,EAAzBA,GAAIC,EAAqB,EAArBA,GAAIJ,EAAiB,EAAjBA,WAKpB,GAJIA,IAAekK,GACjBC,EAAkBnK,GAGhBA,EAAY,CACTiK,EAA2BvN,UAC9BuN,EAA2BvN,QAA3B,2BACK+G,EAAiB2G,WACjB3G,EAAiB6B,gBAInBiE,EAA4B7M,UAC/B6M,EAA4B7M,QAC1B+G,EAAiBmG,wBAGrB,MAA8BK,EAA2BvN,QAAnDgI,EAAN,EAAMA,MAAOhG,EAAb,EAAaA,OAAQoF,EAArB,EAAqBA,EAAGC,EAAxB,EAAwBA,EAEpBsG,EAAqBd,EAA4B7M,QAAQgI,MACzD4F,EAAsBf,EAA4B7M,QAAQgC,OAE9D,OAAQmB,GACN,KAAKP,EACHoF,GAAgBvE,EAChBzB,GAAkB0B,EAElB0D,GAAQ3D,EACR4D,GAAQ3D,EAER,MAEF,IpB1DkB,IoB2DhB1B,GAAkB0B,EAClB2D,GAAQ3D,EACR,MAEF,KAAKb,EACHb,GAAkB0B,EAClBsE,GAAgBvE,EAEhB4D,GAAQ3D,EACR,MAEF,KAAKZ,EACHkF,GAAgBvE,EAChB,MAEF,KAAKV,EACHiF,GAAgBvE,EAChBzB,GAAkB0B,EAClB,MAEF,IpB3EkB,IoB4EhB1B,GAAkB0B,EAClB,MAEF,KAAKV,EACHgF,GAAgBvE,EAChBzB,GAAkB0B,EAElB0D,GAAQ3D,EACR,MAEF,KAAKR,EACH+E,GAAgBvE,EAEhB2D,GAAQ3D,EACR,MAEF,QACE,MAAM,IAAIoK,eAAJ,6BAAyC1K,IASnD,IAAK,CAACN,EAAeC,EAAcC,GAAe+K,SAAS3K,IAErDiE,EAAI,EAAG,CAGT,IAAM2G,EAAQ,EAAI3G,EAClBA,EAAI,EACJY,GAAgB+F,EAKpB,GAAI1G,EAAI,EAAG,CAGT,IAAM2G,EAAQ,EAAI3G,EAClBA,EAAI,EACJrF,GAAkBgM,EA+BpB,GAvBK,CAACpL,EAAeK,EAAcD,GAAe8K,SAAS3K,IAErD6E,EAAQZ,EAAIuG,IACd3F,EAAQ2F,EAAqBvG,EAC7BA,EAAI,MAKJpF,EAASqF,EAAIuG,IpBxIG,MoB4IhBzK,GACAA,IAAcJ,GACdI,IAAcH,IAEdhB,EAAS4L,EAAsBvG,EAC/BA,EAAI,OAKJuG,EAAsBvG,EP3JkB,GO4J1C,OAGFN,EAAiBkH,QAAQ,CAAEjG,QAAOhG,WAClC+E,EAAiB+B,YAAY,CAAE1B,IAAGC,WAElCkG,EAA2BvN,QAAU,KACrC6M,EAA4B7M,QAAU,OAG1C,CAAC+G,EAAkByG,IAGKA,GL/BiBF,CAAqB,CAC9DvG,qBADF,qBAAOmH,GAAP,MAAyBV,GAAzB,MAIQW,GAAgBrK,oBAAhBqK,YAGFC,GAA0BjJ,mBAC9B,kBACE,gBAAMkJ,EAAN,2BACEF,GAEE,cAAC,IAAMG,SAAP,2BACMD,GADN,IAEEE,GAAIxH,EAAiByH,UACrBC,SAAU,+CAAIC,EAAJ,yBAAIA,EAAJ,uBACR3H,EAAiB4H,qBAAqBD,OAI1C,cAAC,IAAME,SAAP,eAAoBP,OAE1B,CAACF,GAAapH,IAIhB,GMhKa,SAAS8H,gBAAT,GAA+D,IAApC9M,EAAmC,EAAnCA,MAAOyJ,EAA4B,EAA5BA,YAAaE,EAAe,EAAfA,YA0B5D,MAAO,CACLoD,iBAxBuB3J,mBAAQ,WAC/B,OAAIqG,GAAeE,EACV,GAEA,CACL1D,MAAOjG,EAAMiG,MACbhG,OAAQD,EAAMC,UAGjB,CAACD,EAAMiG,MAAOjG,EAAMC,OAAQwJ,EAAaE,IAgB1CqD,YAdkB5J,mBAAQ,WAC1B,MAAO,CACL6J,gBAAiBjN,EAAMiN,mBAExB,CAACjN,EAAMiN,kBAWRC,UATgB9J,mBAAQ,WACxB,MAAO,CACL+J,QAASnN,EAAMmN,WAEhB,CAACnN,EAAMmN,WNwI2CL,CAAgB,CACnE9M,QACAyJ,cACAE,iBAHMoD,GAAR,GAAQA,iBAAkBC,GAA1B,GAA0BA,YAAaE,GAAvC,GAAuCA,UAMvC,OAEE,aADA,CACCE,EAAA,EAAD,yBACEC,QAASlF,GACLlL,GAFN,IAGE+C,MAAK,2BAAO+M,IAAP,IAAyB9D,WAC9BxL,UAAWC,IACTmC,IAAO,wBAGNwI,GAAwBxI,IAAM,OAE/BqI,GAAYrI,IAAM,OAClB4J,GAAe5J,IAAM,UACrB8J,IAAe9J,IAAM,WACpBkL,IAAkBU,KAAmB5L,IAAM,UAI9CyN,cAAevC,IAAkBU,GAEjC,4BAA2BzG,EAAiBgF,WAnB9C,SA0BE,cAACqC,GAAD,UACE,cAACpE,WAAWsF,OAAZ,CACE3C,WAAYtB,EACZjI,aAAc8K,GAFhB,SAIE,cAAC7L,EAAA,EAAD,CACE7C,UAAWC,IACTmC,IAAM,OACNqI,GAAYrI,IAAM,OAGlBkL,IAAkBlL,IAAM,UAE1BG,MAAOgN,GART,SAUE,eAAC,EAAD,WACE,cAAC3M,OAAD,UACE,cAAC,EAAD,2BACMiL,MADN,IAEE3I,MAAOA,EACPC,oBAAqBA,GACrBC,WAAYA,GACZ7F,QAASA,GACT+F,aAAcA,OAGlB,cAAC,gBAAD,CAAStF,UAAWoC,IAAM,KAAUG,MAAOkN,GAA3C,SACG9O,iBAUjB6J,GAAWsF,Of/MI,SAASC,aAAT,GAOX,IANFpP,EAMC,EANDA,SACAiD,EAKC,EALDA,aAKC,IAHDoM,mBAGC,MAHa,EAGb,MAFD7C,kBAEC,SADE3N,EACF,iBACKyQ,EAASvM,EAAsBN,EAAeQ,GAC9CsM,EAAQxM,EApCY,IAoCwBE,GAC5CuM,EAASzM,EAAsBL,EAAeO,GAC9CwM,EAAQ1M,EAAsBJ,EAAcM,GAC5CyM,EAAS3M,EAAsBH,EAAeK,GAC9C0M,EAAQ5M,EApCY,IAoCwBE,GAC5C2M,EAAS7M,EAAsBF,EAAeI,GAC9C4M,EAAQ9M,EAAsBD,EAAcG,GAElD,OAGE,cAFA,CAEC,EAAD,2BAAYpE,GAAZ,cACE,cAACoD,OAAD,WACIuK,GACA,eAACnK,IAAD,CAAKT,MAAO,CAAEkO,UAAWT,EAAaxN,OAAQwN,GAA9C,UACE,cAAC9M,OAAD,2BACM+M,KADN,IAEE1N,MAAO,CAAEmO,SAAUV,EAAaW,OAAQ,kBAE1C,cAACzN,OAAD,2BAAYgN,KAAZ,IAAqB3N,MAAO,CAAEoO,OAAQ,gBACtC,cAACzN,OAAD,2BACMiN,KADN,IAEE5N,MAAO,CAAEmO,SAAUV,EAAaW,OAAQ,uBAKhD,cAAC,gBAAD,UACE,eAAC3N,IAAD,YACImK,GACA,cAACjK,OAAD,2BACMsN,KADN,IAEEjO,MAAO,CAAEmO,SAAUV,EAAaW,OAAQ,gBAI5C,cAACzN,OAAD,UAIGvC,KAEDwM,GACA,cAACjK,OAAD,2BACMkN,KADN,IAEE7N,MAAO,CAAEmO,SAAUV,EAAaW,OAAQ,qBAKhD,cAAC5N,OAAD,WACIoK,GACA,eAACnK,IAAD,CAAKT,MAAO,CAAEkO,UAAWT,EAAaxN,OAAQwN,GAA9C,UACE,cAAC9M,OAAD,2BACMqN,KADN,IAEEhO,MAAO,CAAEmO,SAAUV,EAAaW,OAAQ,kBAE1C,cAACzN,OAAD,2BAAYoN,KAAZ,IAAqB/N,MAAO,CAAEoO,OAAQ,gBACtC,cAACzN,OAAD,2BACMmN,KADN,IAEE9N,MAAO,CAAEmO,SAAUV,EAAaW,OAAQ,4Be4IvCnG,U,oEOhPAoG,GCQAC,IAAMC,YACnB,WAaE/Q,GACI,IAZFY,EAYC,EAZDA,SACA2G,EAWC,EAXDA,gBAGAmD,EAQC,EARDA,SAEAnF,EAMC,EANDA,aAMC,IAJD/C,aAIC,MAJO,GAIP,EAHE/C,EAGF,kBACH,EAAmDqC,mBAAS,MAA5D,mBAAO0F,EAAP,KAAyBwJ,EAAzB,KAUA,OAPAC,8BAAoBjR,GAAK,iBAAO,CAE9BgR,6BAKGxJ,EAKH,cAAC,GAAD,2BACM/H,GADN,IAEE+C,MAAOA,EACP+E,gBAAiBA,EACjBC,iBAAkBA,EAClBkD,SAAUA,EACVnF,aAAcA,EANhB,SAQG3E,KAZI,QCjCAsQ,GAAgBJ,IAAMK,cAAc,IAIlC,SAASC,eAAT,GAAgE,IAAtCxQ,EAAqC,EAArCA,SAAqC,IAA3ByQ,mBACjD,EAAsCpL,oBADsC,MAAN,GAAM,GAC5E,mBAAOqL,EAAP,KAAoBC,EAApB,KAEA,OACE,cAACL,GAAcM,SAAf,CACEC,MAAO,CACLF,iBACAD,eAHJ,SAMG1Q,I,wBCTM8Q,GAA4BZ,IAAMK,cAAc,IAM9C,SAASQ,2BAAT,GAAmD,IAAD,EAAZ/Q,EAAY,EAAZA,SACnD,EACEuG,6BADMyK,EAAR,EAAQA,iCAAkCC,EAA1C,EAA0CA,8BAG1C,EACEtN,oBADMuN,EAAR,EAAQA,uBAAwBC,EAAhC,EAAgCA,0BAI1BC,EAA4BC,eAGlCrS,qBAAU,WACJoS,EAEFH,EAA8BG,GAE9BD,EAA0B,QAE3B,CACDC,EACAJ,EACAG,EACAF,IAIF,IAAMK,EAAoB,OAAGJ,QAAH,IAAGA,GAAH,UAAGA,EACzBK,uBADsB,aAAG,EAEzBC,oBAEEC,EAAUC,eAwBhB,OArBA1S,qBAAU,WACR,GAAIsS,IAAyBF,EAA2B,CAMtD,IAAMO,EAAqC3J,KACzC,kBACEyJ,EAAQrR,KAAKkR,EAAoB,WAAOA,GAAyB,OAEnE,IACA,GAKF,OAFAK,IAEO,kBAAMA,EAAmCC,YAEjD,CAACN,EAAsBF,EAA2BK,IAGnD,cAACX,GAA0BF,SAA3B,CAAoCC,MAAO,GAA3C,SACG7Q,I,oKClDH8L,GAAgB,EAuBpB,SAAS+F,kBAAT,GAA0C,IAAb7R,EAAY,EAAZA,SACnBwJ,EAAgBjD,6BAAhBiD,YAER,EAA4BtI,mBAAS,MAArC,mBAAO4Q,EAAP,KAAeC,EAAf,KAEA,EAGIpO,oBAFsBqO,EAD1B,EACEd,uBAC2Be,EAF7B,EAEEd,0BAIF,EAAwDjQ,mBAAS,IAAjE,mBAAOgR,EAAP,KAA6BC,EAA7B,KAMMC,EAAgC1M,uBACpC,SAAA2M,GAGE,OAFYH,EAAqBG,KAInC,CAACH,IAIGI,EAA0CvT,iBAAO,MACvDuT,EAAwCzS,QACtCmS,EAMF,IAAMO,EAAwB7M,uBAC5B,SAAAkB,IAKE,OAAIA,QAAJ,IAAIA,OAAJ,EAAIA,EAAkBqB,mBACpBrB,EAAiB4L,gBAAe,GAI/BpM,OAAOqM,GACN7L,EACA0L,EAAwCzS,WAG1CoS,EAAwCrL,GAEpCA,GAEFA,EAAiBnB,SAAS,CAAEqG,gBAAiBA,QAInD,CAACmG,IASGS,EAA0BhN,uBAC9B,SAAAkB,GAAgB,OACdR,OAAOqM,GAAGT,EAAsCpL,KAClD,CAACoL,IAGKW,EAAsBC,eAAtBD,kBAGFE,EAA2B9T,iBAAOwT,GACxCM,EAAyBhT,QAAU0S,EACnCvT,qBAAU,WACR,GAAI8S,EAAQ,CACV,IAAMgB,EAAqB,SAArBA,mBAAqB5N,GAErBA,EAAIC,SAAW2M,GACjBe,EAAyBhT,QAAQ,OAUrC,OANAiS,EAAO5S,iBAAiB,YAAa4T,GACrChB,EAAO5S,iBAAiB,aAAc4T,EAAoB,CAExDC,SAAS,IAGJ,SAASzK,UACdwJ,EAAO3S,oBAAoB,YAAa2T,GACxChB,EAAO3S,oBAAoB,aAAc2T,EAAoB,CAM3DC,SAAS,QAId,CAACjB,IAkBJ,IAAMkB,EAAUxJ,EACbyJ,KAAI,SAAAC,GACH,IAAMC,EAAgBD,EAAWE,mBACjC,IAAKD,EACH,OAAO,KAIT,IAAMd,EAAMa,EAAW7E,UAWfgF,EAaJF,EAbFG,KACA3O,EAYEwO,EAZFxO,aACA8L,EAWE0C,EAXF1C,mBAKAlM,GAME4O,EARF/E,GAQE+E,EANF5O,OARF,EAcI4O,EALFI,sBATF,MASmB,GATnB,EAaKC,GACDL,EAJFM,SAIEN,EAHFO,eAGEP,EAFFQ,YAZF,YAcIR,EAdJ,KAgBA,IAAKE,EACH,OAAO,KAUT,IAAMO,EAAUxB,EAA8BC,GAGxCzL,EAAmBgN,GAAWA,EAAQhN,iBAc5C,GAAIgN,IAAYA,EAAQhN,iBACtB,OAAO,KAOT,IArEiB,EAqEXiN,EAAc,GArEH,cAsEUN,GAtEV,IAsEjB,2BAA2C,CAAC,IAAjCO,EAAgC,QACnCC,EAAUpB,EAAkBmB,GAElCD,EAAYC,GAAgBC,GAzEb,8BA6EjB,OACE,cAACvD,eAAD,CAA0BC,mBAAoBA,EAA9C,SACE,cAAC,GAAD,2BACM+C,GADN,IAEE7M,gBAAiBmL,EAEjBhI,SAAU4I,EAAwB9L,GAClCrH,YAAa,8BAAMgT,EAAsB3L,IACzCoN,aAAc,+BAAMzB,EAAsB3L,IAC1CjC,aACEA,EACE,cAAC,GAAD,CACEA,aAAcA,EACdkP,YAAaA,EACbjN,iBAAkBA,EAClBsM,WAAYA,IAEZ,KAEN9T,IAAK,SAAAA,OACH,GAAIA,IAAQwH,EAAkB,CAI5B,IAAMA,EAAmB,IAAIqN,IAC3B,GACA,CACEC,aAAc3B,IAIlB3L,EAAiBuN,SAAS5P,GAE1BqC,EAAiBwN,uCAAuCtC,GAIxDlL,EAAiByN,cAAcnB,GAC/BA,EAAWoB,gCAAgC1N,GAG3CxH,EAAIgR,uBAAuBxJ,GAE3BuL,GAAwB,SAAAoC,GACtB,IAAMC,EAAI,eAAQD,GAOlB,OANAC,EAAKnC,GAAO,CACVzL,mBACAyL,OAIKmC,KAGT5N,EAAiB6N,KAAKC,iBAAe,WACnCvC,GAAwB,SAAAoC,GACtB,IAAMC,EAAI,eAAQD,GAIlB,OAFAC,EAAKnC,GAAKzL,iBAAmB,KAEtB4N,QAKXjC,EAAsB3L,KA/D5B,SAyEGA,GACC,cAAC+N,kBAAD,CACEd,YAAaA,EACbjN,iBAAkBA,EAClBsM,WAAYA,EACZI,KAAMD,QA/EOhB,MAsFxBuC,QAAO,SAAA3V,GAAM,OAAIzB,QAAQyB,MAE5B,OACE,cAAC4V,EAAA,EAAD,UAQE,sBACEzV,IAAK2S,EACLnQ,MAAO,CAAEiG,MAAO,OAAQhG,OAAQ,OAAQiT,SAAU,YAFpD,UAIG9U,EAEAgT,OAOT,IAAM+B,GAAsB,SAAtBA,oBAAsB,GAAsC,IAA1BpQ,EAAyB,EAAzBA,aAAiB9F,EAAQ,kBAC/D,OAAO,cAAC8V,kBAAD,2BAAuB9V,GAAvB,IAA6ByU,KAAM3O,MAoB5C,SAASgQ,kBAAT,GAKI,IAJFd,EAIC,EAJDA,YACAjN,EAGC,EAHDA,iBACAsM,EAEC,EAFDA,WACMG,EACL,EADDC,KAEM0B,EAAcC,eAEpB,EC9Xa,SAASC,mBACtB,OAAOtR,qBAAW0M,ID6XsB4E,GAAhCxE,EAAR,EAAQA,YAAaC,EAArB,EAAqBA,eAGrB3R,qBAAU,WAKR,IAJA,IAAMmW,EAAuB,SAAvBA,uBACJH,KAGF,MAAsB5O,OAAOgP,OAAOvB,GAApC,eAAkD,CAAhC,KAER1L,GAAG8D,cAAakJ,GAG1B,OAAO,SAAS7M,UACd,cAAsBlC,OAAOgP,OAAOvB,GAApC,eAAkD,CAAhC,KAERtL,IAAI0D,cAAakJ,OAG5B,CAACtB,EAAamB,IAGjB,IAAMK,EE5YO,SAASC,6BAA6B1O,GACnD,IAAM2O,EAAsBxW,iBAAO,MAM7ByW,EAAgB9P,uBAAY,SAAA2P,GAKhCE,EAAoB1V,QAAUwV,IAC7B,IAyBH,OAvBArW,qBAAU,WACR,GAAI4H,EAAkB,CACpB,KAAMA,aAA4BqN,KAChC,MAAM,IAAIhO,UAAU,8CAGtB,IAAMwP,EAA6B,SAA7BA,6BACJ,IAAMC,EAAYH,EAAoB1V,QAGb,oBAAd6V,GACTA,KAMJ,OAFA9O,EAAiBuB,GAAGC,IAAaqN,GAE1B,SAASnN,UACd1B,EAAiB2B,IAAIH,IAAaqN,OAGrC,CAAC7O,IAEG4O,EFsWkBF,CAA6B1O,GAEtD,OACE,cAACyM,EAAD,CACEzM,iBAAkBA,EAClBiN,YAAaA,EACbX,WAAYA,EACZmC,iBAAkBA,EAClB3E,YAAaA,EACbC,eAAgBA,IG/ZPgF,OHuBA,SAASA,cAAT,GAA2D,IAAD,IAAjCC,sBAAiC,MAAhB,GAAgB,EAAZ5V,EAAY,EAAZA,SACnD6V,EAA+BtP,6BAA/BsP,2BAWR,OARA7W,qBAAU,WACR4W,EAAeE,SAAQ,SAAAC,GAAU,OAC/BF,EAA2BE,QAI5B,CAACH,EAAgBC,IAGlB,cAAC9E,2BAAD,UACE,cAACc,kBAAD,UAAoB7R,O,qCIrCXxB,G,OAAf,ECAewX,OCgBA,SAASA,QAAT,GAA2C,IAAD,IAAvBC,sBAAuB,MAAN,GAAM,EACvD,EAA2C/U,mBAAS,IAApD,mBAAOgV,EAAP,KAAsBC,EAAtB,KACA,EAAiCjV,oBAAS,GAA1C,mBAAO4I,EAAP,KAAiBsM,EAAjB,KA+BA,OA5BApX,qBAAU,WACR,IAAMqX,EAAe7Y,QAAQ0Y,EAAc7V,QAEvCyJ,IAAauM,IACfD,EAAaC,GAERA,GACHF,EAAkB,OAGrB,CAACrM,EAAUoM,IAIdlX,qBAAU,WAAO,IAAD,gBACIkX,GADJ,IACd,2BAAiC,CAAC,IAAvBI,EAAsB,QAC/B,IAAKL,EAAeK,GAAM,CACxBH,EAAkB,IAClBC,GAAa,GAEb,QANU,iCASb,CAACF,EAAeD,IAMjB,cAAC,EAAD,UACGA,EAAehD,KACd,SAACxU,EAAe6X,GAAhB,OACE7X,GACE,cAAC,GAAD,CAEEA,cAAeA,EACfE,OAAQ,yBAENwX,GAAkB,SAAA5B,GAAI,oBAAQ,IAAIgC,IAAJ,uBAAYhC,GAAZ,CAAkB+B,UAElD1X,QAAS,0BAEPuX,GAAkB,SAAA5B,GAAI,OAAIA,EAAKK,QAAO,SAAA4B,GAAI,OAAIA,IAASF,SAEzD5X,OAAQlB,QAAQ0Y,EAAcvI,SAAS2I,IACvCG,YAAa,uBACP3M,IACGoM,EAAcvI,SAAS2I,IAE1BH,EAAkB,CAACG,OAfpBA,S,6DC9CEI,G,8EACnB,0BAAsB,IAAD,+DAANxI,EAAM,yBAANA,EAAM,uBACnB,+BAASA,KAEJiG,SAAS,oBAEd,EAAK1O,SAAS,CACZkR,OAAQ,KANS,E,2DAkBrB,SAAAC,UAAUtD,GAAqB,IAAD,OAAd3W,EAAc,uDAAJ,GAClBka,EAAOC,eAETC,EAAU,KAORC,EAAe,SAAfA,eACJC,aAAaF,GAEb,EAAKG,mBAAmBL,IAG1BpZ,KAAKgI,SAAS,CAEZkR,OAAO,GAAD,oBACDlZ,KAAKiO,WAAWiL,QADf,CAEJ,CACErD,OACAuD,OAKAjY,QAASoY,EACTG,SAAUH,OAWZra,EAAQya,WACVL,EAAUM,YAAW,WACnB,EAAKH,mBAAmBL,KACvBla,EAAQya,a,gCAUf,SAAAF,mBAAmBL,GACjB,IAAMS,EAAa7Z,KAAKiO,WAAWiL,OAAO/B,QAAO,YAAyB,IAAhB2C,EAAe,EAArBV,KAGlD,OAFeA,IAASU,KAK1B9Z,KAAKgI,SAAS,CACZkR,OAAQW,Q,gBA/E8BE,M,2DCT7BC,OCGA,SAASA,QAAT,GAAoD,IAAjCzX,EAAgC,EAAhCA,SAAUX,EAAsB,EAAtBA,UAAcR,EAAQ,kBAChE,EAAoBqC,mBAAS,MAA7B,mBAAO6H,EAAP,KAAW2O,EAAX,KACA,EAAsCxW,oBAAS,GAA/C,mBAAOyW,EAAP,KAAoBC,EAApB,KAWA,OARA5Y,qBAAU,WACR,GAAI+J,EAAI,CACN,IAAM4O,EAAcna,QAAQ,aAAIuL,EAAG8O,WAAW7X,UAAUK,OAAS,GAEjEuX,EAAeD,MAEhB,CAAC5O,IAGF,+CACMlK,GADN,IAEEO,IAAKsY,EACLrY,UAAWC,IACTmC,KAAM,SACLkW,GAAelW,KAAO,eACvBpC,GANJ,SASGW,M,0BCzBQ8X,GCGK,SAAdA,YAAe,GAAiC,IAA/BzY,EAA8B,EAA9BA,UAAc0Y,EAAgB,kBACnD,OACE,6CACMA,GADN,IAEE1Y,UAAS,gDAA2CA,EAAS,WAAOA,GAAc,Q,qBCRxF,IAAM2Y,GAAgB,CACpBC,UAAW,mBAAAC,GAAO,OAAI,MACtBC,QAAS,iBAAAD,GAAO,OAAI,MACpBE,QAAS,0BAAM,MACfC,SAAU,2BAAM,MAChBC,WAAW,GAcE,SAASC,kBAAkBC,GAAsB,IAAbC,EAAY,uDAAJ,GACzD,EAA6DzT,mBAC3D,8BAAC,eAAWgT,IAAkBS,KAC9B,CAACA,IAFKR,EAAR,EAAQA,UAAWE,EAAnB,EAAmBA,QAASC,EAA5B,EAA4BA,QAASC,EAArC,EAAqCA,SAAUC,EAA/C,EAA+CA,UAM/CtZ,qBAAU,WACR,GAAKwZ,GAAYF,EAAjB,CAIA,IAAMI,EAAiB,SAAjBA,eAAiBxT,GAErB,IAAIA,EAAIyT,OAMR,OAFAV,EAAU/S,EAAI0T,OAEN1T,EAAI0T,OACV,KAAK,GACHR,IACA,MAEF,KAAK,GACHC,MAQAQ,EAAe,SAAfA,aAAe3T,GACnBA,EAAI4T,iBAEJX,EAAQjT,EAAI0T,QAMd,OAHAJ,EAAQtZ,iBAAiB,UAAWwZ,GACpCF,EAAQtZ,iBAAiB,QAAS2Z,GAE3B,WACLL,EAAQrZ,oBAAoB,UAAWuZ,GACvCF,EAAQrZ,oBAAoB,QAAS0Z,OAEtC,CAACL,EAASP,EAAWE,EAASC,EAASC,EAAUC,ICvDtD,IAAIS,IAAuB,ECXZC,ODqBA,SAASA,YAAT,GAgBX,IAfFhZ,EAeC,EAfDA,SACAX,EAcC,EAdDA,UACAT,EAaC,EAbDA,QACAuY,EAYC,EAZDA,SAYC,IAXD8B,kBAWC,MAXY,KAWZ,MAVDC,kBAUC,MAVY,gBAAG/B,EAAH,EAAGA,SAAH,OACX,qBAAKvV,MAAO,CAAEuX,UAAW,UAAzB,SACE,cAAC,GAAD,UACE,yBAAQ7Y,QAAS6W,EAAUvV,MAAO,CAAEiN,gBAAiB,OAArD,UACE,cAACuK,GAAD,IADF,kBAOL,EACD,EAA+ClY,mBAAS6X,IAAxD,mBAAOM,EAAP,KAAwBC,EAAxB,KAuBA,OAjBAP,GAAuBM,EE7BV,SAASE,gBAItBC,GAEC,IADDC,EACA,uDApB4B,IAqBtBC,EAAmBhU,uBAAY,WACnC,MAAmDzG,OAEnD,MAAO,CACL4I,MAHF,EAAQ8R,WAIN9X,OAJF,EAA2BC,eAM1B,IAIG8X,EAAc7a,iBAAOya,GAC3BI,EAAY/Z,QAAU2Z,EAEtBxa,qBAAU,WACR,GAAmC,oBAAxB4a,EAAY/Z,QAAwB,CAC7C,IAAMga,EAAsB7R,oBAC1B,YAKEwR,EAJiBI,EAAY/Z,SAEhB6Z,OAIfD,GAEA,GASF,OALAI,IAGA5a,OAAOC,iBAAiB,SAAU2a,GAE3B,SAASvR,UACdrJ,OAAOE,oBAAoB,SAAU0a,OAGxC,CAACJ,EAAcC,IFdlBH,EAAgB,YAAwB,IAArB1R,EAAoB,EAApBA,MAAOhG,EAAa,EAAbA,OAGtByX,EADEzR,EAAQ,KAAOhG,EAAS,QAQ9B0W,kBAAkBtZ,OAAQ,CACxBoZ,SAAUlB,IAIV,cAACjV,EAAA,EAAD,CACE7C,UAAWC,IACTmC,KAAO,gBACP4X,EAAkB5X,KAAO,kBAAoB,KAC7CpC,GAJJ,SAOE,qBAAKA,UAAWoC,KAAO,cAAvB,SACE,qBAAKpC,UAAWoC,KAAO,cAAvB,SACE,eAAC,EAAD,WACGwX,GACC,cAAChX,OAAD,CAAQ5C,UAAWoC,KAAM,OAAzB,SACyB,oBAAfwX,EACJA,EAAW,CAAE9B,WAAUvY,YACvBqa,IAIR,cAAC,gBAAD,UAAUjZ,IAETkZ,GACC,cAAC9W,OAAD,CAAQ/C,UAAWoC,KAAM,OAAzB,SACyB,oBAAfyX,EACJA,EAAW,CAAE/B,WAAUvY,YACvBsa,c,8CGtFLY,OCYA,SAASA,aAAT,GA0BX,IAzBF3b,EAyBC,EAzBDA,KACAgZ,EAwBC,EAxBDA,SACAvY,EAuBC,EAvBDA,QAuBC,IAtBDsa,kBAsBC,MAtBY,gBAAG/B,EAAH,EAAGA,SAAUvY,EAAb,EAAaA,QAAb,OACX,qBAAKgD,MAAO,CAAEuX,UAAW,UAAzB,SACE,eAAC,GAAD,WACE,wBACE7Y,QAAS1B,EACTgD,MAAO,CAELiN,gBAAiB,WAJrB,oBAUA,qBAAKjN,MAAO,CAAEmY,QAAS,eAAgBlS,MAAO,SAE9C,wBAAQvH,QAAS6W,EAAUvV,MAAO,CAAEiN,gBAAiB,OAArD,0BAOL,EADEhQ,EACF,kBACD,OACE,cAAC,GAAD,2BACMA,GADN,IAEEsY,SAAUA,EACVvY,QAASA,EACTsa,WAAYA,EAJd,SAME,cAACc,GAAA,EAAD,CAAQC,aAAa,EAAMrY,MAAO,CAAEsY,WAAY,QAAhD,SACG/b,Q,0BC9CM2Z,GCGK,SAAdA,YAAe,GAAiC,IAA/BzY,EAA8B,EAA9BA,UAAc0Y,EAAgB,kBACnD,OACE,6CACMA,GADN,IAEE1Y,UAAS,gDAA2CA,EAAS,WAAOA,GAAc,Q,iDCMzE8a,ICdAA,GDGf,SAASA,kBAAT,GAA8D,IAAjCna,EAAgC,EAAhCA,SAAUX,EAAsB,EAAtBA,UAAcR,EAAQ,kBAC3D,OACE,gDACEQ,UAAWC,IAAWmC,KAAO,sBAAuBpC,IAChDR,GAFN,aAIGmB,M,oDECQ,SAASoa,aAAa5F,GAEnC,IAAMD,ECEO,SAAS8F,YACtBxJ,GAEC,IADDyJ,EACA,uDAjBwB,KAoBlBC,EAAUxb,iBAAOub,GASvB,OALAtb,qBAAU,WACRub,EAAQ1a,QAAUgR,IACjB,CAACA,IAGG0J,EAAQ1a,QDjBFwa,CAAY7F,EAAM,IAE/B,EAAyCtT,mBAAS,CAAEsZ,MAAO,GAAIC,QAAS,KAAxE,mBAAOC,EAAP,KAAqBC,EAArB,KAmBA,OAjBA3b,qBAAU,WAGR,IAAK4b,MAAMC,QAAQrG,GACjB,MAAM,IAAInX,MAAM,2BAGlB,MAA2Byd,oBAAkBC,gBAAgBxG,EAAMC,GAA3DgG,EAAR,EAAQA,MAAOC,EAAf,EAAeA,SAEXD,EAAMna,QAAUoa,EAAQpa,SAC1Bsa,EAAiB,CACfH,QACAC,cAGH,CAAClG,EAAMC,IAEH,CACLgG,MAAOE,EAAaF,MACpBC,QAASC,EAAaD,SEjC1B,IAAQO,GAA4BC,0CAA5BD,wBAYO,SAASE,4CAGrB,IAFDC,EAEA,uDAF2B,GAC3BC,EACA,uCAIMC,EAAoBrW,mBACxB,kBACImW,EAEEP,MAAMC,QAAQM,GACdA,EACA,CAACA,GAHD,IAIFvG,QACA,SAAA0G,GAAK,OAAIA,aAAiBC,kBAAmC,UAAfD,EAAME,UAExD,CAACL,IAGH,EAAqDja,mBAAS,MAA9D,mBAAOua,EAAP,KAA2BC,EAA3B,KAEMC,EAAwB5c,iBAAOqc,GACrCO,EAAsB9b,QAAUub,EAIhCpc,qBAAU,WACR,IAAMyc,EAAqB,IAAIR,0CAU/B,OANAQ,EAAmBtT,GAAG6S,IAAyB,SAAAY,GAC7CD,EAAsB9b,QAAQ+b,MAGhCF,EAAuBD,GAEhB,SAASnT,UACTmT,EAAmBpP,mBACtBoP,EAAmBnP,aAGtB,IAEH,MACE8N,aAAaiB,GADAQ,EAAf,EAAQrB,MAAwCsB,EAAhD,EAAuCrB,QAIvCzb,qBAAU,WACR,GAAIyc,EAAoB,qBAEFI,GAFE,IAEtB,2BAA4C,CAAC,IAAlCP,EAAiC,QAC1CG,EAAmBM,oBAAoBT,IAHnB,kDAOFQ,GAPE,IAOtB,2BAA8C,CAAC,IAApCR,EAAmC,QAC5CG,EAAmBO,uBAAuBV,IARtB,kCAWvB,CAACG,EAAoBI,EAAwBC,I,4DC3EnCG,OC0BA,SAASA,gBAAT,GAKX,IAJF5c,EAIC,EAJDA,UACA6c,EAGC,EAHDA,iBACAb,EAEC,EAFDA,kBACGxc,EACF,kBACD,EAAwCqC,mBAAS,MAAjD,mBAAOib,EAAP,KAAqBC,EAArB,KAGMvF,EAAO7R,kBAAQ8R,KAAQ,IAOvBuF,EAAyB3W,uBAC7B,SAAAkW,GACMO,GACFG,MAA+B,WAE7B,IAAMC,EAAQ,IAAMX,EAEpBO,EAAava,MAAM4a,SAAnB,gBAAuCD,EAAvC,YACAJ,EAAava,MAAM6a,eAAnB,gBAA6CF,EAA7C,cACC1F,KAGP,CAACsF,EAActF,IAgBjB,OAXA7X,qBAAU,WACJmd,GACFE,EAAuB,KAExB,CAACA,EAAwBF,IAE5BjB,0CACEgB,GAAoBb,EACpBgB,GAIA,6CAAKhd,UAAWC,IAAWmC,KAAM,OAAYpC,IAAgBR,GAA7D,aASE,qBAAKQ,UAAWoC,KAAO,mBAAvB,SACE,qBAAKrC,IAAKgd,EAAiB/c,UAAWoC,KAAM,c,0BChFrCqW,GCGK,SAAdA,YAAe,GAAiC,IAA/BzY,EAA8B,EAA9BA,UAAc0Y,EAAgB,kBACnD,OACE,6CACMA,GADN,IAEE1Y,UAAS,gDAA2CA,EAAS,WAAOA,GAAc,QCDzE,SAASqd,yBAAT,GAUX,IATFC,EASC,EATDA,OACAtB,EAQC,EARDA,kBACAuB,EAOC,EAPDA,YACAC,EAMC,EANDA,gBACAC,EAKC,EALDA,QACAC,EAIC,EAJDA,aACAC,EAGC,EAHDA,oBACAC,EAEC,EAFDA,uBACAC,EACC,EADDA,+BAGA,GAAoB,eAAhBP,EAAOnB,KACT,MAAM,IAAIvV,UAAU,sCAGtB,OACE,qBAAIrE,MAAOgb,EAAc,CAAE/N,gBAAiB,sBAAyB,KAArE,UACE,6BACE,eAAC,GAAD,WACE,qBAAKjN,MAAO,CAAEsY,WAAY,QAA1B,SACGyC,EAAOld,OAAP,oBAGH,sBAAKmC,MAAO,CAAEub,UAAW,GAAzB,UACE,sBAAMvb,MAAO,CAAEwb,SAAU,QAAzB,sBAAmD,IACjDR,EA0BA,yBACEtc,QAASuc,EACTjb,MAAO,CAAEyb,SAAU,IAAKlE,UAAW,QAFrC,UAIG8D,EAAwB,IACzB,cAAC7D,GAAD,CAAWxX,MAAO,CAAE0b,MAAO,SAAUC,MAAO,cA9B9C,wBACE1M,MAAOoM,EACPzD,SAAU,kBAAAtU,GAAG,OACXgY,EAA+BhY,EAAIC,OAAO0L,QAS5CrR,SAAUod,EAZZ,SAcGI,EAAoB/J,KAAI,SAACuK,EAAQlH,GAChC,IAAMmH,EAAaD,EAAOE,KAE1B,OACE,wBAAkB7M,MAAO4M,EAAzB,SACGA,GADUnH,gBAmB3B,oBAAIjX,UAAU,SAAd,SACE,cAAC,GAAD,UACE,wBACEiB,QAASuc,EACTjb,MAAO,CACLiN,gBAAiB+N,EAAc,MAAQ,UACvC/U,MAAO,QAJX,SAOG+U,EAAc,OAAS,cAI9B,oBAAIvd,UAAU,SAAd,SACE,cAAC,GAAD,UACE,eAAC,GAAD,CACEG,UAAWod,EACXtc,QAASyc,EACTnb,MAAO,CACL0b,MAAQV,EAA0BE,EAAU,QAAU,SAAhC,WAJ1B,UAOE,qBAAKlb,MAAO,CAAEuX,UAAW,YACzB,cAACwE,GAAD,CAAgB/b,MAAO,CAAEwb,SAAU,WACnC,qBAAKxb,MAAO,CAAEwb,SAAU,OAAQD,UAAW,GAA3C,SACIP,EAAsBE,EAAU,MAAQ,KAA1B,eAKxB,oBACEzd,UAAU,SACVuC,MAAO,CACLiG,MAAO,GAIPhG,OAAQ,IAPZ,SAUE,cAAC,GAAD,UACG+a,EACiB,eAAhBD,EAAOnB,MACL,cAAC,GAAD,CAAiBH,kBAAmBA,IAGtC,cAACrB,GAAA,EAAD,CAAQpY,MAAO,CAAE0b,MAAO,OAAQF,SAAU,QAA1C,wB,uBCjHNQ,GAAmC,gBAGnCC,GAA0B,eAKXC,G,oGACnB,qCAAsB,IAAD,0EAAN5P,EAAM,yBAANA,EAAM,uBACnB,+BAASA,KAEJzI,SAAS,CACZsY,wBAAyB,KAG3B,EAAK5J,SAAS,gCAEd,EAAK6J,eACH,EAAKC,gBAAgBC,MAAiBC,8BAGxC,wBAAC,6BAAA/gB,EAAA,+DACC,EAAKghB,sCAAsCC,MAAK,SAAAN,GAAuB,OACrE,EAAKtY,SAAS,CAAEsY,+BAFnB,gDAAD,GAbmB,E,gIA6BrB,kBAAiCpB,EAAQ2B,GAAzC,sBAAAlhB,EAAA,mEACwB,kBAAXuf,EADb,sBAEU,IAAI1W,UAAU,4BAFxB,UAK8B,kBAAjBqY,EALb,sBAMU,IAAIrY,UAAU,kCANxB,kCApCuB,SA+CC0W,GAXxB,eAYKkB,GAA0BS,GAFzBC,EAVN,WAgB8B9gB,KAAK2gB,sCAAsCC,MACrE,SAAAN,GAAuB,OAErBA,EAAwBnJ,QAAO,SAAA4B,GAC7B,IAAMgI,EAAUC,SAAMC,YAAYC,qBAChCnI,EAAKmG,OACLA,GAUF,OAPI6B,IAEFD,EAASK,oBAAUpI,EAAD,gBACfqH,GAA0BS,MAIvBE,QAhChB,cAgBQK,EAhBR,OAqCQrK,EArCR,uBAqCmBqK,GArCnB,CAqCkCN,IArClC,UAuCQ9gB,KAAKugB,eAAec,QAAQlB,GAAkCpJ,GAvCtE,QAyCE/W,KAAKgI,SAAS,CAAEsY,wBAAyBvJ,IAzC3C,wD,8KAiDA,oCAAApX,EAAA,gFACsBK,KAAKugB,eAAee,UACtCnB,IAFJ,UACQoB,EADR,QAKMpE,MAAMC,QAAQmE,GALpB,yCAMWA,GANX,gCAQW,IARX,uD,kIAqBA,SAAAC,2BAA2BtC,GACzB,IAAMuC,EAAezhB,KAAKiO,WAAWqS,wBAAwBoB,MAAK,SAAA3I,GAAI,OACpEiI,SAAMC,YAAYC,qBAAqBnI,EAAKmG,OAAQA,MAGtD,GAAIuC,EACF,OAAOA,EAAY,iB,2BA1G8B1H,MCJjD4H,G,+RAA0CC,gDAO3BC,G,kGACnB,oCAAsB,IAAD,yEAANpR,EAAM,yBAANA,EAAM,uBACnB,+BAASA,KAEJiG,SAAS,+BAEd,EAAK1O,SAAS,CACZ8Z,wBAAwB,EACxBC,uBAAuB,EACvBC,QAAS,KAGX,EAAKC,2BAA6B,EAAKzB,gBACrCH,IAGF,EAAK6B,mCAAqC,EAAKC,oBAC7CR,IAQF,EAAKS,yBAxBc,E,2HAsCrB,wDAAAziB,EAAA,sEAA6B0iB,IAA7B,iCACEriB,KAAKgI,SAAS,CAAE8Z,wBAAwB,IAD1C,SAWQ9hB,KAAKsiB,2BAXb,uBAakCtB,SAAMC,YACnCmB,uBAAuBC,GACvBE,MAAMja,QAAQC,OACdia,SAAQ,kBAAM,EAAKxa,SAAS,CAAE8Z,wBAAwB,OAhB3D,cAaQW,EAbR,OAqBEziB,KAAKgI,SAAS,CAAEga,QAASS,IArB3B,kBAuBSA,GAvBT,sD,4JA2BA,8BAAA9iB,EAAA,gFACQqhB,SAAM0B,aAAaJ,2BAD3B,OAGEtiB,KAAKgI,SAAS,CACZ+Z,uBAAuB,IAJ3B,uD,sHAaA,SAAAY,4BACE,OAAO3iB,KAAKiO,WAAW6T,yB,kCAOzB,SAAAc,uBAGE,OAFoB5iB,KAAKiO,WAAjB+T,SAEU,K,uCAOpB,SAAAa,4BAIE,OAH0B7iB,KAAK4iB,uBAGNzL,QAAO,SAAA2L,GAAS,OACvCA,EAAU/E,KAAK7N,SAAS,mB,iCAK5B,SAAA6S,sBACE,OAAO/iB,KAAKkiB,mCAAmCc,gC,gDAIjD,SAAAC,mCAAmCC,GACjC,OAAOnjB,QACLojB,qCAAkCC,iCAChCF,EAIA,SACAtgB,U,0CAKN,SAAAygB,6BAA6BH,GAC3B,IAAMI,EACJH,qCAAkCC,iCAChCF,EAEA,SAGJ,GAAII,EACF,OAAOA,EAAU,K,iFA+BrB,kBACEJ,GADF,gCAAAvjB,EAAA,uEAEE4jB,EAFF,+BAEoB,GAClBC,EAHF,+BAGmB,GAHnB,SAKwBxC,SAAMC,YAAYwC,2BACtCP,EACAK,EACAC,GARJ,cAKQE,EALR,OAWE1jB,KAAKkiB,mCAAmCyB,0BAA0BD,GAXpE,kBAaSA,GAbT,uD,qKAiBA,kBAAmCR,GAAnC,UAAAvjB,EAAA,yFACSqhB,SAAMC,YAAY2C,6BAA6BV,IADxD,kD,wHASA,SAAAW,yBACE,OAAO7jB,KAAKkiB,mCAAmC4B,2BAC5ClhB,S,gCAQL,SAAAmhB,qBACE,OAAO/jB,KAAKkiB,mCAAmC8B,oB,gCASjD,SAAAC,mBAAmBC,GACjB,OAAOlkB,KAAKkiB,mCAAmCiC,gBAC7CD,K,0BAWJ,SAAAE,eACE,OAAOpkB,KAAKkiB,mCAAmCmC,c,4BAQjD,SAAAC,iBACE,OAAOtkB,KAAKkiB,mCAAmCqC,kB,0BA1OGxK,MCT9CwF,GAAwByB,SAAMwD,YAA9BjF,oBAGFkF,GACJlF,GAAoBmF,gCCVPC,OCYA,SAASA,0BAAT,GAGX,IAAD,IAFDC,uBAEC,MAFiB,SAAA1F,GAAM,OAAI,MAE3B,MADD2F,kBAEA,EFHa,SAASC,kCAAT,GAGX,IAAD,IAFDF,uBAEC,MAFiB,SAAA1F,GAAM,OAAI,MAE3B,MADD2F,yBACC,MADmB,SAAA3F,GAAM,OAAI,MAC7B,EACwB6F,EAA6BvE,aACpDqB,IADMmD,gBAIiBC,EAA+BzE,aACtDH,IADM2E,gBAKRzjB,qBAAU,WACJwjB,GACFA,EAAyB3C,2BAE1B,CAAC2C,IAKJ,IAAMG,EAA2Cjd,sBAAW,yCAC1D,iBAAOiX,EAAQM,GAAf,gBAAA7f,EAAA,kEAEsB,eAAhBuf,EAAOnB,KAFb,uBAGIzV,QAAQ6c,KAAR,qEACgEjG,EAAOnB,KADvE,uCAHJ,iCASQqH,EACJpE,SAAMwD,YAAYjF,oBAAoB8F,8BACpC7F,GAXN,kBAcSyF,EAA2BK,2BAA2BpG,EAAQ,CACnEkG,wBAfJ,iDAD0D,wDAsB1D,CAACH,IAQGxB,EAA6Bxb,sBAAW,yCAC5C,kBAAMiX,GAAN,oBAAAvf,EAAA,uEACQ4lB,EACJN,EAA2BzD,2BAA2BtC,IAEpDsG,EACFD,IAAkB,UAClBA,EAAmBH,0BADD,aAClB,EAAuCZ,eAGI,eAAhBtF,EAAOnB,OAClCyH,EACEjG,GAAoBkG,iCAClBhB,KAZR,kBAiBSM,EAAyBtB,2BAC9BvE,EACAsG,IAnBJ,kDAD4C,sDAwB5C,CAACT,EAA0BE,IAMvBS,EAA2Czd,uBAC/C,SAAAiX,GACE,IAGwB,EAHlBqG,EACJN,EAA2BzD,2BAA2BtC,GAExD,OAAIqG,EACF,UAAOA,EAAmBH,0BAA1B,aAAO,EAAuCnF,KAEvCwE,GAA6BxE,OAGxC,CAACgF,IAIGU,EAAiC1d,sBAAW,yCAChD,kBAAMiX,GAAN,UAAAvf,EAAA,mEAEIolB,EAAyB9B,mCAAmC/D,GAFhE,gCAOUuE,EAA2BvE,GAPrC,OAUI0F,EAAgB1F,GAVpB,uCAaU6F,EAAyBnB,6BAA6B1E,GAbhE,OAgBI2F,EAAkB3F,GAhBtB,mDADgD,sDAoBhD,CACE6F,EACAtB,EACAmB,EACAC,IAIEe,GACoB,OAAxBb,QAAwB,IAAxBA,OAAA,EAAAA,EAA0BlC,8BAA+B,GAErDgD,EAA4BD,EAAkBzO,QAAO,SAAA+H,GAAM,cAC/D6F,QAD+D,IAC/DA,OAD+D,EAC/DA,EAA0B9B,mCAAmC/D,MAG/D,MAAO,CACL6F,2BACAE,6BACAW,oBACAC,4BACAtG,uBACAoG,iCACAT,2CACAQ,4CEhIEZ,CAAkC,CACpCF,kBACAC,uBAZD,MADmB,SAAA3F,GAAM,OAAI,MAC7B,IAEC6F,EADF,EACEA,yBACAE,EAFF,EAEEA,2BACAW,EAHF,EAGEA,kBACAC,EAJF,EAIEA,0BACAtG,EALF,EAKEA,oBACAoG,EANF,EAMEA,+BACAT,EAPF,EAOEA,yCACAQ,EARF,EAQEA,yCAMF,IAAKX,IAA6BE,EAChC,OAAO,KAGT,IAAMa,EAAuBF,EAAkBhjB,OAEzCmjB,EAAahB,EAAyBpC,4BAE5C,IAAKiD,EAAkBhjB,OACrB,OACE,cAAC2Z,GAAA,EAAD,CAAQpY,MAAO,CAAEsY,WAAY,QAA7B,SACGsJ,EACG,4BACA,oDAKV,IAAMC,EAA+BH,EAA0BjjB,OAE/D,OACE,eAAC,EAAD,WACE,cAAC4B,OAAD,gDACA,cAAC,gBAAD,UACE,cAAC,GAAD,UACE,cAACC,EAAA,EAAD,CACEN,MAAO,CACLlB,SAAU,OACVgjB,OAAQ,oBACRC,aAAc,GAJlB,SAOE,wBAAO/hB,MAAO,CAAEiG,MAAO,QAAvB,UACE,gCACE,+BACE,sCACA,oBAAIxI,UAAU,SAAd,kBACA,oBAAIA,UAAU,SAAd,mBACA,oBAAIA,UAAU,SAAd,wBAGJ,gCACGgkB,EAAkBpQ,KAAI,SAAC0J,EAAQrG,GAAS,IAAD,EAChCsG,EACJ0G,EAA0B3V,SAASgP,GAE/BiH,EACJpB,EAAyB1B,6BACvBnE,GAGEtB,EACJuB,IAAW,OACXgH,QADW,IACXA,GADW,UACXA,EAAsBC,8BADX,aACX,EAA8CC,aAchD,OACE,cAACpH,yBAAD,CAEEC,OAAQA,EACRtB,kBAAmBA,EACnBuB,YAAaA,EACbC,gBAAiB,kCACfuG,EAA+BzG,IAEjCG,QAAO,OAAE8G,QAAF,IAAEA,OAAF,EAAEA,EAAsBG,aAC/BhH,aAAc,sCAAM6G,QAAN,IAAMA,OAAN,EAAMA,EAAsBI,cAC1ChH,oBAAqBA,EACrBC,uBAAwBkG,EACtBxG,GAEFO,+BAAgC,wCAAAD,GAAsB,OACpD0F,EACEhG,EACAM,KAhBC3G,iBA4BrB,cAAClU,OAAD,CAAQR,MAAO,CAAEqiB,UAAW,IAA5B,SACE,eAAC,GAAD,WACE,cAACC,GAAD,CACEtiB,MAAO,CACLwb,SAAU,GACV+G,WAAY,GACZ7G,MAAO,0BAGX,cAACzI,EAAA,EAAD,UACE,eAACmF,GAAA,EAAD,WACE,gCACGuJ,EADH,sBAE4B,IAAzBA,GAA8B,IAFjC,iBAIA,gCACGE,EADH,sBAEoC,IAAjCA,GAAsC,IAFzC,8CC9ICW,OCIA,SAASA,yBAAT,GAKX,IAJF/B,EAIC,EAJDA,gBACAC,EAGC,EAHDA,kBACAnL,EAEC,EAFDA,SACAvY,EACC,EADDA,QAQMylB,EAAsB3e,uBAC1B,SAAAiX,GACE0F,EAAgB1F,GAEhB/d,MAEF,CAACyjB,EAAiBzjB,IAWpB,OACE,cAAC,GAAD,CAAaA,QAASA,EAASuY,SAAUA,EAAzC,SACE,cAAC,GAAD,UACE,cAAC,GAAD,CACEkL,gBAAiBgC,EACjB/B,kBAAmBA,SC9Bd,SAASgC,UAGtB,OAFgBvlB,iBAAO+X,gBAERjX,Q,2ECXF0kB,OCWA,SAASA,eAAT,GAQX,IAPFllB,EAOC,EAPDA,UACAI,EAMC,EANDA,MACA+kB,EAKC,EALDA,YACA5lB,EAIC,EAJDA,QACAuY,EAGC,EAHDA,SAGC,IAFDqC,gBAEC,MAFU,kBAAM,MAEhB,EADE3a,EACF,kBACD,EAA8BqC,mBAAS,MAAvC,mBAAOujB,EAAP,KAAgBC,EAAhB,KACA,EAA0BxjB,mBAAS,IAAnC,mBAAO2P,EAAP,KAAc8T,EAAd,KAGMC,EAAelf,uBACnB,SAAAR,GACE,IAAM2L,EAAQ3L,EAAIC,OAAO0L,MACzB8T,EAAS9T,GACT2I,EAAS3I,KAEX,CAAC2I,IAIGqL,EAAcnf,uBAAY,WAC9B9G,EAAQiS,KACP,CAACjS,EAASiS,IAEPiU,EAAeD,EAGrBtM,kBAAkBkM,EAAS,CACzBrM,QAASyM,IAIX,IAAME,EAAYT,UAElB,OACE,cAAC,GAAD,2BACMzlB,GADN,IAEEQ,UAAWA,EACXI,MAAOA,EACP0X,SAAUA,EACVvY,QAASimB,EALX,SAOE,cAAC,GAAD,UACE,cAAC7K,GAAA,EAAD,UACE,sBAAKpY,MAAO,CAAEuX,UAAW,QAAzB,UACG1Z,GAAS,uBAAOulB,QAASD,EAAhB,SAA4BtlB,IAEtC,eAAC4C,IAAD,WACE,cAACE,OAAD,UACE,uBACEnD,IAAKslB,EACLtW,GAAI2W,EACJ5kB,KAAK,OACLqZ,SAAUoL,EACVJ,YAAaA,EACb5iB,MAAO,CACLqjB,qBAAsB,EACtBC,wBAAyB,OAI/B,cAAC3iB,OAAD,CAAQX,MAAO,CAAEmO,SAAU,KAA3B,SACE,wBACEnO,MAAO,CACLujB,oBAAqB,EACrBC,uBAAwB,EAGxBvW,gBAAiB,WAEnBrP,UAAWhC,QAAQqT,GACnBvQ,QAASwkB,EATX,oC,yCCjEKO,G,0FACnB,gCAAsB,IAAD,qEAANnX,EAAM,yBAANA,EAAM,uBACnB,+BAASA,KAEJiG,SAAS,0BAEd,EAAKmR,gBAAkB,EAAKrH,gBAAgBvH,IALzB,E,wGASrB,iBAAcvY,GAAd,qBAAAf,EAAA,wFAEU,IAAImoB,SAAQ,SAACC,EAASC,GAC1B,EAAKH,gBAAgB1O,WAAU,gBAAGhY,EAAH,EAAGA,QAASuY,EAAZ,EAAYA,SAAatY,EAAzB,yBAC7B,cAAC,GAAD,aACEV,KAAMA,EACNS,QAAS,mBACP4mB,IAEA5mB,KAEFuY,SAAU,oBACRsO,IAEAtO,MAEEtY,UAhBd,iCAqBW,GArBX,uCAuBI6mB,kBAAQ,EAAD,IAvBX,mBAyBW,GAzBX,+D,yJAoCA,2CAAAtoB,EAAA,gFAC0B,IAAImoB,SAAQ,SAAAC,GAAO,OACzC,EAAKF,gBAAgB1O,WAAU,gBAAM/X,EAAN,2BAC7B,cAAC,GAAD,aAA0BwjB,gBAAiBmD,GAAa3mB,UAH9D,cACQ8mB,EADR,yBAOSA,GAPT,kD,mKAYA,8CAAAvoB,EAAA,uEAA2BqC,EAA3B,EAA2BA,MAA3B,SACsB,IAAI8lB,SAAQ,SAAAC,GAAO,OACrC,EAAKF,gBAAgB1O,WAAU,gBAAGhY,EAAH,EAAGA,QAAYC,EAAf,yBAC7B,cAAC,GAAD,aACEY,MAAOA,EAEPb,QAAS,iBAAAT,GACPS,IAEA4mB,EAAQrnB,KAENU,UAXZ,cACQgS,EADR,yBAgBSA,GAhBT,kD,kGA1DgD2G,MCXnCoO,OCgBA,SAASA,iBACtB,MACE9hB,gBADMC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,oBAAqBC,EAAzC,EAAyCA,oBAGhB4hB,EAAyB5H,aAChDoH,IACA,GAFM5C,gBAKAvR,EAA2BvN,oBAA3BuN,uBACR,EAKI3K,6BAJFuf,EADF,EACEA,iBACAC,EAFF,EAEEA,wBACAvc,EAHF,EAGEA,YACAwc,EAJF,EAIEA,wBAGIhR,EAAcC,eAIpBjW,qBAAU,WACR,GAAIkS,EAGF,OAFAA,EAAuB/I,GAAG8D,cAAa+I,GAEhC,WACL9D,EAAuB3I,IAAI0D,cAAa+I,MAG3C,CAAC9D,EAAwB8D,IAE5B,IAAMiR,EAAuBjhB,mBAC3B,kBACE8gB,EAAiB7S,KAAI,SAAAiT,GAAG,MAAK,CAC3B/lB,KAAM,WACNV,MAAOymB,EAAIta,WACXpL,QAASwlB,EACN/S,KAAI,SAAAuD,GAAI,OAAIA,EAAK2P,WACjBxY,SAASuY,EAAIC,SAChB5lB,MAAO,wBAAMwlB,EAAwBG,UAEzC,CAACJ,EAAkBE,EAAyBD,IAGxCK,EAAqBphB,mBAAQ,WACjC,IAAMqhB,EAAaP,EAChBlR,QAAO,SAAA0R,GAAY,OAAIA,EAAaC,iBACpCtT,KAAI,SAAAiT,GAAG,MAAK,CAEXzmB,MAAOymB,EAAIta,WACXrL,MAAO,wBAAMwlB,EAAwBG,QAGzC,OAAIG,EAAWhmB,OACP,CACJ,CAEEF,KAAM,YACNV,MAAO,wBAJX,oBAMK4mB,IAGE,KAER,CAACP,EAAkBC,IAEhBS,EAAmBhd,EAAYnJ,OAAS,EAGxComB,EAAyB,CAC7BhnB,MAAO,UACPQ,QAAQ,CACN,CACER,MAAO,eACPQ,QAASgmB,IAHN,oBAOFG,GAPE,CAQL,CAEEjmB,KAAM,YACNV,MAAO,kBAET,CACEA,MAAO,cACPQ,QAAS,CACP,CACER,MAAO,mBACPc,MAAO,wBAAM0D,EAAoBa,MACjC3E,KAAM,WACNK,QAASuD,IAAee,KAE1B,CACErF,MAAO,kBACPc,MAAO,wBAAM0D,EAAoByG,MACjCvK,KAAM,WACNK,QAASuD,IAAe2G,KAE1B,CACEjL,MAAO,cACPc,MAAO,wBAAM0D,EAAoByiB,MACjCvmB,KAAM,WACNK,QAASwD,MAhCV,aAqCCD,IAAee,IACV,CACL,CACErF,MAAO,kBACPc,MAAO,wBACLiJ,EAAYsM,SAAQ,SAAA6Q,GAClB,IAAM/f,EAAmB+f,EAAQC,sBAE7BhgB,GACFA,EAAiBigB,cAGvBrnB,UAAWgnB,GAEb,CACE/mB,MAAO,iBACPc,MAAO,wBACLiJ,EAAYsM,SAAQ,SAAA6Q,GAClB,IAAM/f,EAAmB+f,EAAQC,sBAE7BhgB,GACFA,EAAiBkgB,aAGvBtnB,UAAWgnB,IAIR,IAjEN,CAoEL,CAEErmB,KAAM,YACNV,MAAO,sBAET,CACEA,MAAO,iBACPc,MAAM,WAAD,8BAAE,6BAAAnD,EAAA,+EAEEyoB,EAAqBkB,QAC1B,oCAHG,4CAICC,IAAYC,SAJb,iDAAF,wDAAC,IAOR,CACExnB,MAAO,eACPc,MAAM,WAAD,8BAAE,8BAAAnD,EAAA,gFAEEyoB,EAAqBkB,QAC1B,+CAHG,4CAICC,IAAY1a,UAJb,kDAAF,wDAAC,OAUN4a,EAAiB,OAAGhW,QAAH,IAAGA,OAAH,EAAGA,EAAwBtF,WAE5Cub,EAA4BniB,mBAAQ,WACxC,GAAIkM,EACF,MAAO,CACLzR,MAAOynB,EACPjnB,QAAS,CACP,CAEER,MAAO,OACPc,MAAO,wBAAM2Q,EAAuB5E,gBAK3C,CAAC4E,EAAwBgW,IAEtBE,EAAgC,WACpC,GAAIrjB,IAAee,KAAoBoM,EACrC,MAAO,CACLzR,MAAO,SACPQ,QAAS,CACP,CACER,MAAO,WACPc,MAAO,wBAAM2Q,EAAuB9E,YACpC5M,SAAU0R,EAAuBjJ,kBAEnC,CACExI,MAAO,WACPc,MAAO,wBAAM2Q,EAAuBvG,YACpCnL,SAAU0R,EAAuB/E,kBAEnC,CACE1M,MAAO,UACPc,MAAO,wBAAM2Q,EAAuBtG,WACpCpL,UACG0R,EAAuB/E,mBACvB+E,EAAuBjJ,kBAE5B,CACExI,MAAO,UACPc,MAAO,wBAAM2Q,EAAuB2V,YAEtC,CACEpnB,MAAO,SACPc,MAAO,wBAAM2Q,EAAuB4V,aA5BR,GAmCtC,OACE,cAAC,GAAD,CACE7Q,eAAgB,CACdwQ,EACAU,EACAC,MC/OOC,OCgBA,SAASA,SAWtB,OACE,cAAChlB,IAAD,UACE,cAACE,OAAD,CAAQX,MAAO,CAAEiG,MAAO,QAAxB,SACE,cAAC,GAAD,S,qBC1BO,SAASyf,SAAT,GAKX,IAJFC,EAIC,EAJDA,gBACAC,EAGC,EAHDA,qBACAlnB,EAEC,EAFDA,QACAmnB,EACC,EADDA,OAEA,EAAqCvmB,mBAAS,MAA9C,mBAAOwmB,EAAP,KAAmBC,EAAnB,KAgBA,OAbA3oB,qBAAU,WACR,GAAIyoB,GAAUC,GAAcF,EAAsB,CAChD,IAAMxe,EAAa0e,EAAW1e,WACxBE,EAAYwe,EAAWxe,UAE7Bue,EAAOG,SAAS,CACdC,IAAK3e,EACL4e,KAAM9e,EACN+e,SAAU,cAGb,CAACN,EAAQC,EAAYF,IAGtB,wBACEpoB,IAAKuoB,EACLtoB,UAAWC,IACTmC,KAAO,aACP+lB,GAAwB/lB,KAAM,QAEhCnB,QAASA,EANX,SAQGinB,EAAgB3b,a,cCnCRoc,OCWA,SAASA,OACtB,MAA6B9mB,mBAAS,MAAtC,mBAAOumB,EAAP,KAAeQ,EAAf,KACA,EAAiD/mB,mBAAS,MAA1D,mBAAOgnB,EAAP,KAAyBC,EAAzB,KAKMC,EAAcC,aAAqBH,GAOnCI,EAAmB5iB,uBACvB,SAAAR,GAIEuiB,EAAOc,OAAO,CACZV,IAAK,EAELC,KAAML,EAAOe,WAAatjB,EAAIujB,WAQlC,CAAChB,IAGKvW,EAA2BvN,oBAA3BuN,uBACR,EACE3K,6BADMuf,EAAR,EAAQA,iBAAkBE,EAA1B,EAA0BA,wBAAyBD,EAAnD,EAAmDA,wBAK7C2C,EAAoB1jB,mBACxB,+BAEK,IAAIuR,IAAJ,uBACEuP,EAAiBlR,QAAO,SAAA0R,GAAY,OACrCA,EAAaqC,wBAFd,aAIE3C,QAGP,CAACF,EAAkBE,IAKf4C,EAAqB5jB,mBACzB,yBAAMkM,QAAN,IAAMA,OAAN,EAAMA,EAAwB2X,uBAC9B,CAAC3X,IAGH,OACE,qBACE9R,IAAK6oB,EACL5oB,UAAWC,IACTmC,KAAM,KACNA,KAAO,0BACP2mB,GAAe3mB,KAAM,WAEvBqnB,QAASR,EAPX,SAkBE,qBACElpB,IAAK+oB,EACL9oB,UAAWC,IAAW,eAAgBmC,KAAO,oBAF/C,SAaGinB,EAAkBzV,KAAI,SAAAqT,GAAY,OACjC,cAACgB,SAAD,CAEEC,gBAAiBjB,EACjBkB,qBAAsBlB,IAAiBsC,EACvCtoB,QAAS,0BAAMylB,EAAwBO,IACvCmB,OAAQA,GAJHnB,EAAajY,mBCxGfpN,G,OAAf,E,2DCQKhC,OAAO8pB,gBACVC,qBCTaC,ODwBA,SAASA,WAAT,GAAuD,IAAjCjpB,EAAgC,EAAhCA,SAAUX,EAAsB,EAAtBA,UAAcR,EAAQ,kBACnE,EAAsCqC,mBAAS,MAA/C,mBAAOgoB,EAAP,KAAoBC,EAApB,KACA,EAAsCjoB,mBAAS,MAA/C,mBAAOkoB,EAAP,KAAoBC,EAApB,KAGMxS,EAAO7R,kBAAQ8R,KAAQ,IA2D7B,OAxDA9X,qBAAU,WACR,GAAIkqB,GAAeE,EAAa,CAC9B,IAAIE,EAAgB,CAClBzhB,MAAO,EACPhG,OAAQ,GAEN0nB,EAAgB,CAClB1hB,MAAO,EACPhG,OAAQ,GAKVunB,EAAYxnB,MAAM4nB,WAAa,SAE/B,IAAMC,EAAK,IAAIV,gBAAe,SAAAW,GAC5BpN,MAA+B,WAAO,IAAD,gBACfoN,GADe,IACnC,2BAA6B,CAAC,IAAnBC,EAAkB,QACrBC,EAAO,CACX/hB,MAAO8hB,EAAMxkB,OAAO8D,YACpBpH,OAAQ8nB,EAAMxkB,OAAOgE,cAGnBwgB,EAAMxkB,SAAW+jB,EACnBI,EAAgBM,EAEhBL,EAAgBK,GAVe,8BAenC,IAAMC,EAAYP,EAAczhB,MAAQ0hB,EAAc1hB,MAChDiiB,EAAYR,EAAcznB,OAAS0nB,EAAc1nB,OAEjDkoB,EAAQ1gB,KAAK2gB,IAAIH,EAAWC,GAElCV,EAAYxnB,MAAMqoB,UAAlB,gBAAuCF,EAAvC,aAAiDA,EAAjD,KAEqC,WAAjCX,EAAYxnB,MAAM4nB,YACpBnS,YAAW,WACT+R,EAAYxnB,MAAM4nB,WAAa,YAC9B,KAEJ3S,MAML,OAHA4S,EAAGS,QAAQhB,GACXO,EAAGS,QAAQd,GAEJ,SAAS9gB,UACdmhB,EAAGU,UAAUjB,GACbO,EAAGU,UAAUf,OAGhB,CAACF,EAAaE,EAAavS,IAG5B,+CACMhY,GADN,IAEEO,IAAK+pB,EACL9pB,UAAWC,IAAWmC,KAAO,eAAgBpC,GAH/C,SAKE,qBAAKD,IAAKiqB,EAAgBhqB,UAAWoC,KAAO,gBAA5C,SACGzB,Q,yDE9FM8X,GCGK,SAAdA,YAAe,GAAiC,IAA/BzY,EAA8B,EAA9BA,UAAc0Y,EAAgB,kBACnD,OACE,6CACMA,GADN,IAEE1Y,UAAS,gDAA2CA,EAAS,WAAOA,GAAc,Q,4FCRzE+qB,OCgBA,SAASA,aAAT,GAUX,IATF1oB,EASC,EATDA,KACA2oB,EAQC,EARDA,MACA9lB,EAOC,EAPDA,MACAsS,EAMC,EANDA,KACAjY,EAKC,EALDA,QACA0B,EAIC,EAJDA,QAIC,IAFDgqB,qBAEC,MAFe,IAEf,EADEzrB,EACF,kBAED,EAAkCqC,oBAAS,GAA3C,mBAAOqpB,EAAP,KAAkBC,EAAlB,KAIMC,EAAa1rB,iBAAOH,GACpBimB,EAAcnf,uBAClB,SAAAR,GACMA,GACFA,EAAIwlB,kBAGNF,GAAa,GAIbnT,YACE,WACEoT,EAAW5qB,QAAQgX,KAGrB,OAGJ,CAACA,IAGH,EAAoB3V,mBAAS,MAA7B,mBAAO6H,EAAP,KAAW2O,EAAX,KAGA1Y,qBAAU,WACR,GAAI+J,EAAI,CACN,IAAI4hB,EAAmB,KAEjBC,EAAe,SAAfA,eACJD,EAAmBtT,WAAWwN,EAAayF,IAG7CM,IAEA,IAAMC,EAAc,SAAdA,cACJ5T,aAAa0T,IAOf,OAJA5hB,EAAG7J,iBAAiB,YAAa2rB,EAAa,CAAE9X,SAAS,IACzDhK,EAAG7J,iBAAiB,WAAY0rB,EAAc,CAAE7X,SAAS,IACzDhK,EAAG7J,iBAAiB,aAAc2rB,EAAa,CAAE9X,SAAS,IAEnD,SAASzK,UACdS,EAAG5J,oBAAoB,YAAa0rB,EAAa,CAAE9X,SAAS,IAC5DhK,EAAG5J,oBAAoB,WAAYyrB,EAAc,CAAE7X,SAAS,IAC5DhK,EAAG5J,oBAAoB,aAAc0rB,EAAa,CAAE9X,SAAS,IAE7D8X,QAGH,CAAC9hB,EAAIuhB,EAAezF,IAGvB,IAAMiG,EAAQ9lB,mBACZ,kBAAM,WACJ,cAAeqlB,GACb,IAAK,SACH,OACE,qBAAKU,IAAKxmB,EAAOymB,IAAKX,EAAOhrB,UAAWoC,KAAO,gBAGnD,IAAK,WACH,OAAO4oB,IAET,QACE,OAAOA,GAAS,cAACY,GAAD,QAGtB,CAACZ,EAAO9lB,IAOJ2mB,EAAgBlmB,mBACpB,kBACE,gBAAMnG,EAAN,0BACqB,oBAAZyB,EACL,cAAC,GAAD,2BACMzB,GADN,IAEEyB,QAASA,EACTjB,UAAWoC,KAAM,UAGnB,cAAC,IAAMgN,SAAP,eAAoB5P,OAE1B,CAACyB,IAGH,OACE,6CACElB,IAAKsY,EACLyT,WAAYtG,EACZuG,UAAWvG,EACXxlB,UAAWoC,KAAM,cACb5C,GALN,aAOE,cAACwsB,GAAA,EAAD,CACEhhB,cAAgBkgB,EAA6B,gBAAjB,eAC5BjgB,kBAAkB,MAFpB,SAIE,sBAAKjL,UAAWoC,KAAO,mBAAvB,UACE,cAACypB,EAAD,UACE,eAAC,GAAD,WACE,qBAAK7rB,UAAWoC,KAAO,mBAAvB,SACE,cAACqpB,EAAD,MAEF,qBAAKzrB,UAAWoC,KAAM,MAAtB,SAAkC8C,IAElC,qBAAKlF,UAAWoC,KAAM,KAAtB,SAAiCC,SAGrC,cAAC,GAAD,CAAmBpB,QAASukB,EAAaxlB,UAAWoC,KAAM,MAA1D,SACE,cAAC,GAAD,UACE,cAAC2X,GAAD,iBCpJCkS,OCSA,SAASA,kBAAT,GAGX,IAAD,IAFDC,qBAEC,MAFe,GAEf,EADDC,EACC,EADDA,oBAEA,OACE,qBAAKnsB,UAAWoC,KAAO,sBAAvB,SAKE,qBAAKpC,UAAWoC,KAAO,cAAvB,SAII8pB,EAActY,KAAI,YAA4C,IAAzCvR,EAAwC,EAAxCA,KAAM2oB,EAAkC,EAAlCA,MAAO/pB,EAA2B,EAA3BA,QAASiE,EAAkB,EAAlBA,MAAOsS,EAAW,EAAXA,KAChD,OACE,8BACE,cAAC,GAAD,CACEnV,KAAMA,EACN2oB,MAAOA,EACP/pB,QAASA,EACTiE,MAAOA,EACPsS,KAAMA,EACNjY,QAAS,0BAAM4sB,EAAoB3U,OAP7BA,W,UCrBX4U,GAAsBvb,IAAMK,cAAc,ICFxCmb,ODMA,SAASA,qBAAT,GAA6C,IAAb1rB,EAAY,EAAZA,SAC7C,EAA0Cie,aACxC0N,MADMlJ,EAAR,EAAQA,gBAAiBmJ,EAAzB,EAAyBA,aAKnBC,EAAmBnmB,uBACvB,SAAAomB,GAAY,OAAIrJ,EAAgBoJ,iBAAiBC,KACjD,CAACrJ,IAIGsJ,EAA4BrmB,uBAChC,SAAAmR,GAAI,OAAI4L,EAAgBsJ,0BAA0BlV,KAClD,CAAC4L,IAGH,OACE,eAACgJ,GAAoB7a,SAArB,CACEC,MAAO,CACLgb,oBAFJ,UAKG7rB,EAED,cAAC,GAAD,CACEurB,cAAeK,EAAaL,cAC5BC,oBAAqBO,Q,sBEnCdC,OCIA,SAASA,MAAT,GAAkD,IAA3BC,EAA0B,EAAhC3Y,KAAY1U,EAAoB,EAApBA,QAAYC,EAAQ,kBAC9D,OACE,cAACgW,EAAA,EAAD,UACE,cAACoX,EAAD,2BAAUptB,GAAV,IAAgBD,QAASA,Q,6BCPhBstB,OCIA,SAASA,WAAT,GAAsC,IAAD,IAAfvV,cAAe,MAAN,GAAM,EAClD,OACE,mCACGA,EAAO1D,KAAI,YAAuC,IAApCK,EAAmC,EAAnCA,KAAMuD,EAA6B,EAA7BA,KAAMjY,EAAuB,EAAvBA,QAAYC,EAAW,kBAChD,OACE,8BACE,cAAC,GAAD,2BAAWA,GAAX,IAAiByU,KAAMA,EAAMuD,KAAMA,EAAMjY,QAASA,MAD1CiY,SCLPsV,GAAejc,IAAMK,cAAc,ICJjC6b,ODOA,SAASA,cAAT,GAAsC,IAAbpsB,EAAY,EAAZA,SACtC,EAA0Cie,aAAgBvH,IAAlD+L,EAAR,EAAQA,gBAAiBmJ,EAAzB,EAAyBA,aAGnBhV,EAAYlR,uBAChB,SAAA2mB,GAAK,OAAI5J,EAAgB7L,UAAUyV,KACnC,CAAC5J,IAGH,OACE,eAAC0J,GAAavb,SAAd,CACEC,MAAO,CACL+F,aAFJ,UAKG5W,EAED,cAAC,GAAD,CAAY2W,OAAQiV,EAAajV,aExBxB2V,OCsBA,SAASA,QAAT,GAA6D,IAAD,IAAzCC,sBAAyC,MAAxB,KAAwB,EAAlB3W,EAAkB,EAAlBA,eACvD,OACE,cAAC,GAAD,UAKE,cAAC,GAAD,UACE,eAAC,GAAD,WACE,cAACf,EAAA,EAAD,CAEEjT,MAAO,CACLiN,gBAAiB,WAHrB,SASG0d,IAEH,cAAC1X,EAAA,EAAD,UACE,eAAC,EAAD,WACE,cAAC5S,OAAD,CACEL,MAAO,CAEL4qB,WAAY,SACZ3d,gBAAiB,kBAJrB,SAOE,cAAC,GAAD,MAEF,eAAC,gBAAD,WAQE,qBACEjN,MAAO,CACLmO,SAAU,MACV+E,SAAU,WACV2X,OAAQ,GACRC,MAAO,GACPpP,MAAO,uBACPF,SAAU,OAKVuP,cAAe,OAGf9hB,OAAQ,YAfZ,SAkBE,cAAC,GAAD,CAAYjJ,MAAO,CAAE4qB,WAAY,UAAjC,SACE,sBAAK5qB,MAAO,CAAEuX,UAAW,OAAQiE,SAAU,QAA3C,UAIE,2CAAc4J,IAAY4F,uBAC1B,+CACevuB,IAAYwuB,2BAW3B,wCAAWC,uBAIjB,cAAC,GAAD,CAAelX,eAAgBA,EAA/B,SACE,cAAC,GAAD,sB,2DCtGHmX,OCOA,SAASA,YAAT,GAAiE,IAA1C/sB,EAAyC,EAAzCA,SAAUX,EAA+B,EAA/BA,UAAWiB,EAAoB,EAApBA,QAAYzB,EAAQ,kBAC7E,OACE,cAAC,GAAD,2BACMA,GADN,IAIEQ,UAAWC,IAAW,OAAQmC,KAAO,gBAAiBpC,GACtDiB,QAASA,EALX,SAOGN,M,kCChBQgtB,OCYA,SAASA,IAAT,GAAyC,IAAD,IAAzB1P,aAAyB,MAAjB,KAAiB,EAARze,EAAQ,kBACrD,OACE,+CAASA,GAAT,IAAeQ,UAAWC,IAAWmC,KAAM,IAASA,KAAO6b,QCRhD,SAAS2P,oBAAT,GAGX,IAAD,IAFDC,mBAEC,MAFa,GAEb,EADDC,EACC,EADDA,mBAEA,EACE5mB,6BADMuf,EAAR,EAAQA,iBAAkBtc,EAA1B,EAA0BA,YAAauc,EAAvC,EAAuCA,wBAGjCqH,EAA0BpoB,mBAC9B,kBAAMwE,EAAYyJ,KAAI,SAAA0T,GAAO,OAAIA,EAAQ0G,uBACzC,CAAC7jB,IAKG8jB,EAAwBtoB,mBAC5B,kBACE8gB,EAAiBlR,QAAO,SAAA0R,GAAY,OACjC9oB,QAAQ0vB,IAEL5G,EACG1a,WACA2hB,cACA5f,SAASuf,EAAYK,oBAEhC,CAACzH,EAAkBoH,IAGrB,OAAe,OAAXA,QAAW,IAAXA,OAAA,EAAAA,EAAa7sB,UAAWitB,EAAsBjtB,OAE9C,eAAC2Z,GAAA,EAAD,WACE,cAAC,GAAD,CAASpY,MAAO,CAAEsY,WAAY,QAA9B,+CAGA,cAAC,GAAD,UACE,wBAAQ5Z,QAAS6sB,EAAjB,qCAON,cAACnT,GAAA,EAAD,CAAQC,aAAa,EAArB,SACE,cAAC,GAAD,UACGqT,EAAsBra,KAAI,SAAAqT,GAEzB,IAAMkH,EAAiBJ,EAAwBxY,QAC7C,SAAA2L,GAAS,OAAIA,IAAc+F,KAC3BjmB,OAEF,OACE,yBAGEuB,MAAO,CACLiG,MAAO,IACPhG,OAAQ,IAORgN,gBAAiB,cACjB4e,YAAaD,EAAiB,EAAI,QAAU,IAE9CltB,QAAS,0BAAMylB,EAAwBO,IAfzC,UAiBGA,EAAa1a,WAMd,qBAAKhK,MAAO,CAAEkT,SAAU,WAAY2X,OAAQ,EAAGC,MAAO,GAAtD,SACG,aAAI,IAAI9R,MAAM4S,IAAiBva,KAAI,SAACya,EAASpX,GAG5C,OAFAoP,kBAAQgI,GAGN,cAAC,GAAD,CAEEpQ,MAAOkQ,EAAiB,EAAI,QAAU,OAEtC5rB,MAAO,CAAE+rB,OAAQ,YAHZrX,UA5BRgQ,EAAajY,kBCvDjB,SAASuf,iBACtB,OACE,cAAC5T,GAAA,EAAD,CAAQC,aAAa,EAArB,SACG7T,OAAOsjB,QAAQ1C,IAAY6G,cAAc5a,KAAI,gBAAE6a,EAAF,2BAC5C,wBAEExtB,QAAS,0BAEPrB,OAAO8nB,QACL,wGACGC,IAAY+G,eAAeD,IANpC,SASGA,GARIA,QCGf,IAAME,GAAc5nB,OAAOC,KAAK2gB,IAAY6G,cAAcxtB,OAI7C4tB,GAAkB,eCdhBC,GDgBS,CACtB9f,GAAI6f,GACJ1pB,MAAO,eACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV8R,aAAa,EACbD,gBAAgB,EAChBjD,mBAAoB,CAClByc,YAdyB,IA2C3BvoB,aAAc,SAASD,aAAT,GAAwD,IAAhCgM,EAA+B,EAA/BA,YAAaC,EAAkB,EAAlBA,eACjD,EAAgCzP,mBAAS,MAAzC,mBAAOitB,EAAP,KAAiBC,EAAjB,KAGA7V,kBAAkB4V,EAAU,CAC1B9V,SAAU,2BAAM1H,EAAe,CAAEuc,YAAa,QAGhD,IAAMmB,EAAuB3oB,uBAC3B,SAAAR,GAAG,OAAIyL,EAAe,CAAEuc,YAAahoB,EAAIC,OAAO0L,UAChD,CAACF,IAGG2d,EAAoB5oB,uBACxB,SAAAR,GAEM1H,QAAQkT,EAAYwc,cACtBhoB,EAAIwlB,oBAGR,CAACha,IAGH,OACE,cAAC,GAAD,UAgBE,uBACEtR,IAAKgvB,EACL5J,YAAY,sBACZhL,SAAU6U,EACVxd,MAAOH,EAAYwc,YACnBtrB,MAAO,CAAEiG,MAAO,QAChB5C,cAAeqpB,OAKvBhb,KAAM,SAAS2Y,KAAT,GAAkE,IAAlDrlB,EAAiD,EAAjDA,iBAAkB8J,EAA+B,EAA/BA,YAAaC,EAAkB,EAAlBA,eACnD,EAAsDzP,oBAAS,GAA/D,mBAAOqtB,EAAP,KAA4BC,EAA5B,KAGAxvB,qBAAU,WACR4H,EAAiBuN,SAEdoa,EAAuC,UAAjB,kBAExB,CAAC3nB,EAAkB2nB,IAEtB,IAAMrB,EAAW,OAAGxc,QAAH,IAAGA,OAAH,EAAGA,EAAawc,YAE3BuB,EAAyB/oB,uBAC7B,kBAAMiL,EAAe,CAAEuc,YA5GA,OA6GvB,CAACvc,IAGH,OACE,eAAC,EAAD,WACE,cAAC,gBAAD,UACI4d,EAMA,cAACX,eAAD,IALA,cAACX,oBAAD,CACEC,YAAaA,EACbC,mBAAoBsB,MAMzBjxB,QAAQwwB,GAAc,IACrB,cAAC5rB,OAAD,UACE,eAAC,GAAD,WACE,wBAAQ9B,QAAS,0BAAMkuB,GAAuB,SAAAja,GAAI,OAAKA,MAAvD,SACIga,EAAkC,eAAZ,YAChB,IACV,sBAAMlvB,UAAU,OAAhB,SACIkvB,EASA,iDACY,IACV,cAAC,GAAD,CAAajuB,QAAS,0BAAMkuB,GAAuB,IAAnD,8BAFF,OARA,8EACyC,IACvC,cAAC,GAAD,CAAaluB,QAAS,0BAAMkuB,GAAuB,IAAnD,4BAFF,mBE3IHE,GALc,2BACxBR,IADwB,IAE3Bva,aAAa,I,iDCFAgb,OCQA,SAASA,YAAT,GAAwD,IAAjCtvB,EAAgC,EAAhCA,UAAWW,EAAqB,EAArBA,SAAanB,EAAQ,kBACpE,OACE,+CAAOQ,UAAWC,IAAWmC,KAAM,OAAYpC,IAAgBR,GAA/D,aACGmB,M,0BCXQ4uB,OCQA,SAASA,MAAT,GAAgD,IAiCnCC,EAjCIC,EAA8B,EAA9BA,OAAsBjwB,GAAQ,EAAtBQ,UAAsB,mBAC5D,EAA+B6B,mBAAS4tB,KAAxC,mBAAOC,EAAP,KAAgBC,EAAhB,KAEMC,EAAavpB,uBAAY,WAG7B,OAFgBopB,MAGf,CAACA,IAgBJ,OAdA9vB,qBAAU,WACR,IAAMkwB,EAAe,SAAfA,eAAe,OAAMF,EAAYC,MAGvCC,IAGA,IAAMC,EAAiBlwB,OAAOmwB,YAAYF,EAAc,KAExD,OAAO,SAAS5mB,UACdrJ,OAAOowB,cAAcF,MAEtB,CAACF,IAEG,cAAC,EAAD,2BAAYpwB,GAAZ,cAUmBgwB,EAVmBE,EAYtC,IAAIO,KAAMT,EAAI,MAAqB,KAAMU,cAAcC,OAAO,GAAI,QCrC5D,SAASC,mBAAT,GAA6C,IAAfvc,EAAc,EAAdA,WACnChC,EAA2BvN,oBAA3BuN,uBAEFtK,EAAmBsM,EAAW0T,sBAE9B8I,GACH9oB,GAAoBA,IAAqBsK,EAE5C,EAA8ChQ,mBAAS,MAAvD,mBAAOyuB,EAAP,KAAwBC,EAAxB,KACA,EACE1uB,mBAAS,MADX,mBAAO2uB,EAAP,KAAiCC,EAAjC,KAEA,EAA4D5uB,mBAAS,MAArE,mBAAO6uB,EAAP,KAA+BC,EAA/B,KACA,EAAsD9uB,mBAAS,MAA/D,mBAAO+uB,EAAP,KAA4BC,EAA5B,KACA,EAAwDhvB,mBAAS,MAAjE,mBAAOivB,EAAP,KAA6BC,EAA7B,KACA,EAA4DlvB,mBAAS,MAArE,mBAAOmvB,EAAP,KAA+BC,EAA/B,KAoDA,OAlDAtxB,qBAAU,WACR,GAAI4H,GAAoB+oB,EAAiB,CAEvC,IAAMY,EAAsB,SAAtBA,oBAAsBC,GAK1B,kBAQIA,EARJ,GACEpiB,EADF,KAEEqiB,EAFF,KAGEC,EAHF,KAIEC,EAJF,KAKEC,EALF,KAMEC,EANF,KAOEC,EAPF,KAYApL,kBAAQtX,GAGRuhB,EAAgBoB,UAAYN,EAC5BZ,EAAyBkB,UACvBC,WAAWN,GAAgBO,QAAQ,GACrClB,EAAuBgB,UAAYC,WAAWL,GAAcM,QAAQ,GACpEhB,EAAoBc,UAAYC,WAAWJ,EAAY,KAAMK,QAAQ,GACrEd,EAAqBY,UAAYC,WAAWH,EAAa,KAAMI,QAC7D,GAEFZ,EAAuBU,UAAY3qB,OAAOgP,OAAO0b,GAAczwB,QAKjE,OAFAuG,EAAiBuB,GAAG+oB,IAAqBX,GAElC,SAASjoB,UACd1B,EAAiB2B,IAAI2oB,IAAqBX,OAG7C,CACD3pB,EACA+oB,EACAE,EACAE,EACAE,EACAE,EACAE,IAIA,qCACE,qBAA+BzuB,MAAO,CAAEuX,UAAW,UAAnD,UACE,6BAAKjG,EAAWtH,YAAc,eAC9B,oBAAIhK,MAAO,CAAEiN,gBAAiB,UAA9B,SACE,sBAAMzP,IAAKwwB,EAAX,mBAEF,oBAAIhuB,MAAO,CAAEiN,gBAAiB,UAA9B,SACE,sBAAMzP,IAAK0wB,EAAX,mBAEF,oBAAIluB,MAAO,CAAEiN,gBAAiB,UAA9B,SACE,sBAAMzP,IAAK4wB,EAAX,mBAEF,oBAAIpuB,MAAO,CAAEiN,gBAAiB,UAA9B,SACE,sBAAMzP,IAAK8wB,EAAX,mBAEF,oBAAItuB,MAAO,CAAEiN,gBAAiB,UAA9B,SACE,sBAAMzP,IAAKgxB,EAAX,mBAEF,oBAAIxuB,MAAO,CAAEiN,gBAAiB,UAA9B,SACE,sBAAMzP,IAAKkxB,EAAX,qBAlBKpd,EAAW7E,WAqBpB,qBAAIzM,MAAO,CAAEuX,UAAW,UAAxB,UACE,qBAAIvX,MAAO,CAAEuvB,UAAW,UAAxB,qBACU,cAAC,GAAD,CAAOrC,OAAQ,yBAAM5b,EAAWke,0BAE1C,qBAAIC,QAAQ,IAAZ,UACE,wBAEE/wB,QAAS,0BAAMyF,QAAQurB,IAAI,CAAEpe,gBAC7B1T,UAAQ,EAHV,qBAOA,uCACA,wBAEEc,QAAS,0BACPyF,QAAQurB,IAAI,CAAEC,YAAare,EAAWse,oBAExChyB,UAAQ,EALV,4BAUF,6BACE,cAAC,GAAD,CAAK8d,MAAOoS,EAA4B,QAAU,WAEpD,qBAAI2B,QAAQ,IAAZ,UACE,wBACE/wB,QAAS,0BAAMsG,EAAiB6qB,cAChC7vB,MAAO,CAAEiN,gBAAiB,QAC1BrP,SAAUkwB,EAHZ,0BAOA,uCACA,wBACEpvB,QAAS,mBACF4S,EAAW7G,mBACd6G,EAAW5G,WAGf1K,MAAO,CAAEiN,gBAAiB,OAN5B,yBAYJ,6BACE,oBAAIwiB,QAAQ,IAAIzvB,MAAO,CAAEiN,gBAAiB,OAAQhN,OAAQ,UC7InD,SAAS6vB,gBAAT,GAA2C,IAAhBloB,EAAe,EAAfA,YACxC,OACE,eAAC,GAAD,CAAa5H,MAAO,CAAEiG,MAAO,QAA7B,UACE,kCACE,+BACE,oBAAI8pB,QAAQ,IAAZ,kBACA,oBAAIN,QAAQ,IAAIzvB,MAAO,CAAEiN,gBAAiB,UAA1C,sBAGA,oBAAIwiB,QAAQ,SAEd,+BACE,oBAAIzvB,MAAO,CAAEiN,gBAAiB,UAA9B,mBACA,qBAAIjN,MAAO,CAAEiN,gBAAiB,UAA9B,mBAEE,uBAFF,cAKA,qBAAIjN,MAAO,CAAEiN,gBAAiB,UAA9B,iBAEE,uBAFF,cAKA,qBAAIjN,MAAO,CAAEiN,gBAAiB,UAA9B,kBAEE,uBAFF,UAKA,qBAAIjN,MAAO,CAAEiN,gBAAiB,UAA9B,mBAEE,uBAFF,UAKA,oBAAIjN,MAAO,CAAEiN,gBAAiB,UAA9B,gCAGJ,gCACGrF,EAAYyJ,KAAI,SAAA0T,GAAO,OACtB,cAAC8I,mBAAD,CAA4Cvc,WAAYyT,GAA/BA,EAAQtY,mB,iCCxC5BujB,OCgBA,SAASA,cAAT,GAKX,IAJFxjB,EAIC,EAJDA,GAIC,IAHDpO,gBAGC,MAHU,KAGV,MAFDuE,aAEC,MAFO,KAEP,EADE1F,EACF,kBACD,ECda,SAASgzB,uBAAuBC,GAC7C,MACEvrB,6BADMwrB,EAAR,EAAQA,8BAA+B9gB,EAAvC,EAAuCA,8BAYvC,MAAO,CACL1M,MAVYS,mBACZ,kBAAM+sB,EAA8BD,KACpC,CAACC,EAA+BD,IAShCE,KAPWtsB,uBACX,kBAAMuL,EAA8B6gB,KACpC,CAAC7gB,EAA+B6gB,KDISD,CAAuBzjB,GAAnD6jB,EAAf,EAAQ1tB,MAA0BytB,EAAlC,EAAkCA,KAI5BE,EAAaltB,mBACjB,kBAAM,SAAAyT,GAAK,OACTzY,EAAW,cAAC,GAAD,eAAuByY,IAAY,sCAAYA,OAC5D,CAACzY,IAKH,OAAKgyB,EAKH,cAACE,EAAD,2BAGMrzB,GAHN,IAIEyB,QAAS0xB,EAJX,SAMGhyB,GAAYuE,GAAS0tB,KAVjB,M,UEREhE,GAAkB,kBAwGhBkE,GAtGW,CACxB/jB,GAAI6f,GACJ1pB,MAAO,kBACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV4R,UAAU,EACVH,KAAM,SAAS2Y,OACb,IAAQmG,EAAaxuB,qBAAWyuB,MAAxBD,SAIR,OACE,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,cAAClwB,EAAA,EAAD,CAAMN,MAAO,CAAE0wB,UAAW,QAA1B,SACE,eAAC,GAAD,CAAa1wB,MAAO,CAAEiG,MAAO,QAA7B,UACE,gCACE,+BACE,6BACE,cAAC,GAAD,6BAEF,6BACE,cAAC,GAAD,uBAEF,6BACE,cAAC,GAAD,0BAgBN,gCACGuqB,EAASnf,KAAI,SAAAc,GAAO,OACnB,+BACE,6BACE,cAAC,GAAD,UAAUA,EAAQnI,YAAc,iBAElC,oBAAIvM,UAAU,SAAd,SACE,cAAC,GAAD,CAAOyvB,OAAQ,yBAAM/a,EAAQqd,yBAgB/B,oBAAI/xB,UAAU,SAAd,SAIE,cAAC,GAAD,UACE,wBAAQiB,QAAS,0BAAMyT,EAAQud,IAAIvd,EAAQrI,aAA3C,SACE,cAAC,EAAD,iCA3BCqI,EAAQ1F,uBAqC3B,eAACjM,OAAD,WACE,oBAAIR,MAAO,CAAE+rB,OAAQ,EAAG5e,QAAS,KACjC,cAAC,GAAD,UACE,eAAC7M,EAAA,EAAD,WACE,sBAAKN,MAAO,CAAEkT,SAAU,WAAY2X,OAAQ,EAAG3E,KAAM,GAArD,gCACsB,IACpB,cAAC,GAAD,CAAOgH,OAAQ,yBAAMzwB,IAAYk0B,kBAEnC,cAAC,GAAD,CACEnkB,GAAIokB,GACJ5wB,MAAO,CAAE2b,MAAO,QAASkV,cAAe,yBCzG3CxE,GAAkB,sBCdhByE,GDgBe,CAC5BtkB,GAAI6f,GACJ1pB,MAAO,sBACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV4R,UAAU,EACVH,KAAM,SAAS2Y,KAAT,GAAoC,EAApBrlB,iBAAqB,IACjC4C,EAAgBjD,6BAAhBiD,YACR,EAAwC7F,oBAAhCqK,EAAR,EAAQA,YAAa2kB,EAArB,EAAqBA,eAiBrB,OAfA3zB,qBAAU,WACR,GAAIgP,EACF,OAAO,kBAAM2kB,GAAe,MAE7B,CAAC3kB,EAAa2kB,IAWZ3kB,EA0CH,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,cAAC,GAAD,CAASpM,MAAO,CAAE0wB,UAAW,QAA7B,SACE,cAACZ,gBAAD,CAAiBloB,YAAaA,QAGlC,eAACpH,OAAD,CAAQR,MAAO,CAAEwb,SAAU,SAA3B,UACE,oBAAIxb,MAAO,CAAE+rB,OAAQ,EAAG5e,QAAS,KACjC,cAAC,GAAD,UACE,eAAC7M,EAAA,EAAD,WACE,sBAAKN,MAAO,CAAEkT,SAAU,WAAY2X,OAAQ,EAAG3E,KAAM,GAArD,gCACsB,IACpB,cAAC,GAAD,CAAOgH,OAAQ,yBAAMzwB,IAAYk0B,kBAEnC,cAAC,GAAD,CACEnkB,GAAIwkB,GACJhxB,MAAO,CAAE2b,MAAO,QAASkV,cAAe,uBAxDhD,cAACzY,GAAA,EAAD,UACE,gCACE,mBAAGpY,MAAO,CAAEsY,WAAY,QAAxB,oDAIA,qBACEtY,MAAO,CACLmO,SAAU,IACVoJ,UAAW,OACXY,QAAS,gBAJb,UAOE,mGAIA,kHAMF,eAAC,GAAD,WACE,wBACEzZ,QAAS,0BAAMqyB,GAAe,IAC9B/wB,MAAO,CAAEiN,gBAAiB,OAF5B,8BAMA,mBAAGxP,UAAU,OAAb,2E,uGE7ECwzB,OC+BA,SAASA,YAAT,GAAuD,IAAhCC,EAA+B,EAA/BA,QAASzzB,EAAsB,EAAtBA,UAAcR,EAAQ,kBACnE,EAAsCqC,oBAAS,WAC7C,IAAI6xB,EAAc,EAQlB,OANAD,EAAQhd,SAAQ,SAACkd,EAAQ1c,GACnB0c,EAAOC,aACTF,EAAczc,MAIXyc,KATT,mBAAOA,EAAP,KAAoBG,EAApB,KAaMC,EAAep0B,kBAAQ,GAG7B,QAFEo0B,EAAatzB,QAGb,6CAAKR,UAAWC,IAAW,eAAgBD,IAAgBR,GAA3D,aACGi0B,EAAQ7f,KACP,WAWEqD,GACI,IAVOnU,EAUR,EAVDixB,QACA9yB,EASC,EATDA,QACAd,EAQC,EARDA,SAEAoC,GAMC,EAPDqxB,WAOC,EANDrxB,OACAvC,EAKC,EALDA,UAKC,IAJDc,YAIC,MAJM,SAIN,EAHE+N,EAGF,kBAWH,OAR6B,IAAzBilB,EAAatzB,SAAiBkzB,IAAgBzc,GAGhDe,YAAW,WACT/W,OAKF,4DACM4N,GADN,IAEEmE,IAAKiE,EACLnW,KAAMA,EACNG,QAAS,mBACP4yB,EAAe5c,GAEfhW,KAEFd,SAAUA,EACVoC,MAAOA,EACPvC,UAAWC,IAAW,CACpByzB,IAAgBzc,GAAO,SACvBjX,MAKmB,kBAAZ8C,EACLA,EACqB,oBAAZA,EACT,cAACA,EAAD,IAEA,CAAEA,mB,mEClGLkxB,OCaA,SAASA,OAAT,GAMX,IALFh0B,EAKC,EALDA,UACAi0B,EAIC,EAJDA,KACA9zB,EAGC,EAHDA,SAGC,IAFDga,gBAEC,MAFU,kBAAM,MAEhB,EADE3a,EACF,kBACK00B,EAAQjP,UAEd,OACE,8CACEjlB,UAAWC,IACTmC,KAAO,kBACPjC,GAAYiC,KAAM,SAClBpC,IAEER,GANN,cAQE,uBACEsB,KAAK,WACLiO,GAAImlB,EACJl0B,UAAWoC,KAAM,SAEjBjB,QAAS8yB,EACT9Z,SAAU,kBAAAtU,GAAG,OAAIsU,EAAStU,EAAIC,OAAO3E,UACrChB,SAAUA,IAEZ,uBAAOwlB,QAASuO,EAAOl0B,UAAWoC,KAAM,c,mGCxC/B+xB,OCcA,SAASA,cAAT,GASX,IARFn0B,EAQC,EARDA,UAQC,IAPDo0B,gBAOC,MAPU,MAOV,MANDC,eAMC,MANS,KAMT,MALDC,mBAKC,MALa,GAKb,EAJDL,EAIC,EAJDA,KACA9zB,EAGC,EAHDA,SACAoC,EAEC,EAFDA,MACG/C,EACF,kBAGD,EAA0BmG,mBAAQ,WAChC,IAAM4uB,EAAcH,EAASpzB,OACvBwzB,EAAaH,EAAQrzB,OACrByzB,EACJF,IAAgBC,GAEZD,EAAcC,EADdD,EAGAC,EAIN,MAAO,CAHSC,EAAgBF,EACjBE,EAAgBD,KAG9B,CAACJ,EAAUC,IAbd,mBAAOK,EAAP,KAAgBC,EAAhB,KAeA,OACE,sBACE30B,UAAWC,IACTmC,KAAO,kBACPjC,GAAYiC,KAAM,SAClBpC,GAEFuC,MAAOA,EANT,UAQE,sBAAKvC,UAAWoC,KAAO,eAAvB,UACE,qBACEpC,UAAWC,IACTmC,KAAM,KACNA,KAAO,cACPA,KAAM,KACL6xB,EAAuC,MAA/B9zB,GAAYiC,KAAM,QAI7BG,MAAO,CAAEqyB,YAAY,GAAD,OAAKF,EAAU,EAAf,OATtB,SAWGN,IAEH,qBAAKp0B,UAAWoC,KAAM,KAAtB,SACE,cAAC,GAAD,aAAQ6xB,KAAMA,EAAM9zB,SAAUA,EAAUoC,MAAOA,GAAW/C,MAE5D,qBACEQ,UAAWC,IACTmC,KAAM,KACNA,KAAO,cACPA,KAAM,MACN6xB,GAAQ9zB,GAAYiC,KAAM,OAAa,MAIzCG,MAAO,CAAEsyB,aAAa,GAAD,OAAKF,EAAS,EAAd,OATvB,SAWGN,OAGL,qBAAKr0B,UAAWoC,KAAO,aAAvB,SAAsCkyB,Q,+BCjF7BQ,OCDA,SAASA,aAAT,GAKX,IAJFn0B,EAIC,EAJDA,SAIC,IAHDmF,cAGC,MAHQ,SAGR,MAFDivB,WAEC,MAFK,aAEL,EADEv1B,EACF,kBACD,OACE,6CAAOA,GAAP,IAAasG,OAAQA,EAAQivB,IAAKA,EAAlC,SACGp0B,M,qBCPQq0B,OCDA,SAASA,mBAAT,GAIX,IAHFC,EAGC,EAHDA,KAGC,IAFDnvB,cAEC,MAFQ,SAER,EADEtG,EACF,kBACD,OACE,kDACMA,GADN,IAGEyB,QAAS,0BAAMrB,OAAOs1B,KAAKD,EAAMnvB,QCLjCqvB,GAAQ,CACZn2B,YAAa,6CACbyc,kBACE,6EAEFkM,YAAa,mDAEbyN,WAAY,4CACZC,sBACE,8DACFC,WAAY,6CAIRC,GAAoB,CACxB3Q,UAAW,MACXuI,WAAY,OACZ3kB,MAAO,OACPhG,OAAQ,QCrBKgzB,ODwBA,SAASA,UACtB,OACE,eAAC3yB,EAAA,EAAD,CAAMN,MAAO,CAAE0wB,UAAW,QAA1B,UACE,qHAEsB,IACpB,mBACEgC,KAAK,gCACLnvB,OAAO,SACPivB,IAAI,aAHN,oCAHF,OAYA,uEACyC,IACvC,sBAAMxyB,MAAO,CAAEsY,WAAY,QAA3B,gFAFF,OAOA,mEACqC,IACnC,cAAC,GAAD,CAAcoa,KAAK,sBAAnB,yBAFF,aAGQ,IACN,cAAC,GAAD,CAAcA,KAAK,yBAAnB,wBAAsE,IAJxE,oBAKoB,IAClB,cAAC,GAAD,CAAcA,KAAK,6CAAnB,yBANF,oEAYA,mBAAG1yB,MAAO,CAAEsY,WAAY,QAAxB,yCAEA,qBAAKtY,MAAO,CAAEuX,UAAW,UAAzB,SACG/S,OAAOsjB,QAAQ8K,IAAOvhB,KAAI,WAAuBqD,GAAS,IAAD,mBAA7B/R,EAA6B,KAAtBuwB,EAAsB,KACxD,OACE,cAAC,GAAD,CAAmBlzB,MAAO,CAAEiG,MAAO,IAAKkS,QAAS,gBAAjD,SAC0B,kBAAhB+a,EACN,cAAC,GAAD,CACER,KAAMQ,EACNlzB,MAAOgzB,GAFT,SAIGrwB,IAGH,wBAAQjE,QAASw0B,EAAalzB,MAAOgzB,GAArC,SACGrwB,KAVO+R,YE7DpBke,GAAQ,CACZO,WAAY,yBACZC,OAAQ,gCACR,cAAe,uBCLFC,ODQA,SAASA,YACtB,OACE,eAACjb,GAAA,EAAD,CAAQC,aAAa,EAArB,UACE,mBAAGrY,MAAO,CAAEsY,WAAY,QAAxB,mCACA,qBAAKtY,MAAO,CAAEmY,QAAS,eAAgBZ,UAAW,QAAlD,SACG/S,OAAOsjB,QAAQ8K,IAAOvhB,KAAI,WAAcqD,GAAd,uBAAEoH,EAAF,KAAQwX,EAAR,YACzB,eAAC,GAAD,WACGxX,EADH,IACU,IAIR,cAAC,GAAD,CAAc4W,KAAMY,EAApB,SAA0BA,MALd5e,QAUlB,uBAEA,+DACiC,IAC/B,cAAC,GAAD,CAAcge,KAAK,6BAAnB,iCAFF,WE5BAa,IAAY,IAAI7F,MAAO8F,cCgCtB,IC9BQC,GDgCS,CACtBjnB,GAH6B,gBAI7B7J,MAAO,gBACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV4O,mBAAoB,CAClB6kB,OAAQ,YAEV3wB,aAAc,SAASD,aAAT,GAAwD,IAAhCgM,EAA+B,EAA/BA,YAAaC,EAAkB,EAAlBA,eAmBjD,OACE,cAAC,GAAD,UACE,cAAC,GAAD,CAGEmiB,QAAS,CACP,CACEM,QAAS,WACT9yB,QAAS,0BAAMqQ,EAAe,CAAE2kB,OAAQ,cACxCrC,WAAmC,aAAvBviB,EAAY4kB,QAE1B,CACElC,QAAS,UACT9yB,QAAS,0BAAMqQ,EAAe,CAAE2kB,OAAQ,aACxCrC,WAAmC,YAAvBviB,EAAY4kB,QAE1B,CACElC,QAAS,YACT9yB,QAAS,0BAAMqQ,EAAe,CAAE2kB,OAAQ,eACxCrC,WAAmC,cAAvBviB,EAAY4kB,UAfvB5kB,EAAY4kB,WAsBzBhiB,KAAM,SAAS2Y,KAAT,GAAgD,IAAhCvb,EAA+B,EAA/BA,YAAaC,EAAkB,EAAlBA,eACjC,EACE7M,gBADMC,EAAR,EAAQA,WAAYC,EAApB,EAAoBA,oBAAqBC,EAAzC,EAAyCA,oBAGnCsxB,EAAyBjR,UAE/B,OACE,cAAC,GAAD,UACE,eAAC,EAAD,WACE,eAAC,gBAAD,WAC0B,aAAvB5T,EAAY4kB,QACX,cAAC,GAAD,UACE,eAACtb,GAAA,EAAD,WACE,qBAAKpY,MAAO,CAAEwb,SAAU,OAAQ+T,UAAW,UAA3C,qBAGA,cAAC,EAAD,CAAQvvB,MAAO,CAAEwb,SAAU,UAA3B,oDAOkB,YAAvB1M,EAAY4kB,QAAwB,cAAC,GAAD,IAEb,cAAvB5kB,EAAY4kB,QAA0B,cAAC,GAAD,OAEzC,eAAClzB,OAAD,CAAQR,MAAO,CAAEuX,UAAW,UAA5B,UAC0B,aAAvBzI,EAAY4kB,QACX,eAAC,GAAD,WACE,8BACE,eAAC,EAAD,WACE,cAAC,GAAD,CACE7B,SAAS,SACTC,QAAQ,UACRJ,KAAMvvB,IAAee,IACrB0U,SAAU,kBAAAgc,GAAS,OACjBvxB,EACEuxB,EAAY1wB,IAAmB4F,QAIrC,eAAC,EAAD,WACE,uBACE0D,GAAImnB,EACJp1B,KAAK,WACLK,QAASwD,EACTwV,SAAU,kBAAAtU,GAAG,OACXjB,EACEiB,EAAIC,OAAO3E,QACPkmB,IACA3iB,MAGP,IACH,uBACEihB,QAASuQ,EACT3zB,MAAO,CAAEmY,QAAS,gBAFpB,iCASN,cAAC,GAAD,CACEzZ,QAAS,0BAAMqQ,EAAe,CAAE2kB,OAAQ,aAD1C,qBAIe,IAvCjB,IAwCI,IACF,cAAC,GAAD,CACEh1B,QAAS,0BAAMqQ,EAAe,CAAE2kB,OAAQ,eAD1C,0BAQJ,qBAAK1zB,MAAO,CAAE6zB,QAAS,IAAvB,SDhKJ,yBAAN,OAA6BN,GAA7B,iDGAaO,GALc,2BACxBL,IADwB,IAE3B1hB,aAAa,I,+BCOFsa,GAAkB,oBCThB0H,GDWY,CACzBvnB,GAAI6f,GACJ1pB,MAAO,oBACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV4R,UAAU,EACVH,KAAM,SAAS2Y,OACb,MAAgC/qB,oBAAS,GAAzC,mBAAO00B,EAAP,KAAiBC,EAAjB,KACA,EAAoC30B,oBAAS,GAA7C,mBAAO40B,EAAP,KAAmBC,EAAnB,KACA,EAA8B70B,oBAAS,GAAvC,mBAAO80B,EAAP,KAAgBC,EAAhB,KACA,EAA0C/0B,mBAAS,MAAnD,mBAAOg1B,EAAP,KAAsBC,EAAtB,KAEMC,EAAgBr3B,iBAAO,MAC7Bq3B,EAAcv2B,QAAUi2B,EAGxB,IAAMO,EAAwB3wB,sBAAW,wBAAC,mCAAAtI,EAAA,mEACrBg5B,EAAcv2B,QADO,iEAQtCo2B,GAAW,GACXF,GAAc,GATwB,SAWfO,eAXe,OAWhCV,EAXgC,OAatCC,EAAYD,GAb0B,kDAetC7vB,QAAQC,MAAR,MAEAiwB,GAAW,GACXJ,GAAY,GAlB0B,yBAoBtCE,GAAc,GACdI,GAAiB,IAAI7G,MAAOiH,WArBU,mFAuBvC,IAOH,OAJAv3B,qBAAU,WACRq3B,MACC,CAACA,IAGF,eAAC,EAAD,WACE,cAACp0B,OAAD,UACE,cAAC,GAAD,CAASL,MAAO,CAAEuX,UAAW,UAA7B,SACE,wBAAQ7Y,QAAS+1B,EAAuB72B,SAAUs2B,EAAlD,mCAKJ,cAAC,gBAAD,UACE,cAAC9b,GAAA,EAAD,CAAQC,aAAa,EAArB,SACG+b,EACC,mCACE,yEAC2C,IACzC,wBAAQ11B,QAAS+1B,EAAjB,6BAGFT,EACF,wFAEA,mCACE,6EAC+C,IAC7C,wBAAQt1B,QAAS,0BAAM0mB,IAAYhS,eAAnC,+BAQV,cAAC5S,OAAD,UACE,cAAC,GAAD,UACE,sBAAK/C,UAAU,OAAf,0BACgB,IACb62B,EAAgBM,KAAMN,GAAeO,OAAO,OAAS,kB,qBE/FrDC,GCIU,CACvBtoB,GAAI,iBACJ7J,MAAO,iBACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAGVyR,KAAM,SAAS2Y,KAAT,GAAiD,EAAjCrlB,iBAAiC,EAAfiN,YAAgB,IAEtD,EAAsC3S,oBAAS,GAA/C,mBAAOy1B,EAAP,KAAoBC,EAApB,KAUA,OARA53B,qBAAU,WACJ23B,EACFt1B,SAASK,KAAKH,UAAUC,IAAI,aAE5BH,SAASK,KAAKH,UAAUS,OAAO,eAEhC,CAAC20B,IAGF,eAAC,EAAD,CAAQt3B,UAAWoC,KAAO,kBAA1B,UACE,cAAC,gBAAD,UACE,cAACuY,GAAA,EAAD,UACE,yBAAQ1Z,QAAS,0BAAMs2B,GAAe,SAAAriB,GAAI,OAAKA,MAA/C,UACGoiB,EAAc,UAAY,SAD7B,oBAKJ,cAACv0B,OAAD,UAII,CAAC,UAAW,UAAW,UAAW,UAAW,WAAW6Q,KACtD,SAACqK,EAAOhH,GAAR,OACE,qBAEE1U,MAAO,CACLiN,gBAAiByO,EACjBzb,OAAQ,IACRgG,MAAO,MACPkS,QAAS,gBANb,SASE,cAACC,GAAA,EAAD,UACE,sBACEpY,MAAO,CACLmN,QAAS,EACTF,gBAAiB,iBACjB8U,aAAc,GAJlB,SAOGrG,OAhBAhH,a,iECxCRugB,OCQA,SAASA,aAAT,GAAoD,IAA5Bx3B,EAA2B,EAA3BA,UAAW2rB,EAAgB,EAAhBA,IAAQnsB,EAAQ,kBAChE,OACE,cAACqD,EAAA,EAAD,2BAAUrD,GAAV,IAAgBQ,UAAWC,IAAWmC,KAAO,iBAAkBpC,GAA/D,SACE,cAAC,KAAD,CACE2rB,IAAKA,EACL8L,MAAM,UAENl1B,MAAO,CAAEiG,MAAO,OAAQhG,OAAQ,cCZ3BosB,GAAkB,cCHhB8I,GDKQ,CACrB3oB,GAAI6f,GACJ1pB,MAAO,cACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEVyR,KAAM,SAAS2Y,OACb,OACE,cAAC,EAAD,UACE,cAAC,gBAAD,UACE,cAAC,GAAD,CAAcjB,IAAK8B,2IEAvBkK,GAAcC,EAAQ,KChBbC,GDoBS,CACtB9oB,GAH6B,gBAI7B7J,MAAO,gBACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEVyR,KAAM,SAAS2Y,OACb,OACE,eAAC,EAAD,WACE,cAAChqB,OAAD,UACE,cAAC,GAAD,qCAEF,cAAC,gBAAD,UACE,cAAC,GAAD,CAAc+oB,IAAKgM,OAErB,cAAC50B,OAAD,UACE,cAAC,GAAD,UACE,eAACC,IAAD,WACE,cAACE,OAAD,UACE,cAACyX,GAAA,EAAD,UACE,sBACEpY,MAAO,CAAE2b,MAAO,OAAQpE,UAAW,QACnC9Z,UAAU,OAFZ,8BAIoB2nB,IAAY4F,oBAC9B,uBALF,wBAMwBvuB,IAAYwuB,wBAClC,uBAPF,WAQW7F,IAAYmQ,uBAI3B,cAAC50B,OAAD,UACE,eAACyX,GAAA,EAAD,CAAQpY,MAAO,CAAEuX,UAAW,SAA5B,UACE,cAAC,GAAD,CAAe/K,GAAIgpB,KAAsC,IACzD,cAAC,GAAD,CAAehpB,GAAIipB,sB,qBExDtBC,OCEA,SAASA,qBAAT,GAA4C,IAATz4B,EAAQ,oBACxD,OACE,6CAAKQ,UAAWoC,KAAO,oBAAwB5C,GAA/C,aACE,sBAAKQ,UAAWoC,KAAM,QAAtB,UACE,qBAAKpC,UAAWoC,KAAM,MACtB,qBAAKpC,UAAWoC,KAAM,MACtB,qBAAKpC,UAAWoC,KAAM,MACtB,qBAAKpC,UAAWoC,KAAM,MACtB,qBAAKpC,UAAWoC,KAAM,a,kFCVf81B,OCgBA,SAASA,QAAT,GAMX,IALFv3B,EAKC,EALDA,SACAw3B,EAIC,EAJDA,iBAIC,IAHDC,gCAGC,SADE54B,GACF,EAFD64B,QAEC,mBAGD,OAFuCC,aAAWH,GAA1CI,aAEaH,EAOZ,cAAC,IAAMhpB,SAAP,UAAiBzO,IALtB,cAAC,GAAD,2BAAgBnB,GAAhB,aACE,cAAC,GAAD,Q,qBC9BO,OAA0B,+BCA1B,giJ,gECEAg5B,OC6BA,SAASA,QAAT,GAMX,IAAD,IALDp4B,aAKC,MALO,OAKP,EAJDJ,EAIC,EAJDA,UACA6c,EAGC,EAHDA,iBACAb,EAEC,EAFDA,kBACGxc,EACF,kBACD,EAAwBqC,mBAAS,MAAjC,mBAAO42B,EAAP,KAAaC,EAAb,KACA,EAAgC72B,mBAAS,MAAzC,mBAAO82B,EAAP,KAAiBC,EAAjB,KAGMphB,EAAO7R,kBAAQ8R,KAAQ,IAE7B9X,qBAAU,WACJ84B,GAAQE,IACVF,EAAKl2B,MAAMs2B,gBAAX,cAAoCC,GAApC,KACAL,EAAKl2B,MAAMw2B,mBAAqB,WAChCN,EAAKl2B,MAAMy2B,iBAAmB,YAE9BL,EAASp2B,MAAMs2B,gBAAf,cAAwCI,GAAxC,KACAN,EAASp2B,MAAMw2B,mBAAqB,WACpCJ,EAASp2B,MAAMy2B,iBAAmB,eAEnC,CAACP,EAAME,IAOV,IAAM3b,EAAyB3W,uBAC7B,SAAAkW,GACMoc,GACF1b,MAA+B,WAC7B0b,EAASp2B,MAAMqoB,UAAf,kBAAsC5gB,KAAK2gB,IACnCpO,EAAa,IAAnB,IADF,UAGC/E,KAGP,CAACmhB,EAAUnhB,IAeb,OAXA7X,qBAAU,WACJg5B,GACF3b,EAAuB,KAExB,CAACA,EAAwB2b,IAE5B9c,0CACEgB,GAAoBb,EACpBgB,GAIA,cAAC,GAAD,CAASmb,iBAAkB,CAACW,GAAcG,IAA1C,SACE,8CACEl5B,IAAK24B,EACL14B,UAAWC,IAAWmC,KAAM,GAAQpC,IAChCR,GAHN,cAKE,qBAAKQ,UAAWoC,KAAM,KAAtB,SACE,qBACErC,IAAK64B,EACL54B,UAAWoC,KAAM,OACjBG,MAAO,CAAEqoB,UAAW,qBAGxB,mBAAG5qB,UAAWoC,KAAO,YAArB,SAAmChC,WCzF9BwuB,GAAkB,WCThBsK,GDWI,CACjBnqB,GAAI6f,GACJ1pB,MAAO,WACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAGV0R,eAAgB,CAAC+L,IACjBhM,KAAM,iBAAsB,IASpB+H,EATmB,EAAlBxH,YACiByL,IAEKkB,sBAO1BvN,KAAI,SAAAkO,GAAO,OACVA,EACGI,2BACAtO,KAAI,SAAAulB,GAAU,OAAIA,EAAWC,kCAEjCC,OAEH,OACE,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,cAAC1e,GAAA,EAAD,CAAQC,aAAa,EAArB,SACE,gCACE,cAAC,GAAD,CAAcoB,kBAAmBA,IACjC,cAAC,GAAD,CACEzZ,MAAO,CAAEuiB,WAAY,GAAItiB,OAAQ,IAAKgG,MAAO,IAC7CwT,kBAAmBA,WAmB3B,cAACjZ,OAAD,UACE,cAAC,GAAD,UACE,cAAC,GAAD,CAAegM,GAAIuqB,c,2CE7DhB,SAASC,OAAT,GAKX,IAJF1c,EAIC,EAJDA,iBAIC,IAHD2c,iBAGC,MAHW,QAGX,MAFDC,YAEC,MAFM,SAAA/vB,GAAE,OAAI,MAEZ,EADElK,EACF,kBACD,EAAoBqC,mBAAS,MAA7B,mBAAO6H,EAAP,KAAW2O,EAAX,KAEMhb,EAAcsI,mBAClB,kBAAMkX,GAAoB,IAAI6c,YAAY,CAAC7c,MAC3C,CAACA,IAMHld,qBAAU,WACH+J,IAMArM,GAKLqM,EAAGiwB,UAAYt8B,EAKfqM,EAAGkwB,OACA5a,MAAK,kBAAOtV,EAAGmwB,OAAQ,KACvBlZ,OAAM,SAAAla,GAAG,OAAIC,QAAQ6c,KAAK,SAAU9c,OAXrCiD,EAAGiwB,UAAY,QAYhB,CAACjwB,EAAIrM,IAER,IAAMy8B,EAAUp6B,iBAAO+5B,GAWvB,OARA95B,qBAAU,WACR,IAAM85B,EAAOK,EAAQt5B,QAEjBkJ,GAAsB,oBAAT+vB,GACfA,EAAK/vB,KAEN,CAACA,IAEGmH,IAAMkpB,cAAcP,EAApB,aACLz5B,IAAKsY,EACL2hB,UAAU,EACVH,OAAO,EACPI,aAAa,EACbC,UAAU,GACP16B,I,0CClDQ,SAAS26B,MAAT,GAAwC,IAAvBn6B,EAAsB,EAAtBA,UAAcR,EAAQ,kBACpD,OACE,cAAC+5B,OAAD,aAAQv5B,UAAWC,IAAWmC,KAAM,MAAWpC,IAAgBR,I,ICP7D46B,G,gRAAuCpa,gDAGxBqa,G,4FACnB,iCAAsB,IAAD,sEAANxrB,EAAM,yBAANA,EAAM,uBACnB,+BAASA,KAEJiG,SAAS,2BAEd,EAAKyL,oBAAoB6Z,IALN,E,oFAarB,SAAAE,8BACE,OAAOlb,SAAM6W,OAAOqE,gC,yEAItB,mDAAAv8B,EAAA,sEAAyB6kB,EAAzB,+BAAuC,GAAIhB,EAA3C,+BAA4D,GAA5D,SACwBxC,SAAM6W,OAAOsE,cACjC3X,EACAhB,GAHJ,cACQE,EADR,OAME1jB,KAAKo8B,sBACHJ,IACArY,0BAA0BD,GAR9B,kBAUSA,GAVT,sD,2GAkBA,SAAA2Y,uBACE,OAAOr8B,KAAKo8B,sBAAsBJ,IAC/BM,cACA9mB,KAAI,SAAAkO,GAAO,OACVA,EACG6Y,sBACA/mB,KAAI,SAAAulB,GAAU,OAAIA,EAAWC,kCAEjCC,S,iCAIL,SAAAlY,sBACE,OAAO/iB,KAAKo8B,sBACVJ,IACAM,kB,uBApD6CviB,MCOtCyW,GAAkB,wBAQzBgM,GAAmB,CACvB7rB,GAAI6f,GACJ1pB,MAAO,iBACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV0R,eAAgB,CAACmmB,IACjBpmB,KAAM,SAAS2Y,KAAT,GAAkD,IAAD,IAAjCpY,EAAiC,EAAjCA,YAAajN,EAAoB,EAApBA,iBAC3BszB,EAAMrmB,EAAY6lB,IAQlBS,EAA2Bn1B,mBAC/B,kBAAMk1B,EAAIP,gCACV,CAACO,IAKHl7B,qBAAU,WACR,IAAKm7B,EAA0B,CAC7B,IAAMxP,EAAmB1rB,OAAOoY,WAC9BzQ,EAAiB0F,QACjB,KAGF1F,EAAiB6N,KAAKC,iBAAe,kBACnCzV,OAAOgY,aAAa0T,SAGvB,CAACwP,EAA0BvzB,IAE9B,MAAwD1F,mBAAS,MAAjE,mBAAOk5B,EAAP,KAA6BC,EAA7B,KAEMC,ECrDK,SAASC,qBACtB,IAAMC,EAAkBz7B,kBAAO,GAU/B,OARAC,qBAAU,WACR,OAAO,SAASsJ,UACdkyB,EAAgB36B,SAAU,KAE3B,IAEqB6F,uBAAY,kBAAM80B,EAAgB36B,UAAS,ID4CzC06B,GAGlBE,EAA2B/0B,sBAAW,wBAC1C,mDAAAtI,EAAA,sEAAO6kB,EAAP,+BAAqB,GAAIhB,EAAzB,+BAA0C,GAA1C,SACwBiZ,EAAIQ,mBACxBzY,EACAhB,GAHJ,cACQE,EADR,OAMEkZ,EAAwBlZ,GAExBA,EAAQ1M,KAAKC,iBAAe,WAGrB4lB,KACHD,EAAwB,SAZ9B,kBAgBSlZ,GAhBT,iDAkBA,CAAC+Y,EAAKI,IAIRt7B,qBAAU,WACR,GAAIo7B,EACF,OAAO,WACAA,EAAqB/tB,mBACxB+tB,EAAqB9tB,aAI1B,CAAC8tB,IAEJ,IAAMO,EAAU,OAAGP,QAAH,IAAGA,GAAH,UAAGA,EACfQ,2BAA2B,UADf,aAAG,EAEfC,iBAEEC,EAAU,OAAGV,QAAH,IAAGA,GAAH,UAAGA,EACf7Y,2BAA2B,UADf,aAAG,EAEfsZ,iBAEJ,OAAKV,EAWH,eAAC,EAAD,CAAQv4B,MAAO,CAAEiN,gBAAiB,UAAWyO,MAAO,QAApD,UACE,cAAC,gBAAD,UACE,eAACjb,IAAD,WACE,eAACE,OAAD,WACE,cAACi3B,MAAD,CAAOtd,iBAAkBye,KACvBP,GACA,cAACvlB,EAAA,EAAD,UACE,cAACmF,GAAA,EAAD,UACE,8BACE,wBACE1Z,QAAS,0BAAMm6B,KACf74B,MAAO,CACLiN,gBAAiB,QACjBhH,MAAO,IACPhG,OAAQ,IACR8hB,aAAc,IACdzJ,WAAY,OACZkD,SAAU,SACVsG,OAAQ,kBATZ,2CAmBV,cAACnhB,OAAD,CAAQX,MAAO,CAAEiG,MAAO,GAAIkI,SAAU,IAAtC,SAYE,cAAC1N,IAAD,CAAKT,MAAO,CAAEuX,UAAW,UAAzB,SACE,cAAC5W,OAAD,UACE,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,cAAC,GAAD,CAAiB2Z,iBAAkB4e,MAErC,cAAC14B,OAAD,kCAOZ,cAACA,OAAD,UACE,cAAC,GAAD,UACE,eAACC,IAAD,WACE,cAACE,OAAD,UACE,cAACyX,GAAA,EAAD,UACE,cAAC,GAAD,CAAe5L,GAAIuqB,SAGvB,cAACp2B,OAAD,UACE,cAACyX,GAAA,EAAD,UACE,wBACEpY,MAAO,CACLiN,gBAAkBurB,EAAiC,MAAV,QACzC5N,WAAY,UAEdlsB,QAAS,mBAEL85B,IACCA,EAAqB/tB,kBAEtB+tB,EAAqB9tB,UAErBmuB,KAZN,SAgBIL,EAAmC,OAAZ,0BAxFrC,cAACpgB,GAAA,EAAD,UACE,qBAAKpY,MAAO,CAAEsY,WAAY,QAA1B,kEE7GK+f,GFgNAA,GGxMFhM,GAAkB,sBCRhB8M,GDUc,CAC3B3sB,GAAI6f,GACJ1pB,MAAO,sBACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV0R,eAAgB,CAAC+L,IACjBhM,KAAM,SAAS2Y,KAAT,GAAgC,IAC9B+O,EAD6B,EAAfnnB,YACIyL,IAExB,OACE,cAAC,GAAD,UACE,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,cAAC,GAAD,MAEF,eAACld,OAAD,WACE,wBACE9B,QAAS,0BAAM06B,EAAInb,wBAAuB,IAC1Cje,MAAO,CAAE2b,MAAO,SAFlB,qBAOA,uBAAMle,UAAU,eAAhB,UACE,cAAC,GAAD,CAAe+O,GAAI6sB,KACnB,cAAC,GAAD,CAAe7sB,GAAI8sB,kBEhBlBC,GAXK,SAAdA,YAAcC,GAClB,IAAMC,EAAQ,CAAC,QAAS,KAAM,KAAM,KAAM,MAC1C,GAAc,IAAVD,EAAa,MAAM,KAAN,OAAYC,EAAM,IACnC,IAAMC,EAAIC,SACRlyB,KAAKC,MAAMD,KAAKioB,IAAIjoB,KAAKmyB,IAAIJ,IAAU/xB,KAAKioB,IAAI,OAChD,IAEF,OAAU,IAANgK,EAAe,GAAN,OAAUF,EAAV,YAAmBC,EAAMC,IAChC,GAAN,QAAWF,EAAK,SAAG,KAAQE,IAAGrK,QAAQ,GAAtC,YAA4CoK,EAAMC,KClBrCG,GCIO,CACpBrtB,GAAI,cACJ7J,MAAO,cACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEVyR,KAAM,SAAS2Y,OACb,MAGI/qB,mBAAS,CACXw6B,gBAAiB,MACjBC,gBAAiB,MACjBC,eAAgB,QANlB,0BACIF,EADJ,EACIA,gBAAiBC,EADrB,EACqBA,gBAAiBC,EADtC,EACsCA,eACpCC,EAFF,KAUMC,EAAkBp2B,uBAAY,WAClC,GAAKzG,OAAO88B,YAAYC,OAAxB,CAKA,MACE/8B,OAAO88B,YAAYC,OADbN,EAAR,EAAQA,gBAAiBC,EAAzB,EAAyBA,gBAAiBC,EAA1C,EAA0CA,eAGpCK,EAAa,CACjBP,gBAAiBP,GAAYO,GAC7BC,gBAAiBR,GAAYQ,GAC7BC,eAAgBT,GAAYS,IAK9B,OAFAC,EAAeI,GAERA,KACN,IAmBH,OAhBAj9B,qBAAU,WAGR,GAFqB88B,IAEH,CAChB,IAAMI,EAAkB9M,aAAY,WAClC0M,MACC,KAEH,OAAO,SAASxzB,UACd+mB,cAAc6M,OAGjB,CAACJ,IAKF,eAAC,EAAD,CAAQl6B,MAAO,CAAEiN,gBAAiB,UAAWyO,MAAO,QAApD,UACE,cAAC,gBAAD,UACE,cAACtD,GAAA,EAAD,UACE,wBAAOpY,MAAO,CAAEmY,QAAS,gBAAzB,UACE,gCACE,+BACE,iDACA,iDACA,qDAIJ,gCACE,+BAIE,6BAAK2hB,IACL,6BAAKC,IACL,6BAAKC,gBAMf,eAACx5B,OAAD,CAAQR,MAAO,CAAEwb,SAAU,SAA3B,UACE,mBACEkX,KAAK,sEACLnvB,OAAO,SACPivB,IAAI,aACJxyB,MAAO,CAAE2b,MAAO,QAJlB,+BAQA,sBAAM3b,MAAO,CAAE2b,MAAO,SAAtB,gEC9FK4e,OCIA,SAASA,kBAAT,GAKX,IAAD,IAJDC,4BAIC,MAJsB,GAItB,EAHDC,EAGC,EAHDA,WACAC,EAEC,EAFDA,QACAC,EACC,EADDA,UAEMvnB,EAAcC,eAEpB,OAAKmnB,EAAqB/7B,OAsBxB,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,cAAC,GAAD,CAASuB,MAAO,CAAE0wB,UAAW,QAA7B,SACE,wBAAO1wB,MAAO,CAAEiG,MAAO,QAAvB,UACE,gCACE,+BACE,uBACA,qCACA,oBAAIjG,MAAO,CAAE0b,MAAO,QAApB,mBAIA,4CACA,qDAGJ,gCACG8e,EAAqBnpB,KAAI,SAACupB,EAAQlmB,GACjC,IAAQjE,EAAmCmqB,EAAnCnqB,IAAiBoqB,EAAkBD,EAAlBC,cAEzB,OACE,+BACE,oBAAIp9B,UAAU,SAAd,SACE,uBACEc,KAAK,WAELX,UAAQ,MAGZ,6BAAK6S,IACL,oBAAIhT,UAAU,SAAd,SACE,wBACEiB,QAAS,0BAAM+7B,EAAWhqB,EAAKoqB,IAE/Bj9B,UAAQ,EAHV,mBAYF,oBAAIH,UAAU,SAAd,SACGo9B,EAAcC,qBAAuB,SAExC,oBAAIr9B,UAAU,SAAd,SAAwBo9B,EAAc7wB,eAzB/B0K,eAiCrB,cAAClU,OAAD,UACE,eAAC,GAAD,CAASR,MAAO,CAAElB,SAAU,QAA5B,UACE,wBAAQJ,QAASg8B,EAAjB,mBAEA,wBAAQ16B,MAAO,CAAE2b,MAAO,SAAWjd,QAAS0U,EAA5C,4BA9EJ,cAACgF,GAAA,EAAD,UACE,eAAC,GAAD,WACE,cAAC,GAAD,CAASpY,MAAO,CAAEsY,WAAY,QAA9B,iCACA,cAAC,GAAD,CAAS7a,UAAU,OAAnB,0IAIA,cAAC,GAAD,CAASA,UAAU,OAAnB,yFAIA,cAAC,GAAD,UACE,wBAAQiB,QAASi8B,EAAjB,qCCxBG,SAASI,cAAcC,GAKpC,IAJA,IAAMC,EAAWD,EAAYC,SAEvBznB,EAAS,GAEf,mBAAqBynB,GAArB,eAAgC,CAA3B,IAAM9zB,EAAE,KACLsJ,EAAMtJ,EAAG2U,MAAQ3U,EAAGqF,GAEtBiE,IACF+C,EAAO/C,GAAOtJ,EAAG8H,OAIrB,OAAOuE,E,qECfM0nB,OCCA,SAASA,KAAT,GAOX,IANF98B,EAMC,EANDA,SAMC,IALD+8B,oBAKC,MALc,MAKd,MAJDC,iBAIC,MAJW,SAAAC,GAAU,OAAI,MAIzB,MAHDzjB,gBAGC,MAHU,SAAAyjB,GAAU,OAAI,MAGxB,MAFDC,gBAEC,MAFU,SAAAD,GAAU,OAAI,MAExB,EADEp+B,EACF,kBACD,ECFa,SAASs+B,kBAAT,GAIX,IAHFD,EAGC,EAHDA,SAGC,IAFD1jB,gBAEC,MAFU,kBAAM,MAEhB,MADDwjB,iBACC,MADW,kBAAM,MACjB,EACD,EAAkC97B,mBAAS,MAA3C,mBAAO07B,EAAP,KAAoBQ,EAApB,KAIAp+B,qBAAU,WACR,GAAI49B,EAAa,CAEVx2B,OAAOgP,OAAOunB,cAAcC,IAAcv8B,QAC7C0F,QAAQ6c,KACN,kGACAga,GALW,oBAUEA,EAAYC,UAVd,IAUf,2BAAuC,CAAC,IAA7B9zB,EAA4B,QACrC,GAAiC,WAA7BA,EAAG3D,QAAQmoB,gBAA+BxkB,EAAGs0B,aAAa,QAAS,CACrEt3B,QAAQ6c,KAAR,8FAEE7Z,GAEF,QAhBW,kCAoBhB,CAAC6zB,IAEJ,MAA8B17B,oBAAS,GAAvC,mBAAOo8B,EAAP,KAAgBC,EAAhB,KACA,EAA4Br8B,mBAAS,IAArC,mBAAOs8B,EAAP,KAAeC,EAAf,KAGMC,EAAqBh4B,uBACzB,SAAAu3B,GACE,IAAIU,GAAY,EAEVH,EAASp3B,OAAOw3B,YACpBx3B,OAAOsjB,QAAQsT,EAAUC,IAAe,IAAIroB,QAAO,SAAA2L,GACjD,IAAMyV,EAAUx4B,QAAQ+iB,EAAU,IAMlC,OAJIyV,IACF2H,GAAY,GAGP3H,MAILsH,GAAWK,EAGjB,OAFAJ,EAAWD,GACXG,EAAUD,GACHF,IAET,CAACN,IAIGa,EAAmBn4B,uBACvB,SAAAR,GACE,IAAM+3B,EAAaN,cAAcC,GACjCc,EAAmBT,GAEnBzjB,EAASyjB,KAEX,CAACS,EAAoBd,EAAapjB,IAI9BskB,EAAmBp4B,uBACvB,SAAAR,GACEA,EAAI4T,iBAEJ,IAAMmkB,EAAaN,cAAcC,GACjBc,EAAmBT,IAGjCC,EAASD,KAGb,CAACS,EAAoBd,EAAaM,IAGpC,MAAO,CACLI,UACAI,qBACAG,mBACAC,mBACAN,SACAJ,cDnFED,CAAkB,CACpBD,WACA1jB,WACAwjB,cATAI,EADF,EACEA,WACAS,EAFF,EAEEA,iBACAC,EAHF,EAGEA,iBACAJ,EAJF,EAIEA,mBACAF,EALF,EAKEA,OACAF,EANF,EAMEA,QAOF,OACE,gDACMz+B,GADN,IAEEO,IAAKg+B,EACLL,aAAcA,EACdvjB,SAAUqkB,EACVX,SAAUY,EALZ,SASI99B,EAAS,CACPw9B,SACAF,UACAS,OAAQD,EACRE,SAAUN,QElCL,SAASO,cAAT,GAMX,IALFC,EAKC,EALDA,WACAC,EAIC,EAJDA,aACAC,EAGC,EAHDA,qBACAC,EAEC,EAFDA,eACAnB,EACC,EADDA,SAEA,OACE,cAACljB,GAAA,EAAD,CAAQC,aAAa,EAArB,SACE,cAAC,GAAD,CACEijB,SAAUA,EACVF,UAAW,mBAAAC,GACT,MAAO,CAEL5qB,IACE4qB,EAAW5qB,IAAIhS,OAAS,GACxB,4CAPR,SAWG,yBAAGm9B,EAAH,EAAGA,OAAQF,EAAX,EAAWA,QAAX,OACC,qCACE,cAAC,GAAD,UACE,uBACE5f,KAAK,MACLvd,KAAK,OACLqkB,YAAY,MACZ8Z,aAAcJ,EACdK,UAAQ,OAIL,OAANf,QAAM,IAANA,OAAA,EAAAA,EAAQnrB,MACP,qBAAKhT,UAAU,OAAOuC,MAAO,CAAE0b,MAAO,OAAtC,SACGkgB,EAAOnrB,MAIZ,cAAC,GAAD,UACE,0BACEqL,KAAK,QACL8G,YAAY,QACZ8Z,aAAcH,MAIlB,eAAC,GAAD,CAASv8B,MAAO,CAAEub,UAAW,GAAIhE,UAAW,QAA5C,UACE,mDACA,wBACEuE,KAAK,yBACL4gB,aAAY,OAAEF,QAAF,IAAEA,OAAF,EAAEA,EAAsBI,eACpCD,UAAQ,EAHV,SAKGF,EAAeprB,KAAI,SAAAwpB,GAClB,IAAMl4B,EAAQk4B,EAAc7wB,WACtB6yB,EAAYhC,EAAc+B,eAEhC,OACE,wBAAoB3tB,MAAO4tB,EAA3B,SACGl6B,GADUA,WAQrB,8BACE,uBACEpE,KAAK,SACL0Q,MAAM,SACNjP,MAAO,CAELiN,gBAAiB,WAEnBrP,UAAW89B,c,4BC3EZxlB,GCGK,SAAdA,YAAe,GAAiC,IAA/BzY,EAA8B,EAA9BA,UAAc0Y,EAAgB,kBACnD,OACE,6CACMA,GADN,IAEE1Y,UAAS,gDAA2CA,EAAS,WAAOA,GAAc,QCRzEq/B,GCqBK,CAClBtwB,GAH6B,YAI7B7J,MAAO,YACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV0R,eAAgB,CAAC2K,KAAiBmH,IAClC/R,KAAM,SAAS2Y,KAAT,GAAgC,IAAhBpY,EAAe,EAAfA,YACd8qB,EAA8B9qB,EAAYqK,MAC1C0gB,EACJD,EAA4BE,0BAExBhZ,EAAuBhS,EAAYwR,IAEzC,EAAwDnkB,mBAAS,IAAjE,mBAAOk7B,EAAP,KAA6B0C,EAA7B,KAEA,EAAgD59B,oBAAS,GAAzD,mBAAO69B,EAAP,KAAyBC,EAAzB,KAGAhgC,qBAAU,WACR,wBAAC,+CAAA5B,EAAA,+DACOg/B,EAAuB,GAD9B,cAGsBwC,GAHtB,gEAGYpC,EAHZ,QAISnqB,EAAMmqB,EAAO,GACbC,EAAgBD,EAAO,GALhC,UAMuBC,EAAc1d,UAAU1M,GAN/C,QAMSxB,EANT,OAaGurB,EAAqBh8B,KAAK,CACxBiS,MACAoqB,gBACA5rB,UAhBL,+IAqBCiuB,EAAwB1C,GArBzB,qEAAD,KAuBC,CAACwC,IAiBJ,IAAMK,EAAuBv5B,uBAC3B,SAAAu3B,GAEI0B,EAA4BO,8BAC1BjC,EAAU,wBAIXne,QAAQme,EAAU,IAASA,EAAU,OACrC5e,MAAK,WACJ2gB,GAAoB,QAG1B,CAACL,IAIGQ,EAAcz5B,sBAAW,wBAAC,8BAAAtI,EAAA,gFAGtByoB,EAAqBkB,QACzB,iDAJ0B,kCAO5B4X,EAA4BS,yBAPA,kDAS7B,CAACvZ,EAAsB8Y,IAM1B,OAJApmB,kBAAkBtZ,OAAQ,CACxBoZ,SAAU,2BAAM2mB,GAAoB,MAIpC,eAAC,EAAD,WACE,cAAC/8B,OAAD,UACE,cAAC,GAAD,UAOE,wBAAQ3B,QAAS,0BAAM0+B,GAAoB,SAAAzqB,GAAI,OAAKA,MAApD,SACIwqB,EAGA,qCACE,cAACM,GAAD,IADF,WAFA,0DASR,cAAC,gBAAD,UACIN,EASA,cAACd,cAAD,CACEI,eAAgBM,EAA4BW,oBAC5CpC,SAAU+B,IAVZ,cAAC,GAAD,CACE7C,qBAAsBA,EAEtBE,QAAS6C,EAET5C,UAAW,4BAAMyC,GAAoB,aCzEnD,SAASO,wBAAT,GAA4D,IAAzBC,EAAwB,EAAxBA,qBACzB1Z,EAAqBvf,6BAArBuf,iBAKR,OAFA/f,QAAQurB,IAAI,CAAExL,qBAGZ,8BACE,yBAAQtM,SAAU,kBAAAtU,GAAG,OAAIs6B,EAAqBt6B,EAAIC,OAAO0L,QAAzD,UACE,wBAAQA,MAAM,GAAd,qCACCiV,EAAiB7S,KAAI,SAAAqT,GAAY,OAChC,wBAAqCzV,MAAOyV,EAAaH,QAAzD,SACGG,EAAa1a,YADH0a,EAAajY,mBASrBoxB,ICvFAA,GDKkB,CAC/BrxB,GAH6B,0BAI7B7J,MAAO,0BACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEVyR,KAAM,SAAS2Y,OACb,IAAQnG,EAAqBvf,6BAArBuf,iBAER,EAAwC5kB,mBAAS,MAAjD,mBAAOolB,EAAP,KAAqBoZ,EAArB,KAEMC,EAAwBj6B,uBAC5B,SAAAk6B,GACE,IAAMC,EAAsB/Z,EAAiB3G,MAC3C,SAAAoB,GAAS,OAAIA,EAAU4F,UAAYyZ,KAGrC75B,QAAQurB,IAAI,CACVuO,wBAIAH,EADEG,EACcA,EAAoBzsB,mBAEpB,QAGpB,CAAC0S,IAGH,OAAKQ,EAWH,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,qBAAK1kB,MAAO,CAAEiG,MAAO,OAAQhG,OAAQ,OAAQywB,UAAW,QAAxD,SACE,cAAC,KAAD,CACEtH,IAAK1E,EACLwQ,MAAM,UACNl1B,MAAO,CAAEiG,MAAO,OAAQhG,OAAQ,cAItC,cAACO,OAAD,UACE,cAACm9B,wBAAD,CACEC,qBAAsBG,SArB1B,cAAC3lB,GAAA,EAAD,UACE,cAACulB,wBAAD,CACEC,qBAAsBG,Q,4BE1CnBG,OCCA,SAASA,QAAT,GAAoD,IAAjC9/B,EAAgC,EAAhCA,SAAUX,EAAsB,EAAtBA,UAAcR,EAAQ,kBAChE,OAEE,aADA,CACA,iCAASA,GAAT,IAAeQ,UAAWC,IAAW,UAAWD,GAAhD,SACGW,M,6ECLQ+/B,OCaA,SAASA,WAAT,GAOX,IANFziB,EAMC,EANDA,MACAje,EAKC,EALDA,UACAuC,EAIC,EAJDA,MACAnC,EAGC,EAHDA,MACAD,EAEC,EAFDA,SACGX,EACF,kBACD,OACE,sBACEQ,UAAWC,IACTmC,KAAO,eACPjC,GAAYiC,KAAM,SAClBpC,GAEFuC,MAAOA,EANT,UAQE,qBAAKvC,UAAWoC,KAAO,YAAvB,SACE,cAAC,GAAD,aAAK6b,MAAOA,GAAWze,MAEzB,qBAAKQ,UAAWoC,KAAO,cAAvB,SAAuChC,QCjC9BugC,OCCA,SAASA,oBAAT,GAIX,IAHFC,EAGC,EAHDA,sBACAC,EAEC,EAFDA,uBAEC,IADD1gC,gBACC,SACD,OACE,eAAC6C,IAAD,CAAKC,qBAAmB,EAACV,MAAO,CAAEC,OAAQ,IAA1C,UACE,cAACU,OAAD,CACEX,MAAO,CACL8hB,OAAQ,iBACRC,aAAc,EACd9U,gBAAiB,kBAJrB,SAOE,cAAC,GAAD,UACE,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,qBAAKjN,MAAO,CAAE0b,MAAO9d,EAAW,OAAS,WAAzC,UACIA,GAAYygC,EACVA,EACA,UAGR,cAAC79B,OAAD,UACE,qBACER,MAAO,CACLuvB,UAAW,SACX/T,SAAU,OACVE,MAAO,QAJX,gCAaR,cAAC/a,OAAD,CACEX,MAAO,CACL8hB,OAAQ,iBACRC,aAAc,EACd9U,gBAAiB,kBAJrB,SAOE,cAAC,GAAD,UACE,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,qBAAKjN,MAAO,CAAE0b,MAAO9d,EAAW,OAAS,WAAzC,UACIA,GAAY0gC,EACVA,EACA,UAGR,cAAC99B,OAAD,UACE,qBACER,MAAO,CACLuvB,UAAW,SACX/T,SAAU,OACVE,MAAO,QAJX,oCCvDC6iB,OCWA,SAASA,wBAAT,GAAsD,IAAnBC,EAAkB,EAAlBA,eAC1CC,EAA0BD,EAAeC,wBACzCC,EAA0BF,EAAeE,wBAE/C,OACE,eAAC,GAAD,YACIF,EAAe5gC,UACf,qBAAKoC,MAAO,CAAEkT,SAAU,WAAY+S,IAAK,EAAGC,KAAM,GAAlD,SACE,cAAC,GAAD,CACEgH,OAAQ,gCAAMuR,QAAN,IAAMA,OAAN,EAAMA,EAAyBE,uBACvC3+B,MAAO,CACL0b,OACG8iB,EAAeI,QAAUJ,EAAe5gC,SACrC,OACA,iBAKX4gC,EAAe5gC,UAAY4gC,EAAeK,SAC3C,qBAAK7+B,MAAO,CAAE2b,MAAO,QAAS7c,SAAU,QAAxC,SACE,qBAAKkB,MAAO,CAAEmY,QAAS,eAAgBoK,WAAY,IAAnD,SACIic,EAAe5gC,SA0Bf,sBAAMH,UAAU,OAAhB,SAAwB+gC,EAAeK,SAzBvC,qCACE,cAAC,GAAD,CACEhhC,MAAM,aACN6d,OACE,OAAC+iB,QAAD,IAACA,OAAD,EAACA,EAAyBK,qBAEC,OAAvBL,QAAuB,IAAvBA,OAAA,EAAAA,EAAyB1iC,mBACzB,UACuB,OAAvB0iC,QAAuB,IAAvBA,OAAA,EAAAA,EAAyBviC,kBACzB,QACA,MALA,SAQR,cAAC,GAAD,CACE2B,MAAM,iBACN6d,OACE,OAAC+iB,QAAD,IAACA,OAAD,EAACA,EAAyBK,qBAEC,OAAvBL,QAAuB,IAAvBA,OAAA,EAAAA,EAAyBpiC,oBACzB,QACA,MAHA,gBAclB,oBAAI2D,MAAO,CAAE0b,MAAO8iB,EAAe5gC,SAAW,OAAS,MAAvD,SACG4gC,EAAe77B,QAElB,cAAC,GAAD,UACE,eAAClC,IAAD,WACE,cAACE,OAAD,UACE,cAAC,GAAD,CACEoxB,YAAY,qBACZn0B,SAAU4gC,EAAe5gC,SACzB8zB,KAAI,OAAE+M,QAAF,IAAEA,OAAF,EAAEA,EAAyBK,mBAC/BlnB,SAAU,kBAAA8Z,GAAI,OACZA,EAAI,OACA+M,QADA,IACAA,OADA,EACAA,EAAyBM,mBADzB,OAEAN,QAFA,IAEAA,OAFA,EAEAA,EAAyBO,uBAInC,cAACr+B,OAAD,UACE,cAAC,GAAD,CACEoxB,YAAY,kBACZL,KAAI,OAAE+M,QAAF,IAAEA,OAAF,EAAEA,EAAyBQ,0BAC/BrnB,SAAQ,OAAE6mB,QAAF,IAAEA,OAAF,EAAEA,EAAyBS,wBACnCthC,WACE,OAAC6gC,QAAD,IAACA,OAAD,EAACA,EAAyBK,qBAC1BN,EAAe5gC,mBAMvB4gC,EAAe5gC,UACf,sBAAKoC,MAAO,CAAElB,SAAU,QAAxB,UACE,cAAC,GAAD,UACE,cAAC,GAAD,CACElB,WACE,OAAC6gC,QAAD,IAACA,OAAD,EAACA,EAAyBK,qBAC1BN,EAAe5gC,SAEjBygC,sBAAqB,OAAEI,QAAF,IAAEA,OAAF,EAAEA,EAAyBU,2BAChDb,uBAAsB,OAAEG,QAAF,IAAEA,OAAF,EAAEA,EAAyBW,gCAIpDV,GACC,cAAC,GAAD,CAAS1+B,MAAO,CAAEuX,UAAW,SAA7B,SACGinB,EAAea,gBACd,qCACE,wBACE3gC,QAASggC,EAAwBY,cACjC1hC,SAAU8gC,EAAwBa,qBAFpC,yBAKU,IACV,wBACE7gC,QAASggC,EAAwBc,mBACjC5hC,UAAW8gC,EAAwBa,qBACnCv/B,MAAO,CAAEiN,gBAAiB,OAH5B,oCAaXuxB,EAAeiB,oBACd,sBAAKhiC,UAAU,OAAf,kCACwB,IACtB,cAAC,GAAD,CAAci1B,KAAM8L,EAAeiB,mBAAnC,SACGjB,EAAeiB,4B,iDCvIbC,OCKA,SAASA,YAAT,GAAwD,IAAjCthC,EAAgC,EAAhCA,SAAUX,EAAsB,EAAtBA,UAAcR,EAAQ,kBACpE,OACE,+CACMA,GADN,IAEEQ,UAAWC,IACTmC,KAAO,gBAEP,eACApC,GANJ,SASGW,M,UCRDuhC,GAAoB,IAIbC,GAAwB,CACnCpzB,GAAI,oBACJqzB,SAAU,oBACVC,YAAa,wBACbC,OAAQ,gBAACC,EAAD,GAA4C,EAA9BC,wBACI5wB,8BACtB6wB,MAqBOC,GAA2B,CACtC3zB,GAAI,uBACJqzB,SAAU,6BACVC,YAAa,uBACbC,OAAQ,gBAACC,EAAD,GAA+D,IAAjDh7B,EAAgD,EAAhDA,iBACdo7B,EAD8D,EAA9BH,wBACYI,uBAC5CC,EAAaF,EAAkBG,QAAQv7B,GAEvCw7B,EACJJ,EAAkBE,EAAa,IAAMF,EAAkB,GAErDI,GACFA,EAAqB3Q,eAKd4Q,GAA+B,CAC1Cj0B,GAAI,2BACJqzB,SAAU,iCACVC,YAAa,2BACbC,OAAQ,gBAACC,EAAD,GAA+D,IAAjDh7B,EAAgD,EAAhDA,iBACdo7B,EAD8D,EAA9BH,wBACYI,uBAC5CC,EAAaF,EAAkBG,QAAQv7B,GAEvC07B,EACJN,EAAkBE,EAAa,IAC/BF,EAAkBA,EAAkB3hC,OAAS,GAE3CiiC,GACFA,EAAqB7Q,eAKd8Q,GAAqB,CAChCn0B,GAAI,iBACJqzB,SAAU,4BACVC,YAAa,mBACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBACpB,GAAIA,EAAkB,CACpB,IAAM47B,EAAe57B,EAAiB6B,cAEtC7B,EAAiB+B,YAAY,CAC3B1B,EAAGu7B,EAAav7B,EAChBC,EAAGs7B,EAAat7B,EAAIq6B,QAMfkB,GAA+B,CAC1Cr0B,GAAI,2BACJqzB,SAAU,sCACVC,YAAa,6BACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBACpB,GAAIA,EAAkB,CACpB,IAAM47B,EAAe57B,EAAiB6B,cAEtC7B,EAAiB+B,YAAY,CAC3B1B,EAAGu7B,EAAav7B,EAAIs6B,GACpBr6B,EAAGs7B,EAAat7B,EAAIq6B,QAMfmB,GAA8B,CACzCt0B,GAAI,0BACJqzB,SAAU,qCACVC,YAAa,4BACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBACpB,GAAIA,EAAkB,CACpB,IAAM47B,EAAe57B,EAAiB6B,cAEtC7B,EAAiB+B,YAAY,CAC3B1B,EAAGu7B,EAAav7B,EAAIs6B,GACpBr6B,EAAGs7B,EAAat7B,EAAIq6B,QAMfoB,GAAwB,CACnCv0B,GAAI,oBACJqzB,SAAU,+BACVC,YAAa,sBACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBACpB,GAAIA,EAAkB,CACpB,IAAM47B,EAAe57B,EAAiB6B,cAEtC7B,EAAiB+B,YAAY,CAC3B1B,EAAGu7B,EAAav7B,EAAIs6B,GACpBr6B,EAAGs7B,EAAat7B,OAMX07B,GAAuB,CAClCx0B,GAAI,mBACJqzB,SAAU,8BACVC,YAAa,qBACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBACd47B,EAAe57B,EAAiB6B,cAEtC7B,EAAiB+B,YAAY,CAC3B1B,EAAGu7B,EAAav7B,EAChBC,EAAGs7B,EAAat7B,EAAIq6B,OAKbsB,GAAiC,CAC5Cz0B,GAAI,6BACJqzB,SAAU,wCACVC,YAAa,+BACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBACpB,GAAIA,EAAkB,CACpB,IAAM47B,EAAe57B,EAAiB6B,cAEtC7B,EAAiB+B,YAAY,CAC3B1B,EAAGu7B,EAAav7B,EAAIs6B,GACpBr6B,EAAGs7B,EAAat7B,EAAIq6B,QAMfuB,GAAgC,CAC3C10B,GAAI,4BACJqzB,SAAU,uCACVC,YAAa,8BACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBACd47B,EAAe57B,EAAiB6B,cAEtC7B,EAAiB+B,YAAY,CAC3B1B,EAAGu7B,EAAav7B,EAAIs6B,GACpBr6B,EAAGs7B,EAAat7B,EAAIq6B,OAKbwB,GAAuB,CAClC30B,GAAI,mBACJqzB,SAAU,8BACVC,YAAa,qBACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBACpB,GAAIA,EAAkB,CACpB,IAAM47B,EAAe57B,EAAiB6B,cAEtC7B,EAAiB+B,YAAY,CAC3B1B,EAAGu7B,EAAav7B,EAAIs6B,GACpBr6B,EAAGs7B,EAAat7B,OAMX87B,GAAoB,CAC/B50B,GAAI,gBACJqzB,SAAU,2BACVC,YAAa,kBACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBAChBA,GACFA,EAAiBkgB,WAKVmc,GAAyB,CACpC70B,GAAI,qBACJqzB,SAAU,gCACVC,YAAa,qBACbC,OAAQ,gBAACC,EAAD,GAA4C,EAA9BC,wBAEjBI,uBACAnsB,SAAQ,SAAAlP,GAAgB,OAAIA,EAAiBkgB,cAIvCoc,GAAqB,CAChC90B,GAAI,iBACJqzB,SAAU,4BACVC,YAAa,mBACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBAChBA,GACFA,EAAiBigB,YAKVsc,GAA0B,CACrC/0B,GAAI,sBACJqzB,SAAU,iCACVC,YAAa,sBACbC,OAAQ,gBAACC,EAAD,GAA4C,EAA9BC,wBAEjBI,uBACAnsB,SAAQ,SAAA0iB,GAAU,OAAIA,EAAW3R,eAI3Buc,GAAsB,CACjCh1B,GAAI,kBACJqzB,SAAU,yBACVC,YAAa,oBACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBAChBA,GACFA,EAAiB+D,aAKV04B,GAAsB,CACjCj1B,GAAI,kBACJqzB,SAAU,yBACVC,YAAa,oBACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBAChBA,GACFA,EAAiBwF,aAKVk3B,GAAqB,CAChCl1B,GAAI,iBACJqzB,SAAU,wBACVC,YAAa,mBACbC,OAAQ,gBAACC,EAAD,GAAsC,IAAxBh7B,EAAuB,EAAvBA,iBAChBA,GACFA,EAAiBgE,YAeV24B,GAAoB,CAC/Bn1B,GAAI,oBACJqzB,SAAU,2BACVC,YAAa,8BACbC,OAAO,WAAD,8BAAE,iBAAOC,EAAP,mBAAAxkC,EAAA,oEAAoBwJ,EAApB,EAAoBA,kBAApB,gCAEEA,EAAiB0F,UAFnB,iDAAF,4DAAC,IA2BIk3B,GAA6B,CACxCp1B,GAAI,mBACJqzB,SAAU,8CACVC,YAAa,gCACbC,OAAO,WAAD,8BAAE,kBAAOC,EAAP,aAAAxkC,EAAA,kEAAoBqmC,kBACRx/B,oBAAoBa,KADhC,kDAAF,4DAAC,IAKI4+B,GAA4B,CACvCt1B,GAAI,kBACJqzB,SAAU,6CACVC,YAAa,+BACbC,OAAO,WAAD,8BAAE,kBAAOC,EAAP,aAAAxkC,EAAA,kEAAoBqmC,kBACRx/B,oBAAoByG,KADhC,kDAAF,4DAAC,IAKIi5B,GAAiC,CAC5Cv1B,GAAI,uBACJqzB,SAAU,kDACVC,YAAa,oCACbC,OAAO,WAAD,8BAAE,kBAAOC,EAAP,aAAAxkC,EAAA,kEAAoBqmC,kBACRx/B,oBAAoByiB,KADhC,kDAAF,4DAAC,ICvUYkd,G,oHACnB,6CAAsB,IAAD,kFAAN11B,EAAM,yBAANA,EAAM,iBACnB,+BAASA,KAEJiG,SAAS,wCAEd,EAAK1O,SAAS,CACZo+B,YAAa,KACbC,sBAAuB,OAGzB,EAAKC,yBAA2B,EAAK9lB,gBACnC+lB,MAGF,EAAKC,mBAAqB,EAAKhmB,gBAAgBimB,KAG/C,EAAKC,UAAY,GAIjB,cAAwB/9B,OAAOC,KAAK+9B,GAApC,eAA+C,CAA1C,IAAMC,EAAS,KACZC,EAAUF,EAASC,GAEzB,EAAKE,gBAAgBD,GAxBJ,S,gFA+BrB,SAAAE,cACE,OAAO/mC,KAAK0mC,Y,6BAId,SAAAI,gBAAgBD,GAKkB,kBAArBA,EAAQ7C,WACjB6C,EAAQ7C,SAAW6C,EAAQ7C,SAASgD,MAAM,MAG5ChnC,KAAK0mC,UAAUG,EAAQl2B,IAAMk2B,I,8BAI/B,SAAAI,iBAAiBL,GACf,OAAO5mC,KAAK0mC,UAAUE,K,4BAIxB,SAAAM,iBACE,OAAOlnC,KAAKiO,WAAWm4B,c,sCASzB,SAAAe,2BACE,OAAOnnC,KAAKiO,WAAWo4B,wB,kEAKzB,iBAAkBQ,GAAlB,gCAAAlnC,EAAA,sEAA2BynC,EAA3B,+BAAoC,IACtBj+B,mBACJsK,EACJzT,KAAKsmC,yBAAyBe,4BAM9BD,EAAOj+B,iBADLsK,IAGF,UACEzT,KAAKsmC,yBAAyB9B,8BADhC,aACE,EAAuD,KAI7D4C,EAAOhD,wBAA0BpkC,KAAKsmC,yBACtCc,EAAOpB,kBAAoBhmC,KAAKwmC,mBAKhCxmC,KAAKgI,SAAS,CACZo+B,YAAaS,EACbR,sBAAuBiB,0BAxB3B,kBA4BST,EAAQ3C,OAAOlkC,KAAMonC,IA5B9B,sD,wGAvE6DrtB,MCThDosB,MCIF3V,GAAkB,6BCJhB+W,GDMqB,CAClC52B,GAAI6f,GACJ1pB,MAAO,6BACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV0R,eAAgB,CAACqwB,GAAmCI,MACpD1wB,KAAM,SAAS2Y,KAAT,GAAkD,IAAlCpY,EAAiC,EAAjCA,YAAajN,EAAoB,EAApBA,iBAEjC,EAAiD1F,mBAAS,MAA1D,mBAAO+jC,EAAP,KAAyBC,EAAzB,KAGAlmC,qBAAU,WACJimC,GAMFA,EAAiBptB,WAAWA,WAAW+P,SAAS,CAC9CC,IAAKod,EAAiB/7B,UAAY,GAClC4e,KAAMmd,EAAiBj8B,WAAa,OAGvC,CAACi8B,IAEJ,MACE/jC,mBAAS,MADX,mBAAOikC,EAAP,KAAiCC,EAAjC,KAGMC,EAA4B,OAAGF,QAAH,IAAGA,OAAH,EAAGA,EAA0B92B,UAEzDi3B,EAAiBzxB,EAAY+vB,IAC7B2B,EAAWD,EAAed,cAC1BX,EAAcyB,EAAeX,iBAE7B9C,EAA0BhuB,EAAYmwB,MAEtCwB,EADc3D,EAAwB4D,iBAEzCxyB,KAAI,SAAAC,GAAU,MAAK,CAClBA,aACAtM,iBAAkBsM,EAAW0T,0BAE9BhS,QAAO,SAAA8wB,GAAG,OAAIA,EAAI9+B,oBAQf++B,EAAqCjgC,uBACzC,SAAAR,GACE,IAAM2R,EAAO3R,EAAIC,OAAO0L,MAElBjK,EACJi7B,EAAwB+D,4BAA4B/uB,GAEtDuuB,EAA6Bx+B,KAE/B,CAACi7B,IAGG3wB,EACJ2wB,EAAwBiD,4BAsB1B,OAnBA9lC,qBAAU,WACR,IAAImmC,EAEAj0B,GAA0Bs0B,EAA4BnlC,OAAS,EAI7D6Q,IAA2BtK,IAC7Bu+B,EAA2Bj0B,GAG7Bi0B,EAA2Bv+B,EAGzBu+B,GACFC,EAA6BD,KAE9B,CAACj0B,EAAwBtK,EAAkB4+B,IAG5C,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,cAACxrB,GAAA,EAAD,CAAQC,aAAW,EAAnB,SACE,cAAC,GAAD,UACG7T,OAAOgP,OAAOmwB,GAAUtyB,KAAI,SAAAqxB,GAC3B,IAAMuB,EAAmBvB,IAAYT,EAErC,OACE,qBACEzkC,IAAK,aAAA2J,GAAE,OAAI88B,GAAoBX,EAAqBn8B,IAEpDnH,MAAO,CACLiG,MAAO,IACPhG,OAAQ,IACR6hB,OAAQ,iBACRC,aAAc,EACdgK,OAAQ,EACR5T,QAAS,eACTZ,UAAW,OACXtK,gBAAiBg3B,EAAmB,QAAU,MAXlD,SAcE,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,eAAC,GAAD,CAASjkC,MAAO,CAAE0wB,UAAW,QAA7B,UACE,8BAAMgS,EAAQ5C,cAEd,qBACE9/B,MAAO,CACLuvB,UAAW,SACX/T,SAAU,OACVD,UAAW,GAJf,SAOGmnB,EAAQ7C,SAASqE,KAAK,YAI7B,cAAC1jC,OAAD,CAAQR,MAAO,CAAEuX,UAAW,SAA5B,SACE,wBACE7Y,QAAS,0BACPglC,EAAeS,YAAYzB,EAAS,CAClC19B,iBAAkBu+B,KAGtBvjC,MAAO,CACL+rB,OAAQ,GAPZ,SAUG2W,EAAQl2B,WAvCVk2B,EAAQl2B,aAiDzB,eAAChM,OAAD,WACE,uBACA,cAAC,GAAD,UACE,eAAC4X,GAAA,EAAD,WACE,uEACA,yBACER,SAAUmsB,EACV90B,MAAOw0B,EAFT,UAIE,qDACCG,EAA4BvyB,KAC3B,WAAyCqD,GAAzC,IAAqB1P,EAArB,EAAqBA,iBAArB,OACE,wBAAkBiK,MAAOjK,EAAiByH,UAA1C,SACGzH,EAAiBgF,YADP0K,sBEtKlBlU,OCMA,SAASA,mCACtB,OACE,cAAC,OAAD,UACE,cAAC,GAAD,CAASR,MAAO,CAAEuX,UAAW,UAA7B,SACE,eAAC,GAAD,WACE,cAAC,GAAD,CAAe/K,GAAIuqB,KAEnB,cAAC,GAAD,CACEvqB,GAAI43B,GACJzhC,MAAM,6B,kBCZZ0hC,GAAoB,UACpBC,GAA2B,gBAE3BC,GAA+B,kBAKhBC,G,wHAInB,6CAAYC,GAAsD,IAAD,IAA9BC,EAA8B,uDAAhB,MAAgB,uDAC/D,IAAMC,GAAM,oBACTN,GADS,oBACwBK,EADxB,wBAETJ,GAFS,8CAEyDI,EAFzD,aAMZ,IAAKD,EACH,MAAM,IAAI34B,eAAe,oCARoC,2BAANQ,EAAM,iCAANA,EAAM,yBAW/D,+BAASA,KAEJiG,SAAL,UAAiBmyB,EAAjB,4BAEA,EAAK7gC,SAAL,gBACG0gC,IAA+B,IAGlC,EAAKK,uBAAyBH,EAC9B,EAAKI,QAAUF,EAEf,EAAKG,iBAAmB,EAAKzoB,gBAAgBC,MAG7C,EAAKyoB,0BACH,EAAKD,iBAAiBvoB,8BAIxB,EAAKyoB,qBAML,EAAKC,QAAQ,EAAKH,iBAAkBz6B,MAAa,WAC/C,EAAK26B,wBArCwD,E,4HA+CjE,iBAAmBE,GAAnB,UAAA1pC,EAAA,+EACQK,KAAKkpC,0BAA0B7nB,QACnCrhB,KAAK+oC,uBACLM,GAHJ,OAMErpC,KAAKgI,SAAL,gBAAiB0gC,GAA+B3oC,QAAQspC,KAN1D,sD,6IAgBA,oCAAA1pC,EAAA,gFAC0BK,KAAKkpC,0BAA0B5nB,UACrDthB,KAAK+oC,wBAFT,cACQO,EADR,OAMEtpC,KAAKgI,SAAL,gBAAiB0gC,GAA+B3oC,QAAQupC,KAN1D,kBAQSA,GART,uD,yGAgBA,SAAA5F,qBACE,OAAO1jC,KAAKiO,WAAL,kB,oEAWT,oCAAAtO,EAAA,gFAEqBK,KAAKmpC,qBAF1B,YAEME,EAFN,iDAOWA,GAPX,uBAWiBrpC,KAAKwgB,gBAClBoH,IACA2hB,mBAAmB,CACnBvnC,MAAOhC,KAAKgpC,QAAL,UAdX,UAmBiB,QARfK,EAXF,kDAoBW,MApBX,YAyBMA,EAzBN,kCA2BUrpC,KAAKwpC,aAAaH,GA3B5B,iCA6BWA,GA7BX,iCAgCWrpC,KAAKyjC,iBAhChB,wD,6IAyCA,8BAAA9jC,EAAA,gFAEYK,KAAKwgB,gBAAgBoH,IAAsB0B,QACjDtpB,KAAKgpC,QAAL,eAHN,kFASQhpC,KAAKkpC,0BAA0BO,WACnCzpC,KAAK+oC,wBAVT,OAaE/oC,KAAKgI,SAAL,gBAAiB0gC,IAA+B,IAblD,uD,gHAxI+D3uB,M,UCQ5C2vB,G,wGAUnB,qCAAYC,GAAgD,IAAD,4EAANl5B,EAAM,iCAANA,EAAM,kBAczD,IAbA,+BAASA,KAEJm5B,yBAA2B,EAAKppB,gBACnCmpB,GAKF,EAAKP,QAAQ,EAAKQ,yBAA0Bp7B,MAAa,SAAAq7B,GAAI,OAC3D,EAAK5pC,KAAKuO,KAAaq7B,QAMrB,EAAKD,oCACLjB,IAGF,MAAM,IAAIngC,UACR,4FArBqD,OAyBzD,EAAKR,SAAS,CACZlI,cAAc,EACdM,aAAa,EACb0pC,eAAe,EACfvpC,eAAe,EACfiiC,sBAAuB,KACvBC,uBAAwB,KACxBsH,sBAAsB,IAIxB,EAAKC,YAAc,KAEnB,EAAKvqC,uBAAL,wBAA4B,6BAAAE,EAAA,mEACtB,EAAKqqC,YADiB,gCAElB,EAAKA,YAAYn7B,UAFC,kDAO5B,EAAKnE,GAAG8D,MAAa,WAAwB,IAAvBtG,EAAsB,uDAAP,GACnC,GAAIA,EAAa4hC,cAAe,CAC9B,IAAMG,EAA4B,SAA5BA,4BACJ,EAAKjiC,SAAS,CACZlI,aAAc,EAAKkqC,YAAY9pC,kBAC/BE,YAAa,EAAK4pC,YAAY3pC,oBAIlC,EAAK+oC,QACH,EAAKY,YACLvrC,KACAwrC,GAEF,EAAKb,QACH,EAAKY,YACLtrC,KACAurC,GAEF,EAAKb,QACH,EAAKY,YACLrrC,KACAsrC,GAGF,EAAKb,QAAQ,EAAKY,YAAaprC,MAAqB,WAClD,EAAKoJ,SAAS,CAAEzH,eAAe,OAGjC,EAAK6oC,QAAQ,EAAKY,YAAanrC,MAAmB,WAChD,EAAKmJ,SAAS,CAAEzH,eAAe,OAGjC,EAAK6oC,QAAQ,EAAKY,YAAalrC,MAA+B,SAAA4B,GAC5D,EAAKsH,SAAS,CAAEw6B,sBAAuB9hC,OAGzC,EAAK0oC,QAAQ,EAAKY,YAAajrC,MAA6B,SAAA2B,GAC1D,EAAKsH,SAAS,CAAEy6B,uBAAwB/hC,IAGxC,EAAKT,KAAKlB,KAA6B2B,UAM7C,EAAKwpC,0BAA4B,EAAK1pB,gBACpCqB,IA7FuD,E,yFAsG3D,SAAAsoB,6BACE,OAAOnqC,KAAK4pC,2B,mCASd,SAAAQ,wBACE,MAAM,IAAIxqC,MAAM,8C,6BAQlB,SAAAM,kBACE,OAAOF,KAAKiO,WAAWnO,e,4BAQzB,SAAAO,iBACE,OAAOL,KAAKiO,WAAW7N,c,8BAQzB,SAAA6iC,mBACE,OAAOjjC,KAAKiO,WAAW67B,gB,sCAWzB,SAAAxG,2BACE,OAAOtjC,KAAKiO,WAAWu0B,wB,uCAQzB,SAAAe,4BACE,OAAOvjC,KAAKiO,WAAWw0B,yB,8BAQzB,SAAAjiC,mBACE,OAAOR,KAAKiO,WAAW1N,gB,wEAIzB,kBAAwBtB,EAAaorC,GAArC,UAAA1qC,EAAA,sEACQ,IAAIC,MAAM,wCADlB,kD,kJAUA,2DAAAD,EAAA,mEAAuB0qC,EAAvB,+BAA0C,IACpCrqC,KAAKgqC,YADX,gCAEUhqC,KAAKgqC,YAAYn7B,UAF3B,UAKE7O,KAAKC,KAAKxB,OAEN6rC,EACFtqC,KAAKkqC,0BAA0BnnB,uBAINngB,OAZ7B,gCAaU5C,KAAKwgB,gBACToH,IACA2iB,sCAfN,WAkBED,EACEtqC,KAAKkqC,0BAA0BnnB,uBAINngB,OAvB7B,uBAwBU,IAAIhD,MAAM,4CAxBpB,eA4BQ4qC,EAASF,EAAsB,GAAGlkB,uBA5B1C,UA8B2BpmB,KAAKyqC,kBAAkBD,EAAQH,GA9B1D,QA8BErqC,KAAKgqC,YA9BP,OAgCEhqC,KAAKgI,SAAS,CAAE8hC,eAAe,IAE/B9pC,KAAKgqC,YAAYvqC,wBAAuB,WAGtC,EAAKuI,SAAS,CACZlI,cAAc,EACdM,aAAa,EACb0pC,eAAe,EACfvpC,eAAe,EACfiiC,sBAAuB,KACvBC,uBAAwB,UA3C9B,wD,6IAqDA,8BAAA9iC,EAAA,oEACMK,KAAKgqC,YADX,gCAEUhqC,KAAKgqC,YAAYn7B,UAF3B,uD,2GAeA,SAAAw0B,wBAAwB0G,GACtB/pC,KAAKgI,SAAS,CAAE+hC,qBAAsBhqC,QAAQgqC,O,qCAWhD,SAAA3G,0BACE,OAAOpjC,KAAKiO,WAAW87B,uB,iCAUzB,SAAAjH,sBACE,OAAQ9iC,KAAKgqC,YAAkBhqC,KAAKgqC,YAAYrW,oBAArB,M,6BA9R0B5Z,MCbpC2wB,G,oHACnB,6CAAsB,IAAD,kFAANj6B,EAAM,yBAANA,EAAM,uBACnB,+BAASA,KAGJhR,wBAAuB,kBAAM,EAAKkrC,wBAJpB,E,6EAarB,SAAAC,SAAShI,GAA0B,IAAD,OAKhC,KAAMA,aAAmC8G,IACvC,MAAM,IAAIlhC,UACR,gEAWJ,OAJAxI,KAAKopC,QAAQxG,EAAyB7jC,MAA6B,SAAA8qC,GACjE,EAAK5pC,KAAKlB,KAA6B,CAAC6jC,EAAyBiH,OAG5D,kGAAejH,K,gDAMxB,SAAAiI,mCAAmCjI,GACjC,OAAO5iC,KAAK4qC,SAAShI,K,yCASvB,SAAAkI,8BACE,OAAO9qC,KAAKs8B,kB,mCAjD+Cjf,qBCNzD0tB,GAAMvR,EAAQ,KASCwR,G,0FAMnB,8BAAY/rC,EAAagsC,EAAiB/rC,GAAU,IAAD,kDACjD,cAAMD,EAAaC,IAEdgsC,iBAAmBD,EAGxB,EAAKE,gBAAkB,SACvB,EAAKC,2BAA6B,QAElC,EAAKpB,YAAc,KACnB,EAAKvqC,wBAAuB,kBAAM,EAAKC,sBAVU,E,yEAmBnD,SAAA2rC,oBACE,OAAOrrC,KAAKmrC,kB,oCAQd,SAAAG,yBACE,OAAOtrC,KAAKurC,uB,uEAMd,6BAAA5rC,EAAA,+DACMK,KAAKgqC,cACPhqC,KAAKgqC,YAAYwB,iCAEjBxrC,KAAKgqC,YAAYyB,QAEjBzrC,KAAKgqC,YAAc,MANvB,sD,+IAmBA,iDAAArqC,EAAA,oEACMK,KAAKgqC,YADX,gCAEUhqC,KAAKN,mBAFf,OAKEM,KAAKH,kBAAiB,GAEhB2qC,EAASxqC,KAAKV,cAEdosC,EAAeX,GAAIY,aAAaC,iBACpC5rC,KAAKkrC,iBACLlrC,KAAKmrC,kBAGMU,0BAA4B7rC,KAAKorC,2BAExCU,EAAcf,GAAIgB,YAAYC,gBAAgBxB,GAE9CyB,EAAa,IAAIlB,GAAImB,iBAAiBR,EAAcI,GAC1D9rC,KAAKgqC,YAAciC,EAIjBA,EAAWE,YAAc,SAACC,EAAGC,GAU3B,EAAKxY,IAAIyY,MAAT,4BAAoCD,EAAEE,OAAO7rC,OAE7C,EAAKD,0BAA0B4rC,EAAEE,OAAO7rC,OAG1CurC,EAAWO,WAAa,SAACJ,EAAGC,GACtBA,EAAEE,OAAOE,SAAW1B,GAAI2B,aAAaC,kBACvC,EAAKhsC,2BAA2B0rC,EAAEE,OAAO7rC,MAEzC,EAAKmzB,IAAIyY,MAAT,2BAAmCD,EAAEE,OAAO7rC,QACnC2rC,EAAEE,OAAOE,SAAW1B,GAAI2B,aAAaE,UAC9C,EAAKtsC,mBAAkB,GAEvB,EAAKuzB,IAAIyY,MAAM,8CAInBL,EAAWY,SAAX,yCAAsB,kBAAOT,EAAGC,GAAV,UAAA1sC,EAAA,uEACpB,EAAKW,mBAAkB,GAEvB,EAAKuzB,IAAIyY,MAAT,2BAAmCD,EAAEI,SAEjCJ,EAAEI,SAAW1B,GAAI+B,mBAAmBltC,QACtC,EAAKi0B,IAAIyY,MAAT,+BAAuCD,EAAEU,YACzC,EAAKlZ,IAAIyY,MAAT,kCAA0CD,EAAEW,eAC5C,EAAKnZ,IAAIyY,MACP,+DAMJL,EAAWT,iCAfS,kBAmBb,EAAK38B,WAnBQ,kDAAtB,wDAsBAo9B,EAAWgB,eAAiB,SAACb,EAAGC,GAC9B,EAAKxY,IAAIyY,MAAM,yBACfL,EAAWT,kCAIbS,EAAWiB,kCA9Ef,wD,gGA5DgDluC,MCT5CmuC,GAAiD,aAQlCC,G,0HACnB,gDAAsB,mFAAP38B,EAAM,yBAANA,EAAM,4CAEjB08B,GACA,sBAHiB,OAId18B,I,6CALyDk4B,ICD7C0E,G,wGAEnB,uCAAsB,IAAD,4EAAN58B,EAAM,yBAANA,EAAM,uBACnB,uBAAM28B,IAAN,OAA+C38B,KAE1CiG,SAAS,kCAHK,E,oFAYrB,SAAA0zB,wBACE,MAAO,kF,wEAQT,iBAAwBnrC,EAAxB,mBAAAU,EAAA,sEAAuCsrC,EAAvC,EAAuCA,gBAAvC,kBACS,IAAID,GAAqB/rC,EAAagsC,IAD/C,iD,kJASA,oCAAAtrC,EAAA,gFACgCK,KAAK4pC,yBAAyBnG,gBAD9D,cACQwH,EADR,6HAGgC,CAAEA,qBAHlC,uD,sGAhCuDvB,ICP1C2D,MCOMC,G,kGAMnB,kCAAYruC,EAAaoqC,EAAQnqC,GAAU,IAAD,sDACxC,cAAMD,EAAaC,IAEdquC,QAAUlE,EACf,EAAKmE,gBAAkB,KACvB,EAAKC,eAAiB,KAEtB,EAAKhuC,wBAAuB,kBAAM,EAAKC,sBAPC,E,qHAe1C,6BAAAC,EAAA,+DACMK,KAAKytC,iBACPztC,KAAKytC,eAAeC,OAEpB1tC,KAAKytC,eAAiB,MAGpBztC,KAAKwtC,kBACPxtC,KAAKwtC,gBAAgB/B,QAErBzrC,KAAKwtC,gBAAkB,MAV3B,sD,+IAuBA,yCAAA7tC,EAAA,gFAEQK,KAAKN,mBAFb,OAIEM,KAAKH,kBAAiB,GAEtBG,KAAKwtC,gBAAkB,IAAIG,UAzDF,mCAyDkC,CACzD,QACA3tC,KAAKutC,UAGPvtC,KAAKytC,eAAiB,IAAIG,cAAc5tC,KAAKV,aAAc,CACzDuuC,SAAU,eAGZ7tC,KAAKwtC,gBAAgB/rC,iBAAiB,QAAQ,WAC5C,EAAKtB,iBAAgB,GAErB,EAAKstC,eAAehsC,iBAAiB,iBAAiB,SAAA4N,GAAU,IAAD,EACzDA,EAAMw6B,KAAK1d,KAAO,GAA0C,KAArC,YAAKqhB,uBAAL,eAAsBM,aAC/C,EAAKN,gBAAgBO,KAAK1+B,EAAMw6B,SAKpC,EAAK4D,eAAeO,MAAM,KAE1B,EAAKR,gBAAgB/rC,iBAAiB,WAAW,SAAAwsC,GAC/C,IAAMC,EAAW/lC,KAAKC,MAAM6lC,EAAQpE,MAE9BsE,EAAaD,EAASE,QAAQC,aAAa,GAAGF,WAEhDA,GAAcD,EAASI,SACzB,EAAK3tC,2BAA2BwtC,GAEhC,EAAK1tC,0BAA0B0tC,MAInC,EAAKX,gBAAgB/rC,iBAAiB,SAAS,kBAAM,EAAKoN,gBAvC9D,uD,oGA5CoD7P,MCPhDmuC,GAAiD,iBAKlCoB,G,gHACnB,2CAAsB,8EAAP99B,EAAM,yBAANA,EAAM,4CAEjB08B,GACA,gBAHiB,OAId18B,I,wCALoDk4B,ICExC6F,G,gHAEnB,2CAAsB,IAAD,gFAAN/9B,EAAM,yBAANA,EAAM,uBACnB,uBAAM89B,IAAN,OAA0C99B,KAErCiG,SAAS,sCAHK,E,wFAYrB,SAAA0zB,wBACE,MAAO,0B,wEAQT,iBAAwBnrC,EAAxB,mBAAAU,EAAA,sEAAuC0pC,EAAvC,EAAuCA,OAAvC,kBACS,IAAIiE,GAAyBruC,EAAaoqC,IADnD,iD,kJASA,oCAAA1pC,EAAA,gFACuBK,KAAK4pC,yBAAyBnG,gBADrD,cACQ4F,EADR,iIAGgC,CAAEA,YAHlC,uD,0GAhC2DK,ICP9C8E,MCWMC,G,oHASnB,6CAAsB,IAAD,kFAANh+B,EAAM,yBAANA,EAAM,uBACnB,+BAASA,KAEJiG,SAAS,wCAEd,EAAKg4B,mCAAqC,EAAKvsB,oBAC7CuoB,IAOF,EAAKtB,QACH,EAAKsF,mCACL3vC,MACA,SAAA2B,GAAI,OAAI,EAAKT,KAAKlB,KAA6B2B,MAGjD,EAAKiuC,gCAAgCtB,IACrC,EAAKsB,gCAAgCH,IApBlB,E,oGA2BrB,SAAAG,gCAAgCC,GAE9B,IAAMC,EAAkC7uC,KAAKwgB,gBAC3CouB,GAGF5uC,KAAK0uC,mCAAmC7D,mCACtCgE,K,yCAUJ,SAAA/D,8BACE,OAAO9qC,KAAK0uC,mCAAmCpS,kB,mCAtDYviB,MCRhD00B,MCSMK,G,8GAGnB,0CAAsB,IAAD,+EAANr+B,EAAM,yBAANA,EAAM,uBACnB,+BAASA,KAEJiG,SAAS,2CAEd,EAAKq4B,0BAA4B,EAAKvuB,gBACpC2lB,IAIF,EAAK6I,mCAAqC,EAAKxuB,gBAC7CiuB,IAIF,EAAKrF,QACH,EAAK4F,mCACLjwC,MACA,YAAsC,IAAD,mBAAnC6jC,EAAmC,KAAVliC,EAAU,KAC/BkiC,EAAwBQ,2BAC1B,EAAK6L,6BAA6BvuC,MApBrB,E,uIA6BrB,iBAAmCA,GAAnC,wBAAAf,EAAA,kEAEQuvC,EAAiBxuC,EAAKyuC,cAAcC,QAAQ,eAAgB,IAE5DC,EAAQH,EAAelI,MAAM,KAI7BsI,EAAmB3mC,OAAOgP,OAC9B3X,KAAK+uC,0BAA0BhI,eAE9BvxB,KAAI,SAAAqxB,GACH,IAIM0I,EAJeF,EAAMl4B,QAAO,SAAAq4B,GAAI,OACpC3I,EAAQ7C,SAAS9zB,SAASs/B,MAGE5sC,OAE9B,MAAO,CACLikC,UACA0I,eAGHp4B,QAAO,qBAAGo4B,cAGPE,EAA2BH,EAAiBI,QAAO,SAAC/vC,EAAGgwC,GAC3D,OAAKhwC,GAAKgwC,EAAEJ,SAAW5vC,EAAE4vC,UAEdI,EAAEJ,WAAa5vC,EAAE4vC,UAGtBI,EAAE9I,QAAQ7C,SAASphC,OAASjD,EAAEknC,QAAQ7C,SAASphC,OAJ5C+sC,EAUAhwC,IAER,OAxCL,uBA2CUknC,EAAU4I,EAAyB5I,QA3C7C,SA6CU7mC,KAAK+uC,0BAA0BzG,YAAYzB,GA7CrD,sD,sHAhC0D9sB,MCZ7C61B,GCsBY,CACzBj/B,GAL6B,mBAM7B7J,MAAO,mBACP3C,MAAO,CACLiG,MAAO,IACPhG,OAAQ,KAEV8R,aAAa,EACbJ,eAAgB,CACd24B,GACAoB,GACA1J,IAKFtwB,KAAM,SAAS2Y,KAAT,GAAgC,IAG9BshB,EAH6B,EAAf15B,YACkBq4B,IAGlB3D,8BAIdiF,EAA6BxoC,mBAAQ,WACzC,IAAMyoC,EAAYF,EAA0Bt6B,KAC1C,SAAAotB,GAAuB,MAAK,CAC1B97B,MAAO87B,EAAwBz0B,WAC/By0B,0BACAC,wBACED,EAAwBuH,6BAC1BpoC,UAAU,EACVyhC,gBAAgB,EAChBI,mBAAoBhB,EAAwBwH,4BAgBhD,OAXA4F,EAAUrtC,KAAK,CACbmE,MAAO,mCACP87B,wBAAyB,KACzBC,wBAAyB,KACzB9gC,UAAU,EACVyhC,gBAAgB,EAChBI,mBACE,qEACFZ,OAAQ,oBAGHgN,IACN,CAACF,IAEJ,OACE,eAAC,EAAD,WACE,cAAC,gBAAD,UACE,cAACrrC,EAAA,EAAD,CAAMN,MAAO,CAAE0wB,UAAW,QAA1B,SACE,eAAC,GAAD,WACE,8DAEA,mBAAGjzB,UAAU,OAAb,4EAICmuC,EAA2Bv6B,KAAI,SAAAy6B,GAAQ,OACtC,cAAC,GAAD,CAEEtN,eAAgBsN,GADXA,EAASnpC,UAKlB,cAAC,GAAD,UACE,eAACyV,GAAA,EAAD,WACE,cAAC,GAAD,CAASpY,MAAO,CAAEsY,WAAY,QAA9B,kFAIA,cAAC,GAAD,UACE,cAAC,GAAD,CAAoBoa,KC9F/B,sDD8FW,sCASZ,cAAC,GAAD,SE5GOqZ,UCmBA,SAASC,mBACtB,OACE,cAAC,GAAD,CACEh4B,eAAgB,CACdsY,GACAwE,GACA2C,GACAM,GACAe,GACAK,GACAgE,GACAU,GACAxB,GACA9H,GACA+E,GACAqB,GACAmG,GACAe,GAEA4N,GACArI","file":"static/js/6.b8f24043.chunk.js","sourcesContent":["import PhantomCore, { EVT_BEFORE_DESTROY, EVT_DESTROYED } from \"phantom-core\";\n\nexport const EVT_CONNECTING = \"connecting\";\nexport const EVT_CONNECTED = \"connected\";\nexport const EVT_DISCONNECTED = \"disconnected\";\n\nexport const EVT_BEGIN_RECOGNIZE = \"begin-recognize\";\nexport const EVT_END_RECOGNIZE = \"end-recognize\";\n\n// Emits with the current text being recognized\n// TODO: Document that this emits with text\nexport const EVT_TRANSCRIPTION_RECOGNIZING = \"transcription-recognizing\";\n\n// TODO: Document that this emits with text\nexport const EVT_TRANSCRIPTION_FINALIZED = \"transcription-finalized\";\n\nexport { EVT_BEFORE_DESTROY, EVT_DESTROYED };\n\n// TODO: Ensure this automatically stops when the input stops or after a\n// certain amount of time\n\nexport default class SpeechRecognizerBase extends PhantomCore {\n  // FIXME: (jh) Force to be extended (relates to: https://github.com/zenOSmosis/phantom-core/issues/149)\n\n  /**\n   * @param {MediaStream} mediaStream // FIXME: (jh) or MediaStreamTrack?\n   * @param {Object} options? [default = {}]\n   */\n  constructor(mediaStream, options) {\n    super(options);\n\n    /**\n     * Whether or not the speech engine is connecting\n     *\n     * @type {boolean}\n     */\n    this._isConnecting = false;\n\n    /**\n     * Whether or not the speech engine is connected\n     *\n     * @type {boolean}\n     **/\n    this._isConnected = false;\n\n    /**\n     * Whether or not the speech engine is currently recognizing (otherwise\n     * known as voice activity detection [or VAD])\n     *\n     * @type {boolean}\n     **/\n    this._isRecognizing = false;\n\n    // TODO: Automatically destroy if the media stream stops (may need to make\n    // an API in media-stream-controller)\n    this._mediaStream = mediaStream;\n\n    // Automatically start recognizing (allow events to be bound first)\n    setImmediate(() => {\n      this._startRecognizing();\n    });\n\n    this.registerCleanupHandler(() => this._stopRecognizing());\n  }\n\n  /**\n   * Instantiates the speech engine servicing and binds its lifecycle to this\n   * class.\n   *\n   * @return {Promise<void>}\n   */\n  async _startRecognizing() {\n    throw new Error(\"_startRecognizing must be overridden\");\n  }\n\n  /**\n   * Instantiates the speech engine servicing and binds its lifecycle to this\n   * class.\n   *\n   * @return {Promise<void>}\n   */\n  async _stopRecognizing() {\n    throw new Error(\"_startRecognizing must be overridden\");\n  }\n\n  /**\n   * Sets whether or not the speech recognizer is connecting.\n   *\n   * @param {boolean} isConnecting\n   */\n  _setIsConnecting(isConnecting) {\n    isConnecting = Boolean(isConnecting);\n\n    if (this._isConnecting !== isConnecting) {\n      this._isConnecting = isConnecting;\n\n      if (isConnecting) {\n        this.emit(EVT_CONNECTING);\n      }\n    }\n  }\n\n  /**\n   * Retrieves whether or not the speeech recognizer is connecting.\n   *\n   * @return {boolean}\n   */\n  getIsConnecting() {\n    return this._isConnecting;\n  }\n\n  /**\n   * Sets whether or not the speech recognizer is connected.\n   *\n   * @param {boolean} isConnected\n   * @emits EVT_CONNECTED\n   * @emits EVT_DISCONNECTED\n   * @return {void}\n   */\n  _setIsConnected(isConnected) {\n    isConnected = Boolean(isConnected);\n\n    if (this._isConnected !== isConnected) {\n      this._setIsConnecting(false);\n\n      this._isConnected = isConnected;\n\n      if (isConnected) {\n        this.emit(EVT_CONNECTED);\n      } else {\n        this.emit(EVT_DISCONNECTED);\n      }\n    }\n  }\n\n  /**\n   * Retrieves whether or not the speech recognizer is connected.\n   *\n   * @return {boolean}\n   */\n  getIsConnected() {\n    return this._isConnected;\n  }\n\n  /**\n   * Sets whether or not the speech recognizer is currently recognizing a\n   * transcription.\n   *\n   * @param {boolean} isRecognizing\n   * @emits EVT_BEGIN_RECOGNIZE\n   * @emits EVT_END_RECOGNIZE\n   * @return {void}\n   */\n  _setIsRecognizing(isRecognizing) {\n    isRecognizing = Boolean(isRecognizing);\n\n    if (this._isRecognizing !== isRecognizing) {\n      this._isRecognizing = isRecognizing;\n\n      if (isRecognizing) {\n        this.emit(EVT_BEGIN_RECOGNIZE);\n      } else {\n        this.emit(EVT_END_RECOGNIZE);\n      }\n    }\n  }\n\n  /**\n   * Retrieves whether or not the speech recognizer is currently recognizing a\n   * transcription.\n   *\n   * @return {boolean}\n   */\n  getIsRecognizing() {\n    return this._isRecognizing;\n  }\n\n  /**\n   * Sets whether or not the speech is currently being recognized.\n   *\n   * @param {string} text\n   * @return {void}\n   */\n  _setRealTimeTranscription(text) {\n    // FIXME: (jh) This is in place as a fallback because I wasn't able to find\n    // an appropriate connect event with Azure\n    this._setIsConnected(true);\n\n    this._setIsRecognizing(true);\n\n    this.emit(EVT_TRANSCRIPTION_RECOGNIZING, text);\n  }\n\n  /**\n   * Sets the finalized speech transcription.\n   *\n   * @param {string} text\n   * @emits EVT_TRANSCRIPTION_FINALIZED\n   * @return {void}\n   */\n  _setFinalizedTranscription(text) {\n    this._setIsRecognizing(false);\n\n    this.emit(EVT_TRANSCRIPTION_FINALIZED, text);\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"layout\":\"Layout_layout__3PvPc\",\"header\":\"Layout_header__3EItT\",\"content\":\"Layout_content__1t8Hf\",\"footer\":\"Layout_footer__3EMQb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"window-outer-border\":\"Window_window-outer-border__3TebC\",\"hidden\":\"Window_hidden__3nppO\",\"maximized\":\"Window_maximized__1kLcW\",\"minimized\":\"Window_minimized__10t2-\",\"dragging\":\"Window_dragging__2Ctk1\",\"window\":\"Window_window__uDx5P\",\"active\":\"Window_active__eAyll\",\"title-bar\":\"Window_title-bar__376LO\",\"title\":\"Window_title__3FnAS\",\"window-controls\":\"Window_window-controls__1ACD5\",\"maximize\":\"Window_maximize__2aW7z\",\"minimize\":\"Window_minimize__hemKn\",\"close\":\"Window_close__38hm-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dock\":\"Dock_dock__XYNmR\",\"overflown\":\"Dock_overflown__1vLoU\",\"horizontal-orientation\":\"Dock_horizontal-orientation__32KfK\",\"content-wrapper\":\"Dock_content-wrapper__3sQLP\",\"dock-item\":\"Dock_dock-item__2wvel\",\"active\":\"Dock_active__1Zqia\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"RowColumn_row__2MIpa\",\"disable-vertical-fill\":\"RowColumn_disable-vertical-fill__YiYeg\",\"column\":\"RowColumn_column__3aAA3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"no-wrap\":\"NoWrap_no-wrap__2b0bc\"};","import React, { useEffect, useRef } from \"react\";\nimport LibControlledMenu, {\n  MenuItem as LibMenuItem,\n  SubMenu as LibSubMenu,\n  MenuDivider as LibMenuDivider,\n  MenuHeader as LibMenuHeader,\n} from \"./_Menu.LibWrapper\";\n\nimport PropTypes from \"prop-types\";\n\nimport classNames from \"classnames\";\n\nMenu.propTypes = {\n  /**\n   * FIXME: (jh) Document structure\n   *\n   * Reference example:\n   * @see {@link https://www.electronjs.org/docs/api/menu#examples}\n   */\n  menuStructure: PropTypes.object.isRequired,\n\n  /** If set to true, the menu will be opened */\n  opened: PropTypes.bool,\n\n  /**\n   * Invoked once the menu opens, or the internal logic determines the menu\n   * should open. The containing component should set \"opened\" as necessary,\n   * depending on this state.\n   **/\n  onOpen: PropTypes.func,\n\n  /**\n   * Invoked once the menu closes, or the internal logic determines the menu\n   * should be closed. The containing component should set \"opened\" as\n   * necessary, depending on this state.\n   **/\n  onClose: PropTypes.func,\n};\n\n/**\n * Wraps react-menu with data structure handling which is mostly compatible\n * with Electron's menu API.\n *\n * @see {@link https://www.electronjs.org/docs/api/menu#examples}\n */\nexport default function Menu({\n  menuStructure,\n  opened = false,\n  onOpen = () => null,\n  onClose = () => null,\n  ...rest\n}) {\n  // Coordinates the button position with the menu\n  const refAnchor = useRef(null);\n\n  // Close menu when screen size changes (menu can go offscreen, or be\n  // incorrectly positioned otherwise)\n  useEffect(() => {\n    // TODO: Use common handler instead\n    window.addEventListener(\"resize\", onClose);\n\n    return () => {\n      window.removeEventListener(\"resize\", onClose);\n    };\n  }, [onClose]);\n\n  return (\n    <>\n      <button\n        ref={refAnchor}\n        {...rest}\n        // Retain non-controlled class for easier styling\n        className={classNames(\n          \"szh-menu-button\",\n          opened && \"szh-menu-button--open\"\n        )}\n        // NOTE: onMouseDown also works on mobile (thanks to React) and fixes\n        // issue where onClick handling would always result in an open state,\n        // never togging off\n        onMouseDown={() => {\n          // NOTE: This setImmediate call fixes an issue with Firefox where\n          // selecting a menu item in the list, then clicking on the menu\n          // button again would not activate the menu button without a double-\n          // click\n          setImmediate(() => {\n            opened ? onClose() : onOpen();\n          });\n        }}\n        disabled={menuStructure.disabled}\n      >\n        {\n          // TODO: Normalize label / role handling\n        }\n        {menuStructure.label || menuStructure.role}\n      </button>\n\n      {\n        // NOTE: useMenuStateHook may be of eventual interest here:\n        // @see https://szhsin.github.io/react-menu/docs#use-menu-state\n      }\n      <LibControlledMenu\n        anchorRef={refAnchor}\n        // NOTE: The controlled menu cannot be initially opened to true (see\n        // related issue: https://github.com/szhsin/react-menu/issues/2#issuecomment-719166062)\n        // This issue was caused by hovering a menu option in a structure\n        // beyond the first (i.e. \"Restore\" in \"Window\" menu), then clicking on\n        // the desktop itself, then re-selecting the window.\n        state={refAnchor.current && opened ? \"open\" : \"closed\"}\n        // NOTE: onClose binds to escape / non-child pointer clicks\n        onClose={onClose}\n        portal={true}\n      >\n        {xChildren(menuStructure)}\n      </LibControlledMenu>\n    </>\n  );\n}\n\n/**\n * Provides dynamic, data-driven children for the given menu structure.\n *\n * NOTE: This function may call itself recursively if there is a child sub\n * menu.\n *\n * IMPORTANT: This is NOT a React component itself.\n *\n * @param {Object} menuStructure\n * @return {React.FC[]}\n */\nfunction xChildren(menuStructure) {\n  const children = [];\n\n  // Every top-level menu has a submenu\n  for (const item of menuStructure.submenu) {\n    if (item.type === \"separator\") {\n      children.push(<LibMenuDivider key={children.length} />);\n      // NOTE: This doesn't seem to conform to Electron's API\n      if (item.label) {\n        children.push(\n          <LibMenuHeader key={children.length}>{item.label}</LibMenuHeader>\n        );\n      }\n    } else {\n      if (item.submenu) {\n        children.push(\n          <LibSubMenu key={children.length} label={item.label}>\n            {xChildren(item)}\n          </LibSubMenu>\n        );\n      } else {\n        /**\n         * @see {@link https://www.electronjs.org/docs/latest/api/menu-item}\n         * @see {@link https://szhsin.github.io/react-menu/docs#menu-item}\n         */\n        children.push(\n          <LibMenuItem\n            key={children.length}\n            onClick={item.click}\n            disabled={item.disabled}\n            checked={item.checked}\n            // FIXME: (jh) Update checkbox handling\n            // @see https://szhsin.github.io/react-menu/docs#menu-item\n            // @see https://www.electronjs.org/docs/latest/api/menu-item\n            type={item.type}\n          >\n            {\n              // TODO: Normalize label / role handling\n            }\n            {item.role || item.label}\n          </LibMenuItem>\n        );\n      }\n    }\n  }\n\n  return children;\n}\n","// Basic wrapper interface around react-menu which the data-driven menu builds\n// on top of.\n\n// @see https://szhsin.github.io/react-menu/#basic-menu\nimport {\n  ControlledMenu as LibControlledMenu,\n  MenuItem,\n  MenuButton,\n  MenuHeader,\n  MenuDivider,\n  SubMenu as LibSubMenu,\n  applyHOC,\n  applyStatics,\n} from \"@szhsin/react-menu\";\nimport \"@szhsin/react-menu/dist/index.css\";\nimport \"@szhsin/react-menu/dist/transitions/slide.css\";\nimport \"./Menu.LibWrapper.css\";\n\nconst COMMON_PROPS = {\n  // Enable menu items to overflow in case they overextend the viewport\n  overflow: \"auto\",\n};\n\nconst ControlledMenu = applyHOC(function Menu({ ...rest }) {\n  return <LibControlledMenu {...rest} portal={true} {...COMMON_PROPS} />;\n}, LibControlledMenu);\n\nconst SubMenu = applyStatics(LibSubMenu)(function SubMenu({ ...rest }) {\n  return <LibSubMenu {...rest} {...COMMON_PROPS} />;\n});\n\n// TODO: Apply HOC and adjust styling as necessary (overflow=\"auto\" prop works\n// on Menu & SubMenu outside of styling)\n// @see https://szhsin.github.io/react-menu/#styles-prop for managing menu\n// styles (maybe not necessary to override CSS manually)\n// @see [HOC example] https://codesandbox.io/s/0bipn\n\nexport default ControlledMenu;\nexport { MenuItem, MenuButton, MenuHeader, MenuDivider, SubMenu };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"padding\":\"Padding_padding__3cEtV\",\"no-siblings\":\"Padding_no-siblings__1nLrM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"system-modal\":\"SystemModal_system-modal__3GtOL\",\"outer-wrap\":\"SystemModal_outer-wrap__1fPfM\",\"inner-wrap\":\"SystemModal_inner-wrap__1k8mt\",\"small-viewport\":\"SystemModal_small-viewport__3gvyy\",\"header\":\"SystemModal_header__37UXg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button-transparent\":\"ButtonTransparent_button-transparent__nu1PF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"levels\":\"AudioLevelMeter_levels__3baNN\",\"level-container\":\"AudioLevelMeter_level-container__12piT\",\"level\":\"AudioLevelMeter_level__2fRqJ\"};","import React, { useEffect, useState } from \"react\";\nimport classNames from \"classnames\";\n\nimport styles from \"./FullViewport.module.css\";\n\n// import PropTypes from \"prop-types\";\n\nexport default function FullViewport({ className, children, ...rest }) {\n  const [elContainer, setElContainer] = useState(null);\n\n  useEffect(() => {\n    if (elContainer) {\n      // Dynamically add .full-viewport to html / body elements\n      document.documentElement.classList.add(styles[\"html-full-viewport\"]);\n      document.body.classList.add(styles[\"body-full-viewport\"]);\n\n      const handleResize = () => {\n        // NOTE: The setImmediate wrap seems to help fix layout issues on iOS\n        // 14 after screen rotation\n        //\n        // FIXME: (jh) Potentially don't run this if the user is typing\n        setImmediate(() => {\n          elContainer.style.height = window.innerHeight + \"px\";\n\n          // Fixes issue on iOS where the content may be behind the URL bar after typing\n          document.body.scrollTop = 0;\n        });\n      };\n\n      // Perform initial size handling\n      handleResize();\n\n      // Bind resize handler\n      // TODO: Use common handler instead\n      window.addEventListener(\"resize\", handleResize);\n\n      // Poll the resize handler every second to help fix layout issues with iOS\n      // const resizeInterval = setInterval(handleResize, 1000);\n\n      return () => {\n        // Dynamically remove .full-viewport from html / body elements\n        document.documentElement.classList.remove(styles[\"html-full-viewport\"]);\n        document.body.classList.remove(styles[\"body-full-viewport\"]);\n\n        // Unbind resize handler\n        window.removeEventListener(\"resize\", handleResize);\n\n        // Stop poll interval\n        // clearInterval(resizeInterval);\n      };\n    }\n  }, [elContainer]);\n\n  return (\n    <div\n      {...rest}\n      ref={setElContainer}\n      className={classNames(styles[\"full-viewport\"], className)}\n    >\n      {children}\n    </div>\n  );\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"html-full-viewport\":\"FullViewport_html-full-viewport__2FFOO\",\"body-full-viewport\":\"FullViewport_body-full-viewport__2_xlv\",\"full-viewport\":\"FullViewport_full-viewport__2RwSj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"auto-scaler\":\"AutoScaler_auto-scaler__zdzsp\",\"content-wrap\":\"AutoScaler_content-wrap__2tFDr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notification-stack\":\"NotificationStack_notification-stack__1UiWO\",\"inner-wrap\":\"NotificationStack_inner-wrap__2Mc0d\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notification\":\"Notification_notification__3v54G\",\"action\":\"Notification_action__3RBsB\",\"main-image-wrap\":\"Notification_main-image-wrap__eqHez\",\"main-image\":\"Notification_main-image__1PfuN\",\"title\":\"Notification_title__2OHSD\",\"body-outer-wrap\":\"Notification_body-outer-wrap__3eJfO\",\"body\":\"Notification_body__1eZc4\",\"close\":\"Notification_close__1O8FQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"virtual-link\":\"VirtualLink_virtual-link__76t27\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"led\":\"LED_led__1cyGI\",\"gray\":\"LED_gray__3hMZV\",\"grey\":\"LED_grey__1_Ool\",\"red\":\"LED_red__2O1gd\",\"orange\":\"LED_orange__1Asac\",\"yellow\":\"LED_yellow__H5_0O\",\"green\":\"LED_green__5BS9Y\",\"blue\":\"LED_blue__fOsqG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sticky\":\"StickyTable_sticky__1r-_g\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"toggle-wrapper\":\"Toggle_toggle-wrapper__1K_Qn\",\"disabled\":\"Toggle_disabled__3_Ejj\",\"toggle\":\"Toggle_toggle__2zmhC\",\"checkbox\":\"Toggle_checkbox__2zOQF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"labeled-toggle\":\"LabeledToggle_labeled-toggle__14B6D\",\"disabled\":\"LabeledToggle_disabled__11klv\",\"cell\":\"LabeledToggle_cell__2ahlq\",\"right\":\"LabeledToggle_right__3UVvj\",\"active\":\"LabeledToggle_active__vC7cP\",\"left\":\"LabeledToggle_left__V16KX\",\"content-row\":\"LabeledToggle_content-row__13-yU\",\"title-row\":\"LabeledToggle_title-row__2_m3u\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-adjuster\":\"ColorAdjuster_color-adjuster__2X490\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"object-viewer\":\"ObjectViewer_object-viewer__8k3ak\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-wrapper\":\"StaggeredWaveLoading_loading-wrapper__35kvv\",\"loading\":\"StaggeredWaveLoading_loading__9ah1x\",\"dot\":\"StaggeredWaveLoading_dot__1cWhz\",\"wave\":\"StaggeredWaveLoading_wave__Du7Gv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"vu\":\"VUMeter_vu__Xlt7R\",\"mask\":\"VUMeter_mask__2OXhL\",\"needle\":\"VUMeter_needle__AmMsB\",\"vu-label\":\"VUMeter_vu-label__3kDDJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"video\":\"Video_video__2GgL9\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"labeled-led\":\"LabeledLED_labeled-led__wOicI\",\"led-wrap\":\"LabeledLED_led-wrap__1c0-2\",\"label-wrap\":\"LabeledLED_label-wrap__1FyWJ\",\"disabled\":\"LabeledLED_disabled__1aKnC\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button-group\":\"ButtonGroup_button-group__3JQ0y\"};","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Header({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"header\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Content({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"content\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Footer({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"footer\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./RowColumn.module.css\";\nimport PropTypes from \"prop-types\";\n\n// @see https://dev.to/drews256/ridiculously-easy-row-and-column-layouts-with-flexbox-1k01\n\nRow.propTypes = {\n  className: PropTypes.string,\n\n  /**\n   * If false, the row will fill up the complete vertical space of its parent.\n   *\n   * Default value = false\n   **/\n  disableVerticalFill: PropTypes.bool,\n};\n\n// TODO: Document\nfunction Row({ children, className, disableVerticalFill = false, ...rest }) {\n  // TODO: Enforce that only Column components are direct descendants of this\n\n  return (\n    <div\n      {...rest}\n      className={classNames(\n        styles[\"row\"],\n        disableVerticalFill && styles[\"disable-vertical-fill\"],\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\n// TODO: Implement prop-types\n/**\n * Evenly-sized column.\n */\nfunction Column({ children, className, ...rest }) {\n  // TODO: Enforce that only Row component is direct parent of this\n\n  return (\n    <div {...rest} className={classNames(styles[\"column\"], className)}>\n      {children}\n    </div>\n  );\n}\n\nexport { Row, Column };\n","import Layout, { Header, Content, Footer, Row, Column } from \"./Layout\";\n\nexport default Layout;\nexport { Header, Content, Footer, Row, Column };\n","import React from \"react\";\nimport Full from \"../Full\";\nimport Header from \"./Header\";\nimport Content from \"./Content\";\nimport Footer from \"./Footer\";\nimport { Row, Column } from \"./RowColumn\";\nimport styles from \"./Layout.module.css\";\nimport classNames from \"classnames\";\n\n// TODO: Add prop-types\n// TODO: Consider renaming; there are unrelated components that deal with Layout as well\nexport default function Layout({ className, children, ...rest }) {\n  return (\n    <Full {...rest} className={classNames(styles[\"layout\"], className)}>\n      {children}\n    </Full>\n  );\n}\n\nexport { Header, Content, Footer, Row, Column };\n","import Layout, { Header, Content, Footer, Row, Column } from \"../Layout\";\nimport { useDrag } from \"@use-gesture/react\";\n\n// FIXME: (jh) Look into resizble element for touch displays: https://csslayout.io/resizable-element/\n\nexport const DIR_BORDER_NW = \"NW\";\nexport const DIR_BORDER_N = \"N\";\nexport const DIR_BORDER_NE = \"NE\";\nexport const DIR_BORDER_E = \"E\";\nexport const DIR_BORDER_SE = \"SE\";\nexport const DIR_BORDER_S = \"S\";\nexport const DIR_BORDER_SW = \"SW\";\nexport const DIR_BORDER_W = \"W\";\n\n// @see https://use-gesture.netlify.app/docs/#simple-example\nconst useDirectionalDragger = function (direction, onBorderDrag) {\n  return useDrag(\n    ({ down: isDragging, movement: [mx, my] }) => {\n      onBorderDrag(direction, { mx, my, isDragging });\n    },\n    {\n      pointer: {\n        // IMPORTANT: This makes use-gesture utilize touch events instead of\n        // pointer events and fixes an issue where pointercancel would\n        // sometimes be fired on certain Android devices\n        touch: true,\n      },\n    }\n  );\n};\n\n// TODO: Use prop-types\n// TODO: Document\nexport default function WindowBorder({\n  children,\n  onBorderDrag,\n  // FIXME: (jh) Document how height and width are synonymous\n  borderWidth = 3,\n  isDisabled = false,\n  ...rest\n}) {\n  const bindNW = useDirectionalDragger(DIR_BORDER_NW, onBorderDrag);\n  const bindN = useDirectionalDragger(DIR_BORDER_N, onBorderDrag);\n  const bindNE = useDirectionalDragger(DIR_BORDER_NE, onBorderDrag);\n  const bindE = useDirectionalDragger(DIR_BORDER_E, onBorderDrag);\n  const bindSE = useDirectionalDragger(DIR_BORDER_SE, onBorderDrag);\n  const bindS = useDirectionalDragger(DIR_BORDER_S, onBorderDrag);\n  const bindSW = useDirectionalDragger(DIR_BORDER_SW, onBorderDrag);\n  const bindW = useDirectionalDragger(DIR_BORDER_W, onBorderDrag);\n\n  return (\n    // TODO: Enable merge-able styles / classNames\n    // TODO: Extract classes to module.css\n    <Layout {...rest}>\n      <Header>\n        {!isDisabled && (\n          <Row style={{ maxHeight: borderWidth, height: borderWidth }}>\n            <Column\n              {...bindNW()}\n              style={{ maxWidth: borderWidth, cursor: \"nwse-resize\" }}\n            ></Column>\n            <Column {...bindN()} style={{ cursor: \"ns-resize\" }}></Column>\n            <Column\n              {...bindNE()}\n              style={{ maxWidth: borderWidth, cursor: \"nesw-resize\" }}\n            ></Column>\n          </Row>\n        )}\n      </Header>\n      <Content>\n        <Row>\n          {!isDisabled && (\n            <Column\n              {...bindW()}\n              style={{ maxWidth: borderWidth, cursor: \"ew-resize\" }}\n            ></Column>\n          )}\n\n          <Column>\n            {\n              // TODO: Use layout to wrap the child in a frame, w/ diagonal positions included\n            }\n            {children}\n          </Column>\n          {!isDisabled && (\n            <Column\n              {...bindE()}\n              style={{ maxWidth: borderWidth, cursor: \"ew-resize\" }}\n            ></Column>\n          )}\n        </Row>\n      </Content>\n      <Footer>\n        {!isDisabled && (\n          <Row style={{ maxHeight: borderWidth, height: borderWidth }}>\n            <Column\n              {...bindSW()}\n              style={{ maxWidth: borderWidth, cursor: \"nesw-resize\" }}\n            ></Column>\n            <Column {...bindS()} style={{ cursor: \"ns-resize\" }}></Column>\n            <Column\n              {...bindSE()}\n              style={{ maxWidth: borderWidth, cursor: \"nwse-resize\" }}\n            ></Column>\n          </Row>\n        )}\n      </Footer>\n    </Layout>\n  );\n}\n","import NoWrap from \"./NoWrap\";\n\nexport default NoWrap;\n","import classNames from \"classnames\";\nimport styles from \"./NoWrap.module.css\";\n\n// TODO: Document\nexport default function NoWrap({ children, className, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"no-wrap\"], className)}>\n      {children}\n    </div>\n  );\n}\n","import { useContext } from \"react\";\nimport { DesktopServiceContext } from \"../core/providers/DesktopServiceProvider\";\n\nexport default function useDesktopContext() {\n  return useContext(DesktopServiceContext);\n}\n","import useDesktopContext from \"./useDesktopContext\";\n\nimport {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n  AUTO_DETECT_PARADIGM,\n} from \"@services/UIParadigmService\";\n\nexport { DESKTOP_PARADIGM, MOBILE_PARADIGM, AUTO_DETECT_PARADIGM };\n\n/**\n * Retrieves the currently detected paradigm.\n *\n * @return {{\n *  uiParadigm: DESKTOP_PARADIGM | MOBILE_PARADIGM,\n *  isUIParadigmAutoSet: boolean,\n *  setStaticUIParadigm: Function\n * }}\n */\nexport default function useUIParadigm() {\n  // NOTE: The desktop context is utilized for this vs. tapping into the\n  // UIParadigmService directly in order to prevent excess event emitters from\n  // being added to the service. This decision was also made because a paradigm\n  // change would typically affect the entire app, and should not happen\n  // frequently, so having the entire app re-render per paradigm change is not\n  // unreasonable.\n  const { uiParadigm, isUIParadigmAutoSet, setStaticUIParadigm } =\n    useDesktopContext();\n\n  return {\n    uiParadigm,\n    isUIParadigmAutoSet,\n    setStaticUIParadigm,\n  };\n}\n","import styles from \"../../Window.module.css\";\n\nexport function WindowTitleBarMaximizeButton({ ...rest }) {\n  return <WindowTitleBarButton {...rest} className={styles[\"maximize\"]} />;\n}\n\nexport function WindowTitleBarMinimizeButton({ ...rest }) {\n  return <WindowTitleBarButton {...rest} className={styles[\"minimize\"]} />;\n}\n\nexport function WindowTitleBarCloseButton({ ...rest }) {\n  return <WindowTitleBarButton {...rest} className={styles[\"close\"]} />;\n}\n\nfunction WindowTitleBarButton({ ...rest }) {\n  // TODO: Compose with specific buttons for \"green\", \"yellow\", and \"red\".\n\n  return <button {...rest}></button>;\n}\n","import WindowTitleBar from \"./Window.TitleBar\";\n\nexport default WindowTitleBar;\n","import { useMemo, useRef } from \"react\";\nimport NoWrap from \"@components/NoWrap\";\nimport Full from \"@components/Full\";\n\nimport styles from \"../Window.module.css\";\n\nimport useUIParadigm, { DESKTOP_PARADIGM } from \"@hooks/useUIParadigm\";\n\nimport {\n  WindowTitleBarMaximizeButton,\n  WindowTitleBarMinimizeButton,\n  WindowTitleBarCloseButton,\n} from \"./Window.TitleBar.Button\";\n\n// TODO: Document\n// TODO: Add prop-types\nexport default function WindowTitleBar({\n  title,\n  onRestoreOrMaximize,\n  onMinimize,\n  onClose,\n  titleBarView: TitleBarView,\n  ...rest\n}) {\n  const refElTitleBar = useRef(null);\n\n  const { uiParadigm } = useUIParadigm();\n\n  /** @type {boolean} Whether or not the title bar should display at all */\n  const shouldDisplay = uiParadigm === DESKTOP_PARADIGM || TitleBarView;\n\n  /**\n   * These props are dynamically created for the title bar depending on the\n   * current UI paradigm.\n   *\n   * @type {Object}\n   */\n  const dynamicProps = useMemo(() => {\n    if (uiParadigm === DESKTOP_PARADIGM) {\n      return {\n        onDoubleClick: evt => {\n          // This conditional is intended to prevent inadvertent maximizing or\n          // restoring if a custom title bar is used with additional control\n          // inputs\n          if (evt.target.tagName === \"DIV\") {\n            onRestoreOrMaximize(evt);\n          }\n        },\n      };\n    } else {\n      return {};\n    }\n  }, [uiParadigm, onRestoreOrMaximize]);\n\n  if (!shouldDisplay) {\n    return null;\n  }\n\n  return (\n    <div\n      {...rest}\n      ref={refElTitleBar}\n      className={styles[\"title-bar\"]}\n      {...dynamicProps}\n    >\n      {TitleBarView ? (\n        <Full>{TitleBarView}</Full>\n      ) : (\n        <NoWrap className={styles[\"title\"]}>{title}</NoWrap>\n      )}\n\n      {uiParadigm === DESKTOP_PARADIGM && (\n        <NoWrap className={styles[\"window-controls\"]}>\n          <WindowTitleBarMaximizeButton onClick={onRestoreOrMaximize} />\n          <WindowTitleBarMinimizeButton onClick={onMinimize} />\n          <WindowTitleBarCloseButton onClick={onClose} />\n        </NoWrap>\n      )}\n    </div>\n  );\n}\n","import { useCallback, useRef, useState } from \"react\";\nimport { diff } from \"deep-object-diff\";\n\n// FIXME: (jh) See other implementation here (might be more performant; search\n// for useObjectState): https://thoughtspile.github.io/2021/10/11/usestate-object-vs-multiple/?utm_campaign=thisweekinreact&utm_medium=email&utm_source=Revue%20newsletter\n\n/**\n * Applies a shallow-merge strategy to object updates so that setState() calls\n * don't completely overwrite previous object state.\n *\n * Maintains backwards-compatibility for class-based components which have been\n * migrated to hook versions, without having to write a bunch of useState\n * references for every state property.\n *\n * NOTE: This will perform a deep-equality, non-referential check after pre-\n * merging state updates and only update the state if there is a difference in\n * the deep-equality comparison.\n *\n * @param {Object} initialState\n * @return {[state: Object, setState: Function]} Merged state\n */\nexport default function useObjectState(initialState = {}) {\n  const [state, _setMergedState] = useState(initialState);\n\n  const refState = useRef(state);\n  refState.current = state;\n\n  /**\n   * @param {Object | string | Function} updatedState If passed as a string, it will try\n   * to JSON parse into an object.\n   * @return {void}\n   */\n  const setState = useCallback(updatedState => {\n    // Check type validity / apply type coercion, etc.\n    switch (typeof updatedState) {\n      case \"string\":\n        try {\n          updatedState = JSON.parse(updatedState);\n        } catch (err) {\n          console.error(\n            \"Unable to parse string into JSON.  Did you forget to use an Object when setting object state?\"\n          );\n\n          throw err;\n        }\n        break;\n\n      case \"function\":\n        // i.e. setState(prevState => nextState)\n        updatedState = updatedState(refState.current);\n        break;\n\n      case \"object\":\n        // Objects are okay the way they are\n        break;\n\n      default:\n        throw new TypeError(\n          `Unhandled useObjectState type: ${typeof updatedState}`\n        );\n    }\n\n    _setMergedState(prevState => {\n      const nextState = { ...prevState, ...updatedState };\n\n      if (Object.keys(diff(prevState, nextState)).length) {\n        // There is a difference in values; update the next state\n        return nextState;\n      } else {\n        // Skip rendering if there is no difference in values. This relies on\n        // the React principle that \"if your update function returns the exact\n        // same value as the current state, the subsequent rerender will be\n        // skipped completely.\"\n        // @see https://reactjs.org/docs/hooks-reference.html#usestate\n        return prevState;\n      }\n    });\n  }, []);\n\n  return [state, setState];\n}\n","import { useContext } from \"react\";\nimport { AppOrchestrationServiceContext } from \"@core/providers/AppOrchestrationServiceProvider\";\n\nexport default function useAppOrchestrationContext() {\n  return useContext(AppOrchestrationServiceContext);\n}\n","import useWindowAutoPositioner from \"./useWindowAutoPositioner\";\n\nexport default useWindowAutoPositioner;\n","import { useCallback, useEffect, useRef } from \"react\";\n\nimport getElCenterPoint from \"@utils/getElCenterPoint\";\nimport getElSize from \"@utils/getElSize\";\n\nimport useWindowOutOfBoundsPositionCorrection from \"./useWindowOutOfBoundsPositionCorrection\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\n/**\n * Handles auto-positioning of the given windows.\n *\n * @typedef { import('../../classesWindowController').default} WindowController\n *\n * @param {{elWindow: HTMLElement, elWindowManager: HTMLElement, windowController: WindowController, onInitialAutoPosition?: Function }} options\n * @return {void}\n */\nexport default function useWindowAutoPositioner({\n  elWindow,\n  elWindowManager,\n  windowController,\n  onInitialAutoPosition = () => null,\n}) {\n  const refOnInitialAutoPosition = useRef(null);\n  if (elWindow) {\n    refOnInitialAutoPosition.current = onInitialAutoPosition;\n  }\n\n  const outOfBoundsCorrectionPosition = useWindowOutOfBoundsPositionCorrection({\n    elWindow,\n    elWindowManager,\n    windowController,\n  });\n\n  // Apply auto-position to window if viewport is resized and window is out-of-\n  // bounds\n  useEffect(() => {\n    if (windowController) {\n      if (\n        outOfBoundsCorrectionPosition.x !== null ||\n        outOfBoundsCorrectionPosition.y !== null\n      ) {\n        const currentPosition = windowController.getPosition();\n\n        const nextPosition = {\n          x:\n            outOfBoundsCorrectionPosition.x !== null\n              ? outOfBoundsCorrectionPosition.x\n              : currentPosition.x,\n          y:\n            outOfBoundsCorrectionPosition.y !== null\n              ? outOfBoundsCorrectionPosition.y\n              : currentPosition.y,\n        };\n\n        windowController.setPosition(nextPosition);\n      }\n    }\n  }, [windowController, outOfBoundsCorrectionPosition]);\n\n  /**\n   * Centers the window in relation to the desktop layout.\n   *\n   * @return {void}\n   */\n  const handleCenter = useCallback(() => {\n    const winManCenter = getElCenterPoint(elWindowManager);\n    const winSize = getElSize(elWindow);\n\n    const x = winManCenter.x - winSize.width / 2;\n    const y = winManCenter.y - winSize.height / 2;\n\n    windowController.setPosition({\n      x,\n      y,\n    });\n  }, [elWindowManager, elWindow, windowController]);\n\n  /**\n   * Randomly positions the window within the confines of the desktop layout.\n   *\n   * @return {void}\n   */\n  const handleScatter = useCallback(() => {\n    if (windowController) {\n      const winManSize = getElSize(elWindowManager);\n      const winSize = getElSize(elWindow);\n\n      // Randomly position, but try to keep full window in viewport\n      const x = Math.floor(Math.random() * (winManSize.width - winSize.width));\n      const y = Math.floor(\n        Math.random() * (winManSize.height - winSize.height)\n      );\n\n      windowController.setPosition({ x, y });\n    }\n  }, [elWindowManager, elWindow, windowController]);\n\n  // TODO: Refactor; Determine current app runtimes so we can determine if\n  // we're going to center or scatter new windows\n  const { appRuntimes } = useAppOrchestrationContext();\n  const refInitialAppRuntimes = useRef(appRuntimes);\n\n  // Apply initial auto-position\n  useEffect(() => {\n    if (elWindowManager && elWindow && windowController) {\n      // Apply center / scatter handlers to window controller so they can be\n      // called externally\n      windowController.__INTERNAL__setCenterHandler(handleCenter);\n      windowController.__INTERNAL__setScatterHandler(handleScatter);\n\n      // IMPORTANT: This must be called asynchronously or it will not set\n      window.requestAnimationFrame(() => {\n        // Determine initial window position\n        // TODO: Obtain previous value from local storage, or from window\n        // registration\n        //\n        // TODO: Fix issue where opening more than one initial window will not\n        // center the first window\n        if (refInitialAppRuntimes.current.length < 2) {\n          // Center first window\n          handleCenter();\n        } else {\n          // Randomly scatter subsequent windows\n          handleScatter();\n        }\n\n        // IMPORTANT: This must be called in a subsequent asynchronous call or\n        // it may execute before the previous callback (i.e. handleCenter /\n        // handleScatter)\n        //\n        // FIXME: (jh) Use setImmediate instead?\n        window.requestAnimationFrame(() => {\n          refOnInitialAutoPosition.current();\n        });\n      });\n    }\n  }, [\n    elWindowManager,\n    elWindow,\n    windowController,\n    handleCenter,\n    handleScatter,\n  ]);\n}\n","import { useEffect, useCallback } from \"react\";\nimport debounce from \"debounce\";\n\nimport { EVT_RESIZED, EVT_MOVED } from \"../../classes/WindowController\";\n\nimport getElSize from \"@utils/getElSize\";\nimport getElPosition from \"@utils/getElPosition\";\n\nimport useObjectState from \"@hooks/useObjectState\";\n\nimport {\n  WINDOW_POSITION_OOB_TOP_THRESHOLD,\n  WINDOW_POSITION_OOB_BOTTOM_THRESHOLD,\n  WINDOW_POSITION_OOB_LEFT_THRESHOLD,\n  WINDOW_POSITION_OOB_RIGHT_THRESHOLD,\n} from \"../__window_hook_constants__\";\n\nimport useUIParadigm, { DESKTOP_PARADIGM } from \"@hooks/useUIParadigm\";\n\n/**\n * Dynamically detects if the given window is out-of-bounds and calculates\n * the corrected position to bring it back within the acceptable boundary.\n *\n * This actively monitors the window for moving and resizing, as well as the\n * window manager for resizing.\n *\n * @typedef { import('../../classesWindowController').default} WindowController\n *\n * @param {{elWindow: HTMLElement, elWindowManager: HTMLElement, windowController: WindowController}} options\n * @return {{x: number | null, y: number | null}}\n */\nexport default function useWindowOutOfBoundsPositionCorrection({\n  elWindow,\n  elWindowManager,\n  windowController,\n}) {\n  const [correctionPosition, _setCorrectionPosition] = useObjectState({\n    x: null,\n    y: null,\n  });\n\n  /**\n   * @param {{elWindow: HTMLElement, elWindowManager: HTMLElement}}\n   * @return {{x: number | null, y: number | null}}\n   */\n  const getOutOfBoundsPositionCorrection = useCallback(\n    (elWindow, elWindowManager) => {\n      // const winManCenter = getElCenterPoint(elWindowManager);\n      const winManSize = getElSize(elWindowManager);\n      const winSize = getElSize(elWindow);\n      const winPosition = getElPosition(elWindow);\n\n      const winTL = {\n        x: winPosition.x,\n        y: winPosition.y,\n      };\n\n      const winTR = {\n        x: winPosition.x + winSize.width,\n        y: winPosition.y,\n      };\n\n      const correctedPosition = {\n        x: null,\n        y: null,\n      };\n\n      // If top-right position of window is less than left threshold\n      if (winTR.x < WINDOW_POSITION_OOB_LEFT_THRESHOLD) {\n        correctedPosition.x =\n          WINDOW_POSITION_OOB_LEFT_THRESHOLD - winSize.width;\n      }\n\n      // If top position of window is less than top threshold\n      if (winTR.y < WINDOW_POSITION_OOB_TOP_THRESHOLD) {\n        correctedPosition.y = WINDOW_POSITION_OOB_TOP_THRESHOLD;\n      }\n\n      // If top-left position of window is less than window manager width minus\n      // right threshold\n      if (winTL.x > winManSize.width - WINDOW_POSITION_OOB_RIGHT_THRESHOLD) {\n        correctedPosition.x =\n          winManSize.width - WINDOW_POSITION_OOB_RIGHT_THRESHOLD;\n      }\n\n      // If top position of window is less than window manager height minus\n      // bottom threshold\n      if (winTL.y > winManSize.height - WINDOW_POSITION_OOB_BOTTOM_THRESHOLD) {\n        correctedPosition.y =\n          winManSize.height - WINDOW_POSITION_OOB_BOTTOM_THRESHOLD;\n      }\n\n      return correctedPosition;\n    },\n    []\n  );\n\n  const { uiParadigm } = useUIParadigm();\n\n  // Bind event listeners\n  useEffect(() => {\n    if (\n      // Only run in desktop paradigm\n      uiParadigm === DESKTOP_PARADIGM &&\n      elWindow &&\n      elWindowManager &&\n      windowController\n    ) {\n      // Invoked when window is resized or removed, or if the viewport is\n      // resized\n      const _handleResizeOrMove = debounce(\n        () => {\n          // Fixes issue where previously minimized windows might be out of\n          // position once restored\n          // Relevant issue: https://github.com/jzombie/pre-re-shell/issues/131\n          if (windowController.getIsMinimized()) {\n            return;\n          }\n\n          const nextCorrectionPosition = getOutOfBoundsPositionCorrection(\n            elWindow,\n            elWindowManager\n          );\n\n          // NOTE: This relies on useObjectState's equality checking to not re\n          // render if nothing has changed\n          _setCorrectionPosition(nextCorrectionPosition);\n        },\n\n        100,\n        // Run on trailing edge\n        false\n      );\n\n      windowController.on(EVT_RESIZED, _handleResizeOrMove);\n      windowController.on(EVT_MOVED, _handleResizeOrMove);\n\n      // TODO: Use common handler instead\n      window.addEventListener(\"resize\", _handleResizeOrMove);\n\n      // Perform initial check\n      _handleResizeOrMove();\n\n      return function unmount() {\n        windowController.off(EVT_RESIZED, _handleResizeOrMove);\n        windowController.off(EVT_MOVED, _handleResizeOrMove);\n\n        window.removeEventListener(\"resize\", _handleResizeOrMove);\n      };\n    }\n  }, [\n    uiParadigm,\n    elWindow,\n    elWindowManager,\n    windowController,\n    getOutOfBoundsPositionCorrection,\n    _setCorrectionPosition,\n  ]);\n\n  return correctionPosition;\n}\n","// Window pointer drag thresholds represent the minimum closeness to the\n// relevant edge that the mouse / touch pointer can be before it stops\n// responding\nexport const WINDOW_POINTER_DRAG_TOP_THRESHOLD = 0;\nexport const WINDOW_POINTER_DRAG_RIGHT_THRESHOLD = 0;\nexport const WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD = 58;\nexport const WINDOW_POINTER_DRAG_LEFT_THRESHOLD = 0;\n\n// Window position out-of-bounds thresholds represent the minimum amount of\n// pixels the window can display for the relevant edge before it will be\n// automatically repositioned\nexport const WINDOW_POSITION_OOB_TOP_THRESHOLD = 0;\nexport const WINDOW_POSITION_OOB_RIGHT_THRESHOLD = 58;\nexport const WINDOW_POSITION_OOB_BOTTOM_THRESHOLD = 58;\nexport const WINDOW_POSITION_OOB_LEFT_THRESHOLD = 58;\n","/**\n * TODO: Document\n *\n * @see https://stackoverflow.com/a/46921780\n *\n * @param {DOMElement} el\n * @return {Object} // TODO: Document more thoroughly\n */\nexport default function getElCenterPoint(el) {\n  const x = el.offsetLeft + el.offsetWidth / 2;\n  const y = el.offsetTop + el.offsetHeight / 2;\n\n  return {\n    x,\n    y,\n  };\n}\n","import { EVT_UPDATED } from \"./classes/WindowController\";\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport StackingContext from \"../StackingContext\";\nimport Full from \"../Full\";\nimport Layout, { Header, Content } from \"../Layout\";\n\nimport WindowBorder from \"./Window.Border\";\nimport WindowTitleBar from \"./Window.TitleBar\";\n\nimport styles from \"./Window.module.css\";\nimport classNames from \"classnames\";\n\nimport useWindowStyles from \"./hooks/useWindowStyles\";\nimport useWindowAutoPositioner from \"./hooks/useWindowAutoPositioner\";\nimport useWindowAutoSizer from \"./hooks/useWindowAutoSizer\";\nimport useWindowDragger from \"./hooks/useWindowDragger\";\nimport useWindowDragResizer from \"./hooks/useWindowDragResizer\";\nimport useWindowOpenAnimation from \"./hooks/useWindowOpenAnimation\";\nimport useWindowControls from \"./hooks/useWindowControls\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\n\n// TODO: Apply considerations from Apple's Human Interface Guidelines:\n// https://developer.apple.com/design/human-interface-guidelines/macos/windows-and-views/window-anatomy/\n\n// TODO: Consider adjusting tabindex for non-active windows dynamically so that\n// tabbing will stay within constraints of the active window\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex\n\n// TODO: Add prop-types\n// TODO: Document\n// TODO: Include option to be able to drag the window from within the window body (i.e. like a widget)\nconst WindowView = ({\n  children,\n  elWindowManager,\n\n  windowController,\n\n  // TODO: Obtain via windowController instead?\n  isActive,\n\n  titleBarView = null,\n\n  style = {},\n  ...rest\n}) => {\n  /** @type {DOMElement} */\n  const [elWindow, _setElWindow] = useState(null);\n\n  // TODO: Document\n  const { isOpenAnimationEnded } = useWindowOpenAnimation(elWindow);\n\n  // TODO: Document\n  useWindowAutoPositioner({ elWindow, elWindowManager, windowController });\n\n  // TODO: Document\n  useWindowAutoSizer({ windowController });\n\n  const [zIndex, _setZIndex] = useState(0);\n  const [title, _setTitle] = useState(null);\n  const refTitle = useRef(null);\n  refTitle.current = title;\n\n  // Associate window element with window controller\n  // TODO: Refactor into useWindowController hook\n  useEffect(() => {\n    if (windowController && elWindow) {\n      windowController.__INTERNAL__attachWindowElement(elWindow);\n    }\n  }, [windowController, elWindow]);\n\n  /** @type {boolean} */\n  const [isWindowBorderDisabled, _setIsWindowBorderDisabled] = useState(false);\n  const refIsWindowBorderDisabled = useRef(null);\n  refIsWindowBorderDisabled.current = isWindowBorderDisabled;\n\n  const [isMaximized, _setIsMaximized] = useState(false);\n  const [isMinimized, _setIsMinimized] = useState(false);\n\n  // TODO: Document\n  // TODO: Refactor into useWindowController hook\n  // TODO: Move into container view?\n  useEffect(() => {\n    if (windowController) {\n      const _handleWindowControllerUpdate = updatedState => {\n        if (!updatedState) {\n          updatedState = windowController.getState() || {};\n        }\n\n        // Only apply view state change when necessary\n        const windowTitle = windowController.getTitle();\n        if (windowTitle !== refTitle.current) {\n          _setTitle(windowTitle);\n        }\n\n        // Only apply view state change when necessary\n        if (\n          updatedState.stackingIndex !== undefined &&\n          // TODO: Rather than checking dep value here, create conditionally-setting useState wrapper\n          updatedState.stackingIndex !== zIndex\n        ) {\n          _setZIndex(updatedState.stackingIndex);\n        }\n\n        if (updatedState.isMaximized !== undefined) {\n          _setIsMaximized(updatedState.isMaximized);\n        }\n\n        if (updatedState.isMinimized !== undefined) {\n          _setIsMinimized(updatedState.isMinimized);\n        }\n\n        const shouldWindowBorderBeDisabled =\n          windowController.getIsBorderDisabled();\n        if (\n          refIsWindowBorderDisabled.current !== shouldWindowBorderBeDisabled\n        ) {\n          _setIsWindowBorderDisabled(shouldWindowBorderBeDisabled);\n        }\n      };\n\n      // Perform initial update sync\n      _handleWindowControllerUpdate();\n\n      windowController.on(EVT_UPDATED, _handleWindowControllerUpdate);\n\n      return function unmount() {\n        windowController.off(EVT_UPDATED, _handleWindowControllerUpdate);\n      };\n    }\n  }, [windowController, title, zIndex]);\n\n  const { onRestoreOrMaximize, onMinimize, onClose } = useWindowControls({\n    windowController,\n  });\n\n  // Binds window dragging functionality\n  const [dragBind, isUserDragging] = useWindowDragger({\n    windowController,\n    isDisabled: isWindowBorderDisabled,\n  });\n\n  // Binds border resizing functionality\n  const [handleBorderDrag, isUserResizing] = useWindowDragResizer({\n    windowController,\n  });\n\n  const { isProfiling } = useDesktopContext();\n\n  // TODO: Document\n  const DynamicProfilingWrapper = useMemo(\n    () =>\n      ({ ...args }) =>\n        isProfiling ? (\n          // @see https://reactjs.org/docs/profiler.html\n          <React.Profiler\n            {...args}\n            id={windowController.getUUID()}\n            onRender={(...renderProfile) =>\n              windowController.captureRenderProfile(renderProfile)\n            }\n          />\n        ) : (\n          <React.Fragment {...args} />\n        ),\n    [isProfiling, windowController]\n  );\n\n  // Delegate style properties to their respective sub-components\n  const { outerBorderStyle, windowStyle, bodyStyle } = useWindowStyles({\n    style,\n    isMaximized,\n    isMinimized,\n  });\n\n  return (\n    // TODO: Wrap with ErrorBoundary and React.Suspense\n    <StackingContext\n      onMount={_setElWindow}\n      {...rest}\n      style={{ ...outerBorderStyle, zIndex }}\n      className={classNames(\n        styles[\"window-outer-border\"],\n\n        // Prevents \"popping\" of window before open animation ends\n        !isOpenAnimationEnded && styles[\"hidden\"],\n\n        isActive && styles[\"active\"],\n        isMaximized && styles[\"maximized\"],\n        isMinimized && styles[\"minimized\"],\n        (isUserDragging || isUserResizing) && styles[\"dragging\"]\n      )}\n      // Enable hardware acceleration of window stacking context when user is\n      // dragging or resizing\n      isAccelerated={isUserDragging || isUserResizing}\n      // For debugging reference\n      data-reshell-window-title={windowController.getTitle()}\n    >\n      {\n        // IMPORTANT: The DynamicProfilingWrapper is contained within the\n        // stacking context due to an issue w/ the window losing its\n        // positioning state if profiling is enabled / disabled\n      }\n      <DynamicProfilingWrapper>\n        <WindowView.Border\n          isDisabled={isWindowBorderDisabled}\n          onBorderDrag={handleBorderDrag}\n        >\n          <Full\n            className={classNames(\n              styles[\"window\"],\n              isActive && styles[\"active\"],\n              // NOTE: This check intentionally is not taking resizing into\n              // consideration\n              isUserDragging && styles[\"dragging\"]\n            )}\n            style={windowStyle}\n          >\n            <Layout>\n              <Header>\n                <WindowTitleBar\n                  {...dragBind()}\n                  title={title}\n                  onRestoreOrMaximize={onRestoreOrMaximize}\n                  onMinimize={onMinimize}\n                  onClose={onClose}\n                  titleBarView={titleBarView}\n                />\n              </Header>\n              <Content className={styles[\"body\"]} style={bodyStyle}>\n                {children}\n              </Content>\n            </Layout>\n          </Full>\n        </WindowView.Border>\n      </DynamicProfilingWrapper>\n    </StackingContext>\n  );\n};\n\nWindowView.Border = WindowBorder;\n\nexport default WindowView;\n","import { useState } from \"react\";\nimport useAnimation from \"@hooks/useAnimation\";\n\n// FIXME: (jh) Apply animations to open, close, minimize, maximize, restore,\n// etc. Some of these animations are currently handled directly via\n// Window.module.css and the functionality could be cleaned up / refactored.\n//\n// @see https://animate.style/\n// @see https://github.com/miniMAC/magic (what is \"magic / puffin\"?) (TODO: Create test app to try these libs?)\n// # mac minimize genie effect warp\n\n/**\n * [Currently only] Handles window opening animation.\n *\n * @param {HTMLElement} elWindow\n * @return {{isOpenAnimationEnded: boolean}}\n */\nexport default function useWindowOpenAnimation(elWindow) {\n  //const [phase, setPhase] = useState(\"transition-in\");\n\n  const [isOpenAnimationEnded, _setIsOpenAnimationEnded] = useState(false);\n\n  // Window opening transition\n  useAnimation({\n    domElement: elWindow,\n    animationName: \"zoomInUp\",\n    animationDuration: \".5s\",\n    shouldRun: Boolean(elWindow),\n    onAnimationEnd: () => _setIsOpenAnimationEnded(true),\n  });\n\n  return { isOpenAnimationEnded };\n}\n","import { useEffect } from \"react\";\n\nimport useUIParadigm, {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n} from \"@hooks/useUIParadigm\";\n\n/**\n * Handles auto-sizing of the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController }} options\n * @return {void}\n */\nexport default function useWindowAutoSizer({ windowController }) {\n  const { uiParadigm } = useUIParadigm();\n\n  // Apply auto-maximize / restore depending on paradigm\n  useEffect(() => {\n    if (windowController) {\n      if (!windowController.getIsMinimized()) {\n        switch (uiParadigm) {\n          case MOBILE_PARADIGM:\n            // Auto-maximize windows if on mobile\n            windowController.maximize();\n            break;\n\n          case DESKTOP_PARADIGM:\n            // Restore windows if switched to desktop\n            windowController.restore();\n            break;\n\n          default:\n            break;\n        }\n      }\n    }\n  }, [windowController, uiParadigm]);\n}\n","import { useCallback } from \"react\";\n\n/**\n * Handles window control binding for the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController }} options\n * @return {{ onRestoreOrMaximize: Function, onMinimize: Function, onClose: Function}}\n */\nexport default function useWindowControls({ windowController }) {\n  /**\n   * Handles toggling of window restore or maximize, depending on current\n   * state.\n   *\n   * @return {void}\n   */\n  const handleRestoreOrMaximize = useCallback(() => {\n    if (windowController.getIsMaximized()) {\n      windowController.restore();\n    } else {\n      windowController.maximize();\n    }\n  }, [windowController]);\n\n  /**\n   * Handles minimizing of the window.\n   *\n   * @return {void}\n   */\n  const handleMinimize = useCallback(() => {\n    windowController.minimize();\n  }, [windowController]);\n\n  /**\n   * Handles closing of the window.\n   *\n   * @return {void}\n   */\n  const handleClose = useCallback(() => {\n    if (!windowController.getIsDestroying()) {\n      windowController.destroy();\n    }\n  }, [windowController]);\n\n  return {\n    onRestoreOrMaximize: handleRestoreOrMaximize,\n    onMinimize: handleMinimize,\n    onClose: handleClose,\n  };\n}\n","import { useRef, useState } from \"react\";\nimport { useDrag } from \"@use-gesture/react\";\n\nimport {\n  WINDOW_POINTER_DRAG_TOP_THRESHOLD,\n  WINDOW_POINTER_DRAG_RIGHT_THRESHOLD,\n  WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD,\n  WINDOW_POINTER_DRAG_LEFT_THRESHOLD,\n} from \"./__window_hook_constants__\";\n\n/**\n * Handles window drag binding for the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController, isDisabled: boolean }} options\n * @return {[bind: Function, isUserDragging: boolean]}\n */\nexport default function useWindowDragger({ windowController, isDisabled }) {\n  const refInitialDragPosition = useRef(null);\n  const refInitialWindowManagerSize = useRef(null);\n\n  const [isUserDragging, setIsUserDragging] = useState(false);\n\n  // @see https://use-gesture.netlify.app/docs/#simple-example\n  const bind = useDrag(\n    ({ down: isDragging, movement: [mx, my], xy, event }) => {\n      if (isDisabled) {\n        if (isUserDragging) {\n          setIsUserDragging(false);\n        }\n        return;\n      }\n\n      if (isDragging !== isUserDragging) {\n        setIsUserDragging(isDragging);\n      }\n\n      if (isDragging) {\n        if (!refInitialDragPosition.current) {\n          refInitialDragPosition.current = windowController.getPosition();\n        }\n\n        if (!refInitialWindowManagerSize.current) {\n          refInitialWindowManagerSize.current =\n            windowController.getWindowManagerSize();\n        }\n\n        let x = refInitialDragPosition.current.x + mx;\n        let y = refInitialDragPosition.current.y + my;\n\n        const initialWindowManagerWidth =\n          refInitialWindowManagerSize.current.width;\n        const initialWindowManagerHeight =\n          refInitialWindowManagerSize.current.height;\n\n        // Prevent window from being dragged above top threshold\n        if (y < WINDOW_POINTER_DRAG_TOP_THRESHOLD) {\n          y = WINDOW_POINTER_DRAG_TOP_THRESHOLD;\n        }\n\n        // Prevent window from being dragged below bottom threshold\n        if (\n          y >\n          initialWindowManagerHeight - WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD\n        ) {\n          y = initialWindowManagerHeight - WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD;\n        }\n\n        // Prevent window from being dragged left of left threshold\n        if (xy[0] < WINDOW_POINTER_DRAG_LEFT_THRESHOLD) {\n          x = null;\n        }\n\n        // Prevent window from being dragged right of right threshold\n        if (\n          xy[0] >\n          initialWindowManagerWidth - WINDOW_POINTER_DRAG_RIGHT_THRESHOLD\n        ) {\n          x = null;\n        }\n\n        windowController.setPosition({\n          x,\n          y,\n        });\n      } else {\n        // Reset initial drag position\n        refInitialDragPosition.current = null;\n        refInitialWindowManagerSize.current = null;\n      }\n    }\n  );\n\n  return [bind, isUserDragging];\n}\n","import { useCallback, useRef, useState } from \"react\";\n\nimport {\n  DIR_BORDER_NW,\n  DIR_BORDER_N,\n  DIR_BORDER_NE,\n  DIR_BORDER_E,\n  DIR_BORDER_SE,\n  DIR_BORDER_S,\n  DIR_BORDER_SW,\n  DIR_BORDER_W,\n} from \"../Window.Border\";\n\nimport { WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD } from \"./__window_hook_constants__\";\n\n// FIXME: (jh) Implement ability to disable drag resizing\n/**\n * Handles window border drag resize binding for the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController }} options\n * @return {[handleBorderDrag: Function, isUserResizing: boolean]}\n */\nexport default function useWindowDragResizer({ windowController }) {\n  const refInitialDragSizePosition = useRef(null);\n  const refInitialWindowManagerSize = useRef(null);\n\n  const [isUserResizing, setIsUserResizing] = useState(false);\n\n  const handleBorderDrag = useCallback(\n    (direction, { mx, my, isDragging }) => {\n      if (isDragging !== isUserResizing) {\n        setIsUserResizing(isDragging);\n      }\n\n      if (isDragging) {\n        if (!refInitialDragSizePosition.current) {\n          refInitialDragSizePosition.current = {\n            ...windowController.getSize(),\n            ...windowController.getPosition(),\n          };\n        }\n\n        if (!refInitialWindowManagerSize.current) {\n          refInitialWindowManagerSize.current =\n            windowController.getWindowManagerSize();\n        }\n\n        let { width, height, x, y } = refInitialDragSizePosition.current;\n\n        let windowManagerWidth = refInitialWindowManagerSize.current.width;\n        let windowManagerHeight = refInitialWindowManagerSize.current.height;\n\n        switch (direction) {\n          case DIR_BORDER_NW:\n            width = width - mx;\n            height = height - my;\n\n            x = x + mx;\n            y = y + my;\n\n            break;\n\n          case DIR_BORDER_N:\n            height = height - my;\n            y = y + my;\n            break;\n\n          case DIR_BORDER_NE:\n            height = height - my;\n            width = width + mx;\n\n            y = y + my;\n            break;\n\n          case DIR_BORDER_E:\n            width = width + mx;\n            break;\n\n          case DIR_BORDER_SE:\n            width = width + mx;\n            height = height + my;\n            break;\n\n          case DIR_BORDER_S:\n            height = height + my;\n            break;\n\n          case DIR_BORDER_SW:\n            width = width - mx;\n            height = height + my;\n\n            x = x + mx;\n            break;\n\n          case DIR_BORDER_W:\n            width = width - mx;\n\n            x = x + mx;\n            break;\n\n          default:\n            throw new ReferenceError(`Unknown direction: ${direction}`);\n        }\n\n        // TODO: Handle min width / height\n\n        // NOTE: The directional check fixes an issue where resizing the right\n        // edge of the window while very close to the left of the window\n        // manager would make the window reposition substantially to the right\n        // before resizing\n        if (![DIR_BORDER_NE, DIR_BORDER_E, DIR_BORDER_SE].includes(direction)) {\n          // Prevent left resize from extending left of left threshold\n          if (x < 0) {\n            // This affects window height calculations when cursor is left of\n            // left threshold\n            const diffX = 0 - x;\n            x = 0;\n            width = width - diffX;\n          }\n        }\n\n        // Prevent top resize from extending above top threshold\n        if (y < 0) {\n          // IMPORTANT: Order of operations is important here; diffY comes\n          // before y\n          const diffY = 0 - y;\n          y = 0;\n          height = height - diffY;\n        }\n\n        // NOTE: The directional check fixes an issue where resizing the left\n        // edge of the window while very close to the right of the window\n        // manager would appear to resize from the right side of the window\n        // instead\n        // @see https://github.com/jzombie/pre-re-shell/issues/116\n        if (![DIR_BORDER_NW, DIR_BORDER_W, DIR_BORDER_SW].includes(direction)) {\n          // Prevent right resize from extending right of right threshold\n          if (width + x > windowManagerWidth) {\n            width = windowManagerWidth - x;\n            x = null;\n          }\n        }\n\n        // Prevent bottom resize from extending below bottom threshold\n        if (height + y > windowManagerHeight) {\n          if (\n            // Fix issue where resizing windows from the top, which extended\n            // below the bottom threshold, would move the bottom edge up\n            direction === DIR_BORDER_S ||\n            direction === DIR_BORDER_SE ||\n            direction === DIR_BORDER_SW\n          ) {\n            height = windowManagerHeight - y;\n            y = null;\n          }\n        }\n\n        // Prevent drags from the top to be able to drag below bottom threshold\n        if (windowManagerHeight - y < WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD) {\n          return;\n        }\n\n        windowController.setSize({ width, height });\n        windowController.setPosition({ x, y });\n      } else {\n        refInitialDragSizePosition.current = null;\n        refInitialWindowManagerSize.current = null;\n      }\n    },\n    [windowController, isUserResizing]\n  );\n\n  return [handleBorderDrag, isUserResizing];\n}\n","import { useMemo } from \"react\";\n\n/**\n * Dynamically applies and filters styling based on current state of given\n * window.\n *\n * @param {{ style: Object, isMaximized: boolean, isMinimized: boolean }}\n * @return {{ outerBorderStyle: Object, windowStyle: Object, bodyStyle: Object }}\n */\nexport default function useWindowStyles({ style, isMaximized, isMinimized }) {\n  // Conditionally overrides style property when window is maximized or\n  // minimized so that they do not conflict with the CSS classes\n  const outerBorderStyle = useMemo(() => {\n    if (isMaximized || isMinimized) {\n      return {};\n    } else {\n      return {\n        width: style.width,\n        height: style.height,\n      };\n    }\n  }, [style.width, style.height, isMaximized, isMinimized]);\n\n  const windowStyle = useMemo(() => {\n    return {\n      backgroundColor: style.backgroundColor,\n    };\n  }, [style.backgroundColor]);\n\n  const bodyStyle = useMemo(() => {\n    return {\n      padding: style.padding,\n    };\n  }, [style.padding]);\n\n  return {\n    outerBorderStyle,\n    windowStyle,\n    bodyStyle,\n  };\n}\n","import Window from \"./Window\";\n\nexport default Window;\n","import React, { useImperativeHandle, useState } from \"react\";\n\nimport WindowView from \"./Window.View\";\n\n// TODO: Implement CodeSandbox support for development / debugging:\n// https://codesandbox.io/docs/embedding#embed-options\n\n// TODO: Add prop-types\n// TODO: Document\n// TODO: Include option to be able to drag the window from within the window body (i.e. like a widget)\nconst Window = React.forwardRef(\n  (\n    {\n      children,\n      elWindowManager,\n\n      // TODO: Obtain via windowController instead?\n      isActive,\n\n      titleBarView,\n\n      style = {},\n      ...rest\n    },\n    ref\n  ) => {\n    const [windowController, attachWindowController] = useState(null);\n\n    // These are exposed to the WindowManager\n    useImperativeHandle(ref, () => ({\n      // windowSymbol: Symbol(\"window\"),\n      attachWindowController,\n    }));\n\n    // The windowController should already be supplied by WindowManager before\n    // rendering is even attempted\n    if (!windowController) {\n      return null;\n    }\n\n    return (\n      <WindowView\n        {...rest}\n        style={style}\n        elWindowManager={elWindowManager}\n        windowController={windowController}\n        isActive={isActive}\n        titleBarView={titleBarView}\n      >\n        {children}\n      </WindowView>\n    );\n  }\n);\n\nexport default Window;\n","import React from \"react\";\n\nimport useObjectState from \"@hooks/useObjectState\";\n\nexport const WindowContext = React.createContext({});\n\n// TODO: Document (per-window WindowProvider)\n// TODO: Use prop-types\nexport default function WindowProvider({ children, initialSharedState = {} }) {\n  const [sharedState, setSharedState] = useObjectState(initialSharedState);\n\n  return (\n    <WindowContext.Provider\n      value={{\n        setSharedState,\n        sharedState,\n      }}\n    >\n      {children}\n    </WindowContext.Provider>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport debounce from \"debounce\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useLocationAppRegistrationID from \"@hooks/useLocationAppRegistrationID\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nimport { useHistory } from \"react-router-dom\";\n\nexport const WindowManagerRouteContext = React.createContext({});\n\n/**\n * Updates React Router location and provides location-based handling for\n * ReShell applications.\n */\nexport default function WindowManagerRouteProvider({ children }) {\n  const { getAppRuntimesWithRegistrationID, activateAppRegistrationWithID } =\n    useAppOrchestrationContext();\n\n  const { activeWindowController, setActiveWindowController } =\n    useDesktopContext();\n\n  // Detected app registration ID from React Router URL location\n  const locationAppRegistrationID = useLocationAppRegistrationID();\n\n  // Update active app registration based on location changes\n  useEffect(() => {\n    if (locationAppRegistrationID) {\n      // Launch, or bring to front\n      activateAppRegistrationWithID(locationAppRegistrationID);\n    } else {\n      setActiveWindowController(null);\n    }\n  }, [\n    locationAppRegistrationID,\n    getAppRuntimesWithRegistrationID,\n    setActiveWindowController,\n    activateAppRegistrationWithID,\n  ]);\n\n  // Active window controller app registration ID\n  const activeRegistrationID = activeWindowController\n    ?.getAppRuntime()\n    ?.getRegistrationID();\n\n  const history = useHistory();\n\n  // Update URL when active registration ID changes\n  useEffect(() => {\n    if (activeRegistrationID !== locationAppRegistrationID) {\n      // IMPORTANT: This debounce fixes an issue where the browser could get\n      // stuck in an infinite URL redirect loop if in-development and certain\n      // host files were updated. Firefox could still see the issue present\n      // with a lower debounce time (of 0).\n      // @see https://github.com/jzombie/pre-re-shell/issues/129\n      const handleRegistrationOrLocationChange = debounce(\n        () =>\n          history.push(activeRegistrationID ? `/${activeRegistrationID}` : \"/\"),\n\n        50,\n        false\n      );\n\n      handleRegistrationOrLocationChange();\n\n      return () => handleRegistrationOrLocationChange.clear();\n    }\n  }, [activeRegistrationID, locationAppRegistrationID, history]);\n\n  return (\n    <WindowManagerRouteContext.Provider value={{}}>\n      {children}\n    </WindowManagerRouteContext.Provider>\n  );\n}\n","import { EVT_UPDATED, EVT_DESTROYED } from \"phantom-core\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\n\nimport useRegistrationViewOnResized from \"./hooks/useRegistrationViewOnResized\";\n\nimport Cover from \"@components/Cover\";\nimport Window from \"@components/Window\";\nimport WindowProvider from \"@components/Window/Window.Provider\";\nimport useWindowContext from \"@components/Window/hooks/useWindowContext\";\nimport WindowController from \"@components/Window/classes/WindowController\";\n\nimport WindowManagerRouteProvider from \"./WindowManager.RouteProvider\"; // WindowManagerRouteContext,\n\nimport useServicesContext from \"@hooks/useServicesContext\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport useForceUpdate from \"@hooks/useForceUpdate\";\n\n// TODO: Add hotkey listener service and map to active window\n\n// TODO: Refactor (shared across all windows to determine relevant zIndexes)\nlet stackingIndex = 0;\n\n// TODO: Document\n// TODO: Use prop-types\nexport default function WindowManager({ appDescriptors = [], children }) {\n  const { addOrUpdateAppRegistration } = useAppOrchestrationContext();\n\n  // TODO: Refactor outside of window manager?\n  useEffect(() => {\n    appDescriptors.forEach(descriptor =>\n      addOrUpdateAppRegistration(descriptor)\n    );\n\n    // TODO: Add or update these descriptors in the appropriate provider\n  }, [appDescriptors, addOrUpdateAppRegistration]);\n\n  return (\n    <WindowManagerRouteProvider>\n      <WindowManagerView>{children}</WindowManagerView>\n    </WindowManagerRouteProvider>\n  );\n}\n\nfunction WindowManagerView({ children }) {\n  const { appRuntimes } = useAppOrchestrationContext();\n\n  const [elBase, setElBase] = useState(null);\n\n  const {\n    activeWindowController: desktopContextActiveWindowController,\n    setActiveWindowController: setDesktopContextActiveWindowController,\n  } = useDesktopContext();\n\n  // TODO: Document\n  const [windowControllerMaps, setWindowControllerMaps] = useState({});\n\n  /**\n   * @param {number | string } key\n   * @return {Object | void} // TODO: Document structure\n   */\n  const getWindowControllerMapWithKey = useCallback(\n    key => {\n      const map = windowControllerMaps[key];\n\n      return map;\n    },\n    [windowControllerMaps]\n  );\n\n  // IMPORTANT: Prevents infinite loop of handleSetActiveWindow when used as dependency\n  const refDesktopContextActiveWindowController = useRef(null);\n  refDesktopContextActiveWindowController.current =\n    desktopContextActiveWindowController;\n\n  /**\n   * @param {WindowController | null} windowController?\n   * @return {void}\n   */\n  const handleSetActiveWindow = useCallback(\n    windowController => {\n      // Restore minimized windows\n      // IMPORTANT: This should come before the is-current-window determination\n      // so that the Dock (and other activators) can un-minimize, regardless of\n      // the active window\n      if (windowController?.getIsMinimized()) {\n        windowController.setIsMinimized(false);\n      }\n\n      if (\n        !Object.is(\n          windowController,\n          refDesktopContextActiveWindowController.current\n        )\n      ) {\n        setDesktopContextActiveWindowController(windowController);\n\n        if (windowController) {\n          // TODO: Don't bring to front if already in front (i.e. is already the active window)\n          windowController.setState({ stackingIndex: ++stackingIndex });\n        }\n      }\n    },\n    [setDesktopContextActiveWindowController]\n  );\n\n  /**\n   * Retrieves whether or not the given window controller is attached to the\n   * active window.\n   *\n   * @return {boolean}\n   */\n  const handleGetIsActiveWindow = useCallback(\n    windowController =>\n      Object.is(desktopContextActiveWindowController, windowController),\n    [desktopContextActiveWindowController]\n  );\n\n  const { startServiceClass } = useServicesContext();\n\n  // Handle when window manager is clicked on directly (no window interacted with directly)\n  const refHandleSetActiveWindow = useRef(handleSetActiveWindow);\n  refHandleSetActiveWindow.current = handleSetActiveWindow;\n  useEffect(() => {\n    if (elBase) {\n      const _handleElBaseTouch = evt => {\n        // Deselect active window if desktop base is touched\n        if (evt.target === elBase) {\n          refHandleSetActiveWindow.current(null);\n        }\n      };\n\n      elBase.addEventListener(\"mousedown\", _handleElBaseTouch);\n      elBase.addEventListener(\"touchstart\", _handleElBaseTouch, {\n        // @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n        passive: true,\n      });\n\n      return function unmount() {\n        elBase.removeEventListener(\"mousedown\", _handleElBaseTouch);\n        elBase.removeEventListener(\"touchstart\", _handleElBaseTouch, {\n          // FIXME: (jh) I'm not positive if this should be on the\n          // removeEventListener (I think not, but erroring on the side of\n          // caution)\n          // @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n          // @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener\n          passive: true,\n        });\n      };\n    }\n  }, [elBase]);\n\n  /**\n   * Determines which windows are rendered to the screen at any given time, as\n   * \\well as controls instantiation and association of window controllers with\n   * their respective views.\n   *\n   * @type {React.Component[]}\n   */\n  // TODO: Can this be memoized again even w/ hooks running in window\n  // descriptors?\n  // TODO: Fix issue where every window will re-render when another window\n  // actively goes on top (not sure if it's a huge deal, but is seemingly\n  // unnecessary)\n  //\n  // TODO: Somehow figure out support for reparenting if needing to change\n  // window manager layouts: https://github.com/facebook/react/issues/3965\n  // (maybe this? https://www.npmjs.com/package/react-reverse-portal)\n  const windows = appRuntimes\n    .map(appRuntime => {\n      const appDescriptor = appRuntime.getAppDescriptor();\n      if (!appDescriptor) {\n        return null;\n      }\n\n      // TODO: Ensure key is unique across the map\n      const key = appRuntime.getUUID();\n\n      // NOTE: The variables absorbed by this decompositor (except for\n      // windowProps) are NOT passed down to the underlying DOM element of the\n      // window\n      //\n      // FIXME: (jh) Perhaps this logic should be refactored and most props not\n      // utilized on every single render (maybe the complete wrapped window\n      // could be a separate component instead of re-calcuating all of this\n      // stuff on every render)\n      const {\n        view: ViewComponent,\n        titleBarView,\n        initialSharedState,\n\n        // This one is tricky, don't pass up registration ID as DOM element ID\n        id,\n\n        title,\n        serviceClasses = [],\n        isPinned,\n        isPinnedToDock,\n        isAutoStart,\n        ...windowProps\n      } = appDescriptor;\n\n      if (!ViewComponent) {\n        return null;\n      }\n\n      // TODO: Re-active previously focused element when bringing new window to\n      // top\n\n      // TODO: (mostly for development), determine changed descriptor window\n      // title and update the window controller w/ new values\n\n      // TODO: Document\n      const dataMap = getWindowControllerMapWithKey(key);\n\n      /** @type {WindowController | void} */\n      const windowController = dataMap && dataMap.windowController;\n\n      // TODO: Fix issues with rendering errors related to the usage of this\n      /*\n      if (windowController) {\n        windowController.__INTERNAL__setIsActive(\n          handleGetIsActiveWindow(windowController)\n        );\n      }\n      */\n\n      // If we previously had a window controller running with this id\n      //\n      // TODO: Implement ability to flush this and restart a window with the same id?\n      if (dataMap && !dataMap.windowController) {\n        return null;\n      }\n\n      // TODO: Memoize this handling\n      // TODO: Attach services to window controller so other UI utilities can\n      // reference what is specific to this window\n      // TODO: Rename to appServices?\n      const appServices = {};\n      for (const serviceClass of serviceClasses) {\n        const service = startServiceClass(serviceClass);\n\n        appServices[serviceClass] = service;\n      }\n\n      // TODO: Memoize this component, when refactoring outer map\n      return (\n        <WindowProvider key={key} initialSharedState={initialSharedState}>\n          <Window\n            {...windowProps}\n            elWindowManager={elBase}\n            // TODO: Remove isActive and pass in from WindowController to the window\n            isActive={handleGetIsActiveWindow(windowController)}\n            onMouseDown={() => handleSetActiveWindow(windowController)}\n            onTouchStart={() => handleSetActiveWindow(windowController)}\n            titleBarView={\n              titleBarView ? (\n                <WrappedTitleBarView\n                  titleBarView={titleBarView}\n                  appServices={appServices}\n                  windowController={windowController}\n                  appRuntime={appRuntime}\n                />\n              ) : null\n            }\n            ref={ref => {\n              if (ref && !windowController) {\n                // Begin process of attaching window controller to rendered view\n                // and setting up event bindings\n\n                const windowController = new WindowController(\n                  {},\n                  {\n                    onBringToTop: handleSetActiveWindow,\n                  }\n                );\n\n                windowController.setTitle(title);\n\n                windowController.__INTERNAL__attachWindowManagerElement(elBase);\n\n                // Link app runtime to window controller (so that when the window\n                // controller is destructed it will take down the app runtime)\n                windowController.setAppRuntime(appRuntime);\n                appRuntime.__INTERNAL__setWindowController(windowController);\n\n                // Attach the view controller to the window\n                ref.attachWindowController(windowController);\n\n                setWindowControllerMaps(prev => {\n                  const next = { ...prev };\n                  next[key] = {\n                    windowController,\n                    key,\n                    // windowSymbol: ref.windowSymbol,\n                  };\n\n                  return next;\n                });\n\n                windowController.once(EVT_DESTROYED, () => {\n                  setWindowControllerMaps(prev => {\n                    const next = { ...prev };\n\n                    next[key].windowController = null;\n\n                    return next;\n                  });\n                });\n\n                // Set this new window as the active window\n                handleSetActiveWindow(windowController);\n              }\n            }}\n          >\n            {\n              // Wrap the view so that it updates when a bound service updates\n              // NOTE: (jh) I originally tried wrapping the window itself, but\n              // it didn't work, and it's a better idea to only update what's\n              // necessary anyway\n            }\n            {windowController && (\n              <WrappedWindowView\n                appServices={appServices}\n                windowController={windowController}\n                appRuntime={appRuntime}\n                view={ViewComponent}\n              />\n            )}\n          </Window>\n        </WindowProvider>\n      );\n    })\n    .filter(window => Boolean(window));\n\n  return (\n    <Cover>\n      {\n        // TODO: Bind touch event to this element, and if directly touching it,\n        // make currently active window not active (if cursor is in another\n        // window, ensure it is removed as well)\n        //\n        // setActiveWindowController(null)\n      }\n      <div\n        ref={setElBase}\n        style={{ width: \"100%\", height: \"100%\", position: \"relative\" }}\n      >\n        {children}\n\n        {windows}\n      </div>\n    </Cover>\n  );\n}\n\n// TODO: Document\nconst WrappedTitleBarView = function ({ titleBarView, ...rest }) {\n  return <WrappedWindowView {...rest} view={titleBarView} />;\n};\n\n// FIXME: (jh) [As a consideration] Implement Svelte lifecycle methods, to\n// avoid users having to deal with hooks (keep hooks as more of a low-level\n// thing instead, if possible)\n// - https://svelte.dev/tutorial/onmount\n// - https://svelte.dev/tutorial/ondestroy\n// - https://svelte.dev/tutorial/update\n// - https://svelte.dev/tutorial/tick\n// Maybe we can say, \"we built a rendering engine on top of React, so that\n// React components can be used, without the complexity of dealing with React\n// hook dependencies, in order to reduce excessive rendering, or stale states,\n// caused by improper user of hook dependencies\".... could also smooth the\n// transition over to Svelte or any other rendering engine for apps created on\n// top of one of them.\n//\n// TODO: Document; rename? (NOTE: this wrapped view was designed to make it\n// easier to make the wrapping view render out-of-sequence with the containing\n// view, such as when a service updates, etc.)\nfunction WrappedWindowView({\n  appServices,\n  windowController,\n  appRuntime,\n  view: ViewComponent,\n}) {\n  const forceUpdate = useForceUpdate();\n\n  const { sharedState, setSharedState } = useWindowContext();\n\n  // Re-render window when a service updates\n  useEffect(() => {\n    const _handleServiceUpdate = () => {\n      forceUpdate();\n    };\n\n    for (const service of Object.values(appServices)) {\n      // TODO: Make this channel-specific (i.e. EVT_MAIN_STATE_UPDATED)?\n      service.on(EVT_UPDATED, _handleServiceUpdate);\n    }\n\n    return function unmount() {\n      for (const service of Object.values(appServices)) {\n        // TODO: Make this channel-specific (i.e. EVT_MAIN_STATE_UPDATED)?\n        service.off(EVT_UPDATED, _handleServiceUpdate);\n      }\n    };\n  }, [appServices, forceUpdate]);\n\n  // TODO: Document\n  const setResizeHandler = useRegistrationViewOnResized(windowController);\n\n  return (\n    <ViewComponent\n      windowController={windowController}\n      appServices={appServices}\n      appRuntime={appRuntime}\n      setResizeHandler={setResizeHandler}\n      sharedState={sharedState}\n      setSharedState={setSharedState}\n    />\n  );\n}\n","import { useContext } from \"react\";\nimport { WindowContext } from \"../Window.Provider\";\n\n// TODO: Document (per-window useWindowContext)\nexport default function useWindowContext() {\n  return useContext(WindowContext);\n}\n","import { useCallback, useEffect, useRef } from \"react\";\nimport WindowController, {\n  EVT_RESIZED,\n} from \"@components/Window/classes/WindowController\";\n\n/**\n * Handles automatic invocation of AppRegistration view's setResizeHandler when\n * the relevant window resizes.\n *\n * @param {WindowController} windowController\n * @return {function}\n */\nexport default function useRegistrationViewOnResized(windowController) {\n  const refSetResizeHandler = useRef(null);\n\n  /**\n   * @param {function | void} setResizeHandler Passed up from AppRegistration view\n   * properties.\n   */\n  const handleResized = useCallback(setResizeHandler => {\n    /**\n     * onResized is passed from view, and is executed by the WindowManager when\n     * the WindowController emits EVT_RESIZED event.\n     */\n    refSetResizeHandler.current = setResizeHandler;\n  }, []);\n\n  useEffect(() => {\n    if (windowController) {\n      if (!(windowController instanceof WindowController)) {\n        throw new TypeError(\"windowController is not a WindowController\");\n      }\n\n      const _handleExecResizedCallback = () => {\n        const onResized = refSetResizeHandler.current;\n\n        // AppRegistration view might not set an onResized handler\n        if (typeof onResized === \"function\") {\n          onResized();\n        }\n      };\n\n      windowController.on(EVT_RESIZED, _handleExecResizedCallback);\n\n      return function unmount() {\n        windowController.off(EVT_RESIZED, _handleExecResizedCallback);\n      };\n    }\n  }, [windowController]);\n\n  return handleResized;\n}\n","import WindowManager from \"./WindowManager\";\n\nexport default WindowManager;\n","import Menu from \"./Menu\";\n\nexport default Menu;\n","import MenuBar from \"./MenuBar\";\n\nexport default MenuBar;\n","import { useEffect, useState } from \"react\";\nimport Menu from \"../Menu\";\nimport NoWrap from \"../NoWrap\";\n\nimport PropTypes from \"prop-types\";\n\n// FIXME: (jh) Implement keyboard accessibility across menu bar: https://szhsin.github.io/react-menu/docs#keyboard\n\nMenuBar.propTypes = {\n  /**\n   * FIXME: (jh) Document structure\n   *\n   * Reference example:\n   * @see {@link https://www.electronjs.org/docs/api/menu#examples}\n   */\n  menuStructures: PropTypes.arrayOf(PropTypes.object).isRequired,\n};\n\nexport default function MenuBar({ menuStructures = [] }) {\n  const [openedIndexes, _setOpenedIndexes] = useState([]);\n  const [isActive, _setIsActive] = useState(false);\n\n  // Set active state depending on if there are opened menu indexes\n  useEffect(() => {\n    const nextIsActive = Boolean(openedIndexes.length);\n\n    if (isActive !== nextIsActive) {\n      _setIsActive(nextIsActive);\n\n      if (!nextIsActive) {\n        _setOpenedIndexes([]);\n      }\n    }\n  }, [isActive, openedIndexes]);\n\n  // Reset menus if there is an open index registered to a now non-existent\n  // menu structure index\n  useEffect(() => {\n    for (const idx of openedIndexes) {\n      if (!menuStructures[idx]) {\n        _setOpenedIndexes([]);\n        _setIsActive(false);\n\n        break;\n      }\n    }\n  }, [openedIndexes, menuStructures]);\n\n  // FIXME: (jh) Determine if overflown, and adjust layout as necessary (perhaps\n  // by converging menu data structures)\n\n  return (\n    <NoWrap>\n      {menuStructures.map(\n        (menuStructure, idx) =>\n          menuStructure && (\n            <Menu\n              key={idx}\n              menuStructure={menuStructure}\n              onOpen={() =>\n                // Add this idx to list of opened indexes, if not already added\n                _setOpenedIndexes(prev => [...new Set([...prev, idx])])\n              }\n              onClose={() =>\n                // Remove this idx from list of opened indexes\n                _setOpenedIndexes(prev => prev.filter(pred => pred !== idx))\n              }\n              opened={Boolean(openedIndexes.includes(idx))}\n              onMouseOver={() => {\n                if (isActive) {\n                  if (!openedIndexes.includes(idx)) {\n                    // Close other menus\n                    _setOpenedIndexes([idx]);\n                  }\n                }\n              }}\n            />\n          )\n      )}\n    </NoWrap>\n  );\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n/**\n * Handles management of UI modals.\n *\n * FIXME: (jh) This class cannot be reliably extended and still maintain\n * correct functionality in extended services. PhantomCore needs the ability\n * to not be able to extend a class.\n * Relevant issue: https://github.com/zenOSmosis/phantom-core/issues/149\n */\nexport default class UIModalService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"UI Modal Service\");\n\n    this.setState({\n      modals: [],\n    });\n  }\n\n  /**\n   * Renders the given modal view.\n   *\n   * Sends the given React component as a message to the ModalProvider.\n   *\n   * @param {React.Component} view\n   * @param {Object} options? [default = {}] TODO: Document options\n   */\n  showModal(view, options = {}) {\n    const uuid = uuidv4();\n\n    let timeout = null;\n\n    /**\n     * Closes the modal.\n     *\n     * @return {void}\n     */\n    const _handleClose = () => {\n      clearTimeout(timeout);\n\n      this.closeModalWithUUID(uuid);\n    };\n\n    this.setState({\n      // Add new modals to end of stack\n      modals: [\n        ...this.getState().modals,\n        {\n          view,\n          uuid,\n          // NOTE: It is intended for onCancel and onClose to call the same\n          // _handleClose handler, as they are both intended to close the\n          // modal. Functionality differences between the two callbacks are\n          // handled within the view composition.\n          onClose: _handleClose,\n          onCancel: _handleClose,\n        },\n      ],\n    });\n\n    // TODO: [To fix issue where typing can still occur on below elements] If\n    // an element was focused before modal is displayed, remove the focus, and\n    // [potentially] reapply to the element once the modal is gone.  Can\n    // underlying elements still be selected and can tabindex somehow fix that?\n\n    // Handles auto-closing of the modal if it has a set duration\n    if (options.duration) {\n      timeout = setTimeout(() => {\n        this.closeModalWithUUID(uuid);\n      }, options.duration);\n    }\n  }\n\n  /**\n   * Closes the modal with the given UUID, if exists.\n   *\n   * @param {string} uuid\n   * @return {void}\n   */\n  closeModalWithUUID(uuid) {\n    const nextModals = this.getState().modals.filter(({ uuid: prevUUID }) => {\n      const isKept = uuid !== prevUUID;\n\n      return isKept;\n    });\n\n    this.setState({\n      modals: nextModals,\n    });\n  }\n}\n","import Padding from \"./Padding\";\n\nexport default Padding;\n","import { useEffect, useState } from \"react\";\n\nimport styles from \"./Padding.module.css\";\nimport classNames from \"classnames\";\n\nexport default function Padding({ children, className, ...rest }) {\n  const [el, setEl] = useState(null);\n  const [hasSiblings, setHasSiblings] = useState(false);\n\n  // Auto-determine if the element has siblings\n  useEffect(() => {\n    if (el) {\n      const hasSiblings = Boolean([...el.parentNode.children].length > 1);\n\n      setHasSiblings(hasSiblings);\n    }\n  }, [el]);\n\n  return (\n    <div\n      {...rest}\n      ref={setEl}\n      className={classNames(\n        styles[\"padding\"],\n        !hasSiblings && styles[\"no-siblings\"],\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`id92dd65b22cd4a62996cb3b8e0f579db-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import { useEffect, useMemo } from \"react\";\n\nconst DEFAULT_PROPS = {\n  onKeyDown: keyCode => null,\n  onKeyUp: keyCode => null,\n  onEnter: () => null,\n  onEscape: () => null,\n  isEnabled: true,\n};\n\n/**\n * Binds keyboard event handlers to the given DOM element.\n *\n * IMPORTANT: If domNode is captured via a ref on a React element, the ref\n * should be wired through a useState in the component, and the resulting state\n * be sent here, or it might not work on subsequent calls. This is a known\n * issue when trying to use with multiple iterations of TextInputModal.\n *\n * @param {DOMElement} domNode // TODO: Default to window or document body?\n * @param {Object} props TODO: Document structure\n */\nexport default function useKeyboardEvents(domNode, props = {}) {\n  const { onKeyDown, onKeyUp, onEnter, onEscape, isEnabled } = useMemo(\n    () => ({ ...DEFAULT_PROPS, ...props }),\n    [props]\n  );\n\n  // Handle event binding and unbinding\n  useEffect(() => {\n    if (!domNode || !isEnabled) {\n      return;\n    }\n\n    const _handleKeyDown = evt => {\n      // Prevent repeated calls from holding down a key\n      if (evt.repeat) {\n        return;\n      }\n\n      onKeyDown(evt.which);\n\n      switch (evt.which) {\n        case 13:\n          onEnter();\n          break;\n\n        case 27:\n          onEscape();\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    const _handleKeyUp = evt => {\n      evt.preventDefault();\n\n      onKeyUp(evt.which);\n    };\n\n    domNode.addEventListener(\"keydown\", _handleKeyDown);\n    domNode.addEventListener(\"keyup\", _handleKeyUp);\n\n    return () => {\n      domNode.removeEventListener(\"keydown\", _handleKeyDown);\n      domNode.removeEventListener(\"keyup\", _handleKeyUp);\n    };\n  }, [domNode, onKeyDown, onKeyUp, onEnter, onEscape, isEnabled]);\n}\n","import React, { useState } from \"react\";\nimport Full from \"@components/Full\";\nimport Layout, { Header, Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\n\nimport CloseIcon from \"@icons/CloseIcon\";\n\nimport classNames from \"classnames\";\nimport styles from \"./SystemModal.module.css\";\n\nimport useViewportSize from \"@hooks/useViewportSize\";\nimport useKeyboardEvents from \"@hooks/useKeyboardEvents\";\n\nlet _prevIsSmallViewport = false;\n\n// TODO: Add prop-types\n/**\n * TODO: Document updated type\n *\n * SystemModal is inspired by OS setup screens, and is typically used outside\n * of the main application to drive any sort of helper utilities needed to\n * configure the application.\n */\nexport default function SystemModal({\n  children,\n  className,\n  onClose,\n  onCancel,\n  headerView = null,\n  footerView = ({ onCancel }) => (\n    <div style={{ textAlign: \"center\" }}>\n      <Padding>\n        <button onClick={onCancel} style={{ backgroundColor: \"red\" }}>\n          <CloseIcon /> Cancel\n        </button>\n      </Padding>\n    </div>\n  ),\n  // theme = THEME_DARK,\n}) {\n  const [isSmallViewport, _setIsSmallViewport] = useState(_prevIsSmallViewport);\n\n  // Cache value for next full SystemModal lifecycle\n  //\n  // Fixes issue where display readjusts when switching navigation links in\n  // SystemModal\n  _prevIsSmallViewport = isSmallViewport;\n\n  // Automatically configure layout based on viewport size\n  useViewportSize(({ width, height }) => {\n    // TODO: Use range constants\n    if (width < 500 || height < 600) {\n      _setIsSmallViewport(true);\n    } else {\n      _setIsSmallViewport(false);\n    }\n  });\n\n  // Close modal when escape button is pressed\n  useKeyboardEvents(window, {\n    onEscape: onCancel,\n  });\n\n  return (\n    <Full\n      className={classNames(\n        styles[\"system-modal\"],\n        isSmallViewport ? styles[\"small-viewport\"] : null,\n        className\n      )}\n    >\n      <div className={styles[\"outer-wrap\"]}>\n        <div className={styles[\"inner-wrap\"]}>\n          <Layout>\n            {headerView && (\n              <Header className={styles[\"header\"]}>\n                {typeof headerView === \"function\"\n                  ? headerView({ onCancel, onClose })\n                  : headerView}\n              </Header>\n            )}\n\n            <Content>{children}</Content>\n\n            {footerView && (\n              <Footer className={styles[\"footer\"]}>\n                {typeof footerView === \"function\"\n                  ? footerView({ onCancel, onClose })\n                  : footerView}\n              </Footer>\n            )}\n          </Layout>\n        </div>\n      </div>\n    </Full>\n  );\n}\n","import SystemModal from \"./SystemModal\";\n\nexport default SystemModal;\n","import { useCallback, useEffect, useRef } from \"react\";\nimport { debounce } from \"debounce\";\n\nconst DEFAULT_DEBOUNCE_TIME = 100;\n\n/**\n * Calls onChange handler whenever viewport size changes.\n *\n * Note that this does not re-render the component per size change in order to\n * save render cycles / prevent weird effects such as inputs losing focus when\n * mobile software keyboards render.\n *\n * @param {function | any} onChange If a non-functional value is passed the\n * hook will not monitor viewport size\n * @param {number} debounceTime? [default = 100] Minimum number of milliseconds\n * to wait between subsequent onChange callbacks\n */\nexport default function useViewportSize(\n  /**\n   * i.e. ({ width, height }) => console.log({width, height})\n   */\n  onChange,\n  debounceTime = DEFAULT_DEBOUNCE_TIME\n) {\n  const _getViewportSize = useCallback(() => {\n    const { innerWidth: width, innerHeight: height } = window;\n\n    return {\n      width,\n      height,\n    };\n  }, []);\n\n  // Wrap onChange so we can pass it through the next useEffect without\n  // creating a dependency\n  const refOnChange = useRef(onChange);\n  refOnChange.current = onChange;\n\n  useEffect(() => {\n    if (typeof refOnChange.current === \"function\") {\n      const _handleViewportSize = debounce(\n        () => {\n          const onChange = refOnChange.current;\n\n          const size = _getViewportSize();\n\n          onChange(size);\n        },\n        debounceTime,\n        // Trailing edge\n        false\n      );\n\n      // Perform initial sync\n      _handleViewportSize();\n\n      // TODO: Use common handler instead\n      window.addEventListener(\"resize\", _handleViewportSize);\n\n      return function unmount() {\n        window.removeEventListener(\"resize\", _handleViewportSize);\n      };\n    }\n  }, [debounceTime, _getViewportSize]);\n}\n","import ConfirmModal from \"./ConfirmModal\";\n\nexport default ConfirmModal;\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\n\nimport SystemModal from \"../SystemModal\";\n\nimport PropTypes from \"prop-types\";\n\nConfirmModal.propTypes = {\n  text: PropTypes.string.isRequired,\n};\n\n/**\n * Renders a boolean \"accept\" / \"reject\" (yes / no) dialog.\n */\nexport default function ConfirmModal({\n  text,\n  onCancel,\n  onClose,\n  footerView = ({ onCancel, onClose }) => (\n    <div style={{ textAlign: \"center\" }}>\n      <Padding>\n        <button\n          onClick={onClose}\n          style={{\n            // TODO: Use color variable for highlighted elements\n            backgroundColor: \"#347fe8\",\n          }}\n        >\n          Accept\n        </button>\n\n        <div style={{ display: \"inline-block\", width: \"1em\" }} />\n\n        <button onClick={onCancel} style={{ backgroundColor: \"red\" }}>\n          Reject\n        </button>\n      </Padding>\n    </div>\n  ),\n  ...rest\n}) {\n  return (\n    <SystemModal\n      {...rest}\n      onCancel={onCancel}\n      onClose={onClose}\n      footerView={footerView}\n    >\n      <Center canOverflow={true} style={{ fontWeight: \"bold\" }}>\n        {text}\n      </Center>\n    </SystemModal>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`i91eec2200f934fc6a4087e250fa26340-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./ButtonTransparent.module.css\";\n\n// TODO: Rename to ButtonUnstyled?\nfunction ButtonTransparent({ children, className, ...rest }) {\n  return (\n    <button\n      className={classNames(styles[\"button-transparent\"], className)}\n      {...rest}\n    >\n      {children}\n    </button>\n  );\n}\n\nexport default ButtonTransparent;\n","import ButtonTransparent from './ButtonTransparent';\n\nexport default ButtonTransparent;","import { PhantomCollection } from \"phantom-core\";\nimport { useEffect, useState } from \"react\";\nimport usePrevious from \"./usePrevious\";\n\n/**\n * @typedef {Object} ArrayDiff\n * @property {any[]} added Elements added since last change\n * @property {any[]} removed Elements removed since last change\n *\n * @param {any[]} next\n * @return {ArrayDiff}\n */\nexport default function useArrayDiff(next) {\n  // IMPORTANT: Using empty array for previous default value\n  const prev = usePrevious(next, []);\n\n  const [addedRemoved, _setAddedRemoved] = useState({ added: [], removed: [] });\n\n  useEffect(() => {\n    // NOTE: This check is inside the useEffect so it is not re-run more often\n    // than it should\n    if (!Array.isArray(next)) {\n      throw new Error(\"next should be an array\");\n    }\n\n    const { added, removed } = PhantomCollection.getChildrenDiff(prev, next);\n\n    if (added.length || removed.length) {\n      _setAddedRemoved({\n        added,\n        removed,\n      });\n    }\n  }, [prev, next]);\n\n  return {\n    added: addedRemoved.added,\n    removed: addedRemoved.removed,\n  };\n}\n","import { useEffect, useRef } from \"react\";\n\nconst DEFAULT_REF_VALUE = null;\n\n/**\n * Adapted from:\n * @see https://usehooks.com/usePrevious\n *\n * getPreviousValue, a memoized callback with no dependencies, was added so\n * that the value could be obtained from within a hook without the value being\n * called as a dependency, which could cause an additional render.\n *\n * @param {any} value The current value\n * @param {boolean} defaultPreviousValue? [default = null]\n * @return {any} The previous value\n */\nexport default function usePrevious(\n  value,\n  defaultPreviousValue = DEFAULT_REF_VALUE\n) {\n  // The ref object is a generic container whose \"current\" property is mutable\n  // and can hold any value, similar to an instance property on a class\n  const refPrev = useRef(defaultPreviousValue);\n\n  // Store current value in ref\n  // Only re-run if value changes\n  useEffect(() => {\n    refPrev.current = value;\n  }, [value]);\n\n  // Return previous value (happens before update in useEffect above)\n  return refPrev.current;\n}\n","import { useEffect, useMemo, useRef, useState } from \"react\";\nimport { MultiAudioMediaStreamTrackLevelMonitor } from \"media-stream-track-controller\";\nimport useArrayDiff from \"./useArrayDiff\";\n\nconst { EVT_AUDIO_LEVEL_UPDATED } = MultiAudioMediaStreamTrackLevelMonitor;\n\n/**\n * Utilizes a MultiAudioMediaStreamTrackLevelMonitor as a React hook.\n *\n * @param {MediaStreamTrack | MediaStreamTrack[] | null} mediaStreamTrackOrTracks?\n * [default = []] A single track, or an array of tracks.  It is made optional\n * because rendered audio level meters may not already have an associated\n * MediaStreamTrack. NOTE: It will automatically filter out non-audio tracks.\n * @param {function} onAudioLevelChange Callback which is executed each time the audio level is changed.\n * @return {void}\n */\nexport default function useMultiAudioMediaStreamTrackLevelMonitor(\n  mediaStreamTrackOrTracks = [],\n  onAudioLevelChange\n) {\n  /**\n   * @type {MediaStreamTrack[]}\n   */\n  const mediaStreamTracks = useMemo(\n    () =>\n      (!mediaStreamTrackOrTracks\n        ? []\n        : Array.isArray(mediaStreamTrackOrTracks)\n        ? mediaStreamTrackOrTracks\n        : [mediaStreamTrackOrTracks]\n      ).filter(\n        track => track instanceof MediaStreamTrack && track.kind === \"audio\"\n      ),\n    [mediaStreamTrackOrTracks]\n  );\n\n  const [mediaStreamMonitor, _setMediaStreamMonitor] = useState(null);\n\n  const refOnAudioLevelChange = useRef(onAudioLevelChange);\n  refOnAudioLevelChange.current = onAudioLevelChange;\n\n  // Instantiate and bind MultiAudioMediaStreamTrackLevelMonitor audio level\n  // state to hook state\n  useEffect(() => {\n    const mediaStreamMonitor = new MultiAudioMediaStreamTrackLevelMonitor();\n\n    // NOTE: This event handler will automatically be unbound once the class\n    // destructs\n    mediaStreamMonitor.on(EVT_AUDIO_LEVEL_UPDATED, audioLevel => {\n      refOnAudioLevelChange.current(audioLevel);\n    });\n\n    _setMediaStreamMonitor(mediaStreamMonitor);\n\n    return function unmount() {\n      if (!mediaStreamMonitor.getIsDestroying()) {\n        mediaStreamMonitor.destroy();\n      }\n    };\n  }, []);\n\n  const { added: addedMediaStreamTracks, removed: removedMediaStreamTracks } =\n    useArrayDiff(mediaStreamTracks);\n\n  // Sync hook's media stream tracks with the audio monitor instance\n  useEffect(() => {\n    if (mediaStreamMonitor) {\n      // Handle added / existing tracks\n      for (const track of addedMediaStreamTracks) {\n        mediaStreamMonitor.addMediaStreamTrack(track);\n      }\n\n      // Handle removed tracks\n      for (const track of removedMediaStreamTracks) {\n        mediaStreamMonitor.removeMediaStreamTrack(track);\n      }\n    }\n  }, [mediaStreamMonitor, addedMediaStreamTracks, removedMediaStreamTracks]);\n}\n","import AudioLevelMeter from \"./AudioLevelMeter\";\n\nexport default AudioLevelMeter;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./AudioLevelMeter.module.css\";\n\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport PropTypes from \"prop-types\";\n\nimport useMultiAudioMediaStreamTrackLevelMonitor from \"@hooks/useMultiAudioMediaStreamTrackLevelMonitor\";\n\nAudioLevelMeter.propTypes = {\n  className: PropTypes.string,\n\n  /** When multiple audio tracks may be used together */\n  mediaStreamTracks: PropTypes.arrayOf(PropTypes.instanceOf(MediaStreamTrack)),\n\n  /** When only a single track is used */\n  mediaStreamTrack: PropTypes.instanceOf(MediaStreamTrack),\n};\n\n/**\n * A vertical bar audio meter which takes up its full available vertical space\n * by default.\n *\n * Borrowed from:\n * @see https://codepen.io/snart1/pen/rRvwwr\n */\nexport default function AudioLevelMeter({\n  className,\n  mediaStreamTrack,\n  mediaStreamTracks,\n  ...rest\n}) {\n  const [elAudioLevel, setElAudioLevel] = useState(null);\n\n  // TODO: Replace w/ useUUID\n  const uuid = useMemo(uuidv4, []);\n\n  /**\n   * @param {number} audioLevel A float value from 0 - 100, where 100\n   * represents maximum strength.\n   * @return {void}\n   */\n  const handleAudioLevelChange = useCallback(\n    audioLevel => {\n      if (elAudioLevel) {\n        requestSkippableAnimationFrame(() => {\n          // Inset is inverse of the audio level\n          const inset = 100 - audioLevel;\n\n          elAudioLevel.style.clipPath = `inset(${inset}% 0 0 0)`;\n          elAudioLevel.style.WebkitClipPath = `inset(${inset}% 0 0 0)`;\n        }, uuid);\n      }\n    },\n    [elAudioLevel, uuid]\n  );\n\n  // Set initial level (otherwise they will default to appearing fully\n  // maxed-out, due to the CSS rules)\n  useEffect(() => {\n    if (elAudioLevel) {\n      handleAudioLevelChange(0);\n    }\n  }, [handleAudioLevelChange, elAudioLevel]);\n\n  useMultiAudioMediaStreamTrackLevelMonitor(\n    mediaStreamTrack || mediaStreamTracks,\n    handleAudioLevelChange\n  );\n\n  return (\n    <div className={classNames(styles[\"levels\"], className)} {...rest}>\n      {/*\n        NOTE: The original version of this supported a nice multi-track\n        reading, which is not compatible with this implementation. However it\n        could be enabled by adapting the following to the current setup.\n\n        {renderedLevels.map((percent, idx) => (\n        */}\n\n      <div className={styles[\"level-container\"]}>\n        <div ref={setElAudioLevel} className={styles[\"level\"]}></div>\n      </div>\n      {/*\n      ))}\n      */}\n    </div>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`ie8e4f3089b614c28aa33b6aaeff7d8b0-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import Padding from \"@components/Padding\";\nimport ButtonTransparent from \"@components/ButtonTransparent\";\nimport Center from \"@components/Center\";\nimport AudioLevelMeter from \"@components/audioMeters/AudioLevelMeter\";\n\nimport MicrophoneIcon from \"@icons/MicrophoneIcon\";\nimport CloseIcon from \"@icons/CloseIcon\";\n\n// TODO: Document and add prop-types\nexport default function AudioInputDeviceTableRow({\n  device,\n  mediaStreamTracks,\n  isCapturing,\n  onToggleCapture,\n  isMuted,\n  onToggleMute,\n  audioQualityPresets,\n  audioQualityPresetName,\n  onChangeAudioQualityPresetName,\n}) {\n  // TODO: Use constant for check type\n  if (device.kind !== \"audioinput\") {\n    throw new TypeError(\"device is not an audioinput device\");\n  }\n\n  return (\n    <tr style={isCapturing ? { backgroundColor: \"rgba(0,174,255,.2)\" } : null}>\n      <td>\n        <Padding>\n          <div style={{ fontWeight: \"bold\" }}>\n            {device.label || `[Unknown Label]`}\n          </div>\n\n          <div style={{ marginTop: 4 }}>\n            <span style={{ fontSize: \".7em\" }}>Quality:</span>{\" \"}\n            {!isCapturing ? (\n              <select\n                value={audioQualityPresetName}\n                onChange={evt =>\n                  onChangeAudioQualityPresetName(evt.target.value)\n                }\n                // FIXME: (jh) Due to issues with dynamically changing\n                // constraints while a media device is capturing in Chromium-\n                // based browsers, along with issues with WebRTCPeer / ZenRTCPeer\n                // not seeming to handle rapid track unpublishing / republishing,\n                // it seems better to force the user to have to stop the media\n                // device capturing before changing the preferred audio quality\n                // settings\n                disabled={isCapturing}\n              >\n                {audioQualityPresets.map((preset, idx) => {\n                  const presetName = preset.name;\n\n                  return (\n                    <option key={idx} value={presetName}>\n                      {presetName}\n                    </option>\n                  );\n                })}\n              </select>\n            ) : (\n              <button\n                onClick={onToggleCapture}\n                style={{ minWidth: 145, textAlign: \"left\" }}\n              >\n                {audioQualityPresetName}{\" \"}\n                <CloseIcon style={{ color: \"orange\", float: \"right\" }} />\n              </button>\n            )}\n          </div>\n        </Padding>\n      </td>\n\n      <td className=\"center\">\n        <Padding>\n          <button\n            onClick={onToggleCapture}\n            style={{\n              backgroundColor: isCapturing ? \"red\" : \"#347FE8\",\n              width: \"100%\",\n            }}\n          >\n            {isCapturing ? \"Stop\" : \"Start\"}\n          </button>\n        </Padding>\n      </td>\n      <td className=\"center\">\n        <Padding>\n          <ButtonTransparent\n            disabled={!isCapturing}\n            onClick={onToggleMute}\n            style={{\n              color: !isCapturing ? \"inherit\" : isMuted ? \"white\" : \"orange\",\n            }}\n          >\n            <div style={{ textAlign: \"center\" }}></div>\n            <MicrophoneIcon style={{ fontSize: \"1.5em\" }} />\n            <div style={{ fontSize: \".7em\", marginTop: 4 }}>\n              {!isCapturing ? \"N/A\" : isMuted ? \"Yes\" : \"No\"}\n            </div>\n          </ButtonTransparent>\n        </Padding>\n      </td>\n      <td\n        className=\"center\"\n        style={{\n          width: 80,\n          // NOTE: This height cascades down to the audio level meter and helps\n          // keep the row height consistent regardless of whether the meter is\n          // active or not\n          height: 70,\n        }}\n      >\n        <Padding>\n          {isCapturing ? (\n            device.kind === \"audioinput\" && (\n              <AudioLevelMeter mediaStreamTracks={mediaStreamTracks} />\n            )\n          ) : (\n            <Center style={{ color: \"gray\", fontSize: \".7em\" }}>Off</Center>\n          )}\n        </Padding>\n      </td>\n    </tr>\n  );\n}\n","import { deepMerge } from \"phantom-core\";\nimport UIServiceCore from \"@core/classes/UIServiceCore\";\nimport KeyVaultService from \"./KeyVaultService\";\n\nimport { utils } from \"media-stream-track-controller\";\n\nconst KEY_STORAGE_ENGINE_MEDIA_DEVICES = \"media-devices\";\n\nconst KEY_DMETA_DEVICE = \"device\";\nconst KEY_DMETA_USER_METADATA = \"userMetadata\";\n\n/**\n * Manages arbitrary associative information for media devices.\n */\nexport default class MediaDeviceCachingService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setState({\n      devicesWithUserMetadata: [],\n    });\n\n    this.setTitle(\"Media Device Caching Service\");\n\n    this._storageEngine =\n      this.useServiceClass(KeyVaultService).getSecureLocalStorageEngine();\n\n    // Set initial state from local storage\n    (async () => {\n      this._fetchCachedMediaDeviceUserMetadata().then(devicesWithUserMetadata =>\n        this.setState({ devicesWithUserMetadata })\n      );\n    })();\n  }\n\n  /**\n   * Adds user-defined information to the given media device.\n   *\n   * Subsequent calls will deep merge userMetadata with existing metadata.\n   *\n   * @param {MediaDeviceInfo} device\n   * @param {Object} userMetadata\n   * @return {Promise<void>}\n   */\n  async setMediaDeviceUserMetadata(device, userMetadata) {\n    if (typeof device !== \"object\") {\n      throw new TypeError(\"device must be an object\");\n    }\n\n    if (typeof userMetadata !== \"object\") {\n      throw new TypeError(\"userMetadata must be an object\");\n    }\n\n    // Current device (may be overwritten after fetching from cache)\n    let update = {\n      [KEY_DMETA_DEVICE]: device,\n      [KEY_DMETA_USER_METADATA]: userMetadata,\n    };\n\n    // Previously cached devices without the current device\n    const filteredCache = await this._fetchCachedMediaDeviceUserMetadata().then(\n      devicesWithUserMetadata =>\n        // Remove matched device from prev\n        devicesWithUserMetadata.filter(pred => {\n          const isMatch = utils.mediaDevice.getIsSameMediaDevice(\n            pred.device,\n            device\n          );\n\n          if (isMatch) {\n            // Deep merge new meta data on top of previous metadata\n            update = deepMerge(pred, {\n              [KEY_DMETA_USER_METADATA]: userMetadata,\n            });\n          }\n\n          return !isMatch;\n        })\n    );\n\n    // This is what will be written back to the local storage cache\n    const next = [...filteredCache, update];\n\n    await this._storageEngine.setItem(KEY_STORAGE_ENGINE_MEDIA_DEVICES, next);\n\n    this.setState({ devicesWithUserMetadata: next });\n  }\n\n  /**\n   * Fetches stored device information from local storage.\n   *\n   * @return {Promise<Object[]>} TODO: Document structure\n   */\n  async _fetchCachedMediaDeviceUserMetadata() {\n    const cache = await this._storageEngine.fetchItem(\n      KEY_STORAGE_ENGINE_MEDIA_DEVICES\n    );\n\n    if (Array.isArray(cache)) {\n      return cache;\n    } else {\n      return [];\n    }\n  }\n\n  /**\n   * Retrieves stored device information from local state.\n   *\n   * NOTE: This does not make a disk call, only reads from memory (current\n   * state); it is not intended to be asynchronous\n   *\n   * @param {MediaDeviceInfo} device\n   * @return {Object} TODO: Document structure\n   */\n  getMediaDeviceUserMetadata(device) {\n    const cachedDevice = this.getState().devicesWithUserMetadata.find(pred =>\n      utils.mediaDevice.getIsSameMediaDevice(pred.device, device)\n    );\n\n    if (cachedDevice) {\n      return cachedDevice[KEY_DMETA_USER_METADATA];\n    }\n  }\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport {\n  MediaStreamTrackControllerFactory,\n  MediaStreamTrackControllerFactoryCollection,\n  utils,\n} from \"media-stream-track-controller\";\n\nimport MediaDeviceCachingService from \"./MediaDeviceCachingService\";\n\n// TODO: Refactor\nclass InputMediaDeviceFactoryCollection extends MediaStreamTrackControllerFactoryCollection {}\n\n/**\n * Manages capturing of physical input media devices (i.e. microphone or camera).\n *\n * It does not manage virtual devices, such as screen captures, canvas, etc.\n */\nexport default class InputMediaDevicesService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Input Media Devices Service\");\n\n    this.setState({\n      isFetchingMediaDevices: false,\n      isAudioContextStarted: false,\n      devices: [],\n    });\n\n    this._mediaDeviceCachingService = this.useServiceClass(\n      MediaDeviceCachingService\n    );\n\n    this._inputMediaDeviceFactoryCollection = this.bindCollectionClass(\n      InputMediaDeviceFactoryCollection\n    );\n\n    // TODO: Re-fetch when devices have been changed (listen to event; backport\n    // from original Speaker.app)\n    //\n    // TODO: Capture fetch errors and set them as state / UI notifications\n\n    this.fetchInputMediaDevices();\n  }\n\n  /**\n   * Performs a \"system call\" against the browser in order to determine\n   * physical input media devices.\n   *\n   * This will internally cache the media device info in the state, and calls\n   * to this.getInputMediaDevices() can retrieve that state for the UI.\n   *\n   * @param {boolean} isAggressive [default = true]  If true, temporarily\n   * turn on devices in order to obtain label information.\n   * @return {MediaDeviceInfo[] || Object[]}\n   */\n  async fetchInputMediaDevices(isAggressive = true) {\n    this.setState({ isFetchingMediaDevices: true });\n\n    // Fixes issue where sending media stream track to remote peers is muted\n    // until something starts the audio context (TODO: Define which\n    // environments this is happening in; all? Should this fix be moved into\n    // media-stream-track-controller itself?)\n    //\n    // IMPORTANT: This isn't the ONLY fix related to this, and others are\n    // specified in the LocalZenRTCPeer connect sequence (currently part of\n    // SpeakerAppPortal)\n    await this.untilAudioContextResumed();\n\n    const inputMediaDevices = await utils.mediaDevice\n      .fetchInputMediaDevices(isAggressive)\n      .catch(console.error)\n      .finally(() => this.setState({ isFetchingMediaDevices: false }));\n\n    // Set the captured device information as state so that calls to\n    // this.getInputMediaDevices() can retrieve cached state, and any UI\n    // listeners can see the state of cached device information.\n    this.setState({ devices: inputMediaDevices });\n\n    return inputMediaDevices;\n  }\n\n  // TODO: Document\n  async untilAudioContextResumed() {\n    await utils.audioContext.untilAudioContextResumed();\n\n    this.setState({\n      isAudioContextStarted: true,\n    });\n  }\n\n  /**\n   * Retrieves whether or not this service is currently fetching media devices.\n   *\n   * @return {boolean}\n   */\n  getIsFetchingMediaDevices() {\n    return this.getState().isFetchingMediaDevices;\n  }\n\n  // TODO: Document\n  //\n  // IMPORTANT: This depends on a prior resolved call to\n  // this.fetchInputMediaDevices() before this will return anything\n  getInputMediaDevices() {\n    const { devices } = this.getState();\n\n    return devices || [];\n  }\n\n  // TODO: Document\n  //\n  // IMPORTANT: This depends on a prior resolved call to\n  // this.fetchInputMediaDevices() before this will return anything\n  getAudioInputMediaDevices() {\n    const inputMediaDevices = this.getInputMediaDevices();\n\n    // TODO: Use utility function for filtering\n    return inputMediaDevices.filter(predicate =>\n      predicate.kind.includes(\"audioinput\")\n    );\n  }\n\n  // TODO: Document\n  getCaptureFactories() {\n    return this._inputMediaDeviceFactoryCollection.getTrackControllerFactories();\n  }\n\n  // TODO: Document\n  getIsAudioMediaDeviceBeingCaptured(mediaDeviceInfo) {\n    return Boolean(\n      MediaStreamTrackControllerFactory.getFactoriesWithInputMediaDevice(\n        mediaDeviceInfo,\n        // TODO: Use constant here\n        // TODO: Auto-detect this input value from the device (within\n        // media-stream-track-controller)\n        \"audio\"\n      ).length\n    );\n  }\n\n  // TODO: Document\n  getMediaDeviceCaptureFactory(mediaDeviceInfo) {\n    const factories =\n      MediaStreamTrackControllerFactory.getFactoriesWithInputMediaDevice(\n        mediaDeviceInfo,\n        // TODO: Use constant here\n        \"audio\"\n      );\n\n    if (factories) {\n      return factories[0];\n    }\n  }\n\n  // TODO: Document\n  //\n  // IMPORTANT: For most use cases, use this.captureSpecificMediaDevice\n  // instead\n  /*\n  async captureDefaultAudioInputDevice(\n    userConstraints = {},\n    factoryOptions = {}\n  ) {\n    // TODO: Implement ability to apply preset quality settings to default\n    // audio device (potentially obtain default audio device from list, apply\n    // the settings there, then call this.captureSpecificMediaDevice())\n\n    const factory = await utils.mediaDevice.captureMediaDevice(\n      userConstraints,\n      factoryOptions\n    );\n\n    this._inputMediaDeviceFactoryCollection.addTrackControllerFactory(\n      factory\n    );\n\n    return factory;\n  }\n  */\n\n  // TODO: Document\n  async captureSpecificMediaDevice(\n    mediaDeviceInfo,\n    userConstraints = {},\n    factoryOptions = {}\n  ) {\n    const factory = await utils.mediaDevice.captureSpecificMediaDevice(\n      mediaDeviceInfo,\n      userConstraints,\n      factoryOptions\n    );\n\n    this._inputMediaDeviceFactoryCollection.addTrackControllerFactory(factory);\n\n    return factory;\n  }\n\n  // TODO: Document\n  async uncaptureSpecificMediaDevice(mediaDeviceInfo) {\n    return utils.mediaDevice.uncaptureSpecificMediaDevice(mediaDeviceInfo);\n  }\n\n  /**\n   * Determines whether or not any audio input devices are currently capturing.\n   *\n   * @return {boolean}\n   */\n  getIsCapturingAnyAudio() {\n    return this._inputMediaDeviceFactoryCollection.getAudioTrackControllers()\n      .length;\n  }\n\n  /**\n   * Determines whether or not all audio input devices are muted.\n   *\n   * @return {boolean}\n   */\n  getIsAllAudioMuted() {\n    return this._inputMediaDeviceFactoryCollection.getIsAudioMuted();\n  }\n\n  /**\n   * Sets whether or not all audio input devices are muted.\n   *\n   * @param {boolean} isAllAudioMuted\n   * @return {void}\n   */\n  setIsAllAudioMuted(isAllAudioMuted) {\n    return this._inputMediaDeviceFactoryCollection.setIsAudioMuted(\n      isAllAudioMuted\n    );\n  }\n\n  /**\n   * Mutes all audio input devices.\n   *\n   * NOTE: Subsequently added input devices will not be muted by default.\n   *\n   * @return {void}\n   */\n  muteAllAudio() {\n    return this._inputMediaDeviceFactoryCollection.muteAudio();\n  }\n\n  /**\n   * Unmutes all audio input devices.\n   *\n   * @return {void}\n   */\n  unmuteAllAudio() {\n    return this._inputMediaDeviceFactoryCollection.unmuteAudio();\n  }\n}\n","import { useCallback, useEffect } from \"react\";\n\nimport useServiceClass from \"@hooks/useServiceClass\";\nimport InputMediaDevicesService from \"@services/InputMediaDevicesService\";\nimport MediaDeviceCachingService from \"@services/MediaDeviceCachingService\";\n\n// FIXME: (jh) Move to service class?\nimport { utils } from \"media-stream-track-controller\";\nconst { audioQualityPresets } = utils.constraints;\n\n// FIXME: (jh) Move to service class?\nconst DEFAULT_AUDIO_QUALITY_PRESET =\n  audioQualityPresets.AUDIO_QUALITY_PRESET_TALK_RADIO;\n\n// TODO: Document\nexport default function useInputMediaDevicesSelectorState({\n  onDeviceCapture = device => null,\n  onDeviceUncapture = device => null,\n}) {\n  const { serviceInstance: inputMediaDevicesService } = useServiceClass(\n    InputMediaDevicesService\n  );\n\n  const { serviceInstance: mediaDevicesCachingService } = useServiceClass(\n    MediaDeviceCachingService\n  );\n\n  // Automatically fetch input media devices when component mounts\n  useEffect(() => {\n    if (inputMediaDevicesService) {\n      inputMediaDevicesService.fetchInputMediaDevices();\n    }\n  }, [inputMediaDevicesService]);\n\n  /**\n   * @return {Promise<void>}\n   */\n  const setDevicePreferredAudioQualityPresetName = useCallback(\n    async (device, audioQualityPresetName) => {\n      // TODO: Use constant\n      if (device.kind !== \"audioinput\") {\n        console.warn(\n          `Cannot set device preferred audio quality preset name for \"${device.kind}\" kind.  Expected audioinput kind.`\n        );\n        return;\n      }\n\n      const audioQualityPreset =\n        utils.constraints.audioQualityPresets.getAudioQualityPresetWithName(\n          audioQualityPresetName\n        );\n\n      return mediaDevicesCachingService.setMediaDeviceUserMetadata(device, {\n        audioQualityPreset,\n      });\n\n      // TODO: Uncapture device (if being captured)\n      // TODO: Re-capture device (using new audio constraints)\n    },\n    [mediaDevicesCachingService]\n  );\n\n  // FIXME: (jh) Constraint matching could be moved into the service level\n  // instead\n  /**\n   * @return {Promise<void>}\n   */\n  const captureSpecificMediaDevice = useCallback(\n    async device => {\n      const deviceUserMetadata =\n        mediaDevicesCachingService.getMediaDeviceUserMetadata(device);\n\n      let preferredConstraints =\n        deviceUserMetadata &&\n        deviceUserMetadata.audioQualityPreset?.constraints;\n\n      // TODO: Use constant for kind\n      if (!preferredConstraints && device.kind === \"audioinput\") {\n        preferredConstraints =\n          audioQualityPresets.getAudioQualityPresetConstraints(\n            DEFAULT_AUDIO_QUALITY_PRESET\n          );\n      }\n\n      // Start the capturing\n      return inputMediaDevicesService.captureSpecificMediaDevice(\n        device,\n        preferredConstraints\n        // FIXME: (jh) Use device title in factory options?\n      );\n    },\n    [inputMediaDevicesService, mediaDevicesCachingService]\n  );\n\n  /**\n   * @return {string}\n   */\n  const getDevicePreferredAudioQualityPresetName = useCallback(\n    device => {\n      const deviceUserMetadata =\n        mediaDevicesCachingService.getMediaDeviceUserMetadata(device);\n\n      if (deviceUserMetadata) {\n        return deviceUserMetadata.audioQualityPreset?.name;\n      } else {\n        return DEFAULT_AUDIO_QUALITY_PRESET.name;\n      }\n    },\n    [mediaDevicesCachingService]\n  );\n\n  // TODO: Document\n  const toggleSpecificAudioInputDevice = useCallback(\n    async device => {\n      const isCapturing =\n        inputMediaDevicesService.getIsAudioMediaDeviceBeingCaptured(device);\n\n      if (!isCapturing) {\n        // IMPORTANT: Using the local (non-service) version here, as it\n        // utilizes the user constraint handling\n        await captureSpecificMediaDevice(device);\n\n        // UI callback\n        onDeviceCapture(device);\n      } else {\n        // Stop the capturing\n        await inputMediaDevicesService.uncaptureSpecificMediaDevice(device);\n\n        // UI callback\n        onDeviceUncapture(device);\n      }\n    },\n    [\n      inputMediaDevicesService,\n      captureSpecificMediaDevice,\n      onDeviceCapture,\n      onDeviceUncapture,\n    ]\n  );\n\n  const audioInputDevices =\n    inputMediaDevicesService?.getAudioInputMediaDevices() || [];\n\n  const capturedAudioInputDevices = audioInputDevices.filter(device =>\n    inputMediaDevicesService?.getIsAudioMediaDeviceBeingCaptured(device)\n  );\n\n  return {\n    inputMediaDevicesService,\n    mediaDevicesCachingService,\n    audioInputDevices,\n    capturedAudioInputDevices,\n    audioQualityPresets,\n    toggleSpecificAudioInputDevice,\n    setDevicePreferredAudioQualityPresetName,\n    getDevicePreferredAudioQualityPresetName,\n  };\n}\n","import InputMediaDevicesSelector from \"./InputMediaDevicesSelector\";\n\nexport default InputMediaDevicesSelector;\n","import Full from \"../Full\";\nimport Layout, { Header, Content, Footer } from \"../Layout\";\nimport Padding from \"../Padding\";\nimport Center from \"../Center\";\nimport Cover from \"../Cover\";\n\nimport RCACableIcon from \"@icons/RCACableIcon\";\n\nimport AudioInputDeviceTableRow from \"./subComponents/AudioInputDeviceTableRow\";\n\nimport useInputMediaDevicesSelectorState from \"./subHooks/useInputMediaDevicesSelectorState\";\n\n// TODO: Document and add prop-types\n// TODO: Refactor for all input device types\nexport default function InputMediaDevicesSelector({\n  onDeviceCapture = device => null,\n  onDeviceUncapture = device => null,\n}) {\n  const {\n    inputMediaDevicesService,\n    mediaDevicesCachingService,\n    audioInputDevices,\n    capturedAudioInputDevices,\n    audioQualityPresets,\n    toggleSpecificAudioInputDevice,\n    setDevicePreferredAudioQualityPresetName,\n    getDevicePreferredAudioQualityPresetName,\n  } = useInputMediaDevicesSelectorState({\n    onDeviceCapture,\n    onDeviceUncapture,\n  });\n\n  if (!inputMediaDevicesService || !mediaDevicesCachingService) {\n    return null;\n  }\n\n  const lenAudioInputDevices = audioInputDevices.length;\n\n  const isFetching = inputMediaDevicesService.getIsFetchingMediaDevices();\n\n  if (!audioInputDevices.length) {\n    return (\n      <Center style={{ fontWeight: \"bold\" }}>\n        {isFetching\n          ? \"Fetching audio devices...\"\n          : \"No audio input devices are currently available.\"}\n      </Center>\n    );\n  }\n\n  const lenCapturedAudioInputDevices = capturedAudioInputDevices.length;\n\n  return (\n    <Layout>\n      <Header>Select device(s) for sound input:</Header>\n      <Content>\n        <Padding>\n          <Full\n            style={{\n              overflow: \"auto\",\n              border: \"4px #22668F solid\",\n              borderRadius: 4,\n            }}\n          >\n            <table style={{ width: \"100%\" }}>\n              <thead>\n                <tr>\n                  <td>Name</td>\n                  <td className=\"center\">f(x)</td>\n                  <td className=\"center\">Muted</td>\n                  <td className=\"center\">Level</td>\n                </tr>\n              </thead>\n              <tbody>\n                {audioInputDevices.map((device, idx) => {\n                  const isCapturing =\n                    capturedAudioInputDevices.includes(device);\n\n                  const deviceCaptureFactory =\n                    inputMediaDevicesService.getMediaDeviceCaptureFactory(\n                      device\n                    );\n\n                  const mediaStreamTracks =\n                    isCapturing &&\n                    deviceCaptureFactory?.getOutputMediaStream()?.getTracks();\n\n                  // TODO: Remove\n                  /*\n                  const audioTrackController =\n                    isCapturing &&\n                    deviceCaptureFactory?.getAudioTrackControllers()[0];\n                  if (audioTrackController) {\n                    console.log({\n                      settings: audioTrackController.getSettings(),\n                    });\n                  }\n                  */\n\n                  return (\n                    <AudioInputDeviceTableRow\n                      key={idx}\n                      device={device}\n                      mediaStreamTracks={mediaStreamTracks}\n                      isCapturing={isCapturing}\n                      onToggleCapture={() =>\n                        toggleSpecificAudioInputDevice(device)\n                      }\n                      isMuted={deviceCaptureFactory?.getIsMuted()}\n                      onToggleMute={() => deviceCaptureFactory?.toggleMute()}\n                      audioQualityPresets={audioQualityPresets}\n                      audioQualityPresetName={getDevicePreferredAudioQualityPresetName(\n                        device\n                      )}\n                      onChangeAudioQualityPresetName={audioQualityPresetName =>\n                        setDevicePreferredAudioQualityPresetName(\n                          device,\n                          audioQualityPresetName\n                        )\n                      }\n                    />\n                  );\n                })}\n              </tbody>\n            </table>\n          </Full>\n        </Padding>\n      </Content>\n\n      <Footer style={{ minHeight: 50 }}>\n        <Padding>\n          <RCACableIcon\n            style={{\n              fontSize: 38,\n              marginLeft: 20,\n              color: \"rgba(255,255,255,.2)\",\n            }}\n          />\n          <Cover>\n            <Center>\n              <div>\n                {lenAudioInputDevices} audio input device\n                {lenAudioInputDevices !== 1 && \"s\"} available.\n              </div>\n              <div>\n                {lenCapturedAudioInputDevices} audio input device\n                {lenCapturedAudioInputDevices !== 1 && \"s\"} currently being\n                captured.\n              </div>\n            </Center>\n          </Cover>\n        </Padding>\n      </Footer>\n    </Layout>\n  );\n}\n","import InputDeviceSelectorModal from \"./InputDeviceSelectorModal\";\n\nexport default InputDeviceSelectorModal;\n","import { useCallback } from \"react\";\nimport Padding from \"@components/Padding\";\nimport InputMediaDevicesSelector from \"@components/InputMediaDevicesSelector\";\nimport SystemModal from \"../SystemModal\";\n\n// TODO: Add prop-types\nexport default function InputDeviceSelectorModal({\n  onDeviceCapture,\n  onDeviceUncapture,\n  onCancel,\n  onClose,\n}) {\n  /**\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/InputDeviceInfo}\n   *\n   * @param {InputDeviceInfo}\n   * @return {void}\n   */\n  const handleDeviceCapture = useCallback(\n    device => {\n      onDeviceCapture(device);\n\n      onClose();\n    },\n    [onDeviceCapture, onClose]\n  );\n\n  /*\n  const handleCancel = useCallback(() => {\n    onCancel();\n\n    onClose();\n  }, [onCancel, onClose]);\n  */\n\n  return (\n    <SystemModal onClose={onClose} onCancel={onCancel}>\n      <Padding>\n        <InputMediaDevicesSelector\n          onDeviceCapture={handleDeviceCapture}\n          onDeviceUncapture={onDeviceUncapture}\n        />\n      </Padding>\n    </SystemModal>\n  );\n}\n","// FIXME: (jh) React 18 includes useId and this hook may no longer be necessary\n\nimport { useRef } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n/**\n * Creates a stable UUID for usage in React components and hooks.\n *\n * @return {string} i.e. '1b9d6bcd-bbfd-4b2d-9b5d-ab8dfbbd4bed'\n */\nexport default function useUUID() {\n  const refUUID = useRef(uuidv4());\n\n  return refUUID.current;\n}\n","import TextInputModal from \"./TextInputModal\";\n\nexport default TextInputModal;\n","import { useCallback, useState } from \"react\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport { Row, Column } from \"@components/Layout\";\n\nimport SystemModal from \"../SystemModal\";\n\nimport useKeyboardEvents from \"@hooks/useKeyboardEvents\";\nimport useUUID from \"@hooks/useUUID\";\n\n// TODO: Document\n// TODO: Add prop-types\n// TODO: Implement optional default value\nexport default function TextInputModal({\n  className,\n  label,\n  placeholder,\n  onClose,\n  onCancel,\n  onChange = () => null,\n  ...rest\n}) {\n  const [elInput, setElInput] = useState(null);\n  const [value, setValue] = useState(\"\");\n\n  // TODO: Document\n  const handleChange = useCallback(\n    evt => {\n      const value = evt.target.value;\n      setValue(value);\n      onChange(value);\n    },\n    [onChange]\n  );\n\n  // TODO: Document\n  const handleClose = useCallback(() => {\n    onClose(value);\n  }, [onClose, value]);\n\n  const handleSubmit = handleClose;\n\n  // FIXME: (jh) Use form controller instead?\n  useKeyboardEvents(elInput, {\n    onEnter: handleClose,\n    // NOTE: Escape event is already handled by SystemModal\n  });\n\n  const elInputId = useUUID();\n\n  return (\n    <SystemModal\n      {...rest}\n      className={className}\n      label={label}\n      onCancel={onCancel}\n      onClose={handleClose}\n    >\n      <Padding>\n        <Center>\n          <div style={{ textAlign: \"left\" }}>\n            {label && <label htmlFor={elInputId}>{label}</label>}\n\n            <Row>\n              <Column>\n                <input\n                  ref={setElInput}\n                  id={elInputId}\n                  type=\"text\"\n                  onChange={handleChange}\n                  placeholder={placeholder}\n                  style={{\n                    borderTopRightRadius: 0,\n                    borderBottomRightRadius: 0,\n                  }}\n                />\n              </Column>\n              <Column style={{ maxWidth: 100 }}>\n                <button\n                  style={{\n                    borderTopLeftRadius: 0,\n                    borderBottomLeftRadius: 0,\n\n                    // TODO: Use color variable for highlighted element\n                    backgroundColor: \"#347fe8\",\n                  }}\n                  disabled={!Boolean(value)}\n                  onClick={handleSubmit}\n                >\n                  Submit\n                </button>\n              </Column>\n            </Row>\n          </div>\n        </Center>\n      </Padding>\n    </SystemModal>\n  );\n}\n","import { consume } from \"phantom-core\";\nimport UIServiceCore from \"@core/classes/UIServiceCore\";\n\nimport UIModalService from \"@services/UIModalService\";\n\nimport ConfirmModal from \"@components/modals/ConfirmModal\";\nimport InputDeviceSelectorModal from \"@components/modals/InputDeviceSelectorModal\";\nimport TextInputModal from \"@components/modals/TextInputModal\";\n\n// TODO: Rename to UIModalDialogHelperService?\n/**\n * An assortment of modals designed for async programmatic usage.\n */\nexport default class UIModalWidgetService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"UIModal Widget Service\");\n\n    this._uiModalService = this.useServiceClass(UIModalService);\n  }\n\n  // TODO: Document\n  async confirm(text) {\n    try {\n      await new Promise((resolve, reject) => {\n        this._uiModalService.showModal(({ onClose, onCancel, ...rest }) => (\n          <ConfirmModal\n            text={text}\n            onClose={() => {\n              resolve();\n\n              onClose();\n            }}\n            onCancel={() => {\n              reject();\n\n              onCancel();\n            }}\n            {...rest}\n          />\n        ));\n      });\n\n      return true;\n    } catch (err) {\n      consume(err);\n\n      return false;\n    }\n  }\n\n  /**\n   * Controls a UIModal specifically for input media device selection.\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/InputDeviceInfo}\n   *\n   * @return {Promise<InputDeviceInfo>}\n   */\n  async showInputMediaDevicesSelectionModal() {\n    const selection = await new Promise(resolve =>\n      this._uiModalService.showModal(({ ...rest }) => (\n        <InputDeviceSelectorModal onDeviceCapture={resolve} {...rest} />\n      ))\n    );\n\n    return selection;\n  }\n\n  // Add a modal to replace window.prompt (possibly extend dialog modal)\n  // TODO: Document\n  async showTextInputModal({ label }) {\n    const value = await new Promise(resolve =>\n      this._uiModalService.showModal(({ onClose, ...rest }) => (\n        <TextInputModal\n          label={label}\n          // TODO: Refactor so the onClose handler is called with the value\n          onClose={text => {\n            onClose();\n\n            resolve(text);\n          }}\n          {...rest}\n        />\n      ))\n    );\n\n    return value;\n  }\n}\n","import DesktopMenuBar from \"./DesktopMenuBar\";\n\nexport default DesktopMenuBar;\n","import { EVT_UPDATED } from \"phantom-core\";\nimport ReShellCore from \"@core\";\nimport { useEffect, useMemo } from \"react\";\nimport MenuBar from \"@components/MenuBar\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport useForceUpdate from \"@hooks/useForceUpdate\";\nimport useUIParadigm, {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n  AUTO_DETECT_PARADIGM,\n} from \"@hooks/useUIParadigm\";\nimport useServiceClass from \"@hooks/useServiceClass\";\n\nimport UIModalWidgetService from \"@services/UIModalWidgetService\";\n\n// TODO: Document\nexport default function DesktopMenuBar() {\n  const { uiParadigm, isUIParadigmAutoSet, setStaticUIParadigm } =\n    useUIParadigm();\n\n  const { serviceInstance: uiModalWidgetService } = useServiceClass(\n    UIModalWidgetService,\n    false\n  );\n\n  const { activeWindowController } = useDesktopContext();\n  const {\n    appRegistrations,\n    activateAppRegistration,\n    appRuntimes,\n    runningAppRegistrations,\n  } = useAppOrchestrationContext();\n\n  const forceUpdate = useForceUpdate();\n\n  // Force update menus when active window controller updates (i.e. when\n  // changed, minimized, maximized, etc.)\n  useEffect(() => {\n    if (activeWindowController) {\n      activeWindowController.on(EVT_UPDATED, forceUpdate);\n\n      return () => {\n        activeWindowController.off(EVT_UPDATED, forceUpdate);\n      };\n    }\n  }, [activeWindowController, forceUpdate]);\n\n  const applicationsMenuData = useMemo(\n    () =>\n      appRegistrations.map(app => ({\n        type: \"checkbox\",\n        label: app.getTitle(),\n        checked: runningAppRegistrations\n          .map(pred => pred.getID())\n          .includes(app.getID()),\n        click: () => activateAppRegistration(app),\n      })),\n    [appRegistrations, runningAppRegistrations, activateAppRegistration]\n  );\n\n  const pinnedAppsMenuData = useMemo(() => {\n    const pinnedApps = appRegistrations\n      .filter(registration => registration.getIsPinned())\n      .map(app => ({\n        // FIXME: (jh) Include checkboxes next to active pinned registrations?\n        label: app.getTitle(),\n        click: () => activateAppRegistration(app),\n      }));\n\n    if (pinnedApps.length) {\n      return [\n        {\n          // TODO: Use constant\n          type: \"separator\",\n          label: \"Pinned Applications\",\n        },\n        ...pinnedApps,\n      ];\n    } else {\n      return [];\n    }\n  }, [appRegistrations, activateAppRegistration]);\n\n  const hasOpenedWindows = appRuntimes.length > 0;\n\n  // FIXME: (jh) Include menu option to reload the app (force refresh)\n  const DESKTOP_MENU_STRUCTURE = {\n    label: \"Desktop\",\n    submenu: [\n      {\n        label: \"Applications\",\n        submenu: applicationsMenuData,\n      },\n      // Dynamically include pinned apps and their corresponding separator, if\n      // exists\n      ...pinnedAppsMenuData,\n      {\n        // TODO: Use constant\n        type: \"separator\",\n        label: \"Layout Control\",\n      },\n      {\n        label: \"UI Paradigm\",\n        submenu: [\n          {\n            label: \"Desktop Paradigm\",\n            click: () => setStaticUIParadigm(DESKTOP_PARADIGM),\n            type: \"checkbox\",\n            checked: uiParadigm === DESKTOP_PARADIGM,\n          },\n          {\n            label: \"Mobile Paradigm\",\n            click: () => setStaticUIParadigm(MOBILE_PARADIGM),\n            type: \"checkbox\",\n            checked: uiParadigm === MOBILE_PARADIGM,\n          },\n          {\n            label: \"Auto Detect\",\n            click: () => setStaticUIParadigm(AUTO_DETECT_PARADIGM),\n            type: \"checkbox\",\n            checked: isUIParadigmAutoSet,\n          },\n        ],\n      },\n      ...(() => {\n        if (uiParadigm === DESKTOP_PARADIGM) {\n          return [\n            {\n              label: \"Scatter Windows\",\n              click: () =>\n                appRuntimes.forEach(runtime => {\n                  const windowController = runtime.getWindowController();\n\n                  if (windowController) {\n                    windowController.scatter();\n                  }\n                }),\n              disabled: !hasOpenedWindows,\n            },\n            {\n              label: \"Center Windows\",\n              click: () =>\n                appRuntimes.forEach(runtime => {\n                  const windowController = runtime.getWindowController();\n\n                  if (windowController) {\n                    windowController.center();\n                  }\n                }),\n              disabled: !hasOpenedWindows,\n            },\n          ];\n        } else {\n          return [];\n        }\n      })(),\n      {\n        // TODO: Use constant\n        type: \"separator\",\n        label: \"Desktop Operations\",\n      },\n      {\n        label: \"Reload ReShell\",\n        click: async () => {\n          // TODO: Replace w/ UIModal\n          (await uiModalWidgetService.confirm(\n            \"Are you sure you wish to reload?\"\n          )) && ReShellCore.reload();\n        },\n      },\n      {\n        label: \"Quit ReShell\",\n        click: async () => {\n          // TODO: Replace w/ UIModal\n          (await uiModalWidgetService.confirm(\n            \"Are you sure you wish to close the desktop?\"\n          )) && ReShellCore.destroy();\n        },\n      },\n    ],\n  };\n\n  const activeWindowTitle = activeWindowController?.getTitle();\n\n  const ACTIVE_APP_MENU_STRUCTURE = useMemo(() => {\n    if (activeWindowController) {\n      return {\n        label: activeWindowTitle,\n        submenu: [\n          {\n            // TODO: Use role instead\n            label: \"Quit\",\n            click: () => activeWindowController.destroy(),\n          },\n        ],\n      };\n    }\n  }, [activeWindowController, activeWindowTitle]);\n\n  const ACTIVE_WINDOW_MENU_STRUCTURE = (() => {\n    if (uiParadigm === DESKTOP_PARADIGM && activeWindowController) {\n      return {\n        label: \"Window\",\n        submenu: [\n          {\n            label: \"Minimize\",\n            click: () => activeWindowController.minimize(),\n            disabled: activeWindowController.getIsMinimized(),\n          },\n          {\n            label: \"Maximize\",\n            click: () => activeWindowController.maximize(),\n            disabled: activeWindowController.getIsMaximized(),\n          },\n          {\n            label: \"Restore\",\n            click: () => activeWindowController.restore(),\n            disabled:\n              !activeWindowController.getIsMaximized() &&\n              !activeWindowController.getIsMinimized(),\n          },\n          {\n            label: \"Scatter\",\n            click: () => activeWindowController.scatter(),\n          },\n          {\n            label: \"Center\",\n            click: () => activeWindowController.center(),\n          },\n        ],\n      };\n    }\n  })();\n\n  return (\n    <MenuBar\n      menuStructures={[\n        DESKTOP_MENU_STRUCTURE,\n        ACTIVE_APP_MENU_STRUCTURE,\n        ACTIVE_WINDOW_MENU_STRUCTURE,\n      ]}\n    />\n  );\n}\n","import TopBar from \"./TopBar\";\n\nexport default TopBar;\n","import DesktopMenuBar from \"./Desktop.TopBar.MenuBar\";\n\nimport { Row, Column } from \"@components/Layout\";\n\n// FIXME: (jh) Refactor commented-code into panel applet which can be tied-into\n// services (related issue: https://github.com/jzombie/pre-re-shell/issues/159)\n// import LED from \"@components/LED\";\n\n// TODO: Change this to use data-driven MenuBar\n// import Menu, { MenuButton, MenuItem } from \"@components/Menu/_Menu.LibWrapper\";\n\n// import useServicesContext from \"@hooks/useServicesContext\";\n// import useAppRegistrationLink from \"@hooks/useAppRegistrationLink\";\n\n// import { REGISTRATION_ID as SERVICE_MONITOR_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/ServiceMonitorApp\";\n\n// TODO: Use prop-types\n// TODO: Document\nexport default function TopBar() {\n  // FIXME: (jh) This currently triggers a \"Could not locate appRegistration\n  // with id: service-monitor\" warning on first render; it should be refactored\n  /*\n  const { link: openServiceMonitor } = useAppRegistrationLink(\n    SERVICE_MONITOR_REGISTRATION_ID\n  );\n  */\n\n  // const { services } = useServicesContext();\n\n  return (\n    <Row>\n      <Column style={{ width: \"100%\" }}>\n        <DesktopMenuBar />\n      </Column>\n      {/*\n        <Column\n        style={{\n          // TODO: Rework so column width expands according to content\n          maxWidth: 110,\n        }}\n      >\n        <div style={{ textAlign: \"right\" }}>\n          {\n            // TODO: Change this to use data-driven MenuBar\n          }\n          <Menu\n            portal={true}\n            menuButton={\n              <MenuButton>\n                Service Core{\" \"}\n                <LED color={services.length > 0 ? \"green\" : \"gray\"} />\n              </MenuButton>\n            }\n          >\n            {services.length === 0 ? (\n              <MenuItem>\n                <span style={{ fontStyle: \"italic\" }}>No running services</span>\n              </MenuItem>\n            ) : (\n              services.map(service => (\n                <MenuItem\n                  key={service.getUUID()}\n                  // TODO: Open direct service in service monitor\n                  onClick={openServiceMonitor}\n                >\n                  {service.getTitle()}\n                </MenuItem>\n              ))\n            )}\n          </Menu>\n        </div>\n      </Column>\n        */}\n    </Row>\n  );\n}\n","import { useEffect, useState } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./Dock.module.css\";\n\n// TODO: Document\n// TODO: Add prop-types\nexport default function DockItem({\n  appRegistration,\n  isActiveRegistration,\n  onClick,\n  elDock,\n}) {\n  const [elDockItem, _setElDockItem] = useState(null);\n\n  // Automatically scroll to relevant dock item when active\n  useEffect(() => {\n    if (elDock && elDockItem && isActiveRegistration) {\n      const offsetLeft = elDockItem.offsetLeft;\n      const offsetTop = elDockItem.offsetTop;\n\n      elDock.scrollTo({\n        top: offsetTop,\n        left: offsetLeft,\n        behavior: \"smooth\",\n      });\n    }\n  }, [elDock, elDockItem, isActiveRegistration]);\n\n  return (\n    <button\n      ref={_setElDockItem}\n      className={classNames(\n        styles[\"dock-item\"],\n        isActiveRegistration && styles[\"active\"]\n      )}\n      onClick={onClick}\n    >\n      {appRegistration.getTitle()}\n    </button>\n  );\n}\n","import Dock from \"./Dock\";\n\nexport default Dock;\n","import { useCallback, useMemo, useState } from \"react\";\nimport DockItem from \"./DockItem\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useOverflowDetection from \"@hooks/useOverflowDetection\";\n\nimport styles from \"./Dock.module.css\";\nimport classNames from \"classnames\";\n\n/**\n * Application selection Dock component.\n */\nexport default function Dock() {\n  const [elDock, _setElDock] = useState(null);\n  const [elContentWrapper, _setElContentWrapper] = useState(null);\n\n  /**\n   * @type {boolean} If true, the Dock is scrollable\n   */\n  const isOverflown = useOverflowDetection(elContentWrapper);\n\n  /**\n   * Handles scrolling of Dock in relation to mousewheel.\n   *\n   * @return {void}\n   */\n  const handleDockScroll = useCallback(\n    evt => {\n      /**\n       * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/scroll}\n       */\n      elDock.scroll({\n        top: 0,\n        // If horizontal orientation...\n        left: elDock.scrollLeft + evt.deltaY,\n        // FIXME: (jh) I can't yet tell if it's just me, or maybe my hardware,\n        // but \"smooth\" scrolling on my laptop seems a bit quirky to get\n        // started, as if the initial delta should be multiplied higher than\n        // subsequent deltas\n        // behavior: \"smooth\",\n      });\n    },\n    [elDock]\n  );\n\n  const { activeWindowController } = useDesktopContext();\n  const { appRegistrations, runningAppRegistrations, activateAppRegistration } =\n    useAppOrchestrationContext();\n\n  // TODO: Import type definition\n  /** @type {AppRegistration[]} */\n  const dockRegistrations = useMemo(\n    () => [\n      // Show unique app registrations\n      ...new Set([\n        ...appRegistrations.filter(registration =>\n          registration.getIsPinnedToDock()\n        ),\n        ...runningAppRegistrations,\n      ]),\n    ],\n    [appRegistrations, runningAppRegistrations]\n  );\n\n  // TODO: Import type definition\n  /** @type {AppRegistration | void} */\n  const activeRegistration = useMemo(\n    () => activeWindowController?.getAppRegistration(),\n    [activeWindowController]\n  );\n\n  return (\n    <div\n      ref={_setElDock}\n      className={classNames(\n        styles[\"dock\"],\n        styles[\"horizontal-orientation\"],\n        isOverflown && styles[\"overflown\"]\n      )}\n      onWheel={handleDockScroll}\n    >\n      {\n        // TODO: Add tooltip functionality\n        // - https://www.npmjs.com/package/rc-tooltip\n        // - https://www.npmjs.com/package/react-tooltip\n        // - Note: Original Shell's Antd theme used rc-tooltip as the base (https://github.com/zenOSmosis/js-shell/blob/master/frontend/src/components/Desktop/Dock/DockItem.jsx)\n        //\n        // TODO: Add button menu\n        // - See original Shell implementation: https://github.com/zenOSmosis/js-shell/blob/master/frontend/src/components/Desktop/Dock/DockItem.jsx\n      }\n      <div\n        ref={_setElContentWrapper}\n        className={classNames(\"button-group\", styles[\"content-wrapper\"])}\n      >\n        {\n          // FIXME: (jh) Add left / right scroll buttons [in horizontal\n          // orientation] when Dock overflows\n          //\n          // TODO: (jh) Automatically switch to another window / dock item if\n          // a window is minimized or closed (should be handled via\n          // AppOrchestrationService; there's a TODO there as well; search for\n          // \"Activating Windows\")\n        }\n        {dockRegistrations.map(registration => (\n          <DockItem\n            key={registration.getUUID()}\n            appRegistration={registration}\n            isActiveRegistration={registration === activeRegistration}\n            onClick={() => activateAppRegistration(registration)}\n            elDock={elDock}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n","import FullViewport from './FullViewport';\n\nexport default FullViewport;","import React, { useEffect, useMemo, useState } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./AutoScaler.module.css\";\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n/**\n * Fix issue on iOS 13 where ResizeObserver isn't available.\n */\nimport { install } from \"resize-observer\";\nif (!window.ResizeObserver) {\n  install();\n}\n\n// FIXME: (jh) Fix issue where SVG images appear blurry if scaled on Safari\n// (experienced issues on Safari 14 & 15; not tested on other versions at this\n// time)\n// Related issue: https://github.com/jzombie/pre-re-shell/issues/174\n\n/**\n * Automatically applies CSS transform scaling to children to fill parent node,\n * while preserving aspect ratio.\n *\n * Useful for videos and canvases, where the resolution is a fixed size and\n * should not change.\n */\nexport default function AutoScaler({ children, className, ...rest }) {\n  const [elOuterWrap, setElOuterWrap] = useState(null);\n  const [elInnerWrap, setElInnerWrap] = useState(null);\n\n  // TODO: Replace w/ useUUID\n  const uuid = useMemo(uuidv4, []);\n\n  // Handle scaling\n  useEffect(() => {\n    if (elOuterWrap && elInnerWrap) {\n      let outerWrapSize = {\n        width: 0,\n        height: 0,\n      };\n      let innerWrapSize = {\n        width: 0,\n        height: 0,\n      };\n\n      // This is uesd w/ visibility below to try to reduce position defects\n      // when first rendering\n      elInnerWrap.style.visibility = \"hidden\";\n\n      const ro = new ResizeObserver(entries => {\n        requestSkippableAnimationFrame(() => {\n          for (const entry of entries) {\n            const size = {\n              width: entry.target.offsetWidth,\n              height: entry.target.offsetHeight,\n            };\n\n            if (entry.target === elOuterWrap) {\n              outerWrapSize = size;\n            } else {\n              innerWrapSize = size;\n            }\n          }\n\n          // Determine against all available space\n          const maxScaleX = outerWrapSize.width / innerWrapSize.width;\n          const maxScaleY = outerWrapSize.height / innerWrapSize.height;\n\n          const scale = Math.min(maxScaleX, maxScaleY);\n\n          elInnerWrap.style.transform = `scale(${scale}, ${scale})`;\n\n          if (elInnerWrap.style.visibility === \"hidden\") {\n            setTimeout(() => {\n              elInnerWrap.style.visibility = \"visible\";\n            }, 4);\n          }\n        }, uuid);\n      });\n\n      ro.observe(elOuterWrap);\n      ro.observe(elInnerWrap);\n\n      return function unmount() {\n        ro.unobserve(elOuterWrap);\n        ro.unobserve(elInnerWrap);\n      };\n    }\n  }, [elOuterWrap, elInnerWrap, uuid]);\n\n  return (\n    <div\n      {...rest}\n      ref={setElOuterWrap}\n      className={classNames(styles[\"auto-scaler\"], className)}\n    >\n      <div ref={setElInnerWrap} className={styles[\"content-wrap\"]}>\n        {children}\n      </div>\n    </div>\n  );\n}\n","import AutoScaler from \"./AutoScaler\";\n\nexport default AutoScaler;\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`ibcd0b21d7ccf498b89d8ce646138a3ec-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import Notification from \"./Notification\";\n\nexport default Notification;\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport Animation from \"@components/Animation\";\nimport ButtonTransparent from \"@components/ButtonTransparent\";\nimport Padding from \"@components/Padding\";\n\nimport InfoIcon from \"@icons/InfoIcon\";\nimport CloseIcon from \"@icons/CloseIcon\";\n\nimport styles from \"./Notification.module.css\";\n\n// TODO: Add PropTypes\n// TODO: Document\nexport default function Notification({\n  body,\n  image,\n  title,\n  uuid,\n  onClose,\n  onClick,\n  // In milliseconds\n  autoCloseTime = 4000,\n  ...rest\n}) {\n  // TODO: Should this state be managed from the outside?\n  const [isClosing, setIsClosing] = useState(false);\n\n  // IMPORTANT: refOnClose is memoized to fix an issue where generating new\n  // notifications would restart the internal timer\n  const refOnClose = useRef(onClose);\n  const handleClose = useCallback(\n    evt => {\n      if (evt) {\n        evt.stopPropagation();\n      }\n\n      setIsClosing(true);\n\n      // NOTE (jh): We could also listen for Animation ended event, but decided\n      // to do the easy route at first.\n      setTimeout(\n        () => {\n          refOnClose.current(uuid);\n        },\n        // TODO: Make this value dynamic?\n        500\n      );\n    },\n    [uuid]\n  );\n\n  const [el, setEl] = useState(null);\n\n  // TODO: Document\n  useEffect(() => {\n    if (el) {\n      let autoCloseTimeout = null;\n\n      const startTimeout = () => {\n        autoCloseTimeout = setTimeout(handleClose, autoCloseTime);\n      };\n\n      startTimeout();\n\n      const stopTimeout = () => {\n        clearTimeout(autoCloseTimeout);\n      };\n\n      el.addEventListener(\"mouseover\", stopTimeout, { passive: true });\n      el.addEventListener(\"mouseout\", startTimeout, { passive: true });\n      el.addEventListener(\"touchstart\", stopTimeout, { passive: true });\n\n      return function unmount() {\n        el.removeEventListener(\"mouseover\", stopTimeout, { passive: true });\n        el.removeEventListener(\"mouseout\", startTimeout, { passive: true });\n        el.removeEventListener(\"touchstart\", stopTimeout, { passive: true });\n\n        stopTimeout();\n      };\n    }\n  }, [el, autoCloseTime, handleClose]);\n\n  // TODO: Refactor into Image component?\n  const Image = useMemo(\n    () => () => {\n      switch (typeof image) {\n        case \"string\":\n          return (\n            <img alt={title} src={image} className={styles[\"main-image\"]} />\n          );\n\n        case \"function\":\n          return image();\n\n        default:\n          return image || <InfoIcon />;\n      }\n    },\n    [image, title]\n  );\n\n  /**\n   * Note: Exports a button only if an onClick handler has been defined for\n   * the notification.\n   */\n  const MessageButton = useMemo(\n    () =>\n      ({ ...rest }) =>\n        typeof onClick === \"function\" ? (\n          <ButtonTransparent\n            {...rest}\n            onClick={onClick}\n            className={styles[\"action\"]}\n          />\n        ) : (\n          <React.Fragment {...rest} />\n        ),\n    [onClick]\n  );\n\n  return (\n    <div\n      ref={setEl}\n      onTouchEnd={handleClose}\n      onMouseUp={handleClose}\n      className={styles[\"notification\"]}\n      {...rest}\n    >\n      <Animation\n        animationName={!isClosing ? \"slideInRight\" : \"slideOutRight\"}\n        animationDuration=\".5s\"\n      >\n        <div className={styles[\"body-outer-wrap\"]}>\n          <MessageButton>\n            <Padding>\n              <div className={styles[\"main-image-wrap\"]}>\n                <Image />\n              </div>\n              <div className={styles[\"title\"]}>{title}</div>\n\n              <div className={styles[\"body\"]}>{body}</div>\n            </Padding>\n          </MessageButton>\n          <ButtonTransparent onClick={handleClose} className={styles[\"close\"]}>\n            <Padding>\n              <CloseIcon />\n            </Padding>\n          </ButtonTransparent>\n        </div>\n      </Animation>\n    </div>\n  );\n}\n","import NotificationStack from \"./NotificationStack\";\n\nexport default NotificationStack;\n","import React from \"react\";\n\nimport styles from \"./NotificationStack.module.css\";\n\nimport Notification from \"../Notification\";\n\n// TODO: Fix issue where notifications may move up if previous notifications\n// are closed before-hand\n\n// TODO: Document\n// Handles multiple-rendered notifications\nexport default function NotificationStack({\n  notifications = [],\n  onNotificationClose,\n}) {\n  return (\n    <div className={styles[\"notification-stack\"]}>\n      {\n        // NOTE: The inner-wrap enables too many UI notifications to be\n        // scrollable\n      }\n      <div className={styles[\"inner-wrap\"]}>\n        {\n          // IMPORTANT: onClose is not mapped from the data object because it is\n          // handled internally by the provider\n          notifications.map(({ body, image, onClick, title, uuid }) => {\n            return (\n              <div key={uuid}>\n                <Notification\n                  body={body}\n                  image={image}\n                  onClick={onClick}\n                  title={title}\n                  uuid={uuid}\n                  onClose={() => onNotificationClose(uuid)}\n                />\n              </div>\n            );\n          })\n        }\n      </div>\n    </div>\n  );\n}\n","import React, { useCallback } from \"react\";\n\nimport NotificationStack from \"./views/NotificationStack\";\nimport useServiceClass from \"@hooks/useServiceClass\";\nimport UINotificationService from \"@services/UINotificationService\";\n\nexport const NotificationContext = React.createContext({});\n\n// TODO: Document\n// TODO: Borrow API logic from https://www.npmjs.com/package/react-notifications\nexport default function NotificationProvider({ children }) {\n  const { serviceInstance, serviceState } = useServiceClass(\n    UINotificationService\n  );\n\n  // TODO: Document\n  const showNotification = useCallback(\n    notification => serviceInstance.showNotification(notification),\n    [serviceInstance]\n  );\n\n  // TODO: Document\n  const closeNotificationWithUUID = useCallback(\n    uuid => serviceInstance.closeNotificationWithUUID(uuid),\n    [serviceInstance]\n  );\n\n  return (\n    <NotificationContext.Provider\n      value={{\n        showNotification,\n      }}\n    >\n      {children}\n\n      <NotificationStack\n        notifications={serviceState.notifications}\n        onNotificationClose={closeNotificationWithUUID}\n      />\n    </NotificationContext.Provider>\n  );\n}\n","import NotificationProvider, {\n  NotificationContext,\n} from \"./NotificationProvider\";\n\nexport default NotificationProvider;\nexport { NotificationContext };\n","import Modal from \"./Modal\";\n\nexport default Modal;\n","import React from \"react\";\n\nimport Cover from \"@components/Cover\";\n\n// TODO: Add PropTypes\n// TODO: Document\nexport default function Modal({ view: View, onClose, ...rest }) {\n  return (\n    <Cover>\n      <View {...rest} onClose={onClose} />\n    </Cover>\n  );\n}\n","import ModalStack from \"./ModalStack\";\n\nexport default ModalStack;\n","import React from \"react\";\n\nimport Modal from \"../Modal\";\n\n// TODO: Document\n// Handles multiple-rendered modals\nexport default function ModalStack({ modals = [] }) {\n  return (\n    <>\n      {modals.map(({ view, uuid, onClose, ...rest }) => {\n        return (\n          <div key={uuid}>\n            <Modal {...rest} view={view} uuid={uuid} onClose={onClose} />\n          </div>\n        );\n      })}\n    </>\n  );\n}\n","import React, { useCallback } from \"react\";\n\nimport ModalStack from \"./views/ModalStack\";\nimport useServiceClass from \"@hooks/useServiceClass\";\nimport UIModalService from \"@services/UIModalService\";\n\nexport const ModalContext = React.createContext({});\n\n// TODO: Document\nexport default function ModalProvider({ children }) {\n  const { serviceInstance, serviceState } = useServiceClass(UIModalService);\n\n  // TODO: Document\n  const showModal = useCallback(\n    modal => serviceInstance.showModal(modal),\n    [serviceInstance]\n  );\n\n  return (\n    <ModalContext.Provider\n      value={{\n        showModal,\n      }}\n    >\n      {children}\n\n      <ModalStack modals={serviceState.modals} />\n    </ModalContext.Provider>\n  );\n}\n","import ModalProvider, { ModalContext } from \"./ModalProvider\";\n\nexport default ModalProvider;\nexport { ModalContext };\n","import Desktop from \"./Desktop\";\n\nexport default Desktop;\n","import PhantomCore from \"phantom-core\";\nimport ReShellCore from \"@core\";\n\nimport WindowManager from \"./Desktop.WindowManager\";\nimport TopBar from \"./Desktop.TopBar\";\nimport Dock from \"./Desktop.Dock\";\n\nimport FullViewport from \"../FullViewport\";\nimport Cover from \"../Cover\";\nimport Layout, { Header, Content } from \"../Layout\";\n\nimport AutoScaler from \"../AutoScaler\";\n\nimport NotificationProvider from \"./providers/NotificationProvider\";\nimport ModalProvider from \"./providers/ModalProvider\";\n\n// TODO: Consider using Noto Sans font for UI (same that Slack uses, nice font;\n// preload resources w/ Preloader component): https://fonts.google.com/noto/specimen/Noto+Sans\n\n// TODO: Implement context menu\n// @see https://szhsin.github.io/react-menu/#context-menu\n\n// TODO: Use prop-types\n// TODO: Document\nexport default function Desktop({ backgroundView = null, appDescriptors }) {\n  return (\n    <FullViewport>\n      {\n        // IMPORTANT: Using NotificationProvider directly on the BaseView does\n        // not apply CSS module styling\n      }\n      <ModalProvider>\n        <NotificationProvider>\n          <Cover\n            // TODO: Remove this hardcoding\n            style={{\n              backgroundColor: \"#424242\",\n            }}\n          >\n            {\n              // TODO: Refactor\n            }\n            {backgroundView}\n          </Cover>\n          <Cover>\n            <Layout>\n              <Header\n                style={{\n                  // borderBottom: \"1px #ccc solid\",\n                  whiteSpace: \"nowrap\",\n                  backgroundColor: \"rgba(0,0,0,.5)\",\n                }}\n              >\n                <TopBar />\n              </Header>\n              <Content>\n                {\n                  // TODO: Allow videos to play on background\n                }\n\n                {\n                  // TODO: Refactor into a version component\n                }\n                <div\n                  style={{\n                    maxWidth: \"50%\",\n                    position: \"absolute\",\n                    bottom: 28,\n                    right: 10,\n                    color: \"rgba(255,255,255,.2)\",\n                    fontSize: \"2rem\",\n\n                    // The following properties enable this to overlay all (or\n                    // most) other components without interfering with their\n                    // handling (thanks to \"pointer-events: none\")\n                    pointerEvents: \"none\",\n                    // FIXME: (jh) Is there a way to do this overlawy w/o using\n                    // z-index?\n                    zIndex: 2147483647,\n                  }}\n                >\n                  <AutoScaler style={{ whiteSpace: \"nowrap\" }}>\n                    <div style={{ textAlign: \"left\", fontSize: \".5em\" }}>\n                      {\n                        // TODO: Load as env variable\n                      }\n                      <div>ReShell {ReShellCore.getReShellVersion()}</div>\n                      <div>\n                        PhantomCore {PhantomCore.getPhantomCoreVersion()}\n                      </div>\n                      {\n                        // FIXME: (jh) This typically always renders \"default\"\n                        // for the portal name, and portal name acquisition\n                        // needs to be improved (more than likely via\n                        // reshell-scripts and __registerPortals__.js)\n                        /*\n                        <div>Portal: {ReShellCore.getPortalName()}</div>\n                        */\n                      }\n                      <div>Env: {process.env.NODE_ENV}</div>\n                    </div>\n                  </AutoScaler>\n                </div>\n                <WindowManager appDescriptors={appDescriptors}>\n                  <Dock />\n                </WindowManager>\n              </Content>\n            </Layout>\n          </Cover>\n        </NotificationProvider>\n      </ModalProvider>\n    </FullViewport>\n  );\n}\n","import VirtualLink from \"./VirtualLink\";\n\nexport default VirtualLink;\n","import ButtonTransparent from \"../ButtonTransparent\";\n\nimport styles from \"./VirtualLink.module.css\";\nimport classNames from \"classnames\";\n\n/**\n * NOTE: Fake links need to be a button, so this button is designed to look\n * like a real link, for the most part.\n */\nexport default function VirtualLink({ children, className, onClick, ...rest }) {\n  return (\n    <ButtonTransparent\n      {...rest}\n      // IMPORTANT: The seemingly double link styles are placed on purpose (one\n      // is the normal CSS, and the other is the module.css override)\n      className={classNames(\"link\", styles[\"virtual-link\"], className)}\n      onClick={onClick}\n    >\n      {children}\n    </ButtonTransparent>\n  );\n}\n","import LED from \"./LED\";\n\nexport default LED;\n","import React from \"react\";\nimport styles from \"./LED.module.css\";\nimport classNames from \"classnames\";\nimport PropTypes from \"prop-types\";\n\nLED.propTypes = {\n  /** The color of the LED */\n  color: PropTypes.string,\n};\n\n/**\n * @see https://github.com/aus/led.css\n * @see http://jsfiddle.net/XrHcA/\n */\nexport default function LED({ color = null, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"led\"], styles[color])}></div>\n  );\n}\n","import { consume } from \"phantom-core\";\nimport { useMemo } from \"react\";\nimport Center from \"@components/Center\";\nimport LED from \"@components/LED\";\nimport Padding from \"@components/Padding\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nexport default function ApplicationSelector({\n  searchQuery = \"\",\n  onResetSearchQuery,\n}) {\n  const { appRegistrations, appRuntimes, activateAppRegistration } =\n    useAppOrchestrationContext();\n\n  const appRuntimeRegistrations = useMemo(\n    () => appRuntimes.map(runtime => runtime.getRegistration()),\n    [appRuntimes]\n  );\n\n  // TODO: Move application search into a service and implement keyword-based\n  // searching, other criteria\n  const filteredRegistrations = useMemo(\n    () =>\n      appRegistrations.filter(registration =>\n        !Boolean(searchQuery)\n          ? true\n          : registration\n              .getTitle()\n              .toUpperCase()\n              .includes(searchQuery.toUpperCase())\n      ),\n    [appRegistrations, searchQuery]\n  );\n\n  if (searchQuery?.length && !filteredRegistrations.length) {\n    return (\n      <Center>\n        <Padding style={{ fontWeight: \"bold\" }}>\n          No applications found for search.\n        </Padding>\n        <Padding>\n          <button onClick={onResetSearchQuery}>Reset Search Query</button>\n        </Padding>\n      </Center>\n    );\n  }\n\n  return (\n    <Center canOverflow={true}>\n      <Padding>\n        {filteredRegistrations.map(registration => {\n          // const isRunning = appRuntimeRegistrations.includes(registration);\n          const totalInstances = appRuntimeRegistrations.filter(\n            predicate => predicate === registration\n          ).length;\n\n          return (\n            <button\n              key={registration.getUUID()}\n              // TODO: Extract to module.css\n              style={{\n                width: 100,\n                height: 100,\n                // IMPORTANT: This overflow being hidden was causing an issue\n                // in Chrome where buttons could be clickable in the title bar\n                // region of the window, if scrolled beyond.\n                // Relevant issue: https://github.com/jzombie/pre-re-shell/issues/169\n                //\n                // overflow: \"hidden\",\n                backgroundColor: \"transparent\",\n                borderColor: totalInstances > 0 ? \"green\" : \"\",\n              }}\n              onClick={() => activateAppRegistration(registration)}\n            >\n              {registration.getTitle()}\n\n              {\n                // FIXME: (jh) This isn't valid HTML, as a button element\n                // shouldn't contain non-inline styling\n              }\n              <div style={{ position: \"absolute\", bottom: 0, right: 0 }}>\n                {[...new Array(totalInstances)].map((nonUsed, idx) => {\n                  consume(nonUsed);\n\n                  return (\n                    <LED\n                      key={idx}\n                      color={totalInstances > 0 ? \"green\" : \"gray\"}\n                      // TODO: Extract to module.css\n                      style={{ margin: \"0px 2px\" }}\n                    />\n                  );\n                })}\n              </div>\n            </button>\n          );\n        })}\n      </Padding>\n    </Center>\n  );\n}\n","import Center from \"@components/Center\";\n\nimport ReShellCore from \"@core\";\n\nexport default function PortalSwitcher() {\n  return (\n    <Center canOverflow={true}>\n      {Object.entries(ReShellCore.getPortals()).map(([portalName]) => (\n        <button\n          key={portalName}\n          onClick={() =>\n            // TODO: Use dialog modal for this, and dynamically set the title based on the current portal state\n            window.confirm(\n              \"Any unsaved state will be lost and the current call will be dropped if switching portals.  Proceed?\"\n            ) && ReShellCore.switchToPortal(portalName)\n          }\n        >\n          {portalName}\n        </button>\n      ))}\n    </Center>\n  );\n}\n","import ReShellCore from \"@core\";\n\nimport { useCallback, useEffect, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\nimport VirtualLink from \"@components/VirtualLink\";\n\nimport useKeyboardEvents from \"@hooks/useKeyboardEvents\";\n\nimport ApplicationSelector from \"./views/ApplicationSelector\";\nimport PortalSwitcher from \"./views/PortalSelector\";\n\nconst LEN_PORTALS = Object.keys(ReShellCore.getPortals()).length;\n\nconst DEFAULT_SEARCH_QUERY = \"\";\n\nexport const REGISTRATION_ID = \"applications\";\n\nconst ApplicationsApp = {\n  id: REGISTRATION_ID,\n  title: \"Applications\",\n  style: {\n    width: 640 * 1.2,\n    height: 400 * 1.2,\n  },\n  isAutoStart: true,\n  isPinnedToDock: true,\n  initialSharedState: {\n    searchQuery: DEFAULT_SEARCH_QUERY,\n  },\n  // TODO: Implement the ability to set control handlers which can be driven by the menu\n  /*\n  controlMethods: {\n    // [ROLE_WINDOW_MENU_SUBITEM]\n    setIsDisplayingPortals: ({...samePropsAsView, etc.}) => {\n    }\n  },\n  */\n  // TODO: Implement custom menu functionality\n  /**\n  menu: {\n    window: [\n      {\n        role: 'view-switch'\n        getIsShown: ({sharedState}) => !sharedState.isShowingApplications\n        title: 'Show Applications',\n        onClick: ({controlMethods}) => ...\n      },\n      {\n        role: 'view-switch'\n        getIsShown: ({sharedState}) => sharedState.isShowingApplications\n        title: 'Show Portals',\n        onClick: ({controlMethods}) => ...\n      },\n  ]\n  }\n  */\n  titleBarView: function TitleBarView({ sharedState, setSharedState }) {\n    const [elSearch, setElSearch] = useState(null);\n\n    // Clear search query on escape\n    useKeyboardEvents(elSearch, {\n      onEscape: () => setSharedState({ searchQuery: \"\" }),\n    });\n\n    const handleSetSearchQuery = useCallback(\n      evt => setSharedState({ searchQuery: evt.target.value }),\n      [setSharedState]\n    );\n\n    const handleDoubleClick = useCallback(\n      evt => {\n        // Prevent double-clicks from propagating if there is text\n        if (Boolean(sharedState.searchQuery)) {\n          evt.stopPropagation();\n        }\n      },\n      [sharedState]\n    );\n\n    return (\n      <Padding>\n        {\n          // TODO: Automatically focus when window is activated (unless on mobile)\n          //\n          // TODO: Switch to Applications view on change\n          //\n          // FIXME: (jh) I tried to use type=\"search\", which gives you an X in\n          // the input field, however I wasn't able to make it clear itself. If\n          // this were an uncontrolled component, it might work. Needs some\n          // refactoring.\n          //\n          // FIXME: Create common TextInput component which has double-click\n          // functionality baked in; use in TextInputModal as well, etc. It\n          // shouldn't get fancy and it should be compatible with regular DOM-\n          // based text input props\n        }\n        <input\n          ref={setElSearch}\n          placeholder=\"Search Applications\"\n          onChange={handleSetSearchQuery}\n          value={sharedState.searchQuery}\n          style={{ width: \"100%\" }}\n          onDoubleClick={handleDoubleClick}\n        />\n      </Padding>\n    );\n  },\n  view: function View({ windowController, sharedState, setSharedState }) {\n    const [isDisplayingPortals, setIsDisplayingPortals] = useState(false);\n\n    // Auto-switch window title depending on \"Applications\" or \"Portals\" mode\n    useEffect(() => {\n      windowController.setTitle(\n        // TODO: Use default values instead of hardcoded\n        !isDisplayingPortals ? \"Applications\" : \"Portals\"\n      );\n    }, [windowController, isDisplayingPortals]);\n\n    const searchQuery = sharedState?.searchQuery;\n\n    const handleResetSearchQuery = useCallback(\n      () => setSharedState({ searchQuery: DEFAULT_SEARCH_QUERY }),\n      [setSharedState]\n    );\n\n    return (\n      <Layout>\n        <Content>\n          {!isDisplayingPortals ? (\n            <ApplicationSelector\n              searchQuery={searchQuery}\n              onResetSearchQuery={handleResetSearchQuery}\n            />\n          ) : (\n            <PortalSwitcher />\n          )}\n        </Content>\n        {Boolean(LEN_PORTALS > 1) && (\n          <Footer>\n            <Padding>\n              <button onClick={() => setIsDisplayingPortals(prev => !prev)}>\n                {!isDisplayingPortals ? \"Portals\" : \"Applications\"}\n              </button>{\" \"}\n              <span className=\"note\">\n                {!isDisplayingPortals ? (\n                  <>\n                    Other applications may be available in{\" \"}\n                    <VirtualLink onClick={() => setIsDisplayingPortals(true)}>\n                      another portal\n                    </VirtualLink>\n                    .\n                  </>\n                ) : (\n                  <>\n                    Return to{\" \"}\n                    <VirtualLink onClick={() => setIsDisplayingPortals(false)}>\n                      application list\n                    </VirtualLink>\n                    .\n                  </>\n                )}\n              </span>\n            </Padding>\n          </Footer>\n        )}\n      </Layout>\n    );\n  },\n};\n\nexport default ApplicationsApp;\n","import ApplicationsApp, { REGISTRATION_ID } from \"./ApplicationsApp\";\n\nexport default ApplicationsApp;\nexport { REGISTRATION_ID };\n","import ApplicationsApp from \"../../ExamplePortal/apps/ApplicationsApp\";\n\nconst ApplicationsOverrideApp = {\n  ...ApplicationsApp,\n  isAutoStart: false,\n};\n\nexport default ApplicationsOverrideApp;\n","import StickyTable from \"./StickyTable\";\n\nexport default StickyTable;\n","import classNames from \"classnames\";\nimport styles from \"./StickyTable.module.css\";\n\n/**\n * A light wrapper around HTML table elements which provides sticky thead and\n * tbody elements.\n *\n * @see https://css-tricks.com/making-tables-with-sticky-header-and-footers-got-a-bit-easier/\n * @see https://caniuse.com/css-sticky\n */\nexport default function StickyTable({ className, children, ...rest }) {\n  return (\n    <table className={classNames(styles[\"sticky\"], className)} {...rest}>\n      {children}\n    </table>\n  );\n}\n","import Timer from \"./Timer\";\n\nexport default Timer;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport NoWrap from \"../NoWrap\";\n\nimport PropTypes from \"prop-types\";\n\nTimer.propTypes = {\n  onTick: PropTypes.func.isRequired,\n};\n\n// TODO: Document\nexport default function Timer({ onTick, className, ...rest }) {\n  const [seconds, _setSeconds] = useState(onTick());\n\n  const getSeconds = useCallback(() => {\n    const seconds = onTick();\n\n    return seconds;\n  }, [onTick]);\n\n  useEffect(() => {\n    const handleUpdate = () => _setSeconds(getSeconds());\n\n    // Perform initial render\n    handleUpdate();\n\n    // FIXME: (jh) Would it be more performant to combine these intervals?\n    const updateInterval = window.setInterval(handleUpdate, 1000);\n\n    return function unmount() {\n      window.clearInterval(updateInterval);\n    };\n  }, [getSeconds]);\n\n  return <NoWrap {...rest}>{getSecondsToHHMMSS(seconds)}</NoWrap>;\n}\n\n// TODO: Refactor\n/**\n * @see https://stackoverflow.com/questions/1322732/convert-seconds-to-hh-mm-ss-with-javascript\n *\n * @param {number} seconds\n * @return {string} hh:mm:ss format\n */\nfunction getSecondsToHHMMSS(secs) {\n  // Note: This version should handle seconds if length is longer than one day\n  return new Date((secs % (60 * 60 * 24)) * 1000).toISOString().substr(11, 8);\n}\n","import { consume } from \"phantom-core\";\nimport { useEffect, useState } from \"react\";\nimport Timer from \"@components/Timer\";\nimport { EVT_RENDER_PROFILED } from \"@components/Window/classes/WindowController\";\nimport LED from \"@components/LED\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\n\nexport default function AppRuntimeTableRow({ appRuntime }) {\n  const { activeWindowController } = useDesktopContext();\n\n  const windowController = appRuntime.getWindowController();\n\n  const isTopMostWindowController =\n    !windowController || windowController === activeWindowController;\n\n  const [elProfilerPhase, setElProfilerPhase] = useState(null);\n  const [elProfilerActualDuration, setElProfilerActualDuration] =\n    useState(null);\n  const [elProfilerBaseDuration, setElProfilerBaseDuration] = useState(null);\n  const [elProfilerStartTime, setElProfilerStartTime] = useState(null);\n  const [elProfilerCommitTime, setElProfilerCommitTime] = useState(null);\n  const [elProfilerInteractions, setElProfilerInteractions] = useState(null);\n\n  useEffect(() => {\n    if (windowController && elProfilerPhase) {\n      // @see https://reactjs.org/docs/profiler.html\n      const handleRenderProfile = arrRenderProfile => {\n        // IMPORTANT: (jh) This was not cast to an Object because I'm not\n        // positive if that would induce a lot of extra overhead over time;\n        // React defines this as an array, so maybe it's best just leaving it\n        // the way it is\n        const [\n          id, // the \"id\" prop of the Profiler tree that has just committed\n          phase, // either \"mount\" (if the tree just mounted) or \"update\" (if it re-rendered)\n          actualDuration, // time spent rendering the committed update\n          baseDuration, // estimated time to render the entire subtree without memoization\n          startTime, // when React began rendering this update\n          commitTime, // when React committed this update\n          interactions, // the Set of interactions belonging to this update\n        ] = arrRenderProfile;\n\n        // We're not doing anything w/ id, but if we remove it from the array,\n        // the other variable names are out of sync\n        consume(id);\n\n        // We have to skip setting these as state or we'll run into an infinite loop\n        elProfilerPhase.innerHTML = phase;\n        elProfilerActualDuration.innerHTML =\n          parseFloat(actualDuration).toFixed(2);\n        elProfilerBaseDuration.innerHTML = parseFloat(baseDuration).toFixed(2);\n        elProfilerStartTime.innerHTML = parseFloat(startTime / 1000).toFixed(2);\n        elProfilerCommitTime.innerHTML = parseFloat(commitTime / 1000).toFixed(\n          2\n        );\n        elProfilerInteractions.innerHTML = Object.values(interactions).length;\n      };\n\n      windowController.on(EVT_RENDER_PROFILED, handleRenderProfile);\n\n      return function unmount() {\n        windowController.off(EVT_RENDER_PROFILED, handleRenderProfile);\n      };\n    }\n  }, [\n    windowController,\n    elProfilerPhase,\n    elProfilerActualDuration,\n    elProfilerBaseDuration,\n    elProfilerStartTime,\n    elProfilerCommitTime,\n    elProfilerInteractions,\n  ]);\n\n  return (\n    <>\n      <tr key={appRuntime.getUUID()} style={{ textAlign: \"center\" }}>\n        <td>{appRuntime.getTitle() || \"[Untitled]\"}</td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerPhase}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerActualDuration}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerBaseDuration}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerStartTime}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerCommitTime}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerInteractions}>N/A</span>\n        </td>\n      </tr>\n      <tr style={{ textAlign: \"center\" }}>\n        <td style={{ fontStyle: \"italic\" }}>\n          Uptime: <Timer onTick={() => appRuntime.getInstanceUptime()} />\n        </td>\n        <td colSpan=\"3\">\n          <button\n            // TODO: Implement alternate handling\n            onClick={() => console.log({ appRuntime })}\n            disabled\n          >\n            Process\n          </button>\n          <span> | </span>\n          <button\n            // TODO: Implement alternate handling\n            onClick={() =>\n              console.log({ environment: appRuntime.getEnvironment() })\n            }\n            disabled\n          >\n            Environment\n          </button>\n        </td>\n        <td>\n          <LED color={isTopMostWindowController ? \"green\" : \"gray\"} />\n        </td>\n        <td colSpan=\"2\">\n          <button\n            onClick={() => windowController.bringToTop()}\n            style={{ backgroundColor: \"blue\" }}\n            disabled={isTopMostWindowController}\n          >\n            Bring to Top\n          </button>\n          <span> | </span>\n          <button\n            onClick={() => {\n              if (!appRuntime.getIsDestroying()) {\n                appRuntime.destroy();\n              }\n            }}\n            style={{ backgroundColor: \"red\" }}\n          >\n            Close\n          </button>\n        </td>\n      </tr>\n      <tr>\n        <td colSpan=\"7\" style={{ backgroundColor: \"gray\", height: 4 }}></td>\n      </tr>\n    </>\n  );\n}\n","import StickyTable from \"@components/StickyTable\";\nimport AppRuntimeTableRow from \"./AppRuntime.Table.Row\";\n\n// TODO: Document\nexport default function AppRuntimeTable({ appRuntimes }) {\n  return (\n    <StickyTable style={{ width: \"100%\" }}>\n      <thead>\n        <tr>\n          <td rowSpan=\"2\">Name</td>\n          <td colSpan=\"6\" style={{ backgroundColor: \"purple\" }}>\n            Profiler\n          </td>\n          <td colSpan=\"2\"></td>\n        </tr>\n        <tr>\n          <td style={{ backgroundColor: \"purple\" }}>Phase</td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Actual\n            <br />\n            Duration\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Base\n            <br />\n            Duration\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Start\n            <br />\n            Time\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Commit\n            <br />\n            Time\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>Interactions</td>\n        </tr>\n      </thead>\n      <tbody>\n        {appRuntimes.map(runtime => (\n          <AppRuntimeTableRow key={runtime.getUUID()} appRuntime={runtime} />\n        ))}\n      </tbody>\n    </StickyTable>\n  );\n}\n","import AppLinkButton from \"./AppLinkButton\";\n\nexport default AppLinkButton;\n","import { useMemo } from \"react\";\nimport useAppRegistrationLink from \"@hooks/useAppRegistrationLink\";\nimport ButtonTransparent from \"../ButtonTransparent\";\n\nimport PropTypes from \"prop-types\";\n\n// FIXME: (jh) Apply \"active\" class to button whenever registration is active?\n\nAppLinkButton.propTypes = {\n  // App descriptor / registration ID\n  id: PropTypes.string.isRequired,\n\n  // Optional title override for button link, if wanting to inherit title from\n  // app itself\n  title: PropTypes.string,\n};\n\n// TODO: Document\nexport default function AppLinkButton({\n  id,\n  children = null,\n  title = null,\n  ...rest\n}) {\n  const { title: registrationTitle, link } = useAppRegistrationLink(id);\n\n  // If there are children, show a non-styled [transparent] button, otherwise,\n  // show a standard button\n  const ButtonView = useMemo(\n    () => props =>\n      children ? <ButtonTransparent {...props} /> : <button {...props} />,\n    [children]\n  );\n\n  // Link might not be available if calling from another portal or if the app\n  // descriptor is not currently registered with app registrations\n  if (!link) {\n    return null;\n  }\n\n  return (\n    <ButtonView\n      // IMPORTANT: ...rest is moved before onClick handler so the internal\n      // onClick handler will not be overridden\n      {...rest}\n      onClick={link}\n    >\n      {children || title || registrationTitle}\n    </ButtonView>\n  );\n}\n","import { useCallback, useMemo } from \"react\";\n// TODO: Refactor\nimport useAppOrchestrationContext from \"./useAppOrchestrationContext\";\n\n// TODO: Move to @core/hooks\n\n// FIXME: (jh) Is there any reason to not just use the appDescriptor itself,\n// and not the ID?\n\n// TODO: Document\nexport default function useAppRegistrationLink(appDescriptorID) {\n  const { getAppRegistrationTitleWithID, activateAppRegistrationWithID } =\n    useAppOrchestrationContext();\n\n  const title = useMemo(\n    () => getAppRegistrationTitleWithID(appDescriptorID),\n    [getAppRegistrationTitleWithID, appDescriptorID]\n  );\n  const link = useCallback(\n    () => activateAppRegistrationWithID(appDescriptorID),\n    [activateAppRegistrationWithID, appDescriptorID]\n  );\n\n  return {\n    title,\n    link,\n  };\n}\n","// NOTE: No hook is wrapped directly around this because the goal is to not\n// make it easy to expose services to windows which don't directly use said\n// service\n\nimport PhantomCore from \"phantom-core\";\n\nimport { useContext } from \"react\";\nimport StickyTable from \"@components/StickyTable\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport Timer from \"@components/Timer\";\nimport NoWrap from \"@components/NoWrap\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { UIServicesContext } from \"@core/providers/UIServicesProvider\";\n\nimport { REGISTRATION_ID as APPLICATION_MONITOR_REGISTRATION_ID } from \"./ApplicationMonitorApp\";\n\n// TODO: Include (either here, or elsewhere,) ability to monitor running\n// PhantomCore instances (use WeakRef here or there, as well)?\n\n// TODO: Include links to apps which are using this service\n\n// TODO: Show last update time, state, etc.\n\n// TODO: Include ability to render service reporters, once functionality is\n// integrated\n\nexport const REGISTRATION_ID = \"service-monitor\";\n\nconst ServiceMonitorApp = {\n  id: REGISTRATION_ID,\n  title: \"Service Monitor\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  isPinned: true,\n  view: function View() {\n    const { services } = useContext(UIServicesContext);\n\n    // TODO: Group by runtime\n\n    return (\n      <Layout>\n        <Content>\n          <Full style={{ overflowY: \"auto\" }}>\n            <StickyTable style={{ width: \"100%\" }}>\n              <thead>\n                <tr>\n                  <td>\n                    <Padding>Service Name</Padding>\n                  </td>\n                  <td>\n                    <Padding>Uptime</Padding>\n                  </td>\n                  <td>\n                    <Padding>f(x)</Padding>\n                  </td>\n                  {/**\n              <td>\n                Active\n                <br />\n                App Runtimes\n              </td>\n              <td>\n                Dynamically\n                <br />\n                Linked Providers\n              </td>  \n               */}\n                </tr>\n              </thead>\n              <tbody>\n                {services.map(service => (\n                  <tr key={service.getUUID()}>\n                    <td>\n                      <Padding>{service.getTitle() || \"[Untitled]\"}</Padding>\n                    </td>\n                    <td className=\"center\">\n                      <Timer onTick={() => service.getInstanceUptime()} />\n                    </td>\n                    {/*\n                  <td className=\"center\">N/A</td>\n                  <td className=\"center\">N/A</td>\n                  */}\n                    {/*\n              <td>\n                <button\n                  onClick={() => service.destroy()}\n                  style={{ width: \"100%\" }}\n                >\n                  Close\n                </button>\n              </td>\n                */}\n                    <td className=\"center\">\n                      {\n                        // TODO: Remove\n                      }\n                      <Padding>\n                        <button onClick={() => service.log(service.getState())}>\n                          <NoWrap>log(state)</NoWrap>\n                        </button>\n                      </Padding>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </StickyTable>\n          </Full>\n        </Content>\n        <Footer>\n          <hr style={{ margin: 0, padding: 0 }} />\n          <Padding>\n            <Full>\n              <div style={{ position: \"absolute\", bottom: 0, left: 0 }}>\n                PhantomCore uptime:{\" \"}\n                <Timer onTick={() => PhantomCore.getUptime()} />\n              </div>\n              <AppLinkButton\n                id={APPLICATION_MONITOR_REGISTRATION_ID}\n                style={{ float: \"right\", verticalAlign: \"bottom\" }}\n              />\n            </Full>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ServiceMonitorApp;\n","import PhantomCore from \"phantom-core\";\n\nimport { useEffect } from \"react\";\n\nimport AppRuntimeTable from \"./AppRuntime.Table\";\n\nimport Center from \"@components/Center\";\nimport Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Timer from \"@components/Timer\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { REGISTRATION_ID as SERVICE_MONITOR_REGISTRATION_ID } from \"../ServiceMonitorApp\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nexport const REGISTRATION_ID = \"application-monitor\";\n\nconst ApplicationMonitorApp = {\n  id: REGISTRATION_ID,\n  title: \"Application Monitor\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  isPinned: true,\n  view: function View({ windowController }) {\n    const { appRuntimes } = useAppOrchestrationContext();\n    const { isProfiling, setIsProfiling } = useDesktopContext();\n\n    useEffect(() => {\n      if (isProfiling) {\n        return () => setIsProfiling(false);\n      }\n    }, [isProfiling, setIsProfiling]);\n\n    // TODO: Determine if profiler is available in the current environment\n\n    // TODO: Group by registration\n    // TODO: Show attached services, per application\n    // TODO: Show last render time / frequency / graph?\n    // TODO: Implement ability to record render profile intervals, with the ability to show them in a graph (per application; use legend)\n    // TODO: Implement ability to show how linked services affect render profiles; capture in recordings\n    // TODO: Implement ability to do call stack tracing (only when recording)\n\n    if (!isProfiling) {\n      return (\n        <Center>\n          <div>\n            <p style={{ fontWeight: \"bold\" }}>\n              Application Profiling is experimental!\n            </p>\n\n            <ol\n              style={{\n                maxWidth: 500,\n                textAlign: \"left\",\n                display: \"inline-block\",\n              }}\n            >\n              <li>\n                Each window may lose its current state once profiling is\n                enabled.\n              </li>\n              <li>\n                Also, once enabled and closing this application, the state may\n                be lost again!\n              </li>\n            </ol>\n\n            <Padding>\n              <button\n                onClick={() => setIsProfiling(true)}\n                style={{ backgroundColor: \"red\" }}\n              >\n                Enable Profiling\n              </button>\n              <p className=\"note\">\n                Profiling will be disabled once closing this window\n              </p>\n            </Padding>\n          </div>\n        </Center>\n      );\n    }\n\n    return (\n      <Layout>\n        <Content>\n          <Padding style={{ overflowY: \"auto\" }}>\n            <AppRuntimeTable appRuntimes={appRuntimes} />\n          </Padding>\n        </Content>\n        <Footer style={{ fontSize: \".8rem\" }}>\n          <hr style={{ margin: 0, padding: 0 }} />\n          <Padding>\n            <Full>\n              <div style={{ position: \"absolute\", bottom: 0, left: 0 }}>\n                PhantomCore uptime:{\" \"}\n                <Timer onTick={() => PhantomCore.getUptime()} />\n              </div>\n              <AppLinkButton\n                id={SERVICE_MONITOR_REGISTRATION_ID}\n                style={{ float: \"right\", verticalAlign: \"bottom\" }}\n              />\n            </Full>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ApplicationMonitorApp;\n","import ApplicationMonitorApp, {\n  REGISTRATION_ID,\n} from \"./ApplicationMonitorApp\";\n\nexport default ApplicationMonitorApp;\nexport { REGISTRATION_ID };\n","import ButtonPanel from \"./ButtonPanel\";\n\nexport default ButtonPanel;\n","import React, { useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\n\nButtonPanel.propTypes = {\n  buttons: PropTypes.arrayOf(\n    PropTypes.shape({\n      // TODO: Require to be React component (or any?)\n      // TODO: Rename to view, or label\n      content: PropTypes.any.isRequired,\n\n      onClick: PropTypes.func.isRequired,\n\n      type: PropTypes.string,\n\n      disabled: PropTypes.bool,\n\n      // Optional style override\n      style: PropTypes.string,\n\n      // Optional style override\n      className: PropTypes.string,\n\n      /** If set to true, this acts as the default button */\n      isSelected: PropTypes.bool,\n    })\n  ),\n};\n\n/**\n * ButtonPanel is utilized for a set of buttons which need to maintain state\n * relative to one another, operating much like radio controls.\n */\nexport default function ButtonPanel({ buttons, className, ...rest }) {\n  const [selectedIdx, setSelectedIdx] = useState(() => {\n    let selectedIdx = 0;\n\n    buttons.forEach((button, idx) => {\n      if (button.isSelected) {\n        selectedIdx = idx;\n      }\n    });\n\n    return selectedIdx;\n  });\n\n  // TODO: Document\n  const refRenderIdx = useRef(-1);\n  ++refRenderIdx.current;\n\n  return (\n    <div className={classNames(\"button-group\", className)} {...rest}>\n      {buttons.map(\n        (\n          {\n            content: Content,\n            onClick,\n            disabled,\n            isSelected,\n            style,\n            className,\n            type = \"button\",\n            ...args\n          },\n          idx\n        ) => {\n          // If first render, and we're at the defaultSelectedIdx, call the onClick handler\n          // TODO: Detect if first render of React after page updates\n          if (refRenderIdx.current === 0 && selectedIdx === idx) {\n            // Fixes issue:  Cannot update a component (`X`) while rendering a\n            // different component (`Y`).\n            setTimeout(() => {\n              onClick();\n            });\n          }\n\n          return (\n            <button\n              {...args}\n              key={idx}\n              type={type}\n              onClick={() => {\n                setSelectedIdx(idx);\n\n                onClick();\n              }}\n              disabled={disabled}\n              style={style}\n              className={classNames([\n                selectedIdx === idx && \"active\",\n                className,\n              ])}\n            >\n              {\n                // TODO: Refactor\n                typeof Content === \"string\" ? (\n                  Content\n                ) : typeof Content === \"function\" ? (\n                  <Content />\n                ) : (\n                  { Content }\n                )\n              }\n            </button>\n          );\n        }\n      )}\n    </div>\n  );\n}\n","import Toggle from \"./Toggle\";\n\nexport default Toggle;\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./Toggle.module.css\";\nimport PropTypes from \"prop-types\";\nimport useUUID from \"@hooks/useUUID\";\n\nToggle.propTypes = {\n  isOn: PropTypes.bool,\n\n  // Invoked with boolean \"on\" value as its argument\n  onChange: PropTypes.func,\n\n  disabled: PropTypes.bool,\n};\n\nexport default function Toggle({\n  className,\n  isOn,\n  disabled,\n  onChange = () => null,\n  ...rest\n}) {\n  const domId = useUUID();\n\n  return (\n    <div\n      className={classNames(\n        styles[\"toggle-wrapper\"],\n        disabled && styles[\"disabled\"],\n        className\n      )}\n      {...rest}\n    >\n      <input\n        type=\"checkbox\"\n        id={domId}\n        className={styles[\"checkbox\"]}\n        // FIXME: (jh) Implement optional name and value: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/checkbox#value\n        checked={isOn}\n        onChange={evt => onChange(evt.target.checked)}\n        disabled={disabled}\n      />\n      <label htmlFor={domId} className={styles[\"toggle\"]}></label>\n    </div>\n  );\n}\n","import LabeledToggle from \"./LabeledToggle\";\n\nexport default LabeledToggle;\n","import React, { useMemo } from \"react\";\nimport Toggle from \"@components/Toggle\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"./LabeledToggle.module.css\";\n\n// TODO: Apply htmlFor ids for labels\n\nLabeledToggle.propTypes = {\n  labelOff: PropTypes.string,\n  labelOn: PropTypes.string,\n\n  masterLabel: PropTypes.string,\n};\n\n// TODO: Implement ability to disable\nexport default function LabeledToggle({\n  className,\n  labelOff = \"Off\",\n  labelOn = \"On\",\n  masterLabel = \"\",\n  isOn,\n  disabled,\n  style,\n  ...rest\n}) {\n  // Calculate padding for off / on labels in order to keep their positions\n  // centered\n  const [diffOff, diffOn] = useMemo(() => {\n    const lenLabelOff = labelOff.length;\n    const lenLabelOn = labelOn.length;\n    const longestLength =\n      lenLabelOff === lenLabelOn\n        ? lenLabelOff\n        : lenLabelOff > lenLabelOn\n        ? lenLabelOff\n        : lenLabelOn;\n    const diffOff = longestLength - lenLabelOff;\n    const diffOn = longestLength - lenLabelOn;\n\n    return [diffOff, diffOn];\n  }, [labelOff, labelOn]);\n\n  return (\n    <div\n      className={classNames(\n        styles[\"labeled-toggle\"],\n        disabled && styles[\"disabled\"],\n        className\n      )}\n      style={style}\n    >\n      <div className={styles[\"content-row\"]}>\n        <div\n          className={classNames(\n            styles[\"cell\"],\n            styles[\"label-wrap\"],\n            styles[\"left\"],\n            !isOn ? !disabled && styles[\"active\"] : null\n          )}\n          // Add style 1/2 of an em per diff increment in order to balance\n          // switch layout\n          style={{ paddingLeft: `${diffOff / 2}em` }}\n        >\n          {labelOff}\n        </div>\n        <div className={styles[\"cell\"]}>\n          <Toggle isOn={isOn} disabled={disabled} style={style} {...rest} />\n        </div>\n        <div\n          className={classNames(\n            styles[\"cell\"],\n            styles[\"label-wrap\"],\n            styles[\"right\"],\n            isOn ? !disabled && styles[\"active\"] : null\n          )}\n          // Add style 1/2 of an em per diff increment in order to balance\n          // switch layout\n          style={{ paddingRight: `${diffOn / 2}em` }}\n        >\n          {labelOn}\n        </div>\n      </div>\n      <div className={styles[\"title-row\"]}>{masterLabel}</div>\n    </div>\n  );\n}\n","import ExternalLink from \"./ExternalLink\";\n\nexport default ExternalLink;\n","// TODO: Document w/ prop-types\nexport default function ExternalLink({\n  children,\n  target = \"_blank\",\n  rel = \"noreferrer\",\n  ...rest\n}) {\n  return (\n    <a {...rest} target={target} rel={rel}>\n      {children}\n    </a>\n  );\n}\n","import ExternalLinkButton from \"./ExternalLinkButton\";\n\nexport default ExternalLinkButton;\n","// TODO: Document w/ prop-types\nexport default function ExternalLinkButton({\n  href,\n  target = \"_blank\",\n  ...rest\n}) {\n  return (\n    <button\n      {...rest}\n      // TODO: Refactor to useCallback\n      onClick={() => window.open(href, target)}\n    />\n  );\n}\n","import Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport ExternalLink from \"@components/ExternalLink\";\nimport ExternalLinkButton from \"@components/ExternalLinkButton\";\n\nconst LINKS = {\n  PhantomCore: \"https://github.com/zenOSmosis/phantom-core\",\n  PhantomCollection:\n    \"https://github.com/zenOSmosis/phantom-core/tree/main/src/PhantomCollection\",\n\n  ReShellCore: \"https://github.com/zenOSmosis/reshell.org-static\",\n\n  SyncObject: \"https://github.com/zenOSmosis/sync-object\",\n  MediaStreamController:\n    \"https://github.com/zenOSmosis/media-stream-track-controller\",\n  WebRTCPeer: \"https://github.com/zenOSmosis/webrtc-peer\",\n};\n\n// TODO: Refactor\nconst LINK_BUTTON_STYLE = {\n  minHeight: \"4em\",\n  whiteSpace: \"wrap\",\n  width: \"100%\",\n  height: \"100%\",\n};\n\nexport default function Details() {\n  return (\n    <Full style={{ overflowY: \"auto\" }}>\n      <p>\n        ReShell is a browser-based layout library and UI services engine\n        composed of various{\" \"}\n        <a\n          href=\"https://github.com/zenosmosis\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          open-source components\n        </a>\n        .\n      </p>\n      <p>\n        It is currently in an alpha phase, and{\" \"}\n        <span style={{ fontWeight: \"bold\" }}>\n          other builds (i.e. \"portals\") may have other built-in applications\n        </span>\n        .\n      </p>\n      <p>\n        Leveraged off of the core code for{\" \"}\n        <ExternalLink href=\"https://speaker.app\">Speaker.app</ExternalLink> and\n        other{\" \"}\n        <ExternalLink href=\"https://zenosmosis.com\">zenOSmosis</ExternalLink>{\" \"}\n        projects based on{\" \"}\n        <ExternalLink href=\"https://github.com/zenOSmosis/phantom-core\">\n          PhantomCore\n        </ExternalLink>\n        , a library for managing the JavaScript application lifecycle.\n      </p>\n\n      <p style={{ fontWeight: \"bold\" }}>Some included technologies:</p>\n\n      <div style={{ textAlign: \"center\" }}>\n        {Object.entries(LINKS).map(([title, urlOrAction], idx) => {\n          return (\n            <Padding key={idx} style={{ width: 200, display: \"inline-block\" }}>\n              {typeof urlOrAction === \"string\" ? (\n                <ExternalLinkButton\n                  href={urlOrAction}\n                  style={LINK_BUTTON_STYLE}\n                >\n                  {title}\n                </ExternalLinkButton>\n              ) : (\n                <button onClick={urlOrAction} style={LINK_BUTTON_STYLE}>\n                  {title}\n                </button>\n              )}\n            </Padding>\n          );\n        })}\n      </div>\n    </Full>\n  );\n}\n","import Details from \"./Details\";\n\nexport default Details;\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport ExternalLink from \"@components/ExternalLink\";\n\nconst LINKS = {\n  zenOSmosis: \"https://zenOSmosis.com\",\n  GitHub: \"https://github.com/zenosmosis\",\n  \"Speaker.app\": \"https://speaker.app\",\n};\n\nexport default function Resources() {\n  return (\n    <Center canOverflow={true}>\n      <p style={{ fontWeight: \"bold\" }}>Additional resources:</p>\n      <div style={{ display: \"inline-block\", textAlign: \"left\" }}>\n        {Object.entries(LINKS).map(([name, url], idx) => (\n          <Padding key={idx}>\n            {name}:{\" \"}\n            {\n              // TODO: Use ExternalLink component for this\n            }\n            <ExternalLink href={url}>{url}</ExternalLink>\n          </Padding>\n        ))}\n      </div>\n\n      <hr />\n\n      <p>\n        To contact us directly, email:{\" \"}\n        <ExternalLink href=\"mailto:info@zenosmosis.com\">\n          info@zenosmosis.com\n        </ExternalLink>\n        .\n      </p>\n    </Center>\n  );\n}\n","import Resources from \"./Resources\";\n\nexport default Resources;\n","const FULL_YEAR = new Date().getFullYear();\n\n// FIXME: (jh) Rename to getReShellCopyright\n/**\n * @return {string}\n */\nexport default function getCopyright() {\n  return `Copyright  2010 - ${FULL_YEAR} zenOSmosis. All rights reserved.`;\n}\n","import Padding from \"@components/Padding\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport AutoScaler from \"@components/AutoScaler\";\nimport ButtonPanel from \"@components/ButtonPanel\";\nimport VirtualLink from \"@components/VirtualLink\";\nimport NoWrap from \"@components/NoWrap\";\nimport LabeledToggle from \"@components/labeled/LabeledToggle\";\n\nimport Details from \"./views/Details\";\nimport Resources from \"./views/Resources\";\n\nimport useUUID from \"@hooks/useUUID\";\n\nimport getCopyright from \"@utils/getCopyright\";\n\n// TODO: Include ReShell documentation here, as well as architecture overview\n\n// TODO: Include property for \"about\" view (per app), where its rendered HTML can be utilized for SEO purposes\n\n// TODO: Include license link type: https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types\n\n// TODO: Include \"declarative API\" (it is React, but the components themselves\n// do their base to abstract away logic w/ their opinionated internal handling,\n// while trying to stay very performant themselves)\n\nimport useUIParadigm, {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n  AUTO_DETECT_PARADIGM,\n} from \"@hooks/useUIParadigm\";\n\nexport const REGISTRATION_ID = \"about-reshell\";\n\nconst AboutReShellApp = {\n  id: REGISTRATION_ID,\n  title: \"About ReShell\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  initialSharedState: {\n    screen: \"overview\",\n  },\n  titleBarView: function TitleBarView({ sharedState, setSharedState }) {\n    /*\n    const handleSetSearchQuery = useCallback(\n      evt => setSharedState({ searchQuery: evt.target.value }),\n      [setSharedState]\n    );\n\n    const handleDoubleClick = useCallback(\n      evt => {\n        // Prevent double-clicks from resizing the window if there is text in\n        // the search bar\n        if (Boolean(sharedState.searchQuery)) {\n          evt.stopPropagation();\n        }\n      },\n      [sharedState]\n    );\n    */\n\n    return (\n      <Padding>\n        <ButtonPanel\n          // Force update if the screen changes\n          key={sharedState.screen}\n          buttons={[\n            {\n              content: \"Overview\",\n              onClick: () => setSharedState({ screen: \"overview\" }),\n              isSelected: sharedState.screen === \"overview\",\n            },\n            {\n              content: \"Details\",\n              onClick: () => setSharedState({ screen: \"details\" }),\n              isSelected: sharedState.screen === \"details\",\n            },\n            {\n              content: \"Resources\",\n              onClick: () => setSharedState({ screen: \"resources\" }),\n              isSelected: sharedState.screen === \"resources\",\n            },\n          ]}\n        />\n      </Padding>\n    );\n  },\n  view: function View({ sharedState, setSharedState }) {\n    const { uiParadigm, isUIParadigmAutoSet, setStaticUIParadigm } =\n      useUIParadigm();\n\n    const uuidAutoDetectCheckbox = useUUID();\n\n    return (\n      <Padding>\n        <Layout>\n          <Content>\n            {sharedState.screen === \"overview\" && (\n              <AutoScaler>\n                <Center>\n                  <div style={{ fontSize: \"5rem\", fontStyle: \"italic\" }}>\n                    ReShell\n                  </div>\n                  <NoWrap style={{ fontSize: \"1.5rem\" }}>\n                    Web Desktop and UI Service Engine\n                  </NoWrap>\n                </Center>\n              </AutoScaler>\n            )}\n\n            {sharedState.screen === \"details\" && <Details />}\n\n            {sharedState.screen === \"resources\" && <Resources />}\n          </Content>\n          <Footer style={{ textAlign: \"center\" }}>\n            {sharedState.screen === \"overview\" && (\n              <Padding>\n                <div>\n                  <NoWrap>\n                    <LabeledToggle\n                      labelOff=\"Mobile\"\n                      labelOn=\"Desktop\"\n                      isOn={uiParadigm === DESKTOP_PARADIGM}\n                      onChange={isDesktop =>\n                        setStaticUIParadigm(\n                          isDesktop ? DESKTOP_PARADIGM : MOBILE_PARADIGM\n                        )\n                      }\n                    />\n                    <NoWrap>\n                      <input\n                        id={uuidAutoDetectCheckbox}\n                        type=\"checkbox\"\n                        checked={isUIParadigmAutoSet}\n                        onChange={evt =>\n                          setStaticUIParadigm(\n                            evt.target.checked\n                              ? AUTO_DETECT_PARADIGM\n                              : uiParadigm\n                          )\n                        }\n                      />{\" \"}\n                      <label\n                        htmlFor={uuidAutoDetectCheckbox}\n                        style={{ display: \"inline-block\" }}\n                      >\n                        Auto-Detect\n                      </label>\n                    </NoWrap>\n                  </NoWrap>\n                </div>\n                <VirtualLink\n                  onClick={() => setSharedState({ screen: \"details\" })}\n                >\n                  Details\n                </VirtualLink>{\" \"}\n                |{\" \"}\n                <VirtualLink\n                  onClick={() => setSharedState({ screen: \"resources\" })}\n                >\n                  Resources\n                </VirtualLink>\n              </Padding>\n            )}\n\n            <div style={{ opacity: 0.5 }}>{getCopyright()}</div>\n\n            {/*\n              <div style={{ padding: 4 }}>\n               Get\n              started with{\" \"}\n              {\n                // TODO: Make link\n              }\n              <span style={{ color: \"orange\", textDecoration: \"underline\" }}>\n                wrapping your app with ReShell\n              </span>\n              .\n            </div>\n              */}\n          </Footer>\n        </Layout>\n      </Padding>\n    );\n  },\n};\n\nexport default AboutReShellApp;\n","import AboutReShellApp, { REGISTRATION_ID } from \"./AboutReShellApp\";\n\nexport default AboutReShellApp;\nexport { REGISTRATION_ID };\n","import AboutReShellApp from \"../../ExamplePortal/apps/AboutReShellApp\";\n\nconst AboutReShellOverrideApp = {\n  ...AboutReShellApp,\n  isAutoStart: true,\n};\n\nexport default AboutReShellOverrideApp;\n","import ReShellCore from \"@core\";\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport Center from \"@components/Center\";\nimport Layout, { Header, Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\n\nimport fetchIsLatestVersion from \"@utils/fetchIsLatestVersion\";\n\nimport dayjs from \"dayjs\";\n\nexport const REGISTRATION_ID = \"check-for-updates\";\n\nconst CheckForUpdatesApp = {\n  id: REGISTRATION_ID,\n  title: \"Check for Updates\",\n  style: {\n    width: 320,\n    height: 240,\n  },\n  isPinned: true,\n  view: function View() {\n    const [isLatest, setIsLatest] = useState(true);\n    const [isChecking, setIsChecking] = useState(false);\n    const [isError, setIsError] = useState(false);\n    const [lastCheckTime, setLastCheckTime] = useState(null);\n\n    const refIsChecking = useRef(null);\n    refIsChecking.current = isChecking;\n\n    // TODO: Refactor into service\n    const handleCheckForUpdates = useCallback(async () => {\n      const isChecking = refIsChecking.current;\n\n      if (isChecking) {\n        return;\n      }\n\n      try {\n        setIsError(false);\n        setIsChecking(true);\n\n        const isLatest = await fetchIsLatestVersion();\n\n        setIsLatest(isLatest);\n      } catch (err) {\n        console.error(err);\n\n        setIsError(true);\n        setIsLatest(false);\n      } finally {\n        setIsChecking(false);\n        setLastCheckTime(new Date().getTime());\n      }\n    }, []);\n\n    // Automatically check for updates when app starts\n    useEffect(() => {\n      handleCheckForUpdates();\n    }, [handleCheckForUpdates]);\n\n    return (\n      <Layout>\n        <Header>\n          <Padding style={{ textAlign: \"center\" }}>\n            <button onClick={handleCheckForUpdates} disabled={isChecking}>\n              Check for Updates\n            </button>\n          </Padding>\n        </Header>\n        <Content>\n          <Center canOverflow={true}>\n            {isError ? (\n              <>\n                <p>\n                  There was an error checking for updates.{\" \"}\n                  <button onClick={handleCheckForUpdates}>Try again?</button>\n                </p>\n              </>\n            ) : isLatest ? (\n              <p>You appear to be running the latest version of ReShell.</p>\n            ) : (\n              <>\n                <p>\n                  Your version of ReShell appears out of date.{\" \"}\n                  <button onClick={() => ReShellCore.forceUpdate()}>\n                    Refresh?\n                  </button>\n                </p>\n              </>\n            )}\n          </Center>\n        </Content>\n        <Footer>\n          <Padding>\n            <div className=\"note\">\n              Last checked:{\" \"}\n              {lastCheckTime ? dayjs(lastCheckTime).format(\"LLL\") : \"N/A\"}\n            </div>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default CheckForUpdatesApp;\n","import CheckForUpdatesApp, { REGISTRATION_ID } from \"./CheckForUpdatesApp\";\n\nexport default CheckForUpdatesApp;\nexport { REGISTRATION_ID };\n","import ColorAdjusterApp from \"./ColorAdjusterApp\";\n\nexport default ColorAdjusterApp;\n","import { useState, useEffect } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\n\nimport styles from \"./ColorAdjuster.module.css\";\n\nconst ColorAdjusterApp = {\n  id: \"color-adjuster\",\n  title: \"Color Adjuster\",\n  style: {\n    width: 640,\n    height: 400,\n  },\n  // serviceClasses: [],\n  view: function View({ windowController, appServices }) {\n    // TODO: Add service state; fix issue where if choosing grayscale, closing, then re-opening disables grayscale\n    const [isGrayscale, setIsGrayscale] = useState(false);\n\n    useEffect(() => {\n      if (isGrayscale) {\n        document.body.classList.add(\"grayscale\");\n      } else {\n        document.body.classList.remove(\"grayscale\");\n      }\n    }, [isGrayscale]);\n\n    return (\n      <Layout className={styles[\"color-adjuster\"]}>\n        <Content>\n          <Center>\n            <button onClick={() => setIsGrayscale(prev => !prev)}>\n              {isGrayscale ? \"Disable\" : \"Enable\"} Grayscale\n            </button>\n          </Center>\n        </Content>\n        <Footer>\n          {\n            // @see https://color.adobe.com/create/color-wheel\n\n            [\"#B04628\", \"#B9FC6D\", \"#FC7853\", \"#3A65FC\", \"#314EB0\"].map(\n              (color, idx) => (\n                <div\n                  key={idx}\n                  style={{\n                    backgroundColor: color,\n                    height: 100,\n                    width: \"20%\",\n                    display: \"inline-block\",\n                  }}\n                >\n                  <Center>\n                    <span\n                      style={{\n                        padding: 4,\n                        backgroundColor: \"rgba(0,0,0,.4)\",\n                        borderRadius: 4,\n                      }}\n                    >\n                      {color}\n                    </span>\n                  </Center>\n                </div>\n              )\n            )\n          }\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ColorAdjusterApp;\n","import ObjectViewer from \"./ObjectViewer\";\n\nexport default ObjectViewer;\n","import Full from \"../Full\";\nimport ReactJson from \"react-json-view\";\nimport classNames from \"classnames\";\nimport styles from \"./ObjectViewer.module.css\";\nimport PropTypes from \"prop-types\";\n\nObjectViewer.propTypes = {\n  src: PropTypes.object.isRequired,\n};\n\nexport default function ObjectViewer({ className, src, ...rest }) {\n  return (\n    <Full {...rest} className={classNames(styles[\"object-viewer\"], className)}>\n      <ReactJson\n        src={src}\n        theme=\"monokai\"\n        // NOTE: className appears to be unsupported here\n        style={{ width: \"100%\", height: \"100%\" }}\n      />\n    </Full>\n  );\n}\n","import Layout, { Content /* Footer */ } from \"@components/Layout\";\nimport ObjectViewer from \"@components/ObjectViewer\";\n\n// TODO: Include ability to show environment of any given AppRuntime?\n\nexport const REGISTRATION_ID = \"environment\";\n\nconst EnvironmentApp = {\n  id: REGISTRATION_ID,\n  title: \"Environment\",\n  style: {\n    width: 640 * 0.8,\n    height: 480 * 0.8,\n  },\n  view: function View() {\n    return (\n      <Layout>\n        <Content>\n          <ObjectViewer src={process.env} />\n        </Content>\n      </Layout>\n    );\n  },\n};\n\nexport default EnvironmentApp;\n","import EnvironmentApp, { REGISTRATION_ID } from \"./EnvironmentApp\";\n\nexport default EnvironmentApp;\nexport { REGISTRATION_ID };\n","import ReShellCore from \"@core\";\nimport PhantomCore from \"phantom-core\";\n\nimport Layout, {\n  Header,\n  Content,\n  Footer,\n  Row,\n  Column,\n} from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport ObjectViewer from \"@components/ObjectViewer\";\n\nimport { REGISTRATION_ID as ENVIRONMENT_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/EnvironmentApp\";\nimport { REGISTRATION_ID as CHECK_FOR_UPDATES_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/CheckForUpdatesApp\";\n\nconst packageJson = require(\"@root/package.json\");\n\nexport const REGISTRATION_ID = \"software-info\";\n\nconst SoftwareInfoApp = {\n  id: REGISTRATION_ID,\n  title: \"Software Info\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  view: function View() {\n    return (\n      <Layout>\n        <Header>\n          <Padding>Package.json content</Padding>\n        </Header>\n        <Content>\n          <ObjectViewer src={packageJson} />\n        </Content>\n        <Footer>\n          <Padding>\n            <Row>\n              <Column>\n                <Center>\n                  <div\n                    style={{ float: \"left\", textAlign: \"left\" }}\n                    className=\"note\"\n                  >\n                    ReShell version: {ReShellCore.getReShellVersion()}\n                    <br />\n                    PhantomCore version: {PhantomCore.getPhantomCoreVersion()}\n                    <br />\n                    Portal: {ReShellCore.getPortalName()}\n                  </div>\n                </Center>\n              </Column>\n              <Column>\n                <Center style={{ textAlign: \"right\" }}>\n                  <AppLinkButton id={CHECK_FOR_UPDATES_REGISTRATION_ID} />{\" \"}\n                  <AppLinkButton id={ENVIRONMENT_REGISTRATION_ID} />\n                </Center>\n              </Column>\n            </Row>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default SoftwareInfoApp;\n","import SoftwareInfoApp, { REGISTRATION_ID } from \"./SoftwareInfoApp\";\n\nexport default SoftwareInfoApp;\nexport { REGISTRATION_ID };\n","import StaggeredWaveLoading from \"./StaggeredWaveLoading\";\n\nexport default StaggeredWaveLoading;\n","import React from \"react\";\nimport styles from \"./StaggeredWaveLoading.module.css\";\n\n// @see https://codepen.io/alphardex/pen/XWWWBmQ\nexport default function StaggeredWaveLoading({ ...rest }) {\n  return (\n    <div className={styles[\"loading-wrapper\"]} {...rest}>\n      <div className={styles[\"loading\"]}>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n      </div>\n    </div>\n  );\n}\n","import Preload from \"./Preload\";\n\nexport default Preload;\n","import React from \"react\";\nimport AutoScaler from \"../AutoScaler\";\nimport StaggeredWaveLoading from \"../StaggeredWaveLoading\";\nimport PropTypes from \"prop-types\";\n\nimport usePreload from \"@hooks/usePreload\";\n\nPreload.propTypes = {\n  /** An array of URLs to preload */\n  preloadResources: PropTypes.arrayOf(PropTypes.string.isRequired).isRequired,\n\n  /** Called when there is a loading error  */\n  onError: PropTypes.func,\n\n  /** If true, disables loading indicator */\n  disabledLoadingIndicator: PropTypes.bool,\n};\n\nexport default function Preload({\n  children,\n  preloadResources,\n  disabledLoadingIndicator = false,\n  onError = err => console.warn(\"Caught\", err),\n  ...rest\n}) {\n  const { isPreloaded /* progress */ } = usePreload(preloadResources);\n\n  if (!isPreloaded && !disabledLoadingIndicator) {\n    return (\n      <AutoScaler {...rest}>\n        <StaggeredWaveLoading />\n      </AutoScaler>\n    );\n  } else {\n    return <React.Fragment>{children}</React.Fragment>;\n  }\n}\n","export default __webpack_public_path__ + \"static/media/vu.8cb21748.png\";","export default \"data:image/png;base64,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\"","import VUMeter from \"./VUMeter\";\n\nexport default VUMeter;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport Preload from \"@components/Preload\";\n\nimport classNames from \"classnames\";\nimport styles from \"./VUMeter.module.css\";\n\nimport PropTypes from \"prop-types\";\n\nimport useMultiAudioMediaStreamTrackLevelMonitor from \"@hooks/useMultiAudioMediaStreamTrackLevelMonitor\";\n\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport vuBackground from \"./images/vu.png\";\nimport vuNeedle from \"./images/needle.png\";\n\nVUMeter.propTypes = {\n  label: PropTypes.string,\n\n  className: PropTypes.string,\n\n  /** When multiple audio tracks may be used together */\n  mediaStreamTracks: PropTypes.arrayOf(PropTypes.instanceOf(MediaStreamTrack)),\n\n  /** When only a single track is used */\n  mediaStreamTrack: PropTypes.instanceOf(MediaStreamTrack),\n};\n\n/**\n * A needle-based audio meter.\n */\nexport default function VUMeter({\n  label = \"Mono\",\n  className,\n  mediaStreamTrack,\n  mediaStreamTracks,\n  ...rest\n}) {\n  const [elVU, setElVU] = useState(null);\n  const [elNeedle, setElNeedle] = useState(null);\n\n  // TODO: Replace w/ useUUID\n  const uuid = useMemo(uuidv4, []);\n\n  useEffect(() => {\n    if (elVU && elNeedle) {\n      elVU.style.backgroundImage = `url(${vuBackground})`;\n      elVU.style.backgroundPosition = \"top left\";\n      elVU.style.backgroundRepeat = \"no-repeat\";\n\n      elNeedle.style.backgroundImage = `url(${vuNeedle})`;\n      elNeedle.style.backgroundPosition = \"top left\";\n      elNeedle.style.backgroundRepeat = \"no-repeat\";\n    }\n  }, [elVU, elNeedle]);\n\n  /**\n   * @param {number} audioLevel A float value from 0 - 100, where 100\n   * represents maximum strength.\n   * @return {void}\n   */\n  const handleAudioLevelChange = useCallback(\n    audioLevel => {\n      if (elNeedle) {\n        requestSkippableAnimationFrame(() => {\n          elNeedle.style.transform = `rotateZ(${Math.min(\n            87 * (audioLevel / 100)\n          )}deg)`;\n        }, uuid);\n      }\n    },\n    [elNeedle, uuid]\n  );\n\n  // Set initial level\n  useEffect(() => {\n    if (elNeedle) {\n      handleAudioLevelChange(0);\n    }\n  }, [handleAudioLevelChange, elNeedle]);\n\n  useMultiAudioMediaStreamTrackLevelMonitor(\n    mediaStreamTrack || mediaStreamTracks,\n    handleAudioLevelChange\n  );\n\n  return (\n    <Preload preloadResources={[vuBackground, vuNeedle]}>\n      <div\n        ref={setElVU}\n        className={classNames(styles[\"vu\"], className)}\n        {...rest}\n      >\n        <div className={styles[\"mask\"]}>\n          <div\n            ref={setElNeedle}\n            className={styles[\"needle\"]}\n            style={{ transform: \"rotateZ(0deg)\" }}\n          ></div>\n        </div>\n        <p className={styles[\"vu-label\"]}>{label}</p>\n      </div>\n    </Preload>\n  );\n}\n","import InputMediaDevicesService from \"@services/InputMediaDevicesService\";\n\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport AudioLevelMeter from \"@components/audioMeters/AudioLevelMeter\";\nimport VULevelMeter from \"@components/audioMeters/VUMeter\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"../InputMediaDevicesApp\";\n\nexport const REGISTRATION_ID = \"vu-meter\";\n\nconst VUMeterApp = {\n  id: REGISTRATION_ID,\n  title: \"VU Meter\",\n  style: {\n    width: 360,\n    height: 360,\n    // backgroundColor: \"rgba(0,0,0,.4)\",\n  },\n  serviceClasses: [InputMediaDevicesService],\n  view: ({ appServices }) => {\n    const mds = appServices[InputMediaDevicesService];\n\n    const captureFactories = mds.getCaptureFactories();\n    // const isCapturing = Boolean(captureFactories.length);\n\n    // TODO: Add labels / controls (or adapt this program to be something else\n    // entirely)\n\n    const mediaStreamTracks = captureFactories\n      .map(factory =>\n        factory\n          .getAudioTrackControllers()\n          .map(controller => controller.getOutputMediaStreamTrack())\n      )\n      .flat();\n\n    return (\n      <Layout>\n        <Content>\n          <Center canOverflow={true}>\n            <div>\n              <VULevelMeter mediaStreamTracks={mediaStreamTracks} />\n              <AudioLevelMeter\n                style={{ marginLeft: 20, height: 160, width: 40 }}\n                mediaStreamTracks={mediaStreamTracks}\n              />\n            </div>\n            {/*\n              <div>\n                <button\n                  onClick={() => {\n                    !isCapturing\n                      ? mds.captureDefaultAudioInputDevice()\n                      : captureFactories.forEach(factory => factory.destroy());\n                  }}\n                  style={{ backgroundColor: isCapturing ? \"red\" : null }}\n                >\n                  {!isCapturing ? \"Start Microphone\" : \"Stop Capturing\"}\n                </button>\n              </div>\n              */}\n          </Center>\n        </Content>\n        <Footer>\n          <Padding>\n            <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default VUMeterApp;\n","import VUMeterApp, { REGISTRATION_ID } from \"./VUMeterApp\";\n\nexport default VUMeterApp;\nexport { REGISTRATION_ID };\n","import React, { useEffect, useMemo, useState, useRef } from \"react\";\n\n/**\n * Represents audio or video element.\n *\n * TODO: Document and rename\n */\nexport default function AVBase({\n  mediaStreamTrack,\n  mediaType = \"video\",\n  onEl = el => null,\n  ...rest\n}) {\n  const [el, setEl] = useState(null);\n\n  const mediaStream = useMemo(\n    () => mediaStreamTrack && new MediaStream([mediaStreamTrack]),\n    [mediaStreamTrack]\n  );\n\n  // TODO: Document\n  // Contains internal fixes which help Firefox and iOS start playing media\n  // tracks\n  useEffect(() => {\n    if (!el) {\n      return;\n    }\n\n    // Fixes issue in Firefox where setting mediaStream to undefined would keep\n    // video on last frame\n    if (!mediaStream) {\n      el.srcObject = null;\n      return;\n    }\n\n    el.srcObject = mediaStream;\n\n    // TODO: Emit events when playing in order to perform \"read receipts\" for\n    // remote participants\n\n    el.play()\n      .then(() => (el.muted = false))\n      .catch(err => console.warn(\"Caught\", err));\n  }, [el, mediaStream]);\n\n  const refOnEl = useRef(onEl);\n\n  // TODO: Document\n  useEffect(() => {\n    const onEl = refOnEl.current;\n\n    if (el && typeof onEl === \"function\") {\n      onEl(el);\n    }\n  }, [el]);\n\n  return React.createElement(mediaType, {\n    ref: setEl,\n    autoPlay: false,\n    muted: true,\n    playsInline: true,\n    controls: false,\n    ...rest,\n  });\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./Video.module.css\";\n\nimport AVBase from \"./AVBase\";\n\n// NOTE: (jh) There is also an aspect-ratio CSS property:\n// @see https://css-tricks.com/almanac/properties/a/aspect-ratio/\n\n/**\n * Plays a single video MediaStreamTrack out the monitor.\n */\nexport default function Video({ className, ...rest }) {\n  return (\n    <AVBase className={classNames(styles[\"video\"], className)} {...rest} />\n  );\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport {\n  MediaStreamTrackControllerFactoryCollection,\n  utils,\n} from \"media-stream-track-controller\";\n\n// TODO: Build out; ensuring added children are media device controller factories\nclass ScreenCaptureFactoryCollection extends MediaStreamTrackControllerFactoryCollection {}\n\n// TODO: Document\nexport default class ScreenCapturerService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Screen Capturer Service\");\n\n    this.bindCollectionClass(ScreenCaptureFactoryCollection);\n  }\n\n  /**\n   * Determines if screen capture is supported in the browser.\n   *\n   * @return {boolean}\n   */\n  getIsScreenCaptureSupported() {\n    return utils.screen.getIsScreenCaptureSupported();\n  }\n\n  // TODO: Document\n  async startScreenCapture(constraints = {}, factoryOptions = {}) {\n    const factory = await utils.screen.captureScreen(\n      constraints,\n      factoryOptions\n    );\n\n    this.getCollectionInstance(\n      ScreenCaptureFactoryCollection\n    ).addTrackControllerFactory(factory);\n\n    return factory;\n  }\n\n  /**\n   * Returns all media stream tracks from all of the factories as a flat array.\n   *\n   * @return {MediaStreamTrack[]}\n   */\n  getMediaStreamTracks() {\n    return this.getCollectionInstance(ScreenCaptureFactoryCollection)\n      .getChildren()\n      .map(factory =>\n        factory\n          .getTrackControllers()\n          .map(controller => controller.getOutputMediaStreamTrack())\n      )\n      .flat();\n  }\n\n  // TODO: Document\n  getCaptureFactories() {\n    return this.getCollectionInstance(\n      ScreenCaptureFactoryCollection\n    ).getChildren();\n  }\n}\n","import { EVT_DESTROYED } from \"phantom-core\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\n\nimport Layout, { Content, Footer, Row, Column } from \"@components/Layout\";\nimport Cover from \"@components/Cover\";\nimport Center from \"@components/Center\";\nimport { Video } from \"@components/audioVideoRenderers\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport AudioLevelMeter from \"@components/audioMeters/AudioLevelMeter\";\n\nimport useGetIsUnmounting from \"@hooks/useGetIsUnmounting\";\n\nimport ScreenCapturerService from \"@services/ScreenCapturerService\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"../InputMediaDevicesApp\";\n\nexport const REGISTRATION_ID = \"screen-capture-window\";\n\n// TODO: Include ability to screen record and take arbitrary snapshot from video feed (separate from ScreenShot app which is a one-time deal)\n\n// TODO: Include ability to NOT show local screen capture monitor feedback\n\n// TODO: Include ability to open multiple windows with a unique capture per window\n\nconst ScreenCaptureApp = {\n  id: REGISTRATION_ID,\n  title: \"Screen Capture\",\n  style: {\n    width: 640 * 0.8,\n    height: 480 * 0.8,\n  },\n  serviceClasses: [ScreenCapturerService],\n  view: function View({ appServices, windowController }) {\n    const scs = appServices[ScreenCapturerService];\n\n    /**\n     * NOTE: This value is memoized because it shouldn't change during this\n     * browsing session.\n     *\n     * @type {boolean}\n     */\n    const isScreenCaptureSupported = useMemo(\n      () => scs.getIsScreenCaptureSupported(),\n      [scs]\n    );\n\n    // Automatically close the window after a short duration if screen sharing\n    // is not supported\n    useEffect(() => {\n      if (!isScreenCaptureSupported) {\n        const autoCloseTimeout = window.setTimeout(\n          windowController.destroy,\n          3000\n        );\n\n        windowController.once(EVT_DESTROYED, () =>\n          window.clearTimeout(autoCloseTimeout)\n        );\n      }\n    }, [isScreenCaptureSupported, windowController]);\n\n    const [screenCaptureFactory, setScreenCaptureFactory] = useState(null);\n\n    const getIsUnmounting = useGetIsUnmounting();\n\n    // TODO: Document\n    const handleStartScreenCapture = useCallback(\n      async (constraints = {}, factoryOptions = {}) => {\n        const factory = await scs.startScreenCapture(\n          constraints,\n          factoryOptions\n        );\n\n        setScreenCaptureFactory(factory);\n\n        factory.once(EVT_DESTROYED, () => {\n          // Unmounting check fixes an issue where memory-leak error is\n          // presented when closing the window with an active screen capture\n          if (!getIsUnmounting()) {\n            setScreenCaptureFactory(null);\n          }\n        });\n\n        return factory;\n      },\n      [scs, getIsUnmounting]\n    );\n\n    // Stop the screen capture on unmount\n    useEffect(() => {\n      if (screenCaptureFactory) {\n        return () => {\n          if (!screenCaptureFactory.getIsDestroying()) {\n            screenCaptureFactory.destroy();\n          }\n        };\n      }\n    }, [screenCaptureFactory]);\n\n    const videoTrack = screenCaptureFactory\n      ?.getVideoTrackControllers()[0]\n      ?.getOutputTrack();\n\n    const audioTrack = screenCaptureFactory\n      ?.getAudioTrackControllers()[0]\n      ?.getOutputTrack();\n\n    if (!isScreenCaptureSupported) {\n      return (\n        <Center>\n          <div style={{ fontWeight: \"bold\" }}>\n            Screen capture is not supported in this browser.\n          </div>\n        </Center>\n      );\n    }\n\n    return (\n      <Layout style={{ backgroundColor: \"#424242\", color: \"#999\" }}>\n        <Content>\n          <Row>\n            <Column>\n              <Video mediaStreamTrack={videoTrack} />\n              {!screenCaptureFactory && (\n                <Cover>\n                  <Center>\n                    <div>\n                      <button\n                        onClick={() => handleStartScreenCapture()}\n                        style={{\n                          backgroundColor: \"green\",\n                          width: 200,\n                          height: 200,\n                          borderRadius: 200,\n                          fontWeight: \"bold\",\n                          fontSize: \"1.4rem\",\n                          border: \"8px #ccc solid\",\n                        }}\n                      >\n                        Start Screen Capture\n                      </button>\n                    </div>\n                  </Center>\n                </Cover>\n              )}\n            </Column>\n            <Column style={{ width: 50, maxWidth: 50 }}>\n              {/**\n               * Audio level monitoring.\n               *\n               * FIXME: (jh) This was originally set up for two-channel\n               * support, with independent meters, and it will require the\n               * audio track to be split into independent tracks in order to\n               * function as desired.\n               *\n               * The current functionality should represent both channels as\n               * a mono representation.\n               */}\n              <Row style={{ textAlign: \"center\" }}>\n                <Column>\n                  <Layout>\n                    <Content>\n                      <AudioLevelMeter mediaStreamTrack={audioTrack} />\n                    </Content>\n                    <Footer>Audio</Footer>\n                  </Layout>\n                </Column>\n              </Row>\n            </Column>\n          </Row>\n        </Content>\n        <Footer>\n          <Padding>\n            <Row>\n              <Column>\n                <Center>\n                  <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n                </Center>\n              </Column>\n              <Column>\n                <Center>\n                  <button\n                    style={{\n                      backgroundColor: !screenCaptureFactory ? \"green\" : \"red\",\n                      whiteSpace: \"nowrap\",\n                    }}\n                    onClick={() => {\n                      if (\n                        screenCaptureFactory &&\n                        !screenCaptureFactory.getIsDestroying()\n                      ) {\n                        screenCaptureFactory.destroy();\n                      } else {\n                        handleStartScreenCapture();\n                      }\n                    }}\n                  >\n                    {!screenCaptureFactory ? \"Capture\" : \"Stop\"}\n                  </button>\n                </Center>\n              </Column>\n            </Row>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ScreenCaptureApp;\n","import { useCallback, useEffect, useRef } from \"react\";\n\n/**\n * Determines whether the connected component or hook is currently in an\n * unmounting state.\n *\n * Usage:\n *  const getIsUnmounting = useGetIsUnmounting()\n *\n * @return {Function} A stable-referenced handler to determine if unmounting.\n */\nexport default function useGetIsUnmounting() {\n  const refIsUnmounting = useRef(false);\n\n  useEffect(() => {\n    return function unmount() {\n      refIsUnmounting.current = true;\n    };\n  }, []);\n\n  const getIsUnmounting = useCallback(() => refIsUnmounting.current, []);\n\n  return getIsUnmounting;\n}\n","import ScreenCaptureApp, { REGISTRATION_ID } from \"./ScreenCaptureApp\";\n\nexport default ScreenCaptureApp;\nexport { REGISTRATION_ID };\n","import InputMediaDevicesService from \"@services/InputMediaDevicesService\";\n\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport InputMediaDevicesSelector from \"@components/InputMediaDevicesSelector\";\n\nimport { REGISTRATION_ID as VU_METER_REGISTRATION_ID } from \"../VUMeterApp\";\nimport { REGISTRATION_ID as SCREEN_CAPTURE_REGISTRATION_ID } from \"../ScreenCaptureApp\";\n\nexport const REGISTRATION_ID = \"input-media-devices\";\n\nconst InputMediaDevicesApp = {\n  id: REGISTRATION_ID,\n  title: \"Input Media Devices\",\n  style: {\n    width: 640,\n    height: 380,\n  },\n  serviceClasses: [InputMediaDevicesService],\n  view: function View({ appServices }) {\n    const mds = appServices[InputMediaDevicesService];\n\n    return (\n      <Padding>\n        <Layout>\n          <Content>\n            <InputMediaDevicesSelector />\n          </Content>\n          <Footer>\n            <button\n              onClick={() => mds.fetchInputMediaDevices(true)}\n              style={{ float: \"right\" }}\n            >\n              Refetch\n            </button>\n\n            <span className=\"button-group\">\n              <AppLinkButton id={VU_METER_REGISTRATION_ID} />\n              <AppLinkButton id={SCREEN_CAPTURE_REGISTRATION_ID} />\n            </span>\n          </Footer>\n        </Layout>\n      </Padding>\n    );\n  },\n};\n\nexport default InputMediaDevicesApp;\n","import InputMediaDevicesApp, { REGISTRATION_ID } from \"./InputMediaDevicesApp\";\n\nexport default InputMediaDevicesApp;\nexport { REGISTRATION_ID };\n","/**\n * String renderings for orders of magnitude of data.\n *\n * Using decimal bbreviations as specified in:\n * @see https://en.wikipedia.org/wiki/Megabyte\n *\n * Adapted from:\n * @see https://gist.github.com/lanqy/5193417\n *\n * @param {number} bytes\n * @return {string}\n */\nconst bytesToSize = bytes => {\n  const sizes = [\"bytes\", \"kB\", \"MB\", \"GB\", \"TB\"];\n  if (bytes === 0) return `0 ${sizes[0]}`;\n  const i = parseInt(\n    Math.floor(Math.log(Math.abs(bytes)) / Math.log(1024)),\n    10\n  );\n  if (i === 0) return `${bytes} ${sizes[i]}`;\n  return `${(bytes / 1024 ** i).toFixed(1)} ${sizes[i]}`;\n};\n\nexport default bytesToSize;\n","import MemoryInfoApp from \"./MemoryInfoApp\";\n\nexport default MemoryInfoApp;\n","import { useCallback, useEffect, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\n\nimport bytesToSize from \"@utils/bytesToSize\";\n\nconst MemoryInfoApp = {\n  id: \"memory-info\",\n  title: \"Memory Info\",\n  style: {\n    width: 280,\n    height: 150,\n  },\n  view: function View() {\n    const [\n      { jsHeapSizeLimit, totalJSHeapSize, usedJSHeapSize },\n      _setMemoryInfo,\n    ] = useState({\n      jsHeapSizeLimit: \"N/A\",\n      totalJSHeapSize: \"N/A\",\n      usedJSHeapSize: \"N/A\",\n    });\n\n    // TODO: Document\n    const fetchMemoryInfo = useCallback(() => {\n      if (!window.performance.memory) {\n        return;\n      }\n\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Performance/memory\n      const { jsHeapSizeLimit, totalJSHeapSize, usedJSHeapSize } =\n        window.performance.memory;\n\n      const memoryInfo = {\n        jsHeapSizeLimit: bytesToSize(jsHeapSizeLimit),\n        totalJSHeapSize: bytesToSize(totalJSHeapSize),\n        usedJSHeapSize: bytesToSize(usedJSHeapSize),\n      };\n\n      _setMemoryInfo(memoryInfo);\n\n      return memoryInfo;\n    }, []);\n\n    // Automatically refresh heap\n    useEffect(() => {\n      const initialFetch = fetchMemoryInfo();\n\n      if (initialFetch) {\n        const refetchInterval = setInterval(() => {\n          fetchMemoryInfo();\n        }, 1000);\n\n        return function unmount() {\n          clearInterval(refetchInterval);\n        };\n      }\n    }, [fetchMemoryInfo]);\n\n    // TODO: Incorporate graphing library\n\n    return (\n      <Layout style={{ backgroundColor: \"#424242\", color: \"#999\" }}>\n        <Content>\n          <Center>\n            <table style={{ display: \"inline-block\" }}>\n              <thead>\n                <tr>\n                  <td>Heap Size Limit</td>\n                  <td>Total Heap Size</td>\n                  <td>Used Heap Size</td>\n                </tr>\n              </thead>\n\n              <tbody>\n                <tr>\n                  {\n                    // TODO: Render as formatted strings (i.e. \"... GB\")\n                  }\n                  <td>{jsHeapSizeLimit}</td>\n                  <td>{totalJSHeapSize}</td>\n                  <td>{usedJSHeapSize}</td>\n                </tr>\n              </tbody>\n            </table>\n          </Center>\n        </Content>\n        <Footer style={{ fontSize: \".8rem\" }}>\n          <a\n            href=\"https://developer.mozilla.org/en-US/docs/Web/API/Performance/memory\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            style={{ float: \"left\" }}\n          >\n            MDN Documentation\n          </a>\n          <span style={{ float: \"right\" }}>\n            Only supported in Chromium-based browsers.\n          </span>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default MemoryInfoApp;\n","import LocalStorageItems from \"./LocalStorageItems\";\n\nexport default LocalStorageItems;\n","import Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\n\nimport useForceUpdate from \"@hooks/useForceUpdate\";\n\nexport default function LocalStorageItems({\n  keyStorageEngineMaps = [],\n  onGetValue,\n  onEmpty,\n  onNewItem,\n}) {\n  const forceUpdate = useForceUpdate();\n\n  if (!keyStorageEngineMaps.length) {\n    return (\n      <Center>\n        <Padding>\n          <Padding style={{ fontWeight: \"bold\" }}>No Key Vault items.</Padding>\n          <Padding className=\"note\">\n            These may be automatically managed by other applications as needed,\n            in order to perform key / value pair storage operations.\n          </Padding>\n          <Padding className=\"note\">\n            You have the ability to clear all local / session storage via this\n            utility.\n          </Padding>\n          <Padding>\n            <button onClick={onNewItem}>Add new item...</button>\n          </Padding>\n        </Padding>\n      </Center>\n    );\n  }\n\n  return (\n    <Layout>\n      <Content>\n        <Padding style={{ overflowY: \"auto\" }}>\n          <table style={{ width: \"100%\" }}>\n            <thead>\n              <tr>\n                <td></td>\n                <td>Key</td>\n                <td style={{ color: \"gray\" }}>Value</td>\n                {/*\n                    <td>Kind</td>\n                    */}\n                <td>Encryption</td>\n                <td>Storage Engine</td>\n              </tr>\n            </thead>\n            <tbody>\n              {keyStorageEngineMaps.map((keyMap, idx) => {\n                const { key, /* kind, */ storageEngine } = keyMap;\n\n                return (\n                  <tr key={idx}>\n                    <td className=\"center\">\n                      <input\n                        type=\"checkbox\"\n                        // TODO: Remove hard-coding\n                        disabled\n                      ></input>\n                    </td>\n                    <td>{key}</td>\n                    <td className=\"center\">\n                      <button\n                        onClick={() => onGetValue(key, storageEngine)}\n                        // TODO: Remove hard-coding\n                        disabled\n                      >\n                        Get\n                      </button>\n                    </td>\n                    {/*\n                        <td className=\"center\">{kind}</td>\n                        */}\n\n                    <td className=\"center\">\n                      {storageEngine.getEncryptionType() || \"None\"}\n                    </td>\n                    <td className=\"center\">{storageEngine.getTitle()}</td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </Padding>\n      </Content>\n      <Footer>\n        <Padding style={{ overflow: \"auto\" }}>\n          <button onClick={onEmpty}>Empty</button>\n\n          <button style={{ float: \"right\" }} onClick={forceUpdate}>\n            Reload\n          </button>\n        </Padding>\n      </Footer>\n    </Layout>\n  );\n}\n","/**\n * @param {HTMLFormElement} formElement\n * @return {Object}\n */\nexport default function getFormValues(formElement) {\n  const elements = formElement.elements;\n\n  const values = {};\n\n  for (const el of [...elements]) {\n    const key = el.name || el.id;\n\n    if (key) {\n      values[key] = el.value;\n    }\n  }\n\n  return values;\n}\n","import Form from \"./Form\";\n\nexport default Form;\n","import useFormController from \"./hooks/useFormController\";\n\n// TODO: Document and add prop-types\nexport default function Form({\n  children,\n  autoComplete = \"off\",\n  validator = formValues => null,\n  onChange = formValues => null,\n  onSubmit = formValues => null,\n  ...rest\n}) {\n  const {\n    setFormRef,\n    handleFormChange,\n    handleFormSubmit,\n    handleFormValidate,\n    errors,\n    isValid,\n  } = useFormController({\n    onSubmit,\n    onChange,\n    validator,\n  });\n\n  return (\n    <form\n      {...rest}\n      ref={setFormRef}\n      autoComplete={autoComplete}\n      onChange={handleFormChange}\n      onSubmit={handleFormSubmit}\n    >\n      {\n        // TODO: Modify so that non-functional children presents an error showing how to use.  Look for other examples for how other libraries do this and adapt accordingly.\n        children({\n          errors,\n          isValid,\n          submit: handleFormSubmit,\n          validate: handleFormValidate,\n        })\n      }\n    </form>\n  );\n}\n","import { useCallback, useEffect, useState } from \"react\";\n\nimport getFormValues from \"@utils/getFormValues\";\n\n// TODO: Track dirty state\n\n// TODO: Document\n// NOTE: This is supposed to be a simpler alternative to: https://react-hook-form.com/\n// Was struggling to make it easily work with onChange events in a clean way\nexport default function useFormController({\n  onSubmit,\n  onChange = () => null,\n  validator = () => null,\n}) {\n  const [formElement, setFormRef] = useState(null);\n\n  // Perform initial checks to help ensure field values can be obtained and\n  // that the form will not submit when the user doesn't expect it to\n  useEffect(() => {\n    if (formElement) {\n      // Ensure form values can be detected\n      if (!Object.values(getFormValues(formElement)).length) {\n        console.warn(\n          \"No form values detected for form element.  All input fields should have a name or id attribute.\",\n          formElement\n        );\n      }\n\n      // Ensure button elements have a type attribute\n      for (const el of formElement.elements) {\n        if (el.tagName.toUpperCase() === \"BUTTON\" && !el.getAttribute(\"type\")) {\n          console.warn(\n            `All button elements should have a type attribute specified or they will default to \"submit\"`,\n            el\n          );\n          break;\n        }\n      }\n    }\n  }, [formElement]);\n\n  const [isValid, setIsValid] = useState(false);\n  const [errors, setErrors] = useState({});\n\n  // TODO: Document\n  const handleFormValidate = useCallback(\n    formValues => {\n      let hasErrors = false;\n\n      const errors = Object.fromEntries(\n        Object.entries(validator(formValues) || {}).filter(predicate => {\n          const isError = Boolean(predicate[1]);\n\n          if (isError) {\n            hasErrors = true;\n          }\n\n          return isError;\n        })\n      );\n\n      const isValid = !hasErrors;\n      setIsValid(isValid);\n      setErrors(errors);\n      return isValid;\n    },\n    [validator]\n  );\n\n  // TODO: Document\n  const handleFormChange = useCallback(\n    evt => {\n      const formValues = getFormValues(formElement);\n      handleFormValidate(formValues);\n\n      onChange(formValues);\n    },\n    [handleFormValidate, formElement, onChange]\n  );\n\n  // TODO: Document\n  const handleFormSubmit = useCallback(\n    evt => {\n      evt.preventDefault();\n\n      const formValues = getFormValues(formElement);\n      const isValid = handleFormValidate(formValues);\n\n      if (isValid) {\n        onSubmit(formValues);\n      }\n    },\n    [handleFormValidate, formElement, onSubmit]\n  );\n\n  return {\n    isValid,\n    handleFormValidate,\n    handleFormChange,\n    handleFormSubmit,\n    errors,\n    setFormRef,\n  };\n}\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport Form from \"@components/Form\";\n\nexport default function KeyEditorForm({\n  initialKey,\n  initialValue,\n  initialStorageEngine,\n  storageEngines,\n  onSubmit,\n}) {\n  return (\n    <Center canOverflow={true}>\n      <Form\n        onSubmit={onSubmit}\n        validator={formValues => {\n          return {\n            // TODO: Refactor into KeyEditorForm\n            key:\n              formValues.key.length < 1 &&\n              \"Key must contain at least one character\",\n          };\n        }}\n      >\n        {({ errors, isValid }) => (\n          <>\n            <Padding>\n              <input\n                name=\"key\"\n                type=\"text\"\n                placeholder=\"Key\"\n                defaultValue={initialKey}\n                required\n              />\n            </Padding>\n\n            {errors?.key && (\n              <div className=\"note\" style={{ color: \"red\" }}>\n                {errors.key}\n              </div>\n            )}\n\n            <Padding>\n              <textarea\n                name=\"value\"\n                placeholder=\"Value\"\n                defaultValue={initialValue}\n              ></textarea>\n            </Padding>\n\n            <Padding style={{ marginTop: 20, textAlign: \"left\" }}>\n              <label>Storage Engine</label>\n              <select\n                name=\"storageEngineShortUUID\"\n                defaultValue={initialStorageEngine?.getShortUUID()}\n                required\n              >\n                {storageEngines.map(storageEngine => {\n                  const title = storageEngine.getTitle();\n                  const shortUUID = storageEngine.getShortUUID();\n\n                  return (\n                    <option key={title} value={shortUUID}>\n                      {title}\n                    </option>\n                  );\n                })}\n              </select>\n            </Padding>\n\n            <div>\n              <input\n                type=\"submit\"\n                value=\"Submit\"\n                style={{\n                  // TODO: Use color variable for highlighted elements\n                  backgroundColor: \"#347fe8\",\n                }}\n                disabled={!isValid}\n              />\n            </div>\n          </>\n        )}\n      </Form>\n    </Center>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`id0d6dd5d02e64b979154a770ab790dba-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import KeyVaultApp, { REGISTRATION_ID } from \"./KeyVaultApp\";\n\nexport default KeyVaultApp;\nexport { REGISTRATION_ID };\n","// TODO: Implement ability to see how much storage is used\n\n// TODO: Use for local user profiles\n// TODO: Use for optional backend for notes, etc. (anything which can save a file of a reasonably small size)\n\n// TODO: Implement ability to export / import local storage data\n\nimport { useCallback, useEffect, useState } from \"react\";\n\nimport Padding from \"@components/Padding\";\nimport Layout, { Header, Content } from \"@components/Layout\";\nimport LocalStorageItems from \"./views/LocalStorageItems\";\nimport KeyEditorForm from \"./views/KeyEditorForm\";\n\nimport BackArrowIcon from \"@icons/BackArrowIcon\";\n\nimport KeyVaultService from \"@services/KeyVaultService\";\nimport UIModalWidgetService from \"@services/UIModalWidgetService\";\n\nimport useKeyboardEvents from \"@hooks/useKeyboardEvents\";\n\nexport const REGISTRATION_ID = \"key-vault\";\n\nconst KeyVaultApp = {\n  id: REGISTRATION_ID,\n  title: \"Key Vault\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  serviceClasses: [KeyVaultService, UIModalWidgetService],\n  view: function View({ appServices }) {\n    const localDataPersistenceService = appServices[KeyVaultService];\n    const rawKeyStorageEngineMaps =\n      localDataPersistenceService.getKeyStorageEngineMaps();\n\n    const uiModalWidgetService = appServices[UIModalWidgetService];\n\n    const [keyStorageEngineMaps, setKeyStorageEngineMaps] = useState([]);\n\n    const [isCreatingNewKey, setIsCreatingNewKey] = useState(false);\n\n    // Auto-fetch\n    useEffect(() => {\n      (async () => {\n        const keyStorageEngineMaps = [];\n\n        for (const keyMap of rawKeyStorageEngineMaps) {\n          const key = keyMap[0];\n          const storageEngine = keyMap[1];\n          const value = await storageEngine.fetchItem(key);\n\n          // TODO: Move this detection into the service (consider automatically\n          // coercing primitive types:\n          // @see https://developer.mozilla.org/en-US/docs/Glossary/Primitive\n          // const kind = typeof value;\n\n          keyStorageEngineMaps.push({\n            key,\n            storageEngine,\n            value,\n            // kind,\n          });\n        }\n\n        setKeyStorageEngineMaps(keyStorageEngineMaps);\n      })();\n    }, [rawKeyStorageEngineMaps]);\n\n    /*\n    const handleGetValue = useCallback(async (key, storageEngine) => {\n      const value = await storageEngine.fetchItem(key);\n\n      // TODO: Implement\n\n      // TODO: Remove\n      console.log({ key, value });\n\n      // TODO: Remove\n      alert(\"TODO: Implement get value\");\n    }, []);\n    */\n\n    // TODO: Document\n    const handleKeyValueSubmit = useCallback(\n      formValues => {\n        const storageEngine =\n          localDataPersistenceService.getStorageEngineWithShortUUID(\n            formValues[\"storageEngineShortUUID\"]\n          );\n\n        storageEngine\n          .setItem(formValues[\"key\"], formValues[\"value\"])\n          .then(() => {\n            setIsCreatingNewKey(false);\n          });\n      },\n      [localDataPersistenceService]\n    );\n\n    // TODO: Document\n    const handleEmpty = useCallback(async () => {\n      // TODO: Replace w/ UIModal\n      if (\n        await uiModalWidgetService.confirm(\n          \"Are you sure you wish to empty the Key Vault?\"\n        )\n      ) {\n        localDataPersistenceService.clearAllStorageEngines();\n      }\n    }, [uiModalWidgetService, localDataPersistenceService]);\n\n    useKeyboardEvents(window, {\n      onEscape: () => setIsCreatingNewKey(false),\n    });\n\n    return (\n      <Layout>\n        <Header>\n          <Padding>\n            {/*\n              <button>Session Storage</button>\n            <button>IndexedDB</button>\n            <button>Key Vault</button>\n            <button>Memory</button>\n              */}\n            <button onClick={() => setIsCreatingNewKey(prev => !prev)}>\n              {!isCreatingNewKey ? (\n                <>(+) New Item</>\n              ) : (\n                <>\n                  <BackArrowIcon /> Back\n                </>\n              )}\n            </button>\n          </Padding>\n        </Header>\n        <Content>\n          {!isCreatingNewKey ? (\n            <LocalStorageItems\n              keyStorageEngineMaps={keyStorageEngineMaps}\n              // onGetValue={() => null}\n              onEmpty={handleEmpty}\n              // TODO: Move to callback\n              onNewItem={() => setIsCreatingNewKey(true)}\n            />\n          ) : (\n            <KeyEditorForm\n              storageEngines={localDataPersistenceService.getStorageEngines()}\n              onSubmit={handleKeyValueSubmit}\n            />\n          )}\n        </Content>\n      </Layout>\n    );\n  },\n};\n\nexport default KeyVaultApp;\n","import { useCallback, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport ReactJson from \"react-json-view\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nexport const REGISTRATION_ID = \"app-registration-viewer\";\n\nconst AppRegistrationViewerApp = {\n  id: REGISTRATION_ID,\n  title: \"App Registration Viewer\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  view: function View() {\n    const { appRegistrations } = useAppOrchestrationContext();\n\n    const [registration, setRegistration] = useState(null);\n\n    const handleSetRegistration = useCallback(\n      registrationId => {\n        const matchedRegistration = appRegistrations.find(\n          predicate => predicate.getID() === registrationId\n        );\n\n        console.log({\n          matchedRegistration,\n        });\n\n        if (matchedRegistration) {\n          setRegistration(matchedRegistration.getAppDescriptor());\n        } else {\n          setRegistration(null);\n        }\n      },\n      [appRegistrations]\n    );\n\n    if (!registration) {\n      return (\n        <Center>\n          <AppRegistrationSelector\n            onRegistrationChange={handleSetRegistration}\n          />\n        </Center>\n      );\n    }\n\n    return (\n      <Layout>\n        <Content>\n          <div style={{ width: \"100%\", height: \"100%\", overflowY: \"auto\" }}>\n            <ReactJson\n              src={registration}\n              theme=\"monokai\"\n              style={{ width: \"100%\", height: \"100%\" }}\n            />\n          </div>\n        </Content>\n        <Footer>\n          <AppRegistrationSelector\n            onRegistrationChange={handleSetRegistration}\n          />\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nfunction AppRegistrationSelector({ onRegistrationChange }) {\n  const { appRegistrations } = useAppOrchestrationContext();\n\n  // TODO: Remove\n  console.log({ appRegistrations });\n\n  return (\n    <div>\n      <select onChange={evt => onRegistrationChange(evt.target.value)}>\n        <option value=\"\">Select app registration</option>\n        {appRegistrations.map(registration => (\n          <option key={registration.getUUID()} value={registration.getID()}>\n            {registration.getTitle()}\n          </option>\n        ))}\n      </select>\n    </div>\n  );\n}\n\nexport default AppRegistrationViewerApp;\n","import AppRegistrationViewerApp, {\n  REGISTRATION_ID,\n} from \"./AppRegistrationViewerApp\";\n\nexport default AppRegistrationViewerApp;\nexport { REGISTRATION_ID };\n","import Section from \"./Section\";\n\nexport default Section;\n","import React from \"react\";\nimport classNames from \"classnames\";\n\nexport default function Section({ children, className, ...rest }) {\n  return (\n    // IMPORTANT: This intentionally uses global \"section\" CSS styling\n    <div {...rest} className={classNames(\"section\", className)}>\n      {children}\n    </div>\n  );\n}\n","import LabeledLED from \"./LabeledLED\";\n\nexport default LabeledLED;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport LED from \"@components/LED\";\nimport classNames from \"classnames\";\nimport styles from \"./LabeledLED.module.css\";\n\nLabeledLED.propTypes = {\n  label: PropTypes.string.isRequired,\n\n  /** The color of the LED */\n  color: PropTypes.string,\n\n  disabled: PropTypes.bool,\n};\n\nexport default function LabeledLED({\n  color,\n  className,\n  style,\n  label,\n  disabled,\n  ...rest\n}) {\n  return (\n    <div\n      className={classNames(\n        styles[\"labeled-led\"],\n        disabled && styles[\"disabled\"],\n        className\n      )}\n      style={style}\n    >\n      <div className={styles[\"led-wrap\"]}>\n        <LED color={color} {...rest} />\n      </div>\n      <div className={styles[\"label-wrap\"]}>{label}</div>\n    </div>\n  );\n}\n","import SpeechActivityTable from \"./SpeechActivityTable\";\n\nexport default SpeechActivityTable;\n","import Layout, { Content, Footer, Row, Column } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\n\nexport default function SpeechActivityTable({\n  realTimeTranscription,\n  finalizedTranscription,\n  disabled = false,\n}) {\n  return (\n    <Row disableVerticalFill style={{ height: 80 }}>\n      <Column\n        style={{\n          border: \"1px #999 solid\",\n          borderRadius: 4,\n          backgroundColor: \"rgba(0,0,0,.4)\",\n        }}\n      >\n        <Padding>\n          <Layout>\n            <Content>\n              <div style={{ color: disabled ? \"gray\" : \"inherit\" }}>\n                {!disabled && realTimeTranscription\n                  ? realTimeTranscription\n                  : \"N/A\"}\n              </div>\n            </Content>\n            <Footer>\n              <div\n                style={{\n                  fontStyle: \"italic\",\n                  fontSize: \".9em\",\n                  color: \"gray\",\n                }}\n              >\n                Real-time\n              </div>\n            </Footer>\n          </Layout>\n        </Padding>\n      </Column>\n      <Column\n        style={{\n          border: \"1px #999 solid\",\n          borderRadius: 4,\n          backgroundColor: \"rgba(0,0,0,.4)\",\n        }}\n      >\n        <Padding>\n          <Layout>\n            <Content>\n              <div style={{ color: disabled ? \"gray\" : \"inherit\" }}>\n                {!disabled && finalizedTranscription\n                  ? finalizedTranscription\n                  : \"N/A\"}\n              </div>\n            </Content>\n            <Footer>\n              <div\n                style={{\n                  fontStyle: \"italic\",\n                  fontSize: \".9em\",\n                  color: \"gray\",\n                }}\n              >\n                Finalized\n              </div>\n            </Footer>\n          </Layout>\n        </Padding>\n      </Column>\n    </Row>\n  );\n}\n","import SpeechRecognizerSection from \"./SpeechRecognizerSection\";\n\nexport default SpeechRecognizerSection;\n","import Section from \"@components/Section\";\nimport Padding from \"@components/Padding\";\nimport LabeledToggle from \"@components/labeled/LabeledToggle\";\nimport LabeledLED from \"@components/labeled/LabeledLED\";\nimport { Row, Column } from \"@components/Layout\";\nimport Timer from \"@components/Timer\";\nimport ExternalLink from \"@components/ExternalLink\";\n\nimport SpeechActivityTable from \"../SpeechActivityTable\";\n\n// FIXME: Show simple / advanced views?\n// TODO: Add prop-types\n// TODO: Document\nexport default function SpeechRecognizerSection({ speechProvider }) {\n  const speechRecognizerService = speechProvider.speechRecognizerService;\n  const apiKeyManagementService = speechProvider.apiKeyManagementService;\n\n  return (\n    <Section>\n      {!speechProvider.disabled && (\n        <div style={{ position: \"absolute\", top: 4, left: 8 }}>\n          <Timer\n            onTick={() => speechRecognizerService?.getRecognizerUptime()}\n            style={{\n              color:\n                !speechProvider.active || speechProvider.disabled\n                  ? \"gray\"\n                  : \"inherit\",\n            }}\n          />\n        </div>\n      )}\n      {(!speechProvider.disabled || speechProvider.status) && (\n        <div style={{ float: \"right\", overflow: \"auto\" }}>\n          <div style={{ display: \"inline-block\", marginLeft: 10 }}>\n            {!speechProvider.disabled ? (\n              <>\n                <LabeledLED\n                  label=\"Connection\"\n                  color={\n                    !speechRecognizerService?.getHasRecognizer()\n                      ? \"gray\"\n                      : speechRecognizerService?.getIsConnecting()\n                      ? \"yellow\"\n                      : speechRecognizerService?.getIsConnected()\n                      ? \"green\"\n                      : \"red\"\n                  }\n                />\n                <LabeledLED\n                  label=\"Voice Activity\"\n                  color={\n                    !speechRecognizerService?.getHasRecognizer()\n                      ? \"gray\"\n                      : speechRecognizerService?.getIsRecognizing()\n                      ? \"green\"\n                      : \"red\"\n                  }\n                />\n              </>\n            ) : (\n              <span className=\"note\">{speechProvider.status}</span>\n            )}\n          </div>\n        </div>\n      )}\n\n      <h2 style={{ color: speechProvider.disabled ? \"gray\" : null }}>\n        {speechProvider.title}\n      </h2>\n      <Padding>\n        <Row>\n          <Column>\n            <LabeledToggle\n              masterLabel=\"Speech Recognition\"\n              disabled={speechProvider.disabled}\n              isOn={speechRecognizerService?.getHasRecognizer()}\n              onChange={isOn =>\n                isOn\n                  ? speechRecognizerService?.startRecognizing()\n                  : speechRecognizerService?.stopRecognizing()\n              }\n            />\n          </Column>\n          <Column>\n            <LabeledToggle\n              masterLabel=\"Control Desktop\"\n              isOn={speechRecognizerService?.getIsControllingDesktop()}\n              onChange={speechRecognizerService?.setIsControllingDesktop}\n              disabled={\n                !speechRecognizerService?.getHasRecognizer() ||\n                speechProvider.disabled\n              }\n            />\n          </Column>\n        </Row>\n      </Padding>\n      {!speechProvider.disabled && (\n        <div style={{ overflow: \"auto\" }}>\n          <Padding>\n            <SpeechActivityTable\n              disabled={\n                !speechRecognizerService?.getHasRecognizer() ||\n                speechProvider.disabled\n              }\n              realTimeTranscription={speechRecognizerService?.getRealTimeTranscription()}\n              finalizedTranscription={speechRecognizerService?.getFinalizedTranscription()}\n            />\n          </Padding>\n\n          {apiKeyManagementService && (\n            <Padding style={{ textAlign: \"right\" }}>\n              {speechProvider.requiresAPIKey && (\n                <>\n                  <button\n                    onClick={apiKeyManagementService.acquireAPIKey}\n                    disabled={apiKeyManagementService.getHasCachedAPIKey()}\n                  >\n                    Set API Key\n                  </button>{\" \"}\n                  <button\n                    onClick={apiKeyManagementService.deleteCachedAPIKey}\n                    disabled={!apiKeyManagementService.getHasCachedAPIKey()}\n                    style={{ backgroundColor: \"red\" }}\n                  >\n                    Delete API Key\n                  </button>\n                </>\n              )}\n            </Padding>\n          )}\n        </div>\n      )}\n      {speechProvider.serviceProviderURL && (\n        <div className=\"note\">\n          Provider information:{\" \"}\n          <ExternalLink href={speechProvider.serviceProviderURL}>\n            {speechProvider.serviceProviderURL}\n          </ExternalLink>\n        </div>\n      )}\n    </Section>\n  );\n}\n","import ButtonGroup from \"./ButtonGroup\";\n\nexport default ButtonGroup;\n","import classNames from \"classnames\";\nimport styles from \"./ButtonGroup.module.css\";\n\n// TODO: Add prop-types\n// TODO: Document\n// Used for wrapping arbitrary <button> HTML button elements with \"global\" base\n// styling\nexport default function ButtonGroup({ children, className, ...rest }) {\n  return (\n    <div\n      {...rest}\n      className={classNames(\n        styles[\"button-group\"],\n        // \"Global\" styling from base-styles.css\n        \"button-group\",\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n","// import beep from \"@utils/beep\";\n\nimport { REGISTRATION_ID as APPLICATIONS_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/ApplicationsApp\";\n\nimport {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n  AUTO_DETECT_PARADIGM,\n} from \"@services/UIParadigmService\";\n\nconst REPOSITION_OFFSET = 300;\n\n// TODO: Make this more generic so that it can open any application by calling\n// it by name\nexport const CMD_OPEN_APPLICATIONS = {\n  id: \"open-applications\",\n  keywords: \"open applications\",\n  description: \"Open Applications app\",\n  action: (commander, { appOrchestrationService }) => {\n    appOrchestrationService.activateAppRegistrationWithID(\n      APPLICATIONS_REGISTRATION_ID\n    );\n  },\n};\n\n// FIXME: (jh) Safari doesn't like this and can throw an Unhandled Rejection\n// (NotAllowedError) if the user doesn't activate some sort of system sounds\n// prior to this command running. A workaround could be to try / catch and\n// present a UIModal asking the user if they wish to start sounds, should an\n// error be thrown. If accepted, a sound would be generated to start the\n// browser's sound engine.\n/*\nexport const CMD_ACTIVATE_NEXT_WINDOW = {\n  id: \"beep\",\n  keywords: \"beep system sound chime beeping tone\",\n  description: \"Generates a beep tone\",\n  example: \"Beep\"\n  action: (commander, params = {}) => beep(),\n};\n*/\n\nexport const CMD_ACTIVATE_NEXT_WINDOW = {\n  id: \"activate-next-window\",\n  keywords: \"cycle activate next window\",\n  description: \"Activate next window\",\n  action: (commander, { windowController, appOrchestrationService }) => {\n    const windowControllers = appOrchestrationService.getWindowControllers();\n    const idxCurrent = windowControllers.indexOf(windowController);\n\n    const nextWindowController =\n      windowControllers[idxCurrent + 1] || windowControllers[0];\n\n    if (nextWindowController) {\n      nextWindowController.bringToTop();\n    }\n  },\n};\n\nexport const CMD_ACTIVATE_PREVIOUS_WINDOW = {\n  id: \"activate-previous-window\",\n  keywords: \"cycle activate previous window\",\n  description: \"Activate previous window\",\n  action: (commander, { windowController, appOrchestrationService }) => {\n    const windowControllers = appOrchestrationService.getWindowControllers();\n    const idxCurrent = windowControllers.indexOf(windowController);\n\n    const prevWindowController =\n      windowControllers[idxCurrent - 1] ||\n      windowControllers[windowControllers.length - 1];\n\n    if (prevWindowController) {\n      prevWindowController.bringToTop();\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_UP = {\n  id: \"move-window-up\",\n  keywords: \"reposition move window up\",\n  description: \"Move a window up\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x,\n        y: prevPosition.y - REPOSITION_OFFSET,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_UP_AND_RIGHT = {\n  id: \"move-window-up-and-right\",\n  keywords: \"reposition move window up and right\",\n  description: \"Move a window up and right\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x + REPOSITION_OFFSET,\n        y: prevPosition.y - REPOSITION_OFFSET,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_UP_AND_LEFT = {\n  id: \"move-window-up-and-left\",\n  keywords: \"reposition move window up and left\",\n  description: \"Move a window up and left\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x - REPOSITION_OFFSET,\n        y: prevPosition.y - REPOSITION_OFFSET,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_RIGHT = {\n  id: \"move-window-right\",\n  keywords: \"reposition move window right\",\n  description: \"Move a window right\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x + REPOSITION_OFFSET,\n        y: prevPosition.y,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_DOWN = {\n  id: \"move-window-down\",\n  keywords: \"reposition move window down\",\n  description: \"Move a window down\",\n  action: (commander, { windowController }) => {\n    const prevPosition = windowController.getPosition();\n\n    windowController.setPosition({\n      x: prevPosition.x,\n      y: prevPosition.y + REPOSITION_OFFSET,\n    });\n  },\n};\n\nexport const CMD_MOVE_WINDOW_DOWN_AND_RIGHT = {\n  id: \"move-window-down-and-right\",\n  keywords: \"reposition move window down and right\",\n  description: \"Move a window down and right\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x + REPOSITION_OFFSET,\n        y: prevPosition.y + REPOSITION_OFFSET,\n      });\n    }\n  },\n};\n\nexport const CMD_MOVE_WINDOW_DOWN_AND_LEFT = {\n  id: \"move-window-down-and-left\",\n  keywords: \"reposition move window down and left\",\n  description: \"Move a window down and left\",\n  action: (commander, { windowController }) => {\n    const prevPosition = windowController.getPosition();\n\n    windowController.setPosition({\n      x: prevPosition.x - REPOSITION_OFFSET,\n      y: prevPosition.y + REPOSITION_OFFSET,\n    });\n  },\n};\n\nexport const CMD_MOVE_WINDOW_LEFT = {\n  id: \"move-window-left\",\n  keywords: \"reposition move window left\",\n  description: \"Move a window left\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      const prevPosition = windowController.getPosition();\n\n      windowController.setPosition({\n        x: prevPosition.x - REPOSITION_OFFSET,\n        y: prevPosition.y,\n      });\n    }\n  },\n};\n\nexport const CMD_CENTER_WINDOW = {\n  id: \"center-window\",\n  keywords: \"reposition center window\",\n  description: \"Center a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.center();\n    }\n  },\n};\n\nexport const CMD_CENTER_ALL_WINDOWS = {\n  id: \"center-all-windows\",\n  keywords: \"reposition center all windows\",\n  description: \"Center all windows\",\n  action: (commander, { appOrchestrationService }) => {\n    appOrchestrationService\n      .getWindowControllers()\n      .forEach(windowController => windowController.center());\n  },\n};\n\nexport const CMD_SCATTER_WINDOW = {\n  id: \"scatter-window\",\n  keywords: \"reposition scatter window\",\n  description: \"Scatter a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.scatter();\n    }\n  },\n};\n\nexport const CMD_SCATTER_ALL_WINDOWS = {\n  id: \"scatter-all-windows\",\n  keywords: \"reposition scatter all windows\",\n  description: \"Scatter all windows\",\n  action: (commander, { appOrchestrationService }) => {\n    appOrchestrationService\n      .getWindowControllers()\n      .forEach(controller => controller.scatter());\n  },\n};\n\nexport const CMD_MAXIMIZE_WINDOW = {\n  id: \"maximize-window\",\n  keywords: \"resize maximize window\",\n  description: \"Maximize a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.maximize();\n    }\n  },\n};\n\nexport const CMD_MINIMIZE_WINDOW = {\n  id: \"minimize-window\",\n  keywords: \"resize minimize window\",\n  description: \"Minimize a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.minimize();\n    }\n  },\n};\n\nexport const CMD_RESTORE_WINDOW = {\n  id: \"restore-window\",\n  keywords: \"resize restore window\",\n  description: \"Restore a window\",\n  action: (commander, { windowController }) => {\n    if (windowController) {\n      windowController.restore();\n    }\n  },\n};\n\n// TODO: Handle\n/*\nexport const OPEN_APPLICATION = {\n  id: \"open-application\",\n  keywords: \"open application window\",\n  description: \"TODO: Make description\",\n  action: (commander, params = {}) => null,\n};\n*/\n\nexport const CLOSE_APPLICATION = {\n  id: \"close-application\",\n  keywords: \"close application window\",\n  description: \"Close an application window\",\n  action: async (commander, { windowController }) => {\n    if (windowController) {\n      await windowController.destroy();\n    }\n  },\n};\n\n// TODO: Handle\n/*\nexport const FOCUS_TEXT_FIELD = {\n  id: \"focus-text-field\",\n  keywords: \"focus input cursor text field\",\n  description: \"Focus an input field\",\n  action: (commander, params = {}) => null,\n};\n*/\n\n// TODO: Handle\n/*\nexport const TYPE_IN_TEXT_FIELD = {\n  id: \"type-in-text-field\",\n  keywords: \"input cursor type text field\",\n  description: \"Type in an input field\",\n  action: (commander, params = {}) => null,\n};\n*/\n\nexport const SWITCH_TO_DESKTOP_PARADIGM = {\n  id: \"desktop-paradigm\",\n  keywords: \"switch select desktop paradigm view display\",\n  description: \"Switch to desktop UI paradigm\",\n  action: async (commander, { uiParadigmService }) => {\n    uiParadigmService.setStaticUIParadigm(DESKTOP_PARADIGM);\n  },\n};\n\nexport const SWITCH_TO_MOBILE_PARADIGM = {\n  id: \"mobile-paradigm\",\n  keywords: \"switch select mobile paradigm view display\",\n  description: \"Switch to mobile UI paradigm\",\n  action: async (commander, { uiParadigmService }) => {\n    uiParadigmService.setStaticUIParadigm(MOBILE_PARADIGM);\n  },\n};\n\nexport const SWITCH_TO_AUTO_DETECT_PARADIGM = {\n  id: \"auto-detect-paradigm\",\n  keywords: \"switch select auto detect paradigm view display\",\n  description: \"Switch to auto detect UI paradigm\",\n  action: async (commander, { uiParadigmService }) => {\n    uiParadigmService.setStaticUIParadigm(AUTO_DETECT_PARADIGM);\n  },\n};\n","import { getUnixTime } from \"phantom-core\";\nimport UIServiceCore, { EVT_UPDATED } from \"@core/classes/UIServiceCore\";\n\nimport AppOrchestrationService from \"@services/AppOrchestrationService\";\nimport UIParadigmService from \"@services/UIParadigmService\";\n\nimport * as COMMANDS from \"./commands\";\n\nexport { EVT_UPDATED };\n\n// TODO: Document\n// TODO: Rename\n// TODO: Don't make extensible\nexport default class DesktopCommanderControllerService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Desktop Commander Controller Service\");\n\n    this.setState({\n      lastCommand: null,\n      lastCommandInvokeTime: null,\n    });\n\n    this._appOrchestrationService = this.useServiceClass(\n      AppOrchestrationService\n    );\n\n    this._uiParadigmService = this.useServiceClass(UIParadigmService);\n\n    // TODO: Use map instead?\n    this._commands = {};\n\n    // TODO: Iterate over commands and register each one\n    // TODO: Remove\n    for (const commandId of Object.keys(COMMANDS)) {\n      const command = COMMANDS[commandId];\n\n      this.registerCommand(command);\n    }\n  }\n\n  /**\n   * @return {Object}\n   */\n  getCommands() {\n    return this._commands;\n  }\n\n  // TODO: Document\n  registerCommand(command) {\n    // TODO: Ensure each command has a unique name\n\n    // TODO: Validate command structure\n\n    if (typeof command.keywords === \"string\") {\n      command.keywords = command.keywords.split(\" \");\n    }\n\n    this._commands[command.id] = command;\n  }\n\n  // TODO: Document\n  getCommandWithId(commandId) {\n    return this._commands[commandId];\n  }\n\n  // TODO: Document\n  getLastCommand() {\n    return this.getState().lastCommand;\n  }\n\n  /**\n   * Retrieves the UNIX time regarding when the most recent command was\n   * invoked.\n   *\n   * @return {number}\n   */\n  getLastCommandInvokeTime() {\n    return this.getState().lastCommandInvokeTime;\n  }\n\n  // TODO: Document\n  // TODO: This could be an async operation, so potentially treat it as so\n  async execCommand(command, params = {}) {\n    if (!params.windowController) {\n      const activeWindowController =\n        this._appOrchestrationService.getActiveWindowController();\n\n      // FIXME: (jh) This side-steps an issue where no window controller might\n      // be available at all, so select ANY window controller just to have\n      // something selected\n      if (activeWindowController) {\n        params.windowController = activeWindowController;\n      } else {\n        params.windowController =\n          this._appOrchestrationService.getWindowControllers()?.[0];\n      }\n    }\n\n    params.appOrchestrationService = this._appOrchestrationService;\n    params.uiParadigmService = this._uiParadigmService;\n\n    // TODO: Handle condition where no active (in-front) window controller is\n    // present and there are running apps (should we show a UI notification?)\n\n    this.setState({\n      lastCommand: command,\n      lastCommandInvokeTime: getUnixTime(),\n    });\n\n    // Execute the command\n    return command.action(this, params);\n  }\n}\n","import DesktopCommanderControllerService, {\n  EVT_UPDATED,\n} from \"./DesktopCommanderControllerService\";\n\nexport default DesktopCommanderControllerService;\nexport { EVT_UPDATED };\n","import { useCallback, useEffect, useState } from \"react\";\nimport Center from \"@components/Center\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\n\nimport DesktopCommanderControllerService from \"@services/DesktopCommanderControllerService\";\nimport AppOrchestrationService from \"@services/AppOrchestrationService\";\n\nexport const REGISTRATION_ID = \"desktop-commander-debugger\";\n\nconst DesktopCommanderDebuggerApp = {\n  id: REGISTRATION_ID,\n  title: \"Desktop Commander Debugger\",\n  style: {\n    width: 640,\n    height: 720,\n  },\n  serviceClasses: [DesktopCommanderControllerService, AppOrchestrationService],\n  view: function View({ appServices, windowController }) {\n    // DOM element of most recent command\n    const [elCurrentCommand, _setElCurrentCommand] = useState(null);\n\n    // Automatically scroll the command into view\n    useEffect(() => {\n      if (elCurrentCommand) {\n        // IMPORTANT: Don't use scrollIntoView; it can cause layout problems\n        // w/ the user interface if this window is partially moved off the page\n        // elCurrentCommand.scrollIntoView();\n\n        // FIXME: (jh) Refactor so this parentNode.parentNode isn't used\n        elCurrentCommand.parentNode.parentNode.scrollTo({\n          top: elCurrentCommand.offsetTop - 10,\n          left: elCurrentCommand.offsetLeft - 10,\n        });\n      }\n    }, [elCurrentCommand]);\n\n    const [selectedWindowController, _setSelectedWindowController] =\n      useState(null);\n\n    const selectedWindowControllerUUID = selectedWindowController?.getUUID();\n\n    const commandService = appServices[DesktopCommanderControllerService];\n    const commands = commandService.getCommands();\n    const lastCommand = commandService.getLastCommand();\n\n    const appOrchestrationService = appServices[AppOrchestrationService];\n    const appRuntimes = appOrchestrationService.getAppRuntimes();\n    const appRuntimeWindowControllers = appRuntimes\n      .map(appRuntime => ({\n        appRuntime,\n        windowController: appRuntime.getWindowController(),\n      }))\n      .filter(obj => obj.windowController);\n\n    /**\n     * Invoked when the user manually changes the window controller selection\n     * in the dropdown menu.\n     *\n     * @return {void}\n     */\n    const handleSelectWindowControllerChange = useCallback(\n      evt => {\n        const uuid = evt.target.value;\n\n        const windowController =\n          appOrchestrationService.getWindowControllerWithUUID(uuid);\n\n        _setSelectedWindowController(windowController);\n      },\n      [appOrchestrationService]\n    );\n\n    const activeWindowController =\n      appOrchestrationService.getActiveWindowController();\n\n    // Automatically set selectedWindowController\n    useEffect(() => {\n      let selectedWindowController;\n\n      if (activeWindowController && appRuntimeWindowControllers.length > 1) {\n        // Don't automatically set this window as the selected window\n        // controller if clicking on it (otherwise, it would be hard to control\n        // the other windows without jumping through hoops)\n        if (activeWindowController !== windowController) {\n          selectedWindowController = activeWindowController;\n        }\n      } else {\n        selectedWindowController = windowController;\n      }\n\n      if (selectedWindowController) {\n        _setSelectedWindowController(selectedWindowController);\n      }\n    }, [activeWindowController, windowController, appRuntimeWindowControllers]);\n\n    return (\n      <Layout>\n        <Content>\n          <Center canOverflow>\n            <Padding>\n              {Object.values(commands).map(command => {\n                const isCurrentCommand = command === lastCommand;\n\n                return (\n                  <div\n                    ref={el => isCurrentCommand && _setElCurrentCommand(el)}\n                    key={command.id}\n                    style={{\n                      width: 250,\n                      height: 100,\n                      border: \"1px #999 solid\",\n                      borderRadius: 8,\n                      margin: 1,\n                      display: \"inline-block\",\n                      textAlign: \"left\",\n                      backgroundColor: isCurrentCommand ? \"green\" : null,\n                    }}\n                  >\n                    <Layout>\n                      <Content>\n                        <Padding style={{ overflowY: \"auto\" }}>\n                          <div>{command.description}</div>\n\n                          <div\n                            style={{\n                              fontStyle: \"italic\",\n                              fontSize: \".8em\",\n                              marginTop: 4,\n                            }}\n                          >\n                            {command.keywords.join(\" \")}\n                          </div>\n                        </Padding>\n                      </Content>\n                      <Footer style={{ textAlign: \"right\" }}>\n                        <button\n                          onClick={() =>\n                            commandService.execCommand(command, {\n                              windowController: selectedWindowController,\n                            })\n                          }\n                          style={{\n                            margin: 8,\n                          }}\n                        >\n                          {command.id}\n                        </button>\n                      </Footer>\n                    </Layout>\n                  </div>\n                );\n              })}\n            </Padding>\n          </Center>\n        </Content>\n        <Footer>\n          <hr />\n          <Padding>\n            <Center>\n              <label>Choose a window to send a command:</label>\n              <select\n                onChange={handleSelectWindowControllerChange}\n                value={selectedWindowControllerUUID}\n              >\n                <option>Choose a window</option>\n                {appRuntimeWindowControllers.map(\n                  ({ /* appRuntime, */ windowController }, idx) => (\n                    <option key={idx} value={windowController.getUUID()}>\n                      {windowController.getTitle()}\n                    </option>\n                  )\n                )}\n              </select>\n            </Center>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default DesktopCommanderDebuggerApp;\n","import DesktopCommanderDebuggerApp, {\n  REGISTRATION_ID,\n} from \"./DesktopCommanderDebuggerApp\";\n\nexport default DesktopCommanderDebuggerApp;\nexport { REGISTRATION_ID };\n","import Footer from \"./SpeechCommanderApp.Footer\";\n\nexport default Footer;\n","import Padding from \"@components/Padding\";\nimport { Footer as LibFooter } from \"@components/Layout\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport ButtonGroup from \"@components/ButtonGroup\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/InputMediaDevicesApp\";\nimport { REGISTRATION_ID as COMMAND_DEBUGGER_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/DesktopCommanderDebuggerApp\";\n\nexport default function Footer() {\n  return (\n    <LibFooter>\n      <Padding style={{ textAlign: \"center\" }}>\n        <ButtonGroup>\n          <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n\n          <AppLinkButton\n            id={COMMAND_DEBUGGER_REGISTRATION_ID}\n            title=\"Command Debugger\"\n          />\n        </ButtonGroup>\n      </Padding>\n    </LibFooter>\n  );\n}\n","import UIServiceCore, { EVT_UPDATED } from \"@core/classes/UIServiceCore\";\n\nimport KeyVaultService from \"@services/KeyVaultService\";\nimport UIModalWidgetService from \"@services/UIModalWidgetService\";\n\nconst LABEL_KEY_ACQUIRE = \"acquire\";\nconst LABEL_KEY_CONFIRM_DELETE = \"confirmDelete\";\n\nconst STATE_KEY_HAS_CACHED_API_KEY = \"hasCachedAPIKey\";\n\n/**\n * Manages acquisition and caching of API keys for external services.\n */\nexport default class ExternalAPIKeyManagementServiceCore extends UIServiceCore {\n  // TODO: Ensure this class is extended (reference: https://github.com/zenOSmosis/phantom-core/issues/149)\n\n  // TODO: Document\n  constructor(secureLocalStorageKey, keyNickname = \"API\", ...args) {\n    const LABELS = {\n      [LABEL_KEY_ACQUIRE]: `Enter the ${keyNickname} Key`,\n      [LABEL_KEY_CONFIRM_DELETE]: `Are you sure you wish to delete the ${keyNickname} Key?`,\n    };\n\n    // TODO: Ensure secureLocalStorageKey is unique per instance\n    if (!secureLocalStorageKey) {\n      throw new ReferenceError(\"secureLocalStorageKey is not set\");\n    }\n\n    super(...args);\n\n    this.setTitle(`${keyNickname} Key Management Service`);\n\n    this.setState({\n      [STATE_KEY_HAS_CACHED_API_KEY]: false,\n    });\n\n    this._secureLocalStorageKey = secureLocalStorageKey;\n    this._labels = LABELS;\n\n    this._keyVaultService = this.useServiceClass(KeyVaultService);\n\n    // TODO: Document type\n    this._secureLocalStorageEngine =\n      this._keyVaultService.getSecureLocalStorageEngine();\n\n    // Perform initial state sync (internally will update\n    // hasCachedAPIKey state if found)\n    this._fetchCachedAPIKey();\n\n    // Refresh when Key Vault updates\n    //\n    // NOTE: This fixes issue where deleting store from KeyVault itself would\n    // not affect \"Speech Input Controller\" UI state.\n    this.proxyOn(this._keyVaultService, EVT_UPDATED, () => {\n      this._fetchCachedAPIKey();\n    });\n  }\n\n  /**\n   * Stores the API key in local storage.\n   *\n   * @param {string} apiKey\n   * @return {Promise<void>}\n   */\n  async _cacheAPIKey(apiKey) {\n    await this._secureLocalStorageEngine.setItem(\n      this._secureLocalStorageKey,\n      apiKey\n    );\n\n    this.setState({ [STATE_KEY_HAS_CACHED_API_KEY]: Boolean(apiKey) });\n  }\n\n  /**\n   * Retrieves the subscription key, if present, from secure local storage.\n   *\n   * NOTE: This also sets the service state for hasCachedAPIKey.\n   *\n   * @return {Promise<string | void>}\n   */\n  async _fetchCachedAPIKey() {\n    const cachedKey = await this._secureLocalStorageEngine.fetchItem(\n      this._secureLocalStorageKey\n    );\n\n    // Sets the state\n    this.setState({ [STATE_KEY_HAS_CACHED_API_KEY]: Boolean(cachedKey) });\n\n    return cachedKey;\n  }\n\n  /**\n   * Retrieves whether or not there is a cached API key.\n   *\n   * @return {boolean}\n   */\n  getHasCachedAPIKey() {\n    return this.getState()[STATE_KEY_HAS_CACHED_API_KEY];\n  }\n\n  /**\n   * Acquires the API key. If a cached key is not present, it will show a UI\n   * modal prompting the user to enter one.\n   *\n   * Note, this is intentionally not setting the API key in the state.\n   *\n   * @return {string | null} A null value will be returned if the user cancels.\n   */\n  async acquireAPIKey() {\n    // Try to obtain cached subscription key from secure local storage\n    let apiKey = await this._fetchCachedAPIKey();\n\n    // If found...\n    if (apiKey) {\n      // ...return it\n      return apiKey;\n    }\n\n    // Prompt user to input key\n    apiKey = await this.useServiceClass(\n      UIModalWidgetService\n    ).showTextInputModal({\n      label: this._labels[LABEL_KEY_ACQUIRE],\n    });\n\n    // TODO: Provide a graceful way out; an error is currently thrown as a\n    // cancellation signal\n    if (apiKey === null) {\n      return null;\n    }\n\n    // TODO: Validate as necessary (i.e. w/ string length, etc.)\n\n    if (apiKey) {\n      // Cache the subscription key\n      await this._cacheAPIKey(apiKey);\n\n      return apiKey;\n    } else {\n      // Try again\n      return this.acquireAPIKey();\n    }\n  }\n\n  /**\n   * Deletes the cached API key.\n   *\n   * @return {Promise<void>}\n   */\n  async deleteCachedAPIKey() {\n    if (\n      !(await this.useServiceClass(UIModalWidgetService).confirm(\n        this._labels[LABEL_KEY_CONFIRM_DELETE]\n      ))\n    ) {\n      return;\n    }\n\n    await this._secureLocalStorageEngine.removeItem(\n      this._secureLocalStorageKey\n    );\n\n    this.setState({ [STATE_KEY_HAS_CACHED_API_KEY]: false });\n  }\n}\n","import UIServiceCore, { EVT_UPDATED } from \"@core/classes/UIServiceCore\";\nimport ExternalAPIKeyManagementServiceCore from \"@service.cores/ExternalAPIKeyManagementServiceCore\";\n\nimport {\n  EVT_CONNECTING,\n  EVT_CONNECTED,\n  EVT_DISCONNECTED,\n  EVT_BEGIN_RECOGNIZE,\n  EVT_TRANSCRIPTION_RECOGNIZING,\n  EVT_END_RECOGNIZE,\n  EVT_TRANSCRIPTION_FINALIZED,\n} from \"./SpeechRecognizerBase\";\n\nimport InputMediaDevicesService from \"@services/InputMediaDevicesService\";\nimport UIModalWidgetService from \"@services/UIModalWidgetService\";\n\nexport { EVT_UPDATED, EVT_TRANSCRIPTION_FINALIZED };\n\n// TODO: Auto-destruct after a certain amount of time after not retrieving\n// a finalized transcription\n\nexport default class SpeechRecognizerServiceCore extends UIServiceCore {\n  // TODO: Turn into a service core (utilize in service.cores directory)\n  // TODO: Force to be extended (relates to: https://github.com/zenOSmosis/phantom-core/issues/149)\n\n  /**\n   * @param {ExternalAPIKeyManagementServiceCore} ExternalAPIKeyManagementServiceClass\n   * A non-instantiated class which manages the API key for the service\n   * provider.\n   * @param {...args} - The args to pass to the super UIServiceCore.\n   */\n  constructor(ExternalAPIKeyManagementServiceClass, ...args) {\n    super(...args);\n\n    this._apiKeyManagementService = this.useServiceClass(\n      ExternalAPIKeyManagementServiceClass\n    );\n\n    // Emit EVT_UPDATED when API Key Management Service updates\n    // FIXME: (jh) See relevant issue: https://github.com/zenOSmosis/phantom-core/issues/152\n    this.proxyOn(this._apiKeyManagementService, EVT_UPDATED, data =>\n      this.emit(EVT_UPDATED, data)\n    );\n\n    // FIXME: (jh) Validate type before instantiation\n    if (\n      !(\n        this._apiKeyManagementService instanceof\n        ExternalAPIKeyManagementServiceCore\n      )\n    ) {\n      throw new TypeError(\n        \"ExternalAPIKeyManagementServiceClass does not extend ExternalAPIKeyManagementServiceCore\"\n      );\n    }\n\n    this.setState({\n      isConnecting: false,\n      isConnected: false,\n      hasRecognizer: false,\n      isRecognizing: false,\n      realTimeTranscription: null,\n      finalizedTranscription: null,\n      isControllingDesktop: false,\n    });\n\n    /** @type {SpeechRecognizerBase} */\n    this._recognizer = null;\n\n    this.registerCleanupHandler(async () => {\n      if (this._recognizer) {\n        await this._recognizer.destroy();\n      }\n    });\n\n    // Handle recognizer event binding\n    this.on(EVT_UPDATED, (updatedState = {}) => {\n      if (updatedState.hasRecognizer) {\n        const _handleConnectStateChange = () => {\n          this.setState({\n            isConnecting: this._recognizer.getIsConnecting(),\n            isConnected: this._recognizer.getIsConnected(),\n          });\n        };\n\n        this.proxyOn(\n          this._recognizer,\n          EVT_CONNECTING,\n          _handleConnectStateChange\n        );\n        this.proxyOn(\n          this._recognizer,\n          EVT_CONNECTED,\n          _handleConnectStateChange\n        );\n        this.proxyOn(\n          this._recognizer,\n          EVT_DISCONNECTED,\n          _handleConnectStateChange\n        );\n\n        this.proxyOn(this._recognizer, EVT_BEGIN_RECOGNIZE, () => {\n          this.setState({ isRecognizing: true });\n        });\n\n        this.proxyOn(this._recognizer, EVT_END_RECOGNIZE, () => {\n          this.setState({ isRecognizing: false });\n        });\n\n        this.proxyOn(this._recognizer, EVT_TRANSCRIPTION_RECOGNIZING, text => {\n          this.setState({ realTimeTranscription: text });\n        });\n\n        this.proxyOn(this._recognizer, EVT_TRANSCRIPTION_FINALIZED, text => {\n          this.setState({ finalizedTranscription: text });\n\n          // Re-emit\n          this.emit(EVT_TRANSCRIPTION_FINALIZED, text);\n        });\n      }\n    });\n\n    /** @type {InputMediaDevicesService} */\n    this._inputMediaDevicesService = this.useServiceClass(\n      InputMediaDevicesService\n    );\n  }\n\n  /**\n   * Retrieves the API key manager for this speech recognizer.\n   *\n   * @return {ExternalAPIKeyManagementService}\n   */\n  getAPIKeyManagementService() {\n    return this._apiKeyManagementService;\n  }\n\n  /**\n   * For documentation purposes, retrieves the service provider URL which\n   * supplies the speech recognition to ReShell.\n   *\n   * @return {string}\n   */\n  getServiceProviderURL() {\n    throw new Error(\"getServiceProviderURL must be overridden\");\n  }\n\n  /**\n   * Whether or not the speech recognizer is connecting.\n   *\n   * @return {boolean}\n   */\n  getIsConnecting() {\n    return this.getState().isConnecting;\n  }\n\n  /**\n   * Whether or not the speech recognizer is connected.\n   *\n   * @return {boolean}\n   */\n  getIsConnected() {\n    return this.getState().isConnected;\n  }\n\n  /**\n   * Retrieves whether or not the MesaSpeechRecognizer is active.\n   *\n   * @return {boolean}\n   */\n  getHasRecognizer() {\n    return this.getState().hasRecognizer;\n  }\n\n  /**\n   * Retrieves the non-finalized speech transcription.\n   *\n   * NOTE: This will emit much faster than the finalized transcription and may\n   * automatically correct itself as words are spoken.\n   *\n   * @return {string | null}\n   */\n  getRealTimeTranscription() {\n    return this.getState().realTimeTranscription;\n  }\n\n  /**\n   * Retrieves the last finalized transcription received.\n   *\n   * @return {string | null}\n   */\n  getFinalizedTranscription() {\n    return this.getState().finalizedTranscription;\n  }\n\n  /**\n   * Retrieves whether or not the system is currently recognizing speech.\n   *\n   * @return {boolean}\n   */\n  getIsRecognizing() {\n    return this.getState().isRecognizing;\n  }\n\n  // TODO: Document\n  async _createRecognizer(mediaStream, recognizerParams) {\n    throw new Error(\"_createRecognizer must be overridden\");\n  }\n\n  // TODO: Document\n  /**\n   * Starts the speech recognition system.\n   *\n   * @return {Promise<void>}\n   */\n  async startRecognizing(recognizerParams = {}) {\n    if (this._recognizer) {\n      await this._recognizer.destroy();\n    }\n\n    this.emit(EVT_CONNECTING);\n\n    let inputCaptureFactories =\n      this._inputMediaDevicesService.getCaptureFactories();\n\n    // Present UIModal to start input\n    // TODO: Filter to only capturing audio\n    if (!inputCaptureFactories.length) {\n      await this.useServiceClass(\n        UIModalWidgetService\n      ).showInputMediaDevicesSelectionModal();\n    }\n\n    inputCaptureFactories =\n      this._inputMediaDevicesService.getCaptureFactories();\n\n    // FIXME: (jh) Handle more nicely?\n    // TODO: Ensure we're capturing audio\n    if (!inputCaptureFactories.length) {\n      throw new Error(\"Could not obtain input capture factories\");\n    }\n\n    // TODO; Refactor\n    const stream = inputCaptureFactories[0].getOutputMediaStream();\n\n    this._recognizer = await this._createRecognizer(stream, recognizerParams);\n\n    this.setState({ hasRecognizer: true });\n\n    this._recognizer.registerCleanupHandler(() => {\n      // FIXME: (jh) Reset state once implemented\n      // Relevant issue: https://github.com/zenOSmosis/phantom-core/issues/112\n      this.setState({\n        isConnecting: false,\n        isConnected: false,\n        hasRecognizer: false,\n        isRecognizing: false,\n        realTimeTranscription: null,\n        finalizedTranscription: null,\n      });\n    });\n  }\n\n  /**\n   * Stops the speech recognition system.\n   *\n   * @return {Promise<void>}\n   */\n  async stopRecognizing() {\n    if (this._recognizer) {\n      await this._recognizer.destroy();\n    }\n  }\n\n  /**\n   * Sets whether or not the speech recognizer is controlling the desktop.\n   *\n   * NOTE: Despite the value given it will not be effective if the speech\n   * recognizer is not connected.\n   *\n   * @param {boolean} isControllingDesktop\n   * @return {void}\n   */\n  setIsControllingDesktop(isControllingDesktop) {\n    this.setState({ isControllingDesktop: Boolean(isControllingDesktop) });\n  }\n\n  /**\n   * Retrieves whether or not the speech recognizer is controlling the desktop.\n   *\n   * NOTE: Despite the value returned it will not be effective if the speech\n   * recognizer is not connected.\n   *\n   * @return {boolean}\n   */\n  getIsControllingDesktop() {\n    return this.getState().isControllingDesktop;\n  }\n\n  /**\n   * Retrieves the number of seconds the speech recognizer has been instantiated.\n   *\n   * If the speech recognizer is not active, it will return 0.\n   *\n   * @return {number}\n   */\n  getRecognizerUptime() {\n    return !this._recognizer ? 0 : this._recognizer.getInstanceUptime();\n  }\n}\n","import { PhantomCollection } from \"phantom-core\";\nimport SpeechRecognizerServiceCore, {\n  EVT_TRANSCRIPTION_FINALIZED,\n} from \"../__common__/SpeechRecognizerServiceCore\";\n\n/**\n * A collection of speech recognizer service instances.\n */\nexport default class SpeechRecognizerServiceCollection extends PhantomCollection {\n  constructor(...args) {\n    super(...args);\n\n    // Destroy all children on cleanup\n    this.registerCleanupHandler(() => this.destroyAllChildren());\n  }\n\n  /**\n   * Adds a speech recognizer service instance to the collection.\n   *\n   * @param {SpeechRecognizerServiceCore}\n   * @return {void}\n   */\n  addChild(speechRecognizerService) {\n    // TODO: Check for class instance before trying to instantiate it (even\n    // better would be to make this collection do the validation internally\n    // with some sort of config option)\n\n    if (!(speechRecognizerService instanceof SpeechRecognizerServiceCore)) {\n      throw new TypeError(\n        \"speechRecognizerService is not a SpeechRecognizerServiceCore\"\n      );\n    }\n\n    // FIXME: (jh) This proxy is utilized instead of bindChildEventName we want\n    // to obtain the service which broadcast the event. This functionality\n    // might should work its way into PhantomCore instead.\n    this.proxyOn(speechRecognizerService, EVT_TRANSCRIPTION_FINALIZED, data => {\n      this.emit(EVT_TRANSCRIPTION_FINALIZED, [speechRecognizerService, data]);\n    });\n\n    return super.addChild(speechRecognizerService);\n  }\n\n  /**\n   * @alias addChild\n   */\n  addSpeechRecognizerServiceInstance(speechRecognizerService) {\n    return this.addChild(speechRecognizerService);\n  }\n\n  /**\n   * Retrieves the speech recognizer service instances which are bound to this\n   * collection.\n   *\n   * @return {SpeechRecognizerServiceCore[]}\n   */\n  getSpeechRecognizerServices() {\n    return this.getChildren();\n  }\n}\n","import SpeechRecognizerBase from \"../../../__common__/SpeechRecognizerBase\";\n\nconst sdk = require(\"microsoft-cognitiveservices-speech-sdk\");\n\n/**\n * Handles direct communication with Azure CognitiveService backend using the\n * microsoft-cognitiveservices-speech-sdk.\n *\n * Interfaces with npm library:\n * @see {@link https://www.npmjs.com/package/microsoft-cognitiveservices-speech-sdk}\n */\nexport default class MesaSpeechRecognizer extends SpeechRecognizerBase {\n  /**\n   * @param {MediaStream} mediaStream\n   * @param {string} subscriptionKey\n   * @param {Object} options? [default = {}]\n   */\n  constructor(mediaStream, subscriptionKey, options) {\n    super(mediaStream, options);\n\n    this._subscriptionKey = subscriptionKey;\n\n    // TODO: Replace hardcoding with config param\n    this._locationRegion = \"eastus\";\n    this._speechRecognitionLanguage = \"en-US\";\n\n    this._recognizer = null;\n    this.registerCleanupHandler(() => this._stopRecognizing());\n  }\n\n  /**\n   * Retrieves the Mesa cloud service location region this recognizer is\n   * associated with.\n   *\n   * @return {string}\n   */\n  getLocationRegion() {\n    return this._locationRegion;\n  }\n\n  /**\n   * Retrieves the Mesa language code for this recognizer.\n   *\n   * @return {string}\n   */\n  getRecognitionLanguage() {\n    return this._recognitionLanguage;\n  }\n\n  /**\n   * @return {Promise<void>}\n   */\n  async _stopRecognizing() {\n    if (this._recognizer) {\n      this._recognizer.stopContinuousRecognitionAsync();\n\n      this._recognizer.close();\n\n      this._recognizer = null;\n    }\n  }\n\n  /**\n   * Starts the speech recognition processing, performs remote event binding to\n   * the class instance, and handles cleanup operations.\n   *\n   * Based on the example:\n   * @see  https://github.com/Azure-Samples/cognitive-services-speech-sdk/tree/master/quickstart/javascript/browser/from-microphone\n   *\n   * @return {Promise<void>}\n   */\n  async _startRecognizing() {\n    if (this._recognizer) {\n      await this._stopRecognizing();\n    }\n\n    this._setIsConnecting(true);\n\n    const stream = this._mediaStream;\n\n    const speechConfig = sdk.SpeechConfig.fromSubscription(\n      this._subscriptionKey,\n      this._locationRegion\n    );\n\n    speechConfig.speechRecognitionLanguage = this._speechRecognitionLanguage;\n\n    const audioConfig = sdk.AudioConfig.fromStreamInput(stream);\n\n    const recognizer = new sdk.SpeechRecognizer(speechConfig, audioConfig);\n    this._recognizer = recognizer;\n\n    // TODO: Refactor\n    (() => {\n      recognizer.recognizing = (s, e) => {\n        // FIXME: (jh) Is there a more appropriate place to put this?\n        /*\n        if (!this._isConnected) {\n          this._isConnected = true;\n\n          this.emit(EVT_CONNECTED);\n        }\n        */\n\n        this.log.debug(`RECOGNIZING: Text=${e.result.text}`);\n\n        this._setRealTimeTranscription(e.result.text);\n      };\n\n      recognizer.recognized = (s, e) => {\n        if (e.result.reason === sdk.ResultReason.RecognizedSpeech) {\n          this._setFinalizedTranscription(e.result.text);\n\n          this.log.debug(`RECOGNIZED: Text=${e.result.text}`);\n        } else if (e.result.reason === sdk.ResultReason.NoMatch) {\n          this._setIsRecognizing(false);\n\n          this.log.debug(\"NOMATCH: Speech could not be recognized.\");\n        }\n      };\n\n      recognizer.canceled = async (s, e) => {\n        this._setIsRecognizing(false);\n\n        this.log.debug(`CANCELED: Reason=${e.reason}`);\n\n        if (e.reason === sdk.CancellationReason.Error) {\n          this.log.debug(`\"CANCELED: ErrorCode=${e.errorCode}`);\n          this.log.debug(`\"CANCELED: ErrorDetails=${e.errorDetails}`);\n          this.log.debug(\n            \"CANCELED: Did you update the key and location/region info?\"\n          );\n        }\n\n        // NOTE: This should be automatically stopped by the following\n        // operation, but as double insurance, let's stop it here\n        recognizer.stopContinuousRecognitionAsync();\n\n        // We can't do anything about cancellations, so just destruct the\n        // instance\n        return this.destroy();\n      };\n\n      recognizer.sessionStopped = (s, e) => {\n        this.log.debug(\"Session stopped event\");\n        recognizer.stopContinuousRecognitionAsync();\n      };\n\n      // Start recognizing\n      recognizer.startContinuousRecognitionAsync();\n    })();\n  }\n}\n","import ExternalAPIKeyManagementServiceCore from \"@service.cores/ExternalAPIKeyManagementServiceCore\";\n\nconst KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY = \"mesa-sub-1\";\n\n// IMPORTANT: Never add a subscription key to client-side code. For advanced guidance on keeping sensitive subscription info secure, see the sample using a server-side auth token\n// Reference: https://github.com/Azure-Samples/cognitive-services-speech-sdk/tree/master/samples/js/browser\n\n/**\n * Manages the subscription key acquisition and usage for Mesa.\n */\nexport default class MesaSubscriptionKeyManagementService extends ExternalAPIKeyManagementServiceCore {\n  constructor(...args) {\n    super(\n      KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY,\n      \"Azure Subscription\",\n      ...args\n    );\n  }\n}\n","import SpeechRecognizerServiceCore from \"../../../__common__/SpeechRecognizerServiceCore\";\n\nimport MesaSpeechRecognizer from \"./MesaSpeechRecognizer\";\n\nimport MesaSubscriptionKeyManagementService from \"../MesaSubscriptionKeyManagementService\";\n\n/**\n * Manages the creation and destruction of MesaSpeechRecognizer instances.\n */\nexport default class MesaSpeechRecognizerService extends SpeechRecognizerServiceCore {\n  // TODO: Document\n  constructor(...args) {\n    super(MesaSubscriptionKeyManagementService, ...args);\n\n    this.setTitle(\"Mesa Speech Recognizer Service\");\n  }\n\n  /**\n   * For documentation purposes, retrieves the service provider URL which\n   * supplies the speech recognition to ReShell.\n   *\n   * @return {string}\n   */\n  getServiceProviderURL() {\n    return \"https://azure.microsoft.com/en-us/services/cognitive-services/speech-to-text/\";\n  }\n\n  /**\n   * @param {MediaStream} mediaStream\n   * @param {Object} props TODO: Document props\n   * @return {Promise<DeepgramSpeechRecognizer>}\n   */\n  async _createRecognizer(mediaStream, { subscriptionKey }) {\n    return new MesaSpeechRecognizer(mediaStream, subscriptionKey);\n  }\n\n  /**\n   * Starts the speech recognition engine.\n   *\n   * @return {Promise<void>}\n   */\n  async startRecognizing() {\n    const subscriptionKey = await this._apiKeyManagementService.acquireAPIKey();\n\n    return super.startRecognizing({ subscriptionKey });\n  }\n}\n","import MesaSpeechRecognizerService from \"./MesaSpeechRecognizerService\";\n\nexport default MesaSpeechRecognizerService;\n","import SpeechRecognizerBase from \"../../../__common__/SpeechRecognizerBase\";\n\nconst DEEPGRAM_WSS_ADDRESS = \"wss://api.deepgram.com/v1/listen\";\n\n/**\n * Handles direct communication with Deepgram.\n *\n * @see https://deepgram.com/\n */\nexport default class DeepgramSpeechRecognizer extends SpeechRecognizerBase {\n  /**\n   * @param {MediaStream} mediaStream\n   * @param {string} apiKey\n   * @param {Object} options? [default = {}]\n   */\n  constructor(mediaStream, apiKey, options) {\n    super(mediaStream, options);\n\n    this._apiKey = apiKey;\n    this._deepgramSocket = null;\n    this._mediaRecorder = null;\n\n    this.registerCleanupHandler(() => this._stopRecognizing());\n  }\n\n  /**\n   * Stops the previous speech recognizer instance.\n   *\n   * @return {Promise<void>}\n   */\n  async _stopRecognizing() {\n    if (this._mediaRecorder) {\n      this._mediaRecorder.stop();\n\n      this._mediaRecorder = null;\n    }\n\n    if (this._deepgramSocket) {\n      this._deepgramSocket.close();\n\n      this._deepgramSocket = null;\n    }\n  }\n\n  /**\n   * Starts the speech recognition processing, performs remote event binding to\n   * the class instance, and handles cleanup operations.\n   *\n   * Based on the example from:\n   * @see https://github.com/deepgram/deepgram-node-sdk#transcribe-audio-in-real-time\n   *\n   * @return {Promise<void>}\n   */\n  async _startRecognizing() {\n    // Stop previous instance\n    await this._stopRecognizing();\n\n    this._setIsConnecting(true);\n\n    this._deepgramSocket = new WebSocket(DEEPGRAM_WSS_ADDRESS, [\n      \"token\",\n      this._apiKey,\n    ]);\n\n    this._mediaRecorder = new MediaRecorder(this._mediaStream, {\n      mimeType: \"audio/webm\",\n    });\n\n    this._deepgramSocket.addEventListener(\"open\", () => {\n      this._setIsConnected(true);\n\n      this._mediaRecorder.addEventListener(\"dataavailable\", event => {\n        if (event.data.size > 0 && this._deepgramSocket?.readyState === 1) {\n          this._deepgramSocket.send(event.data);\n        }\n      });\n\n      // FIXME: (jh) Adjust as necessary\n      this._mediaRecorder.start(100);\n\n      this._deepgramSocket.addEventListener(\"message\", message => {\n        const received = JSON.parse(message.data);\n\n        const transcript = received.channel.alternatives[0].transcript;\n\n        if (transcript && received.is_final) {\n          this._setFinalizedTranscription(transcript);\n        } else {\n          this._setRealTimeTranscription(transcript);\n        }\n      });\n\n      this._deepgramSocket.addEventListener(\"close\", () => this.destroy());\n    });\n  }\n}\n","import ExternalAPIKeyManagementServiceCore from \"@service.cores/ExternalAPIKeyManagementServiceCore\";\n\nconst KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY = \"deepgram-sub-1\";\n\n/**\n * Manages the subscription key acquisition and usage for Mesa.\n */\nexport default class DeepgramAPIKeyManagementService extends ExternalAPIKeyManagementServiceCore {\n  constructor(...args) {\n    super(\n      KEY_SECURE_LOCAL_STORAGE_MESA_SUBSCRIPTION_KEY,\n      \"Deepgram API\",\n      ...args\n    );\n  }\n}\n","import SpeechRecognizerServiceCore from \"../../../__common__/SpeechRecognizerServiceCore\";\n\nimport DeepgramSpeechRecognizer from \"./DeepgramSpeechRecognizer\";\n\nimport DeepgramAPIKeyManagementService from \"../DeepgramAPIKeyManagementService\";\n\n/**\n * Manages the creation and destruction of MesaSpeechRecognizer instances.\n */\nexport default class DeepgramSpeechRecognizerService extends SpeechRecognizerServiceCore {\n  // TODO: Document\n  constructor(...args) {\n    super(DeepgramAPIKeyManagementService, ...args);\n\n    this.setTitle(\"Deepgram Speech Recognizer Service\");\n  }\n\n  /**\n   * For documentation purposes, retrieves the service provider URL which\n   * supplies the speech recognition to ReShell.\n   *\n   * @return {string}\n   */\n  getServiceProviderURL() {\n    return \"https://deepgram.com/\";\n  }\n\n  /**\n   * @param {MediaStream} mediaStream\n   * @param {Object} props TODO: Document\n   * @return {Promise<DeepgramSpeechRecognizer>}\n   */\n  async _createRecognizer(mediaStream, { apiKey }) {\n    return new DeepgramSpeechRecognizer(mediaStream, apiKey);\n  }\n\n  /**\n   * Starts the speech recognition system.\n   *\n   * @return {Promise<void>}\n   */\n  async startRecognizing() {\n    const apiKey = await this._apiKeyManagementService.acquireAPIKey();\n\n    return super.startRecognizing({ apiKey });\n  }\n}\n","import DeepgramSpeechRecognizerService from \"./DeepgramSpeechRecognizerService\";\n\nexport default DeepgramSpeechRecognizerService;\n","import UIServiceCore, { EVT_UPDATED } from \"@core/classes/UIServiceCore\";\nimport SpeechRecognizerServiceCollection from \"./SpeechRecognizerServiceCollection\";\n\nimport { EVT_TRANSCRIPTION_FINALIZED } from \"../__common__/SpeechRecognizerBase\";\n\nimport MesaSpeechRecognizerService from \"../provider/Mesa/MesaSpeechRecognizerService\";\nimport DeepgramSpeechRecognizerService from \"../provider/Deepgram/DeepgramSpeechRecognizerService\";\n\nexport { EVT_UPDATED, EVT_TRANSCRIPTION_FINALIZED };\n\n/**\n * Maintains a collection of speech recognizer services.\n */\nexport default class SpeechRecognizerCollectionService extends UIServiceCore {\n  // TODO: Enforce non-extendable\n  // @see https://github.com/zenOSmosis/phantom-core/issues/149\n  /*\n  static meta = {\n    extendable: false,\n  };\n  */\n\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Speech Recognizer Collection Service\");\n\n    this._speechRecognizerServiceCollection = this.bindCollectionClass(\n      SpeechRecognizerServiceCollection\n    );\n\n    // NOTE: This does not currently facilitate dynamically adding / removing\n    // speech recognizer services\n    //\n    // Proxy _speechRecognizerCollection EVT_TRANSCRIPTION_FINALIZED\n    this.proxyOn(\n      this._speechRecognizerServiceCollection,\n      EVT_TRANSCRIPTION_FINALIZED,\n      text => this.emit(EVT_TRANSCRIPTION_FINALIZED, text)\n    );\n\n    this.useSpeechRecognizerServiceClass(MesaSpeechRecognizerService);\n    this.useSpeechRecognizerServiceClass(DeepgramSpeechRecognizerService);\n  }\n\n  /**\n   *\n   * @param {*} SpeechRecognizerServiceClass\n   */\n  useSpeechRecognizerServiceClass(SpeechRecognizerServiceClass) {\n    // TODO: Check for class instance before\n    const speechRecognizerServiceInstance = this.useServiceClass(\n      SpeechRecognizerServiceClass\n    );\n\n    this._speechRecognizerServiceCollection.addSpeechRecognizerServiceInstance(\n      speechRecognizerServiceInstance\n    );\n  }\n\n  /**\n   * Retrieves the speech recognizer service instances which are bound to this\n   * service.\n   *\n   * @return {SpeechRecognizerServiceCore[]}\n   */\n  getSpeechRecognizerServices() {\n    return this._speechRecognizerServiceCollection.getChildren();\n  }\n}\n","import SpeechRecognizerCollectionService, {\n  EVT_UPDATED,\n  EVT_TRANSCRIPTION_FINALIZED,\n} from \"./SpeechRecognizerCollectionService\";\n\nexport default SpeechRecognizerCollectionService;\nexport { EVT_UPDATED, EVT_TRANSCRIPTION_FINALIZED };\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\n\nimport DesktopCommanderControllerService, {\n  EVT_UPDATED,\n} from \"@services/DesktopCommanderControllerService\";\n\nimport SpeechRecognizerCollectionService, {\n  EVT_TRANSCRIPTION_FINALIZED,\n} from \"./SpeechRecognizerCollectionService\";\n\nexport { EVT_UPDATED };\n\n// TODO: Document\n// IMPORTANT: Don't extend DesktopCommanderControllerService\nexport default class SpeechDesktopControllerService extends UIServiceCore {\n  // TODO: Prevent extendable (reference: https://github.com/zenOSmosis/phantom-core/issues/149)\n\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Speech Input Desktop Controller Service\");\n\n    this._desktopControllerService = this.useServiceClass(\n      DesktopCommanderControllerService\n    );\n\n    // A proxy to all of the speech recognizer services\n    this._speechRecognizerCollectionService = this.useServiceClass(\n      SpeechRecognizerCollectionService\n    );\n\n    // Handle finalized transcription updates\n    this.proxyOn(\n      this._speechRecognizerCollectionService,\n      EVT_TRANSCRIPTION_FINALIZED,\n      ([speechRecognizerService, text]) => {\n        if (speechRecognizerService.getIsControllingDesktop()) {\n          this.extractCommandIntentFromText(text);\n        }\n      }\n    );\n  }\n\n  // TODO: Document\n  // FIXME: (jh) This could be more efficient in terms of CPU usage\n  // TODO: Process in a web worker?\n  async extractCommandIntentFromText(text) {\n    // Lower-case and alpha-numeric\n    const normalizedText = text.toLowerCase().replace(/[^a-z0-9 ]/gi, \"\");\n\n    const words = normalizedText.split(\" \");\n\n    // Determine potential commands, and assign a \"strength\" rating; the higher\n    // the strength, the most likely it is the relevant command\n    const commandStrengths = Object.values(\n      this._desktopControllerService.getCommands()\n    )\n      .map(command => {\n        const matchedWords = words.filter(word =>\n          command.keywords.includes(word)\n        );\n\n        const strength = matchedWords.length;\n\n        return {\n          command,\n          strength,\n        };\n      })\n      .filter(({ strength }) => strength);\n\n    // Guess the best command, based on the highest strength rating\n    const bestMatchCommandStrength = commandStrengths.reduce((a, b) => {\n      if (!a || b.strength > a.strength) {\n        return b;\n      } else if (b.strength === a.strength) {\n        // If two strengths are the same, favor the one with the least keywords\n\n        if (b.command.keywords.length < a.command.keywords.length) {\n          return b;\n        } else {\n          return a;\n        }\n      } else {\n        return a;\n      }\n    }, null);\n\n    if (bestMatchCommandStrength) {\n      const command = bestMatchCommandStrength.command;\n\n      await this._desktopControllerService.execCommand(command);\n    }\n  }\n}\n","import SpeechCommanderApp, { REGISTRATION_ID } from \"./SpeechCommanderApp\";\n\nexport default SpeechCommanderApp;\nexport { REGISTRATION_ID };\n","import { useMemo } from \"react\";\n\nimport Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport Layout, { Content } from \"@components/Layout\";\nimport Section from \"@components/Section\";\nimport Center from \"@components/Center\";\nimport ExternalLinkButton from \"@components/ExternalLinkButton\";\n\nimport getContactURL from \"@utils/getContactURL\";\n\nimport SpeechRecognizerSection from \"./components/SpeechRecognizerSection\";\nimport SpeechCommanderAppFooter from \"./components/SpeechCommanderApp.Footer\";\n\n// Local services\nimport SpeechInputDesktopControllerService from \"../../services/speechRecognition/SpeechInputDesktopControllerService\";\nimport SpeechRecognizerCollectionService from \"../../services/speechRecognition/SpeechRecognizerCollectionService\";\n\nimport DesktopCommanderControllerService from \"@services/DesktopCommanderControllerService\";\n\nexport const REGISTRATION_ID = \"speech-commander\";\n\n// TODO: Show matched command\n\nconst SpeechCommanderApp = {\n  id: REGISTRATION_ID,\n  title: \"Speech Commander\",\n  style: {\n    width: 640 * 1.5,\n    height: 480 * 1.5,\n  },\n  isAutoStart: true,\n  serviceClasses: [\n    SpeechRecognizerCollectionService,\n    SpeechInputDesktopControllerService,\n    DesktopCommanderControllerService,\n  ],\n\n  // TODO: Include load screen?\n\n  view: function View({ appServices }) {\n    const collectionService = appServices[SpeechRecognizerCollectionService];\n\n    const speechRecognitionServices =\n      collectionService.getSpeechRecognizerServices();\n\n    // TODO: Document\n    // TODO: Refactor into a data view\n    const speechRecognitionProviders = useMemo(() => {\n      const providers = speechRecognitionServices.map(\n        speechRecognizerService => ({\n          title: speechRecognizerService.getTitle(),\n          speechRecognizerService,\n          apiKeyManagementService:\n            speechRecognizerService.getAPIKeyManagementService(),\n          disabled: false,\n          requiresAPIKey: true,\n          serviceProviderURL: speechRecognizerService.getServiceProviderURL(),\n        })\n      );\n\n      // TODO: Remove once native provider is implemented\n      providers.push({\n        title: \"Native Speech Recognizer Service\",\n        speechRecognizerService: null,\n        apiKeyManagementService: null,\n        disabled: true,\n        requiresAPIKey: false,\n        serviceProviderURL:\n          \"https://developer.mozilla.org/en-US/docs/Web/API/SpeechRecognition\",\n        status: \"Not implemented\",\n      });\n\n      return providers;\n    }, [speechRecognitionServices]);\n\n    return (\n      <Layout>\n        <Content>\n          <Full style={{ overflowY: \"auto\" }}>\n            <Padding>\n              <h1>Speech Recognition Providers</h1>\n\n              <p className=\"note\">\n                Multiple speech recognition providers can be run concurrently.\n              </p>\n\n              {speechRecognitionProviders.map(provider => (\n                <SpeechRecognizerSection\n                  key={provider.title}\n                  speechProvider={provider}\n                />\n              ))}\n\n              <Section>\n                <Center>\n                  <Padding style={{ fontWeight: \"bold\" }}>\n                    Do you have a speech recognition API you'd like to see in\n                    this list?\n                  </Padding>\n                  <Padding>\n                    <ExternalLinkButton href={getContactURL()}>\n                      Contact Us\n                    </ExternalLinkButton>\n                  </Padding>\n                </Center>\n              </Section>\n            </Padding>\n          </Full>\n        </Content>\n        <SpeechCommanderAppFooter />\n      </Layout>\n    );\n  },\n};\n\nexport default SpeechCommanderApp;\n","/**\n * Retrieves a URL to contact the author.\n *\n * @return {string}\n */\nexport default function getContactURL() {\n  // FIXME: (jh) Import from environment variable\n  return \"https://www.linkedin.com/in/jeremyharrisconsultant/\";\n}\n","import ReShellOrg from \"./ReShell.org\";\n\nexport default ReShellOrg;\n","import Desktop from \"@components/Desktop\";\n\nimport ApplicationsApp from \"./apps/ApplicationsApp\";\nimport ApplicationMonitorApp from \"../ExamplePortal/apps/ApplicationMonitorApp\";\nimport AboutReShellApp from \"./apps/AboutReShellApp\";\nimport CheckForUpdatesApp from \"../ExamplePortal/apps/CheckForUpdatesApp\";\nimport ColorAdjusterApp from \"../ExamplePortal/apps/ColorAdjusterApp\";\nimport EnvironmentApp from \"../ExamplePortal/apps/EnvironmentApp\";\nimport ServiceMonitorApp from \"../ExamplePortal/apps/ServiceMonitorApp\";\nimport SoftwareInfoApp from \"../ExamplePortal/apps/SoftwareInfoApp\";\nimport InputMediaDevicesApp from \"../ExamplePortal/apps/InputMediaDevicesApp\";\nimport ScreenCaptureApp from \"../ExamplePortal/apps/ScreenCaptureApp\";\nimport VUMeterApp from \"../ExamplePortal/apps/VUMeterApp\";\nimport MemoryInfoApp from \"../ExamplePortal/apps/MemoryInfoApp\";\nimport KeyVaultApp from \"../ExamplePortal/apps/KeyVaultApp\";\nimport AppRegistrationViewerApp from \"../ExamplePortal/apps/AppRegistrationViewerApp\";\n\n// Mesa Hackathon apps\nimport SpeechCommanderApp from \"../HackathonPortal/apps/SpeechCommanderApp\";\nimport DesktopCommanderDebuggerApp from \"../ExamplePortal/apps/DesktopCommanderDebuggerApp\";\n\nexport default function ReShellOrgPortal() {\n  return (\n    <Desktop\n      appDescriptors={[\n        ApplicationsApp,\n        ApplicationMonitorApp,\n        AboutReShellApp,\n        CheckForUpdatesApp,\n        ColorAdjusterApp,\n        EnvironmentApp,\n        InputMediaDevicesApp,\n        MemoryInfoApp,\n        ScreenCaptureApp,\n        ServiceMonitorApp,\n        SoftwareInfoApp,\n        VUMeterApp,\n        KeyVaultApp,\n        AppRegistrationViewerApp,\n        //\n        SpeechCommanderApp,\n        DesktopCommanderDebuggerApp,\n      ]}\n    />\n  );\n}\n"],"sourceRoot":""}