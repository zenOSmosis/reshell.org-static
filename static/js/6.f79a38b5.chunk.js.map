{"version":3,"sources":["components/Layout/Layout.module.css","components/Window/Window.module.css","components/FullViewport/FullViewport.jsx","components/FullViewport/FullViewport.module.css","components/Layout/RowColumn/RowColumn.module.css","components/NoWrap/NoWrap.module.css","components/LED/LED.module.css","components/AutoScaler/AutoScaler.module.css","components/Padding/Padding.module.css","components/Desktop/providers/NotificationProvider/views/NotificationStack/NotificationStack.module.css","components/ButtonTransparent/ButtonTransparent.module.css","components/Desktop/providers/NotificationProvider/views/Notification/Notification.module.css","components/VirtualLink/VirtualLink.module.css","portals/ExamplePortal/apps/ColorAdjusterApp/ColorAdjuster.module.css","components/ObjectViewer/ObjectViewer.module.css","components/audioMeters/AudioLevelMeter/AudioLevelMeter.module.css","components/StaggeredWaveLoading/StaggeredWaveLoading.module.css","components/audioMeters/VUMeter/VUMeter.module.css","components/audioVideoRenderers/Video.module.css","components/FullViewport/index.jsx","hooks/useDesktopContext.js","hooks/useAppOrchestrationContext.js","components/WindowManager/WindowManager.RouteProvider.jsx","utils/getElPosition.js","utils/getElSize.js","components/Window/classes/WindowController.js","components/Layout/Header.jsx","components/Layout/Content.jsx","components/Layout/Footer.jsx","components/Layout/RowColumn/RowColumn.jsx","components/Layout/index.jsx","components/Layout/Layout.jsx","components/Window/Window.Border.jsx","components/NoWrap/index.jsx","components/NoWrap/NoWrap.jsx","components/Window/Window.TitleBar/Window.TitleBar.Button/Window.TitleBar.Button.jsx","components/Window/Window.TitleBar/index.jsx","components/Window/Window.TitleBar/Window.TitleBar.jsx","hooks/useObjectState.js","components/Window/hooks/useWindowAutoPositioner/index.js","components/Window/hooks/useWindowAutoPositioner/useWindowAutoPositioner.js","components/Window/hooks/useWindowAutoPositioner/useWindowOutOfBoundsPositionCorrection.js","components/Window/hooks/__window_hook_constants__.js","utils/getElCenterPoint.js","components/Window/hooks/useWindowAutoSizer.js","hooks/useUIParadigm.js","components/Window/Window.View.jsx","components/Window/hooks/useWindowOpenAnimation.js","components/Window/hooks/useWindowControls.js","components/Window/hooks/useWindowDragger.js","components/Window/hooks/useWindowDragResizer.js","components/Window/hooks/useWindowStyles.js","components/Window/index.jsx","components/Window/Window.jsx","components/Window/Window.Provider.jsx","components/WindowManager/WindowManager.jsx","components/Window/hooks/useWindowContext.js","components/WindowManager/hooks/useRegistrationViewOnResized.js","components/WindowManager/index.jsx","components/LED/index.jsx","components/LED/LED.jsx","components/Dock/index.jsx","components/Dock/Dock.jsx","components/AutoScaler/AutoScaler.jsx","components/AutoScaler/index.jsx","components/_Menu.LibWrapper/index.jsx","hooks/useAppRegistrationLink.js","components/Padding/index.jsx","components/Padding/Padding.jsx","components/Timer/index.jsx","components/Timer/Timer.jsx","portals/ExamplePortal/apps/ServiceMonitorApp.jsx","components/ButtonTransparent/ButtonTransparent.jsx","components/ButtonTransparent/index.jsx","components/icons/InfoIcon/index.jsx","components/icons/InfoIcon/DynamicIcon.jsx","components/icons/CloseIcon/index.jsx","components/icons/CloseIcon/DynamicIcon.jsx","components/Desktop/providers/NotificationProvider/views/Notification/index.jsx","components/Desktop/providers/NotificationProvider/views/Notification/Notification.jsx","components/Desktop/providers/NotificationProvider/views/NotificationStack/index.jsx","components/Desktop/providers/NotificationProvider/views/NotificationStack/NotificationStack.jsx","services/UINotificationService.js","components/Desktop/providers/NotificationProvider/NotificationProvider.jsx","components/Desktop/providers/NotificationProvider/index.jsx","components/Desktop/providers/ModalProvider/views/Modal/index.jsx","components/Desktop/providers/ModalProvider/views/Modal/Modal.jsx","components/Desktop/providers/ModalProvider/views/ModalStack/index.jsx","components/Desktop/providers/ModalProvider/views/ModalStack/ModalStack.jsx","services/UIModalService.js","components/Desktop/providers/ModalProvider/ModalProvider.jsx","components/Desktop/providers/ModalProvider/index.jsx","components/Desktop/index.jsx","components/Desktop/Desktop.jsx","components/VirtualLink/index.jsx","components/VirtualLink/VirtualLink.jsx","hooks/useKeyboardEvents.js","utils/consume.js","portals/ExamplePortal/apps/ApplicationsApp/views/ApplicationSelector.jsx","portals/ExamplePortal/apps/ApplicationsApp/views/PortalSelector.jsx","portals/ExamplePortal/apps/ApplicationsApp/ApplicationsApp.jsx","portals/ExamplePortal/apps/ApplicationsApp/index.jsx","portals/ReShell.org/apps/ApplicationsApp.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/AppRuntime.Table.Row.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/AppRuntime.Table.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/ApplicationMonitorApp.jsx","portals/ExamplePortal/apps/ApplicationMonitorApp/index.jsx","components/ButtonPanel/index.jsx","components/ButtonPanel/ButtonPanel.jsx","components/ExternalLink/index.jsx","components/ExternalLink/ExternalLink.jsx","components/ExternalLinkButton/index.jsx","components/ExternalLinkButton/ExternalLinkButton.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Details/Details.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Details/index.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Resources/Resources.jsx","portals/ExamplePortal/apps/AboutReShellApp/views/Resources/index.jsx","utils/getCopyright.js","portals/ExamplePortal/apps/AboutReShellApp/AboutReShellApp.jsx","portals/ExamplePortal/apps/AboutReShellApp/index.jsx","portals/ReShell.org/apps/AboutReShellApp.jsx","portals/ExamplePortal/apps/CheckForUpdatesApp/CheckForUpdatesApp.jsx","portals/ExamplePortal/apps/CheckForUpdatesApp/index.jsx","portals/ExamplePortal/apps/ColorAdjusterApp/index.jsx","portals/ExamplePortal/apps/ColorAdjusterApp/ColorAdjusterApp.jsx","components/ObjectViewer/index.jsx","components/ObjectViewer/ObjectViewer.jsx","portals/ExamplePortal/apps/EnvironmentApp/EnvironmentApp.jsx","portals/ExamplePortal/apps/EnvironmentApp/index.jsx","components/AppLinkButton/index.jsx","components/AppLinkButton/AppLinkButton.jsx","portals/ExamplePortal/apps/SoftwareInfoApp/SoftwareInfoApp.jsx","portals/ExamplePortal/apps/SoftwareInfoApp/index.jsx","services/MediaDeviceCachingService.js","services/InputMediaDevicesService.js","components/icons/RCACableIcon/index.jsx","components/icons/RCACableIcon/DynamicIcon.jsx","hooks/useArrayDiff.js","hooks/usePrevious.js","hooks/useMultiAudioMediaStreamTrackLevelMonitor.js","components/audioMeters/AudioLevelMeter/index.jsx","components/audioMeters/AudioLevelMeter/AudioLevelMeter.jsx","components/icons/MicrophoneIcon/index.jsx","components/icons/MicrophoneIcon/DynamicIcon.jsx","components/InputMediaDevicesSelector/subComponents/AudioInputDeviceTableRow.js","components/InputMediaDevicesSelector/subHooks/useInputMediaDevicesSelectorState.js","components/InputMediaDevicesSelector/index.jsx","components/InputMediaDevicesSelector/InputMediaDevicesSelector.jsx","components/StaggeredWaveLoading/index.jsx","components/StaggeredWaveLoading/StaggeredWaveLoading.jsx","components/Preload/index.jsx","components/Preload/Preload.jsx","components/audioMeters/VUMeter/images/vu.png","components/audioMeters/VUMeter/images/needle.png","components/audioMeters/VUMeter/index.jsx","components/audioMeters/VUMeter/VUMeter.jsx","portals/ExamplePortal/apps/VUMeterApp/VUMeterApp.jsx","portals/ExamplePortal/apps/VUMeterApp/index.jsx","components/audioVideoRenderers/AVBase.jsx","components/audioVideoRenderers/Video.jsx","services/ScreenCapturerService.js","portals/ExamplePortal/apps/ScreenCaptureApp/ScreenCaptureApp.jsx","hooks/useGetIsUnmounting.js","portals/ExamplePortal/apps/ScreenCaptureApp/index.jsx","portals/ExamplePortal/apps/InputMediaDevicesApp/InputMediaDevicesApp.jsx","portals/ExamplePortal/apps/InputMediaDevicesApp/index.jsx","utils/bytesToSize.js","portals/ExamplePortal/apps/MemoryInfoApp/index.jsx","portals/ExamplePortal/apps/MemoryInfoApp/MemoryInfoApp.jsx","portals/ExamplePortal/apps/KeyVaultApp/views/LocalStorageItems/index.jsx","portals/ExamplePortal/apps/KeyVaultApp/views/LocalStorageItems/LocalStorageItems.jsx","utils/getFormValues.js","components/Form/index.jsx","components/Form/Form.jsx","components/Form/hooks/useFormController.js","portals/ExamplePortal/apps/KeyVaultApp/views/KeyEditorForm.jsx","components/icons/BackArrowIcon/index.jsx","components/icons/BackArrowIcon/DynamicIcon.jsx","portals/ExamplePortal/apps/KeyVaultApp/KeyVaultApp.jsx","portals/ExamplePortal/apps/KeyVaultApp/index.jsx","portals/ReShell.org/index.jsx","portals/ReShell.org/ReShell.org.jsx"],"names":["module","exports","FullViewport","className","children","rest","useState","elContainer","setElContainer","useEffect","document","documentElement","classList","add","styles","body","handleResize","setImmediate","style","height","window","innerHeight","scrollTop","addEventListener","remove","removeEventListener","ref","classNames","useDesktopContext","useContext","DesktopContext","useAppOrchestrationContext","AppOrchestrationContext","WindowManagerRouteContext","React","createContext","WindowManagerRouteProvider","getAppRuntimesWithRegistrationID","activateAppRegistrationID","activeWindowController","setActiveWindowController","locationAppRegistrationID","useLocationAppRegistrationID","activeRegistrationID","getAppRuntime","getRegistrationID","history","useHistory","push","Provider","value","getElPosition","el","x","offsetLeft","y","offsetTop","getElSize","width","offsetWidth","offsetHeight","EVT_RENDER_PROFILED","EVT_RESIZED","EVT_MOVED","WindowController","initialState","onBringToTop","DEFAULT_STATE","isMaximized","isMinimized","PhantomState","mergeOptions","_appRuntime","_elWindow","_elWindowManager","_handleBringToTop","_emitDebouncedResized","debounce","bind","_emitDebouncedMoved","_centerHandler","_scatterHandler","a","clear","getIsDestroying","destroy","__INTERNAL__setCenterHandler","centerHandler","this","center","__INTERNAL__setScatterHandler","scatterHandler","scatter","bringToTop","captureRenderProfile","arrRenderProfile","emit","attachWindowElement","attachWindowManagerElement","setAppRuntime","appRuntime","setTitle","getTitle","getAppRegistration","runtime","getRegistration","setSize","elWindow","requestSkippableAnimationFrame","undefined","_uuid","getSize","log","warn","getWindowManagerSize","elWindowManager","setPosition","getIsMaximized","left","right","top","bottom","getPosition","getIsBorderDisabled","getIsMinimized","setState","partialNextState","TypeError","setIsMaximized","maximize","getState","setIsMinimized","minimize","restore","Header","Full","Content","Footer","Row","disableVerticalFill","Column","Layout","DIR_BORDER_SE","DIR_BORDER_SW","useDirectionalDragger","direction","onBorderDrag","useDrag","isDragging","down","movement","mx","my","pointer","touch","NoWrap","WindowTitleBarMaximizeButton","WindowTitleBarButton","WindowTitleBarMinimizeButton","WindowTitleBarCloseButton","WindowTitleBar","onElTitleBar","title","onRestoreOrMaximize","onMinimize","onClose","TitleBarView","titleBarView","onDoubleClick","onClick","useObjectState","state","_setMergedState","refState","useRef","current","useCallback","updatedState","JSON","parse","err","console","error","prevState","nextState","Object","keys","diff","length","useWindowAutoPositioner","windowController","onInitialAutoPosition","refOnInitialAutoPosition","outOfBoundsCorrectionPosition","useWindowOutOfBoundsPositionCorrection","correctionPosition","_setCorrectionPosition","getOutOfBoundsPositionCorrection","winManSize","winSize","winPosition","winTL","winTR","correctedPosition","_handleResizeOrMove","nextCorrectionPosition","on","unmount","off","currentPosition","nextPosition","handleCenter","winManCenter","getElCenterPoint","handleScatter","Math","floor","random","appRuntimes","refInitialAppRuntimes","requestAnimationFrame","useWindowAutoSizer","uiParadigm","useUIParadigm","paradigm","MOBILE_PARADIGM","DESKTOP_PARADIGM","WindowView","isActive","isProfiling","_setElWindow","useWindowOpenAnimation","isOpenAnimationEnded","_setIsOpenAnimationEnded","useAnimation","domElement","animationName","animationDuration","shouldRun","Boolean","onAnimationEnd","zIndex","_setZIndex","_setTitle","refTitle","isWindowBorderDisabled","_setIsWindowBorderDisabled","refIsWindowBorderDisabled","_setIsMaximized","_setIsMinimized","_handleWindowControllerUpdate","windowTitle","stackingIndex","shouldWindowBorderBeDisabled","EVT_UPDATED","useWindowControls","useWindowDragger","isDisabled","refInitialDragPosition","refInitialWindowManagerSize","isUserDragging","setIsUserDragging","xy","event","initialWindowManagerWidth","initialWindowManagerHeight","dragBind","useWindowDragResizer","refInitialDragSizePosition","isUserResizing","setIsUserResizing","windowManagerWidth","windowManagerHeight","ReferenceError","diffX","diffY","handleBorderDrag","DynamicProfilingWrapper","useMemo","args","Profiler","id","getUUID","onRender","renderProfile","Fragment","useWindowStyles","outerBorderStyle","windowStyle","backgroundColor","bodyStyle","padding","StackingContext","onMount","isAccelerated","Border","WindowBorder","borderWidth","bindNW","bindN","bindNE","bindE","bindSE","bindS","bindSW","bindW","maxHeight","maxWidth","cursor","Window","forwardRef","attachWindowController","useImperativeHandle","WindowContext","WindowProvider","initialSharedState","sharedState","setSharedState","WindowManagerView","elBase","setElBase","desktopContextActiveWindowController","setDesktopContextActiveWindowController","windowControllerMaps","setWindowControllerMaps","getWindowControllerMapWithKey","key","refDesktopContextActiveWindowController","handleSetActiveWindow","is","handleGetIsActiveWindow","startServiceClass","useServicesContext","refHandleSetActiveWindow","_handleElBaseTouch","evt","target","passive","windows","map","appDescriptor","getAppDescriptor","ViewComponent","view","serviceClasses","windowProps","isPinned","isPinnedToDock","isAutoStart","dataMap","appServices","serviceClass","service","onMouseDown","onTouchStart","__INTERNAL__setWindowController","prev","next","once","EVT_DESTROYED","filter","Cover","position","WrappedTitleBarView","WrappedView","forceUpdate","useForceUpdate","useWindowContext","_handleServiceUpdate","values","setResizeHandler","useRegistrationViewOnResized","refSetResizeHandler","handleResized","_handleExecResizedCallback","onResized","WindowManager","appDescriptors","addOrUpdateAppRegistration","forEach","descriptor","LED","color","Dock","appRegistrations","activeAppRegistrations","activateAppRegistration","dockRegistrations","Set","registration","getIsPinnedToDock","activeRegistration","textAlign","isolation","overflowX","pointerEvents","display","whiteSpace","assign","minWidth","ResizeObserver","install","AutoScaler","elOuterWrap","setElOuterWrap","elInnerWrap","setElInnerWrap","uuid","uuidv4","outerWrapSize","innerWrapSize","visibility","ro","entries","entry","size","maxScaleX","maxScaleY","scale","min","transform","setTimeout","observe","unobserve","COMMON_PROPS","overflow","Menu","applyHOC","portal","LibMenu","SubMenu","applyStatics","LibSubMenu","useAppRegistrationLink","appDescriptorID","getAppRegistrationTitleWithDescriptorID","link","Padding","setEl","hasSiblings","setHasSiblings","parentNode","Timer","secs","onTick","seconds","_setSeconds","getSeconds","handleUpdate","updateInterval","setInterval","clearInterval","Date","toISOString","substr","REGISTRATION_ID","ServiceMonitorApp","View","services","UIServicesContext","overflowY","getInstanceUptime","ButtonTransparent","DynamicIcon","propsRest","Notification","image","autoCloseTime","isClosing","setIsClosing","refOnClose","handleClose","stopPropagation","autoCloseTimeout","startTimeout","stopTimeout","clearTimeout","Image","alt","src","InfoIcon","MessageButton","onTouchEnd","onMouseUp","Animation","CloseIcon","NotificationStack","notifications","onNotificationClose","UINotificationService","showNotification","closeNotificationWithUUID","prevUUID","isKept","UIServiceCore","NotificationContext","NotificationProvider","useServiceClass","serviceInstance","serviceState","notification","Modal","ModalStack","modals","UIModalService","showModal","options","timeout","_handleClose","closeModalWithUUID","duration","ModalContext","ModalProvider","modal","Desktop","backgroundView","openServiceMonitor","SERVICE_MONITOR_REGISTRATION_ID","menuButton","MenuButton","label","sort","b","aTitle","bTitle","app","MenuItem","getIsPinned","MenuDivider","MenuHeader","getWindowController","confirm","ReShellCore","reload","fontWeight","fontStyle","fontSize","getReShellVersion","PhantomCore","getPhantomCoreVersion","getPortalName","process","VirtualLink","DEFAULT_PROPS","onKeyDown","keyCode","onKeyUp","onEnter","onEscape","isEnabled","consume","obj","ApplicationSelector","searchQuery","onResetSearchQuery","appRuntimeRegistrations","filteredRegistrations","toUpperCase","includes","Center","canOverflow","totalInstances","predicate","borderColor","Array","nonUsed","idx","margin","PortalSwitcher","getPortals","portalName","switchToPortal","LEN_PORTALS","ApplicationsApp","elSearch","setElSearch","useKeyboardEvents","domNode","props","_handleKeyDown","repeat","which","_handleKeyUp","preventDefault","handleSetSearchQuery","handleDoubleClick","placeholder","onChange","isDisplayingPortals","setIsDisplayingPortals","handleResetSearchQuery","ApplicationsOverrideApp","AppRuntimeTableRow","isTopMostWindowController","elProfilerPhase","setElProfilerPhase","elProfilerActualDuration","setElProfilerActualDuration","elProfilerBaseDuration","setElProfilerBaseDuration","elProfilerStartTime","setElProfilerStartTime","elProfilerCommitTime","setElProfilerCommitTime","elProfilerInteractions","setElProfilerInteractions","handleRenderProfile","phase","actualDuration","baseDuration","startTime","commitTime","interactions","innerHTML","parseFloat","toFixed","colSpan","disabled","environment","getEnvironment","AppRuntimeTable","rowSpan","ApplicationMonitorApp","getUptime","ButtonPanel","buttons","selectedIdx","button","isSelected","setSelectedIdx","refRenderIdx","content","type","ExternalLink","ExternalLinkButton","href","open","LINKS","PhantomCollection","SyncObject","MediaStreamController","WebRTCPeer","LINK_BUTTON_STYLE","minHeight","Details","rel","gridTemplateColumns","urlOrAction","zenOSmosis","GitHub","Resources","name","url","FULL_YEAR","getFullYear","AboutReShellApp","screen","opacity","AboutReShellOverrideApp","CheckForUpdatesApp","isLatest","setIsLatest","isChecking","setIsChecking","isError","setIsError","lastCheckTime","setLastCheckTime","refIsChecking","handleCheckForUpdates","fetchIsLatestVersion","getTime","dayjs","format","ColorAdjusterApp","isGrayscale","setIsGrayscale","borderRadius","ObjectViewer","theme","EnvironmentApp","AppLinkButton","registrationTitle","ButtonView","packageJson","require","SoftwareInfoApp","float","CHECK_FOR_UPDATES_REGISTRATION_ID","ENVIRONMENT_REGISTRATION_ID","KEY_STORAGE_ENGINE_MEDIA_DEVICES","KEY_DMETA_USER_METADATA","MediaDeviceCachingService","devicesWithUserMetadata","_storageEngine","KeyVaultService","getSecureLocalStorageEngine","_fetchCachedMediaDeviceUserMetadata","then","device","userMetadata","update","pred","isMatch","utils","mediaDevice","getIsSameMediaDevice","deepMerge","filteredCache","setItem","fetchItem","cache","isArray","getMediaDeviceUserMetadata","cachedDevice","find","InputMediaDeviceFactoryCollection","MediaStreamTrackControllerFactoryCollection","InputMediaDevicesService","isFetchingMediaDevices","isAudioContextStarted","devices","_mediaDeviceCachingService","_inputMediaDeviceFactoryCollection","bindCollectionClass","fetchInputMediaDevices","isAggressive","untilAudioContextResumed","catch","finally","inputMediaDevices","audioContext","getIsFetchingMediaDevices","getInputMediaDevices","getAudioInputMediaDevices","kind","getCaptureFactories","getTrackControllerFactories","getIsAudioMediaDeviceBeingCaptured","mediaDeviceInfo","MediaStreamTrackControllerFactory","getFactoriesWithInputMediaDevice","getMediaDeviceCaptureFactory","factories","userConstraints","factoryOptions","captureSpecificMediaDevice","factory","addTrackControllerFactory","uncaptureSpecificMediaDevice","getIsCapturingAnyAudio","getAudioTrackControllers","getIsAllAudioMuted","getIsAudioMuted","setIsAllAudioMuted","isAllAudioMuted","setIsAudioMuted","muteAllAudio","muteAudio","unmuteAllAudio","unmuteAudio","useArrayDiff","usePrevious","defaultPreviousValue","refPrev","added","removed","addedRemoved","_setAddedRemoved","Error","getChildrenDiff","EVT_AUDIO_LEVEL_UPDATED","MultiAudioMediaStreamTrackLevelMonitor","useMultiAudioMediaStreamTrackLevelMonitor","mediaStreamTrackOrTracks","onAudioLevelChange","mediaStreamTracks","track","MediaStreamTrack","mediaStreamMonitor","_setMediaStreamMonitor","refOnAudioLevelChange","audioLevel","addedMediaStreamTracks","removedMediaStreamTracks","addMediaStreamTrack","removeMediaStreamTrack","AudioLevelMeter","mediaStreamTrack","elAudioLevel","setElAudioLevel","handleAudioLevelChange","inset","clipPath","WebkitClipPath","AudioInputDeviceTableRow","isCapturing","onToggleCapture","isMuted","onToggleMute","audioQualityPresets","audioQualityPresetName","onChangeAudioQualityPresetName","marginTop","preset","presetName","MicrophoneIcon","constraints","DEFAULT_AUDIO_QUALITY_PRESET","AUDIO_QUALITY_PRESET_TALK_RADIO","InputMediaDevicesSelector","onDeviceCapture","onDeviceUncapture","useInputMediaDevicesSelectorState","inputMediaDevicesService","mediaDevicesCachingService","setDevicePreferredAudioQualityPresetName","audioQualityPreset","getAudioQualityPresetWithName","setMediaDeviceUserMetadata","deviceUserMetadata","preferredConstraints","getAudioQualityPresetConstraints","getDevicePreferredAudioQualityPresetName","toggleSpecificAudioInputDevice","audioInputDevices","capturedAudioInputDevices","lenAudioInputDevices","isFetching","lenCapturedAudioInputDevices","border","deviceCaptureFactory","getOutputMediaStream","getTracks","audioTrackController","settings","getSettings","getIsMuted","toggleMute","RCACableIcon","marginLeft","StaggeredWaveLoading","Preload","preloadResources","disabledLoadingIndicator","onError","usePreload","isPreloaded","VUMeter","elVU","setElVU","elNeedle","setElNeedle","backgroundImage","vuBackground","backgroundPosition","backgroundRepeat","vuNeedle","VUMeterApp","controller","getOutputMediaStreamTrack","flat","INPUT_MEDIA_DEVICES_REGISTRATION_ID","AVBase","mediaType","onEl","mediaStream","MediaStream","srcObject","play","muted","refOnEl","createElement","autoPlay","playsInline","controls","Video","ScreenCaptureFactoryCollection","ScreenCapturerService","captureScreen","getCollectionInstance","getMediaStreamTracks","getChildren","getTrackControllers","ScreenCaptureApp","scs","screenCaptureFactory","setScreenCaptureFactory","getIsUnmounting","useGetIsUnmounting","refIsUnmounting","handleStartScreenCapture","startScreenCapture","videoTrack","getVideoTrackControllers","getOutputTrack","audioTrack","InputMediaDevicesApp","mds","VU_METER_REGISTRATION_ID","SCREEN_CAPTURE_REGISTRATION_ID","bytesToSize","bytes","sizes","i","parseInt","abs","MemoryInfoApp","jsHeapSizeLimit","totalJSHeapSize","usedJSHeapSize","_setMemoryInfo","fetchMemoryInfo","performance","memory","memoryInfo","refetchInterval","LocalStorageItems","keyStorageEngineMaps","onGetValue","onEmpty","onNewItem","keyMap","storageEngine","getEncryptionType","getFormValues","formElement","elements","Form","autoComplete","validator","formValues","onSubmit","useFormController","setFormRef","tagName","getAttribute","isValid","setIsValid","errors","setErrors","handleFormValidate","hasErrors","fromEntries","handleFormChange","handleFormSubmit","submit","validate","KeyEditorForm","initialKey","initialValue","initialStorageEngine","storageEngines","defaultValue","required","getShortUUID","shortUUID","KeyVaultApp","localDataPersistenceService","setKeyStorageEngineMaps","handleFetchKeyStorageEngineMaps","fetchKeyStorageEngineMaps","keyMaps","isCreatingNewKey","setIsCreatingNewKey","handleGetValue","alert","handleKeyValueSubmit","getStorageEngineWithShortUUID","handleEmpty","clearAllStorageEngines","BackArrowIcon","getStorageEngines","ReShellOrg","ReShellOrgPortal"],"mappings":"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","file":"static/js/6.f79a38b5.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"layout\":\"Layout_layout__3PvPc\",\"header\":\"Layout_header__3EItT\",\"content\":\"Layout_content__1t8Hf\",\"footer\":\"Layout_footer__3EMQb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"window-outer-border\":\"Window_window-outer-border__3TebC\",\"hidden\":\"Window_hidden__3nppO\",\"maximized\":\"Window_maximized__1kLcW\",\"minimized\":\"Window_minimized__10t2-\",\"dragging\":\"Window_dragging__2Ctk1\",\"window\":\"Window_window__uDx5P\",\"active\":\"Window_active__eAyll\",\"title-bar\":\"Window_title-bar__376LO\",\"title\":\"Window_title__3FnAS\",\"window-controls\":\"Window_window-controls__1ACD5\",\"maximize\":\"Window_maximize__2aW7z\",\"minimize\":\"Window_minimize__hemKn\",\"close\":\"Window_close__38hm-\"};","import React, { useEffect, useState } from \"react\";\nimport classNames from \"classnames\";\n\nimport styles from \"./FullViewport.module.css\";\n\n// import PropTypes from \"prop-types\";\n\nexport default function FullViewport({ className, children, ...rest }) {\n  const [elContainer, setElContainer] = useState(null);\n\n  useEffect(() => {\n    if (elContainer) {\n      // Dynamically add .full-viewport to html / body elements\n      document.documentElement.classList.add(styles[\"html-full-viewport\"]);\n      document.body.classList.add(styles[\"body-full-viewport\"]);\n\n      const handleResize = () => {\n        // NOTE: The setImmediate wrap seems to help fix layout issues on iOS\n        // 14 after screen rotation\n        //\n        // FIXME: (jh) Potentially don't run this if the user is typing\n        setImmediate(() => {\n          elContainer.style.height = window.innerHeight + \"px\";\n\n          // Fixes issue on iOS where the content may be behind the URL bar after typing\n          document.body.scrollTop = 0;\n        });\n      };\n\n      // Perform initial size handling\n      handleResize();\n\n      // Bind resize handler\n      // TODO: Use common handler instead\n      window.addEventListener(\"resize\", handleResize);\n\n      // Poll the resize handler every second to help fix layout issues with iOS\n      // const resizeInterval = setInterval(handleResize, 1000);\n\n      return () => {\n        // Dynamically remove .full-viewport from html / body elements\n        document.documentElement.classList.remove(styles[\"html-full-viewport\"]);\n        document.body.classList.remove(styles[\"body-full-viewport\"]);\n\n        // Unbind resize handler\n        window.removeEventListener(\"resize\", handleResize);\n\n        // Stop poll interval\n        // clearInterval(resizeInterval);\n      };\n    }\n  }, [elContainer]);\n\n  return (\n    <div\n      {...rest}\n      ref={setElContainer}\n      className={classNames(styles[\"full-viewport\"], className)}\n    >\n      {children}\n    </div>\n  );\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"html-full-viewport\":\"FullViewport_html-full-viewport__2FFOO\",\"body-full-viewport\":\"FullViewport_body-full-viewport__2_xlv\",\"full-viewport\":\"FullViewport_full-viewport__2RwSj\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"row\":\"RowColumn_row__2MIpa\",\"disable-vertical-fill\":\"RowColumn_disable-vertical-fill__YiYeg\",\"column\":\"RowColumn_column__3aAA3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"no-wrap\":\"NoWrap_no-wrap__2b0bc\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"led\":\"LED_led__1cyGI\",\"gray\":\"LED_gray__3hMZV\",\"grey\":\"LED_grey__1_Ool\",\"red\":\"LED_red__2O1gd\",\"orange\":\"LED_orange__1Asac\",\"yellow\":\"LED_yellow__H5_0O\",\"green\":\"LED_green__5BS9Y\",\"blue\":\"LED_blue__fOsqG\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"auto-scaler\":\"AutoScaler_auto-scaler__zdzsp\",\"content-wrap\":\"AutoScaler_content-wrap__2tFDr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"padding\":\"Padding_padding__3cEtV\",\"no-siblings\":\"Padding_no-siblings__1nLrM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notification-stack\":\"NotificationStack_notification-stack__1UiWO\",\"inner-wrap\":\"NotificationStack_inner-wrap__2Mc0d\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"button-transparent\":\"ButtonTransparent_button-transparent__nu1PF\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"notification\":\"Notification_notification__3v54G\",\"action\":\"Notification_action__3RBsB\",\"main-image-wrap\":\"Notification_main-image-wrap__eqHez\",\"main-image\":\"Notification_main-image__1PfuN\",\"title\":\"Notification_title__2OHSD\",\"body-outer-wrap\":\"Notification_body-outer-wrap__3eJfO\",\"body\":\"Notification_body__1eZc4\",\"close\":\"Notification_close__1O8FQ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"virtual-link\":\"VirtualLink_virtual-link__76t27\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"color-adjuster\":\"ColorAdjuster_color-adjuster__2X490\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"object-viewer\":\"ObjectViewer_object-viewer__8k3ak\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"levels\":\"AudioLevelMeter_levels__3baNN\",\"level-container\":\"AudioLevelMeter_level-container__12piT\",\"level\":\"AudioLevelMeter_level__2fRqJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-wrapper\":\"StaggeredWaveLoading_loading-wrapper__35kvv\",\"loading\":\"StaggeredWaveLoading_loading__9ah1x\",\"dot\":\"StaggeredWaveLoading_dot__1cWhz\",\"wave\":\"StaggeredWaveLoading_wave__Du7Gv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"vu\":\"VUMeter_vu__Xlt7R\",\"mask\":\"VUMeter_mask__2OXhL\",\"needle\":\"VUMeter_needle__AmMsB\",\"vu-label\":\"VUMeter_vu-label__3kDDJ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"video\":\"Video_video__2GgL9\"};","import FullViewport from './FullViewport';\n\nexport default FullViewport;","import { useContext } from \"react\";\nimport { DesktopContext } from \"../core/providers/DesktopProvider\";\n\nexport default function useDesktopContext() {\n  return useContext(DesktopContext);\n}\n","import { useContext } from \"react\";\nimport { AppOrchestrationContext } from \"@core/providers/AppOrchestrationProvider\";\n\nexport default function useAppOrchestrationContext() {\n  return useContext(AppOrchestrationContext);\n}\n","import React, { useEffect } from \"react\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useLocationAppRegistrationID from \"@hooks/useLocationAppRegistrationID\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport { useHistory } from \"react-router-dom\";\n\nexport const WindowManagerRouteContext = React.createContext({});\n\n/**\n * Updates React Router location and provides location-based handling for\n * ReShell applications.\n */\nexport default function WindowManagerRouteProvider({ children }) {\n  const { getAppRuntimesWithRegistrationID, activateAppRegistrationID } =\n    useAppOrchestrationContext();\n\n  const { activeWindowController, setActiveWindowController } =\n    useDesktopContext();\n\n  // Detected app registration ID from React Router URL location\n  const locationAppRegistrationID = useLocationAppRegistrationID();\n\n  // Update active app registration based on location changes\n  useEffect(() => {\n    if (locationAppRegistrationID) {\n      // Launch, or bring to front\n      activateAppRegistrationID(locationAppRegistrationID);\n    } else {\n      setActiveWindowController(null);\n    }\n  }, [\n    locationAppRegistrationID,\n    getAppRuntimesWithRegistrationID,\n    setActiveWindowController,\n    activateAppRegistrationID,\n  ]);\n\n  // Active window controller app registration ID\n  const activeRegistrationID = activeWindowController\n    ?.getAppRuntime()\n    ?.getRegistrationID();\n\n  const history = useHistory();\n\n  // Update URL when active registration ID changes\n  useEffect(() => {\n    history.push(activeRegistrationID ? `/${activeRegistrationID}` : \"/\");\n  }, [activeRegistrationID, history]);\n\n  return (\n    <WindowManagerRouteContext.Provider value={{}}>\n      {children}\n    </WindowManagerRouteContext.Provider>\n  );\n}\n","/**\n * Retrieves the given element's position in pixels relative to its parent.\n *\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetLeft}\n * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop}\n *\n * @param {HTMLElement} el\n * @return {{x: number, y: number}}\n */\nexport default function getElPosition(el) {\n  return {\n    x: el.offsetLeft,\n    y: el.offsetTop,\n  };\n}\n","/**\n * Retrieves the given element's size in pixels.\n *\n * @param {DOMElement} el\n * @return {{width: number, height: number}}\n */\nexport default function getElSize(el) {\n  const width = el.offsetWidth;\n  const height = el.offsetHeight;\n\n  return {\n    width,\n    height,\n  };\n}\n","import { PhantomState, EVT_UPDATED, EVT_DESTROYED } from \"phantom-core\";\nimport { debounce } from \"debounce\";\n\nimport getElPosition from \"@utils/getElPosition\";\nimport getElSize from \"@utils/getElSize\";\n\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\n\nexport { EVT_UPDATED, EVT_DESTROYED };\n\n// @see https://reactjs.org/docs/profiler.html\nexport const EVT_RENDER_PROFILED = \"render-profile\";\n\nexport const EVT_RESIZED = \"resized\";\nexport const EVT_MOVED = \"moved\";\n\n// TODO: Implement ability to take snapshot (i.e. save to png, etc) for window previewing\n\n// TODO: Move into core directory?\n// TODO: Document\nexport default class WindowController extends PhantomState {\n  // TODO: Document\n  constructor(initialState = {}, { onBringToTop }) {\n    const DEFAULT_STATE = {\n      isMaximized: false,\n      isMinimized: false,\n    };\n\n    super(PhantomState.mergeOptions({ ...DEFAULT_STATE, ...initialState }));\n\n    this._appRuntime = null;\n\n    this._elWindow = null;\n    this._elWindowManager = null;\n\n    this._handleBringToTop = onBringToTop;\n\n    this._emitDebouncedResized = debounce(\n      this._emitDebouncedResized.bind(this),\n      500,\n      // Ensure runs on trailing edge\n      false\n    );\n\n    this._emitDebouncedMoved = debounce(\n      this._emitDebouncedMoved.bind(this),\n      500,\n      // Ensure runs on trailing edge\n      false\n    );\n\n    // TODO: Retain last size / moved and enable reverting back to previous settings\n    // TODO: Enable percentage calculation and adjust when resizing viewport (this should prevent windows from being able to leave the viewport)\n\n    // TODO: Ensure these are unbound when controller is destructed (related issue: https://github.com/zenOSmosis/phantom-core/issues/68)\n    // (For manually triggering Chrome's built-in Garbage Collector, see: https://github.com/facebook/react/issues/22471)\n    this._centerHandler = null;\n    this._scatterHandler = null;\n  }\n\n  /**\n   * @return {Promise<void>}\n   */\n  async destroy() {\n    return super.destroy(async () => {\n      // Clear any currently scheduled resize executions\n      this._emitDebouncedResized.clear();\n\n      // TODO: Determine if in dirty state, prior to closing\n      // if (\n      // window.confirm(`Are you sure you wish to close \"${this.getTitle()}\"?`)\n      // ) {\n\n      if (this._appRuntime && !this._appRuntime.getIsDestroying()) {\n        await this._appRuntime.destroy();\n      }\n\n      this._appRuntime = null;\n      this._elWindow = null;\n      this._elWindowManager = null;\n    });\n\n    //}\n  }\n\n  // TODO: Document\n  __INTERNAL__setCenterHandler(centerHandler) {\n    this._centerHandler = centerHandler;\n  }\n\n  // TODO: Document\n  center() {\n    return this._centerHandler();\n  }\n\n  // TODO: Document\n  __INTERNAL__setScatterHandler(scatterHandler) {\n    this._scatterHandler = scatterHandler;\n  }\n\n  // TODO: Document\n  scatter() {\n    return this._scatterHandler();\n  }\n\n  // TODO: Document\n  bringToTop() {\n    this._handleBringToTop(this);\n  }\n\n  // TODO: Document\n  /*\n  __INTERNAL__setIsActive(isActive) {\n    if (isActive !== this.getIsActive()) {\n      this.setState({ isActive });\n    }\n  }\n  */\n\n  // TODO: Document\n  /*\n  getIsActive() {\n    return this.getState().isActive;\n  }\n  */\n\n  // TODO: Document\n  // @see https://reactjs.org/docs/profiler.html\n  captureRenderProfile(arrRenderProfile) {\n    this.emit(EVT_RENDER_PROFILED, arrRenderProfile);\n  }\n\n  // TODO: Document\n  attachWindowElement(el) {\n    this._elWindow = el;\n  }\n\n  // TODO: Document\n  attachWindowManagerElement(el) {\n    this._elWindowManager = el;\n  }\n\n  /**\n   * Associates an AppRuntime instance with this window controller.\n   *\n   * @param {AppRuntime} appRuntime\n   * @return {void}\n   */\n  setAppRuntime(appRuntime) {\n    // TODO: Ensure appRuntime is an AppRuntime instance\n\n    this._appRuntime = appRuntime;\n\n    // TODO: Refactor title to app runtime passing (ensure it can work both ways)\n    this._appRuntime.setTitle(this.getTitle());\n  }\n\n  /**\n   * Retrieves the associated AppRuntime for this window controller.\n   *\n   * @return {AppRuntime | void}\n   */\n  getAppRuntime() {\n    return this._appRuntime;\n  }\n\n  // TODO: Document\n  getAppRegistration() {\n    const runtime = this.getAppRuntime();\n\n    if (runtime) {\n      return runtime.getRegistration();\n    }\n  }\n\n  // TODO: Document\n  setSize({ width, height }) {\n    // IMPORTANT!: Do not update state on each iteration (if at all) because that would cause excessive re-rendering\n    const elWindow = this._elWindow;\n    if (elWindow) {\n      // FIXME: (jh) Can these be applied as a single reflow?\n      // @see https://www.sitepoint.com/10-ways-minimize-reflows-improve-performance/\n\n      requestSkippableAnimationFrame(() => {\n        if (width !== undefined) {\n          elWindow.style.width = `${width}px`;\n        }\n        if (height !== undefined) {\n          elWindow.style.height = `${height}px`;\n        }\n\n        // Emit debounced EVT_RESIZED event\n        this._emitDebouncedResized();\n      }, `${this._uuid}-size`);\n    }\n  }\n\n  // TODO: Document\n  _emitDebouncedResized() {\n    this.emit(EVT_RESIZED);\n  }\n\n  /**\n   * Retrieves the window's size in pixels.\n   *\n   * @param {DOMElement} el\n   * @return {{width: number, height: number}}\n   */\n  getSize() {\n    const elWindow = this._elWindow;\n    if (elWindow) {\n      return getElSize(elWindow);\n    } else {\n      this.log.warn(\"Unable to acquire elWindow\");\n    }\n  }\n\n  /**\n   * Retrieves the window manager's size in pixels.\n   *\n   * @param {DOMElement} el\n   * @return {{width: number, height: number}}\n   */\n  getWindowManagerSize() {\n    const elWindowManager = this._elWindowManager;\n    if (elWindowManager) {\n      return getElSize(elWindowManager);\n    } else {\n      this.log.warn(\"Unable to acquire elWindowManager\");\n    }\n  }\n\n  // TODO: Document\n  setPosition({ x, y }) {\n    // Fixes issue where restoring using widow title bar (i.e. double-click or\n    // using window control button) would make window go to upper-left of\n    // screen\n    if (this.getIsMaximized()) {\n      return;\n    }\n\n    const elWindow = this._elWindow;\n    if (elWindow) {\n      /**\n       * FIXME: (jh) While using translate would be better here, it is buggier\n       * to use with some of the window animations (open / minimize / restore)\n       *\n       * However, if able to tie directly into matrix operations provided by\n       * accelerated StackingContext, it might improve acceleration even\n       * further\n       *\n       * Additional reading:\n       *    - [will-change] https://developer.mozilla.org/en-US/docs/Web/CSS/will-change\n       *    - [animating the box model]: https://whistlr.info/2021/box-model-animation\n       */\n\n      requestSkippableAnimationFrame(() => {\n        if (x !== undefined) {\n          elWindow.style.left = `${x}px`;\n\n          // Delete opposing right style\n          delete elWindow.style.right;\n        }\n        if (y !== undefined) {\n          elWindow.style.top = `${y}px`;\n\n          // Delete opposing bottom style\n          delete elWindow.style.bottom;\n        }\n\n        // IMPORTANT!: Do not update state on each iteration (if at all)\n        // because that would cause excessive re-rendering\n        this._emitDebouncedMoved();\n      }, `${this._uuid}-position`);\n    }\n  }\n\n  // TODO: Document\n  _emitDebouncedMoved() {\n    this.emit(EVT_MOVED);\n  }\n\n  /**\n   * Retrieves the window's position relative to its parent (the window manager).\n   *\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetLeft}\n   * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop}\n   *\n   * @param {HTMLElement} el\n   * @return {{x: number, y: number}}\n   */\n  getPosition() {\n    const elWindow = this._elWindow;\n\n    if (elWindow) {\n      return getElPosition(elWindow);\n    }\n  }\n\n  // TODO: Document\n  getIsBorderDisabled() {\n    return this.getIsMaximized() || this.getIsMinimized();\n  }\n\n  /**\n   * Sets a partial next state for this window controller.\n   *\n   * TODO: States are currently deep-merged but may become shallow merged\n   * instead.\n   *\n   * @param {Object} partialNextState\n   * @emits EVT_UPDATED\n   * @return {void}\n   */\n  setState(partialNextState) {\n    if (typeof partialNextState !== \"object\") {\n      throw new TypeError(\"partialNextState is not an object\");\n    }\n\n    // Potentially reset polar-opposite states\n    if (partialNextState.isMaximized) {\n      partialNextState.isMinimized = false;\n    } else if (partialNextState.isMinimized) {\n      partialNextState.isMaximized = false;\n    }\n\n    return super.setState(partialNextState);\n  }\n\n  /**\n   * @param {boolean} isMaximized\n   * @return {void}\n   */\n  setIsMaximized(isMaximized) {\n    return this.setState({ isMaximized });\n  }\n\n  // TODO: Document\n  maximize() {\n    return this.setIsMaximized(true);\n  }\n\n  /**\n   * Retrieves whether or not the window is maximized.\n   *\n   * @returns {boolean}\n   */\n  getIsMaximized() {\n    return this.getState().isMaximized;\n  }\n\n  /**\n   * Sets whether or not the window is minimized.\n   *\n   * @param {boolean} isMinimized\n   * @return {void}\n   */\n  setIsMinimized(isMinimized) {\n    return this.setState({ isMinimized });\n  }\n\n  // TODO: Document\n  minimize() {\n    return this.setIsMinimized(true);\n  }\n\n  /**\n   * Retrieves whether or not the window is minimized.\n   *\n   * @return {boolean}\n   */\n  getIsMinimized() {\n    return this.getState().isMinimized;\n  }\n\n  // TODO: Document\n  restore() {\n    // IMPORTANT: The maximized / minimized states need to be set at the same\n    // time here; don't call the individual methods directly\n    this.setState({\n      isMaximized: false,\n      isMinimized: false,\n    });\n  }\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Header({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"header\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Content({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"content\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import Full from \"../Full\";\nimport classNames from \"classnames\";\nimport styles from \"./Layout.module.css\";\n\nexport default function Footer({ className, children, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"footer\"], className)}>\n      <Full>{children}</Full>\n    </div>\n  );\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./RowColumn.module.css\";\nimport PropTypes from \"prop-types\";\n\n// @see https://dev.to/drews256/ridiculously-easy-row-and-column-layouts-with-flexbox-1k01\n\nRow.propTypes = {\n  className: PropTypes.string,\n\n  /**\n   * If false, the row will fill up the complete vertical space of its parent.\n   *\n   * Default value = false\n   **/\n  disableVerticalFill: PropTypes.bool,\n};\n\n// TODO: Document\nfunction Row({ children, className, disableVerticalFill = false, ...rest }) {\n  // TODO: Enforce that only Column components are direct descendants of this\n\n  return (\n    <div\n      {...rest}\n      className={classNames(\n        styles[\"row\"],\n        disableVerticalFill && styles[\"disable-vertical-fill\"],\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n\n// TODO: Implement prop-types\n/**\n * Evenly-sized column.\n */\nfunction Column({ children, className, ...rest }) {\n  // TODO: Enforce that only Row component is direct parent of this\n\n  return (\n    <div {...rest} className={classNames(styles[\"column\"], className)}>\n      {children}\n    </div>\n  );\n}\n\nexport { Row, Column };\n","import Layout, { Header, Content, Footer, Row, Column } from \"./Layout\";\n\nexport default Layout;\nexport { Header, Content, Footer, Row, Column };\n","import React from \"react\";\nimport Full from \"../Full\";\nimport Header from \"./Header\";\nimport Content from \"./Content\";\nimport Footer from \"./Footer\";\nimport { Row, Column } from \"./RowColumn\";\nimport styles from \"./Layout.module.css\";\nimport classNames from \"classnames\";\n\n// TODO: Add prop-types\n// TODO: Consider renaming; there are unrelated components that deal with Layout as well\nexport default function Layout({ className, children, ...rest }) {\n  return (\n    <Full {...rest} className={classNames(styles[\"layout\"], className)}>\n      {children}\n    </Full>\n  );\n}\n\nexport { Header, Content, Footer, Row, Column };\n","import Layout, { Header, Content, Footer, Row, Column } from \"../Layout\";\nimport { useDrag } from \"@use-gesture/react\";\n\n// TODO: Height and width are synonymous\n\n// TODO: Resizable element for touch displays: https://csslayout.io/patterns/resizable-element\n\nexport const DIR_BORDER_NW = \"NW\";\nexport const DIR_BORDER_N = \"N\";\nexport const DIR_BORDER_NE = \"NE\";\nexport const DIR_BORDER_E = \"E\";\nexport const DIR_BORDER_SE = \"SE\";\nexport const DIR_BORDER_S = \"S\";\nexport const DIR_BORDER_SW = \"SW\";\nexport const DIR_BORDER_W = \"W\";\n\n// @see https://use-gesture.netlify.app/docs/#simple-example\nconst useDirectionalDragger = function (direction, onBorderDrag) {\n  return useDrag(\n    ({ down: isDragging, movement: [mx, my] }) => {\n      onBorderDrag(direction, { mx, my, isDragging });\n    },\n    {\n      pointer: {\n        // IMPORTANT: This makes use-gesture utilize touch events instead of\n        // pointer events and fixes an issue where pointercancel would\n        // sometimes be fired on certain Android devices\n        touch: true,\n      },\n    }\n  );\n};\n\n// TODO: Use prop-types\n// TODO: Document\nexport default function WindowBorder({\n  children,\n  onBorderDrag,\n  borderWidth = 3,\n  isDisabled = false,\n  ...rest\n}) {\n  const bindNW = useDirectionalDragger(DIR_BORDER_NW, onBorderDrag);\n  const bindN = useDirectionalDragger(DIR_BORDER_N, onBorderDrag);\n  const bindNE = useDirectionalDragger(DIR_BORDER_NE, onBorderDrag);\n  const bindE = useDirectionalDragger(DIR_BORDER_E, onBorderDrag);\n  const bindSE = useDirectionalDragger(DIR_BORDER_SE, onBorderDrag);\n  const bindS = useDirectionalDragger(DIR_BORDER_S, onBorderDrag);\n  const bindSW = useDirectionalDragger(DIR_BORDER_SW, onBorderDrag);\n  const bindW = useDirectionalDragger(DIR_BORDER_W, onBorderDrag);\n\n  return (\n    // TODO: Enable merge-able styles / classNames\n    // TODO: Extract classes to module.css\n    <Layout {...rest}>\n      <Header>\n        {!isDisabled && (\n          <Row style={{ maxHeight: borderWidth, height: borderWidth }}>\n            <Column\n              {...bindNW()}\n              style={{ maxWidth: borderWidth, cursor: \"nwse-resize\" }}\n            ></Column>\n            <Column {...bindN()} style={{ cursor: \"ns-resize\" }}></Column>\n            <Column\n              {...bindNE()}\n              style={{ maxWidth: borderWidth, cursor: \"nesw-resize\" }}\n            ></Column>\n          </Row>\n        )}\n      </Header>\n      <Content>\n        <Row>\n          {!isDisabled && (\n            <Column\n              {...bindW()}\n              style={{ maxWidth: borderWidth, cursor: \"ew-resize\" }}\n            ></Column>\n          )}\n\n          <Column>\n            {\n              // TODO: Use layout to wrap the child in a frame, w/ diagonal positions included\n            }\n            {children}\n          </Column>\n          {!isDisabled && (\n            <Column\n              {...bindE()}\n              style={{ maxWidth: borderWidth, cursor: \"ew-resize\" }}\n            ></Column>\n          )}\n        </Row>\n      </Content>\n      <Footer>\n        {!isDisabled && (\n          <Row style={{ maxHeight: borderWidth, height: borderWidth }}>\n            <Column\n              {...bindSW()}\n              style={{ maxWidth: borderWidth, cursor: \"nesw-resize\" }}\n            ></Column>\n            <Column {...bindS()} style={{ cursor: \"ns-resize\" }}></Column>\n            <Column\n              {...bindSE()}\n              style={{ maxWidth: borderWidth, cursor: \"nwse-resize\" }}\n            ></Column>\n          </Row>\n        )}\n      </Footer>\n    </Layout>\n  );\n}\n","import NoWrap from \"./NoWrap\";\n\nexport default NoWrap;\n","import classNames from \"classnames\";\nimport styles from \"./NoWrap.module.css\";\n\n// TODO: Document\nexport default function NoWrap({ children, className, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"no-wrap\"], className)}>\n      {children}\n    </div>\n  );\n}\n","import styles from \"../../Window.module.css\";\n\nexport function WindowTitleBarMaximizeButton({ ...rest }) {\n  return <WindowTitleBarButton {...rest} className={styles[\"maximize\"]} />;\n}\n\nexport function WindowTitleBarMinimizeButton({ ...rest }) {\n  return <WindowTitleBarButton {...rest} className={styles[\"minimize\"]} />;\n}\n\nexport function WindowTitleBarCloseButton({ ...rest }) {\n  return <WindowTitleBarButton {...rest} className={styles[\"close\"]} />;\n}\n\nfunction WindowTitleBarButton({ ...rest }) {\n  // TODO: Compose with specific buttons for \"green\", \"yellow\", and \"red\".\n\n  return <button {...rest}></button>;\n}\n","import WindowTitleBar from \"./Window.TitleBar\";\n\nexport default WindowTitleBar;\n","import NoWrap from \"@components/NoWrap\";\nimport Full from \"@components/Full\";\n\nimport styles from \"../Window.module.css\";\n\nimport {\n  WindowTitleBarMaximizeButton,\n  WindowTitleBarMinimizeButton,\n  WindowTitleBarCloseButton,\n} from \"./Window.TitleBar.Button\";\n\nexport default function WindowTitleBar({\n  onElTitleBar,\n  title,\n  onRestoreOrMaximize,\n  onMinimize,\n  onClose,\n  titleBarView: TitleBarView,\n  ...rest\n}) {\n  return (\n    <div\n      {...rest}\n      ref={onElTitleBar}\n      className={styles[\"title-bar\"]}\n      onDoubleClick={onRestoreOrMaximize}\n    >\n      {TitleBarView ? (\n        <Full>{TitleBarView}</Full>\n      ) : (\n        <NoWrap className={styles[\"title\"]}>{title}</NoWrap>\n      )}\n\n      <NoWrap className={styles[\"window-controls\"]}>\n        <WindowTitleBarMaximizeButton onClick={onRestoreOrMaximize} />\n        <WindowTitleBarMinimizeButton onClick={onMinimize} />\n        <WindowTitleBarCloseButton onClick={onClose} />\n      </NoWrap>\n    </div>\n  );\n}\n","import { useCallback, useRef, useState } from \"react\";\nimport { diff } from \"deep-object-diff\";\n\n// FIXME: (jh) See other implementation here (might be more performant; search\n// for useObjectState): https://thoughtspile.github.io/2021/10/11/usestate-object-vs-multiple/?utm_campaign=thisweekinreact&utm_medium=email&utm_source=Revue%20newsletter\n\n/**\n * Applies a shallow-merge strategy to object updates so that setState() calls\n * don't completely overwrite previous object state.\n *\n * Maintains backwards-compatibility for class-based components which have been\n * migrated to hook versions, without having to write a bunch of useState\n * references for every state property.\n *\n * NOTE: This will perform a deep-equality, non-referential check after pre-\n * merging state updates and only update the state if there is a difference in\n * the deep-equality comparison.\n *\n * @param {Object} initialState\n * @return {[state: Object, setState: Function]} Merged state\n */\nexport default function useObjectState(initialState = {}) {\n  const [state, _setMergedState] = useState(initialState);\n\n  const refState = useRef(state);\n  refState.current = state;\n\n  /**\n   * @param {Object | string | Function} updatedState If passed as a string, it will try\n   * to JSON parse into an object.\n   * @return {void}\n   */\n  const setState = useCallback(updatedState => {\n    // Check type validity / apply type coercion, etc.\n    switch (typeof updatedState) {\n      case \"string\":\n        try {\n          updatedState = JSON.parse(updatedState);\n        } catch (err) {\n          console.error(\n            \"Unable to parse string into JSON.  Did you forget to use an Object when setting object state?\"\n          );\n\n          throw err;\n        }\n        break;\n\n      case \"function\":\n        // i.e. setState(prevState => nextState)\n        updatedState = updatedState(refState.current);\n        break;\n\n      case \"object\":\n        // Objects are okay the way they are\n        break;\n\n      default:\n        throw new TypeError(\n          `Unhandled useObjectState type: ${typeof updatedState}`\n        );\n    }\n\n    _setMergedState(prevState => {\n      const nextState = { ...prevState, ...updatedState };\n\n      if (Object.keys(diff(prevState, nextState)).length) {\n        // There is a difference in values; update the next state\n        return nextState;\n      } else {\n        // Skip rendering if there is no difference in values. This relies on\n        // the React principle that \"if your update function returns the exact\n        // same value as the current state, the subsequent rerender will be\n        // skipped completely.\"\n        // @see https://reactjs.org/docs/hooks-reference.html#usestate\n        return prevState;\n      }\n    });\n  }, []);\n\n  return [state, setState];\n}\n","import useWindowAutoPositioner from \"./useWindowAutoPositioner\";\n\nexport default useWindowAutoPositioner;\n","import { useCallback, useEffect, useRef } from \"react\";\n\nimport getElCenterPoint from \"@utils/getElCenterPoint\";\nimport getElSize from \"@utils/getElSize\";\n\nimport useWindowOutOfBoundsPositionCorrection from \"./useWindowOutOfBoundsPositionCorrection\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\n/**\n * Handles auto-positioning of the given windows.\n *\n * @typedef { import('../../classesWindowController').default} WindowController\n *\n * @param {{elWindow: HTMLElement, elWindowManager: HTMLElement, windowController: WindowController, onInitialAutoPosition?: Function }} options\n * @return {void}\n */\nexport default function useWindowAutoPositioner({\n  elWindow,\n  elWindowManager,\n  windowController,\n  onInitialAutoPosition = () => null,\n}) {\n  const refOnInitialAutoPosition = useRef(null);\n  if (elWindow) {\n    refOnInitialAutoPosition.current = onInitialAutoPosition;\n  }\n\n  const outOfBoundsCorrectionPosition = useWindowOutOfBoundsPositionCorrection({\n    elWindow,\n    elWindowManager,\n    windowController,\n  });\n\n  // Apply auto-position to window if viewport is resized and window is out-of-\n  // bounds\n  useEffect(() => {\n    if (windowController) {\n      if (\n        outOfBoundsCorrectionPosition.x !== null ||\n        outOfBoundsCorrectionPosition.y !== null\n      ) {\n        const currentPosition = windowController.getPosition();\n\n        const nextPosition = {\n          x:\n            outOfBoundsCorrectionPosition.x !== null\n              ? outOfBoundsCorrectionPosition.x\n              : currentPosition.x,\n          y:\n            outOfBoundsCorrectionPosition.y !== null\n              ? outOfBoundsCorrectionPosition.y\n              : currentPosition.y,\n        };\n\n        windowController.setPosition(nextPosition);\n      }\n    }\n  }, [windowController, outOfBoundsCorrectionPosition]);\n\n  /**\n   * Centers the window in relation to the desktop layout.\n   *\n   * @return {void}\n   */\n  const handleCenter = useCallback(() => {\n    const winManCenter = getElCenterPoint(elWindowManager);\n    const winSize = getElSize(elWindow);\n\n    const x = winManCenter.x - winSize.width / 2;\n    const y = winManCenter.y - winSize.height / 2;\n\n    windowController.setPosition({\n      x,\n      y,\n    });\n  }, [elWindowManager, elWindow, windowController]);\n\n  /**\n   * Randomly positions the window within the confines of the desktop layout.\n   *\n   * @return {void}\n   */\n  const handleScatter = useCallback(() => {\n    if (windowController) {\n      const winManSize = getElSize(elWindowManager);\n      const winSize = getElSize(elWindow);\n\n      // Randomly position, but try to keep full window in viewport\n      const x = Math.floor(Math.random() * (winManSize.width - winSize.width));\n      const y = Math.floor(\n        Math.random() * (winManSize.height - winSize.height)\n      );\n\n      windowController.setPosition({ x, y });\n    }\n  }, [elWindowManager, elWindow, windowController]);\n\n  // TODO: Refactor; Determine current app runtimes so we can determine if\n  // we're going to center or scatter new windows\n  const { appRuntimes } = useAppOrchestrationContext();\n  const refInitialAppRuntimes = useRef(appRuntimes);\n\n  // Apply initial auto-position\n  useEffect(() => {\n    if (elWindowManager && elWindow && windowController) {\n      // Apply center / scatter handlers to window controller so they can be\n      // called externally\n      windowController.__INTERNAL__setCenterHandler(handleCenter);\n      windowController.__INTERNAL__setScatterHandler(handleScatter);\n\n      // IMPORTANT: This must be called asynchronously or it will not set\n      window.requestAnimationFrame(() => {\n        // Determine initial window position\n        // TODO: Obtain previous value from local storage, or from window\n        // registration\n        //\n        // TODO: Fix issue where opening more than one initial window will not\n        // center the first window\n        if (refInitialAppRuntimes.current.length < 2) {\n          // Center first window\n          handleCenter();\n        } else {\n          // Randomly scatter subsequent windows\n          handleScatter();\n        }\n\n        // IMPORTANT: This must be called in a subsequent asynchronous call or\n        // it may execute before the previous callback (i.e. handleCenter /\n        // handleScatter)\n        //\n        // FIXME: (jh) Use setImmediate instead?\n        window.requestAnimationFrame(() => {\n          refOnInitialAutoPosition.current();\n        });\n      });\n    }\n  }, [\n    elWindowManager,\n    elWindow,\n    windowController,\n    handleCenter,\n    handleScatter,\n  ]);\n}\n","import { useEffect, useCallback } from \"react\";\nimport debounce from \"debounce\";\n\nimport { EVT_RESIZED, EVT_MOVED } from \"../../classes/WindowController\";\n\nimport getElSize from \"@utils/getElSize\";\nimport getElPosition from \"@utils/getElPosition\";\n\nimport useObjectState from \"@hooks/useObjectState\";\n\nimport {\n  WINDOW_POSITION_OOB_TOP_THRESHOLD,\n  WINDOW_POSITION_OOB_BOTTOM_THRESHOLD,\n  WINDOW_POSITION_OOB_LEFT_THRESHOLD,\n  WINDOW_POSITION_OOB_RIGHT_THRESHOLD,\n} from \"../__window_hook_constants__\";\n\n/**\n * Dynamically detects if the given window is out-of-bounds and calculates\n * the corrected position to bring it back within the acceptable boundary.\n *\n * This actively monitors the window for moving and resizing, as well as the\n * window manager for resizing.\n *\n * @typedef { import('../../classesWindowController').default} WindowController\n *\n * @param {{elWindow: HTMLElement, elWindowManager: HTMLElement, windowController: WindowController}} options\n * @return {{x: number | null, y: number | null}}\n */\nexport default function useWindowOutOfBoundsPositionCorrection({\n  elWindow,\n  elWindowManager,\n  windowController,\n}) {\n  const [correctionPosition, _setCorrectionPosition] = useObjectState({\n    x: null,\n    y: null,\n  });\n\n  /**\n   * @param {{elWindow: HTMLElement, elWindowManager: HTMLElement}}\n   * @return {{x: number | null, y: number | null}}\n   */\n  const getOutOfBoundsPositionCorrection = useCallback(\n    (elWindow, elWindowManager) => {\n      // const winManCenter = getElCenterPoint(elWindowManager);\n      const winManSize = getElSize(elWindowManager);\n      const winSize = getElSize(elWindow);\n      const winPosition = getElPosition(elWindow);\n\n      const winTL = {\n        x: winPosition.x,\n        y: winPosition.y,\n      };\n\n      const winTR = {\n        x: winPosition.x + winSize.width,\n        y: winPosition.y,\n      };\n\n      const correctedPosition = {\n        x: null,\n        y: null,\n      };\n\n      // If top-right position of window is less than left threshold\n      if (winTR.x < WINDOW_POSITION_OOB_LEFT_THRESHOLD) {\n        correctedPosition.x =\n          WINDOW_POSITION_OOB_LEFT_THRESHOLD - winSize.width;\n      }\n\n      // If top position of window is less than top threshold\n      if (winTR.y < WINDOW_POSITION_OOB_TOP_THRESHOLD) {\n        correctedPosition.y = WINDOW_POSITION_OOB_TOP_THRESHOLD;\n      }\n\n      // If top-left position of window is less than window manager width minus\n      // right threshold\n      if (winTL.x > winManSize.width - WINDOW_POSITION_OOB_RIGHT_THRESHOLD) {\n        correctedPosition.x =\n          winManSize.width - WINDOW_POSITION_OOB_RIGHT_THRESHOLD;\n      }\n\n      // If top position of window is less than window manager height minus\n      // bottom threshold\n      if (winTL.y > winManSize.height - WINDOW_POSITION_OOB_BOTTOM_THRESHOLD) {\n        correctedPosition.y =\n          winManSize.height - WINDOW_POSITION_OOB_BOTTOM_THRESHOLD;\n      }\n\n      return correctedPosition;\n    },\n    []\n  );\n\n  // Bind event listeners\n  useEffect(() => {\n    if (elWindow && elWindowManager && windowController) {\n      // Invoked when window is resized or removed, or if the viewport is\n      // resized\n      const _handleResizeOrMove = debounce(\n        () => {\n          const nextCorrectionPosition = getOutOfBoundsPositionCorrection(\n            elWindow,\n            elWindowManager\n          );\n\n          // NOTE: This relies on useObjectState's equality checking to not re\n          // render if nothing has changed\n          _setCorrectionPosition(nextCorrectionPosition);\n        },\n\n        100,\n        // Run on trailing edge\n        false\n      );\n\n      windowController.on(EVT_RESIZED, _handleResizeOrMove);\n      windowController.on(EVT_MOVED, _handleResizeOrMove);\n\n      // TODO: Use common handler instead\n      window.addEventListener(\"resize\", _handleResizeOrMove);\n\n      // Perform initial check\n      _handleResizeOrMove();\n\n      return function unmount() {\n        windowController.off(EVT_RESIZED, _handleResizeOrMove);\n        windowController.off(EVT_MOVED, _handleResizeOrMove);\n\n        window.removeEventListener(\"resize\", _handleResizeOrMove);\n      };\n    }\n  }, [\n    elWindow,\n    elWindowManager,\n    windowController,\n    getOutOfBoundsPositionCorrection,\n    _setCorrectionPosition,\n  ]);\n\n  return correctionPosition;\n}\n","// Window pointer drag thresholds represent the minimum closeness to the\n// relevant edge that the mouse / touch pointer can be before it stops\n// responding\nexport const WINDOW_POINTER_DRAG_TOP_THRESHOLD = 0;\nexport const WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD = 58;\nexport const WINDOW_POINTER_DRAG_LEFT_THRESHOLD = 0;\nexport const WINDOW_POINTER_DRAG_RIGHT_THRESHOLD = 0;\n\n// Window position out-of-bounds thresholds represent the minimum amount of\n// pixels the window can display for the relevant edge before it will be\n// automatically repositioned\nexport const WINDOW_POSITION_OOB_TOP_THRESHOLD = 0;\nexport const WINDOW_POSITION_OOB_BOTTOM_THRESHOLD = 58;\nexport const WINDOW_POSITION_OOB_LEFT_THRESHOLD = 58;\nexport const WINDOW_POSITION_OOB_RIGHT_THRESHOLD = 58;\n","/**\n * TODO: Document\n *\n * @see https://stackoverflow.com/a/46921780\n *\n * @param {DOMElement} el\n * @return {Object} // TODO: Document more thoroughly\n */\nexport default function getElCenterPoint(el) {\n  const x = el.offsetLeft + el.offsetWidth / 2;\n  const y = el.offsetTop + el.offsetHeight / 2;\n\n  return {\n    x,\n    y,\n  };\n}\n","import { useEffect } from \"react\";\n\nimport useUIParadigm, {\n  DESKTOP_PARADIGM,\n  MOBILE_PARADIGM,\n} from \"@hooks/useUIParadigm\";\n\n/**\n * Handles auto-sizing of the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController }} options\n * @return {void}\n */\nexport default function useWindowAutoSizer({ windowController }) {\n  const uiParadigm = useUIParadigm();\n\n  // Apply auto-maximize / restore depending on paradigm\n  useEffect(() => {\n    if (windowController) {\n      switch (uiParadigm) {\n        case MOBILE_PARADIGM:\n          // Auto-maximize windows if on mobile\n          windowController.maximize();\n          break;\n\n        case DESKTOP_PARADIGM:\n          // Restore windows if switched to desktop\n          windowController.restore();\n          break;\n\n        default:\n          break;\n      }\n    }\n  }, [windowController, uiParadigm]);\n}\n","import useDesktopContext from \"./useDesktopContext\";\n\nimport { DESKTOP_PARADIGM, MOBILE_PARADIGM } from \"@services/UIParadigmService\";\n\nexport { DESKTOP_PARADIGM, MOBILE_PARADIGM };\n\n/**\n * Retrieves the currently detected paradigm.\n *\n * @return {DESKTOP_PARADIGM | MOBILE_PARADIGM}\n */\nexport default function useUIParadigm() {\n  // NOTE: The desktop context is utilized for this vs. tapping into the\n  // UIParadigmService directly in order to prevent excess event emitters from\n  // being added to the service. This decision was also made because a paradigm\n  // change would typically affect the entire app, and should not happen\n  // frequently, so having the entire app re-render per paradigm change is not\n  // unreasonable.\n  const { paradigm } = useDesktopContext();\n\n  return paradigm;\n}\n","import { EVT_UPDATED } from \"./classes/WindowController\";\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport StackingContext from \"../StackingContext\";\nimport Full from \"../Full\";\nimport Layout, { Header, Content } from \"../Layout\";\n\nimport WindowBorder from \"./Window.Border\";\nimport WindowTitleBar from \"./Window.TitleBar\";\n\nimport styles from \"./Window.module.css\";\nimport classNames from \"classnames\";\n\nimport useWindowStyles from \"./hooks/useWindowStyles\";\nimport useWindowAutoPositioner from \"./hooks/useWindowAutoPositioner\";\nimport useWindowAutoSizer from \"./hooks/useWindowAutoSizer\";\nimport useWindowDragger from \"./hooks/useWindowDragger\";\nimport useWindowDragResizer from \"./hooks/useWindowDragResizer\";\nimport useWindowOpenAnimation from \"./hooks/useWindowOpenAnimation\";\nimport useWindowControls from \"./hooks/useWindowControls\";\n\n// TODO: Apply considerations from Apple's Human Interface Guidelines:\n// https://developer.apple.com/design/human-interface-guidelines/macos/windows-and-views/window-anatomy/\n\n// TODO: Consider adjusting tabindex for non-active windows dynamically so that\n// tabbing will stay within constraints of the active window\n// https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/tabindex\n\n// TODO: Add prop-types\n// TODO: Document\n// TODO: Include option to be able to drag the window from within the window body (i.e. like a widget)\nconst WindowView = ({\n  children,\n  elWindowManager,\n\n  windowController,\n\n  // TODO: Obtain via windowController instead?\n  isActive,\n\n  // TODO: Obtain via windowController\n  isProfiling = true,\n\n  titleBarView = null,\n\n  style = {},\n  ...rest\n}) => {\n  /** @type {DOMElement} */\n  const [elWindow, _setElWindow] = useState(null);\n\n  // TODO: Document\n  const { isOpenAnimationEnded } = useWindowOpenAnimation(elWindow);\n\n  // TODO: Document\n  useWindowAutoPositioner({ elWindow, elWindowManager, windowController });\n\n  // TODO: Document\n  useWindowAutoSizer({ windowController });\n\n  const [zIndex, _setZIndex] = useState(0);\n  const [title, _setTitle] = useState(null);\n  const refTitle = useRef(null);\n  refTitle.current = title;\n\n  // Associate window element with window controller\n  // TODO: Refactor into useWindowController hook\n  useEffect(() => {\n    if (windowController && elWindow) {\n      windowController.attachWindowElement(elWindow);\n    }\n  }, [windowController, elWindow]);\n\n  /** @type {boolean} */\n  const [isWindowBorderDisabled, _setIsWindowBorderDisabled] = useState(false);\n  const refIsWindowBorderDisabled = useRef(null);\n  refIsWindowBorderDisabled.current = isWindowBorderDisabled;\n\n  const [isMaximized, _setIsMaximized] = useState(false);\n  const [isMinimized, _setIsMinimized] = useState(false);\n\n  // TODO: Document\n  // TODO: Refactor into useWindowController hook\n  // TODO: Move into container view?\n  useEffect(() => {\n    if (windowController) {\n      const _handleWindowControllerUpdate = updatedState => {\n        if (!updatedState) {\n          updatedState = windowController.getState() || {};\n        }\n\n        // Only apply view state change when necessary\n        const windowTitle = windowController.getTitle();\n        if (windowTitle !== refTitle.current) {\n          _setTitle(windowTitle);\n        }\n\n        // Only apply view state change when necessary\n        if (\n          updatedState.stackingIndex !== undefined &&\n          // TODO: Rather than checking dep value here, create conditionally-setting useState wrapper\n          updatedState.stackingIndex !== zIndex\n        ) {\n          _setZIndex(updatedState.stackingIndex);\n        }\n\n        if (updatedState.isMaximized !== undefined) {\n          _setIsMaximized(updatedState.isMaximized);\n        }\n\n        if (updatedState.isMinimized !== undefined) {\n          _setIsMinimized(updatedState.isMinimized);\n        }\n\n        const shouldWindowBorderBeDisabled =\n          windowController.getIsBorderDisabled();\n        if (\n          refIsWindowBorderDisabled.current !== shouldWindowBorderBeDisabled\n        ) {\n          _setIsWindowBorderDisabled(shouldWindowBorderBeDisabled);\n        }\n      };\n\n      // Perform initial update sync\n      _handleWindowControllerUpdate();\n\n      windowController.on(EVT_UPDATED, _handleWindowControllerUpdate);\n\n      return function unmount() {\n        windowController.off(EVT_UPDATED, _handleWindowControllerUpdate);\n      };\n    }\n  }, [windowController, title, zIndex]);\n\n  const { onRestoreOrMaximize, onMinimize, onClose } = useWindowControls({\n    windowController,\n  });\n\n  // Binds window dragging functionality\n  const [dragBind, isUserDragging] = useWindowDragger({\n    windowController,\n    isDisabled: isWindowBorderDisabled,\n  });\n\n  // Binds border resizing functionality\n  const [handleBorderDrag, isUserResizing] = useWindowDragResizer({\n    windowController,\n  });\n\n  // TODO: Document\n  const DynamicProfilingWrapper = useMemo(\n    () =>\n      ({ ...args }) =>\n        isProfiling ? (\n          // @see https://reactjs.org/docs/profiler.html\n          <React.Profiler\n            {...args}\n            id={windowController.getUUID()}\n            onRender={(...renderProfile) =>\n              windowController.captureRenderProfile(renderProfile)\n            }\n          />\n        ) : (\n          <React.Fragment {...args} />\n        ),\n    [isProfiling, windowController]\n  );\n\n  // Delegate style properties to their respective sub-components\n  const { outerBorderStyle, windowStyle, bodyStyle } = useWindowStyles({\n    style,\n    isMaximized,\n    isMinimized,\n  });\n\n  return (\n    // TODO: Wrap with ErrorBoundary and React.Suspense\n    <DynamicProfilingWrapper>\n      <StackingContext\n        onMount={_setElWindow}\n        {...rest}\n        style={{ ...outerBorderStyle, zIndex }}\n        className={classNames(\n          styles[\"window-outer-border\"],\n\n          // Prevents \"popping\" of window before open animation ends\n          !isOpenAnimationEnded && styles[\"hidden\"],\n\n          isActive && styles[\"active\"],\n          isMaximized && styles[\"maximized\"],\n          isMinimized && styles[\"minimized\"],\n          (isUserDragging || isUserResizing) && styles[\"dragging\"]\n        )}\n        // Enable hardware acceleration of window stacking context\n        isAccelerated={true}\n        data-reshell-window-title={windowController.getTitle()}\n      >\n        <WindowView.Border\n          isDisabled={isWindowBorderDisabled}\n          onBorderDrag={handleBorderDrag}\n        >\n          <Full\n            className={classNames(\n              styles[\"window\"],\n              isActive && styles[\"active\"],\n              // NOTE: This check intentionally is not taking resizing into\n              // consideration\n              isUserDragging && styles[\"dragging\"]\n            )}\n            style={windowStyle}\n          >\n            <Layout>\n              <Header>\n                <WindowTitleBar\n                  {...dragBind()}\n                  title={title}\n                  onRestoreOrMaximize={onRestoreOrMaximize}\n                  onMinimize={onMinimize}\n                  onClose={onClose}\n                  titleBarView={titleBarView}\n                />\n              </Header>\n              <Content className={styles[\"body\"]} style={bodyStyle}>\n                {children}\n              </Content>\n            </Layout>\n          </Full>\n        </WindowView.Border>\n      </StackingContext>\n    </DynamicProfilingWrapper>\n  );\n};\n\nWindowView.Border = WindowBorder;\n\nexport default WindowView;\n","import { useState } from \"react\";\nimport useAnimation from \"@hooks/useAnimation\";\n\n// FIXME: (jh) Apply animations to open, close, minimize, maximize, restore,\n// etc. Some of these animations are currently handled directly via\n// Window.module.css and the functionality could be cleaned up / refactored.\n//\n// @see https://animate.style/\n// @see https://github.com/miniMAC/magic (what is \"magic / puffin\"?) (TODO: Create test app to try these libs?)\n// # mac minimize genie effect warp\n\n/**\n * [Currently only] Handles window opening animation.\n *\n * @param {HTMLElement} elWindow\n * @return {{isOpenAnimationEnded: boolean}}\n */\nexport default function useWindowOpenAnimation(elWindow) {\n  //const [phase, setPhase] = useState(\"transition-in\");\n\n  const [isOpenAnimationEnded, _setIsOpenAnimationEnded] = useState(false);\n\n  // Window opening transition\n  useAnimation({\n    domElement: elWindow,\n    animationName: \"zoomInUp\",\n    animationDuration: \".5s\",\n    shouldRun: Boolean(elWindow),\n    onAnimationEnd: () => _setIsOpenAnimationEnded(true),\n  });\n\n  return { isOpenAnimationEnded };\n}\n","import { useCallback } from \"react\";\n\n/**\n * Handles window control binding for the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController }} options\n * @return {{ onRestoreOrMaximize: Function, onMinimize: Function, onClose: Function}}\n */\nexport default function useWindowControls({ windowController }) {\n  /**\n   * Handles toggling of window restore or maximize, depending on current\n   * state.\n   *\n   * @return {void}\n   */\n  const handleRestoreOrMaximize = useCallback(() => {\n    if (windowController.getIsMaximized()) {\n      windowController.restore();\n    } else {\n      windowController.maximize();\n    }\n  }, [windowController]);\n\n  /**\n   * Handles minimizing of the window.\n   *\n   * @return {void}\n   */\n  const handleMinimize = useCallback(() => {\n    windowController.minimize();\n  }, [windowController]);\n\n  /**\n   * Handles closing of the window.\n   *\n   * @return {void}\n   */\n  const handleClose = useCallback(() => {\n    if (!windowController.getIsDestroying()) {\n      windowController.destroy();\n    }\n  }, [windowController]);\n\n  return {\n    onRestoreOrMaximize: handleRestoreOrMaximize,\n    onMinimize: handleMinimize,\n    onClose: handleClose,\n  };\n}\n","import { useRef, useState } from \"react\";\nimport { useDrag } from \"@use-gesture/react\";\n\nimport {\n  WINDOW_POINTER_DRAG_TOP_THRESHOLD,\n  WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD,\n  WINDOW_POINTER_DRAG_LEFT_THRESHOLD,\n  WINDOW_POINTER_DRAG_RIGHT_THRESHOLD,\n} from \"./__window_hook_constants__\";\n\n/**\n * Handles window drag binding for the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController, isDisabled: boolean }} options\n * @return {[bind: Function, isUserDragging: boolean]}\n */\nexport default function useWindowDragger({ windowController, isDisabled }) {\n  const refInitialDragPosition = useRef(null);\n  const refInitialWindowManagerSize = useRef(null);\n\n  const [isUserDragging, setIsUserDragging] = useState(false);\n\n  // @see https://use-gesture.netlify.app/docs/#simple-example\n  const bind = useDrag(\n    ({ down: isDragging, movement: [mx, my], xy, event }) => {\n      if (isDisabled) {\n        if (isUserDragging) {\n          setIsUserDragging(false);\n        }\n        return;\n      }\n\n      if (isDragging !== isUserDragging) {\n        setIsUserDragging(isDragging);\n      }\n\n      if (isDragging) {\n        if (!refInitialDragPosition.current) {\n          refInitialDragPosition.current = windowController.getPosition();\n        }\n\n        if (!refInitialWindowManagerSize.current) {\n          refInitialWindowManagerSize.current =\n            windowController.getWindowManagerSize();\n        }\n\n        let x = refInitialDragPosition.current.x + mx;\n        let y = refInitialDragPosition.current.y + my;\n\n        const initialWindowManagerWidth =\n          refInitialWindowManagerSize.current.width;\n        const initialWindowManagerHeight =\n          refInitialWindowManagerSize.current.height;\n\n        // Prevent window from being dragged above top threshold\n        if (y < WINDOW_POINTER_DRAG_TOP_THRESHOLD) {\n          y = WINDOW_POINTER_DRAG_TOP_THRESHOLD;\n        }\n\n        // Prevent window from being dragged below bottom threshold\n        if (\n          y >\n          initialWindowManagerHeight - WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD\n        ) {\n          y = initialWindowManagerHeight - WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD;\n        }\n\n        // Prevent window from being dragged left of left threshold\n        if (xy[0] < WINDOW_POINTER_DRAG_LEFT_THRESHOLD) {\n          x = null;\n        }\n\n        // Prevent window from being dragged right of right threshold\n        if (\n          xy[0] >\n          initialWindowManagerWidth - WINDOW_POINTER_DRAG_RIGHT_THRESHOLD\n        ) {\n          x = null;\n        }\n\n        windowController.setPosition({\n          x,\n          y,\n        });\n      } else {\n        // Reset initial drag position\n        refInitialDragPosition.current = null;\n        refInitialWindowManagerSize.current = null;\n      }\n    }\n  );\n\n  return [bind, isUserDragging];\n}\n","import { useCallback, useRef, useState } from \"react\";\n\nimport {\n  DIR_BORDER_NW,\n  DIR_BORDER_N,\n  DIR_BORDER_NE,\n  DIR_BORDER_E,\n  DIR_BORDER_SE,\n  DIR_BORDER_S,\n  DIR_BORDER_SW,\n  DIR_BORDER_W,\n} from \"../Window.Border\";\n\nimport { WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD } from \"./__window_hook_constants__\";\n\n// FIXME: (jh) Implement ability to disable drag resizing\n/**\n * Handles window border drag resize binding for the given window.\n *\n * @typedef { import('../classesWindowController').default} WindowController\n *\n * @param {{ windowController: WindowController }} options\n * @return {[handleBorderDrag: Function, isUserResizing: boolean]}\n */\nexport default function useWindowDragResizer({ windowController }) {\n  const refInitialDragSizePosition = useRef(null);\n  const refInitialWindowManagerSize = useRef(null);\n\n  const [isUserResizing, setIsUserResizing] = useState(false);\n\n  const handleBorderDrag = useCallback(\n    (direction, { mx, my, isDragging }) => {\n      if (isDragging !== isUserResizing) {\n        setIsUserResizing(isDragging);\n      }\n\n      if (isDragging) {\n        if (!refInitialDragSizePosition.current) {\n          refInitialDragSizePosition.current = {\n            ...windowController.getSize(),\n            ...windowController.getPosition(),\n          };\n        }\n\n        if (!refInitialWindowManagerSize.current) {\n          refInitialWindowManagerSize.current =\n            windowController.getWindowManagerSize();\n        }\n\n        let { width, height, x, y } = refInitialDragSizePosition.current;\n\n        let windowManagerWidth = refInitialWindowManagerSize.current.width;\n        let windowManagerHeight = refInitialWindowManagerSize.current.height;\n\n        switch (direction) {\n          case DIR_BORDER_NW:\n            width = width - mx;\n            height = height - my;\n\n            x = x + mx;\n            y = y + my;\n\n            break;\n\n          case DIR_BORDER_N:\n            height = height - my;\n            y = y + my;\n            break;\n\n          case DIR_BORDER_NE:\n            height = height - my;\n            width = width + mx;\n\n            y = y + my;\n            break;\n\n          case DIR_BORDER_E:\n            width = width + mx;\n            break;\n\n          case DIR_BORDER_SE:\n            width = width + mx;\n            height = height + my;\n            break;\n\n          case DIR_BORDER_S:\n            height = height + my;\n            break;\n\n          case DIR_BORDER_SW:\n            width = width - mx;\n            height = height + my;\n\n            x = x + mx;\n            break;\n\n          case DIR_BORDER_W:\n            width = width - mx;\n\n            x = x + mx;\n            break;\n\n          default:\n            throw new ReferenceError(`Unknown direction: ${direction}`);\n        }\n\n        // TODO: Handle min width / height\n\n        // Prevent left resize from extending left of left threshold\n        if (x < 0) {\n          // This affects window height calculations when cursor is left of\n          // left threshold\n          const diffX = 0 - x;\n          x = 0;\n          width = width - diffX;\n        }\n\n        // Prevent top resize from extending above top threshold\n        if (y < 0) {\n          // IMPORTANT: Order of operations is important here; diffY comes\n          // before y\n          const diffY = 0 - y;\n          y = 0;\n          height = height - diffY;\n        }\n\n        // Prevent right resize from extending right of right threshold\n        if (width + x > windowManagerWidth) {\n          width = windowManagerWidth - x;\n          x = null;\n        }\n\n        // Prevent bottom resize from extending below bottom threshold\n        if (height + y > windowManagerHeight) {\n          if (\n            // Fix issue where resizing windows from the top, which extended\n            // below the bottom threshold, would move the bottom edge up\n            direction === DIR_BORDER_S ||\n            direction === DIR_BORDER_SE ||\n            direction === DIR_BORDER_SW\n          ) {\n            height = windowManagerHeight - y;\n            y = null;\n          }\n        }\n\n        // Prevent drags from the top to be able to drag below bottom threshold\n        if (windowManagerHeight - y < WINDOW_POINTER_DRAG_BOTTOM_THRESHOLD) {\n          return;\n        }\n\n        windowController.setSize({ width, height });\n        windowController.setPosition({ x, y });\n      } else {\n        refInitialDragSizePosition.current = null;\n        refInitialWindowManagerSize.current = null;\n      }\n    },\n    [windowController, isUserResizing]\n  );\n\n  return [handleBorderDrag, isUserResizing];\n}\n","import { useMemo } from \"react\";\n\n/**\n * Dynamically applies and filters styling based on current state of given\n * window.\n *\n * @param {{ style: Object, isMaximized: boolean, isMinimized: boolean }}\n * @return {{ outerBorderStyle: Object, windowStyle: Object, bodyStyle: Object }}\n */\nexport default function useWindowStyles({ style, isMaximized, isMinimized }) {\n  // Conditionally overrides style property when window is maximized or\n  // minimized so that they do not conflict with the CSS classes\n  const outerBorderStyle = useMemo(() => {\n    if (isMaximized || isMinimized) {\n      return {};\n    } else {\n      return {\n        width: style.width,\n        height: style.height,\n      };\n    }\n  }, [style.width, style.height, isMaximized, isMinimized]);\n\n  const windowStyle = useMemo(() => {\n    return {\n      backgroundColor: style.backgroundColor,\n    };\n  }, [style.backgroundColor]);\n\n  const bodyStyle = useMemo(() => {\n    return {\n      padding: style.padding,\n    };\n  }, [style.padding]);\n\n  return {\n    outerBorderStyle,\n    windowStyle,\n    bodyStyle,\n  };\n}\n","import Window from \"./Window\";\n\nexport default Window;\n","import React, { useImperativeHandle, useState } from \"react\";\n\nimport WindowView from \"./Window.View\";\n\n// TODO: Implement CodeSandbox support for development / debugging:  https://codesandbox.io/docs/embedding#embed-options\n// TODO: See https://csslayout.io/patterns\n\n// TODO: Add prop-types\n// TODO: Document\n// TODO: Include option to be able to drag the window from within the window body (i.e. like a widget)\nconst Window = React.forwardRef(\n  (\n    {\n      children,\n      elWindowManager,\n\n      // TODO: Obtain via windowController instead?\n      isActive,\n\n      titleBarView,\n\n      style = {},\n      ...rest\n    },\n    ref\n  ) => {\n    const [windowController, attachWindowController] = useState(null);\n\n    // These are exposed to the WindowManager\n    useImperativeHandle(ref, () => ({\n      // windowSymbol: Symbol(\"window\"),\n      attachWindowController,\n    }));\n\n    // The windowController should already be supplied by WindowManager before\n    // rendering is even attempted\n    if (!windowController) {\n      return null;\n    }\n\n    return (\n      <WindowView\n        {...rest}\n        style={style}\n        elWindowManager={elWindowManager}\n        windowController={windowController}\n        isActive={isActive}\n        titleBarView={titleBarView}\n      >\n        {children}\n      </WindowView>\n    );\n  }\n);\n\nexport default Window;\n","import React from \"react\";\n\nimport useObjectState from \"@hooks/useObjectState\";\n\nexport const WindowContext = React.createContext({});\n\n// TODO: Document (per-window WindowProvider)\n// TODO: Use prop-types\nexport default function WindowProvider({ children, initialSharedState = {} }) {\n  const [sharedState, setSharedState] = useObjectState(initialSharedState);\n\n  return (\n    <WindowContext.Provider\n      value={{\n        setSharedState,\n        sharedState,\n      }}\n    >\n      {children}\n    </WindowContext.Provider>\n  );\n}\n","import { EVT_UPDATED, EVT_DESTROYED } from \"phantom-core\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport WindowManagerRouteProvider from \"./WindowManager.RouteProvider\"; // WindowManagerRouteContext,\nimport Cover from \"../Cover\";\nimport Window from \"../Window\";\n\nimport WindowProvider from \"../Window/Window.Provider\";\nimport useWindowContext from \"../Window/hooks/useWindowContext\";\n\nimport useServicesContext from \"@hooks/useServicesContext\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport useForceUpdate from \"@hooks/useForceUpdate\";\n\nimport useRegistrationViewOnResized from \"./hooks/useRegistrationViewOnResized\";\n\nimport WindowController from \"../Window/classes/WindowController\";\n\n// TODO: Add hotkey listener service and map to active window\n\n// TODO: Refactor (shared across all windows to determine relevant zIndexes)\nlet stackingIndex = 0;\n\n// TODO: Document\n// TODO: Use prop-types\nexport default function WindowManager({ appDescriptors = [], children }) {\n  const { addOrUpdateAppRegistration } = useAppOrchestrationContext();\n\n  // TODO: Refactor outside of window manager?\n  useEffect(() => {\n    appDescriptors.forEach(descriptor =>\n      addOrUpdateAppRegistration(descriptor)\n    );\n\n    // TODO: Add or update these descriptors in the appropriate provider\n  }, [appDescriptors, addOrUpdateAppRegistration]);\n\n  return (\n    <WindowManagerRouteProvider>\n      <WindowManagerView>{children}</WindowManagerView>\n    </WindowManagerRouteProvider>\n  );\n}\n\nfunction WindowManagerView({ children }) {\n  const { appRuntimes } = useAppOrchestrationContext();\n\n  const [elBase, setElBase] = useState(null);\n\n  const {\n    activeWindowController: desktopContextActiveWindowController,\n    setActiveWindowController: setDesktopContextActiveWindowController,\n  } = useDesktopContext();\n\n  // TODO: Document\n  const [windowControllerMaps, setWindowControllerMaps] = useState({});\n\n  /**\n   * @param {number | string } key\n   * @return {Object | void} // TODO: Document structure\n   */\n  const getWindowControllerMapWithKey = useCallback(\n    key => {\n      const map = windowControllerMaps[key];\n\n      return map;\n    },\n    [windowControllerMaps]\n  );\n\n  // IMPORTANT: Prevents infinite loop of handleSetActiveWindow when used as dependency\n  const refDesktopContextActiveWindowController = useRef(null);\n  refDesktopContextActiveWindowController.current =\n    desktopContextActiveWindowController;\n\n  /**\n   * @param {WindowController | null} windowController?\n   * @return {void}\n   */\n  const handleSetActiveWindow = useCallback(\n    windowController => {\n      // Restore minimized windows\n      // IMPORTANT: This should come before the is-current-window determination\n      // so that the Dock (and other activators) can un-minimize, regardless of\n      // the active window\n      if (windowController?.getIsMinimized()) {\n        windowController.setIsMinimized(false);\n      }\n\n      if (\n        !Object.is(\n          windowController,\n          refDesktopContextActiveWindowController.current\n        )\n      ) {\n        setDesktopContextActiveWindowController(windowController);\n\n        if (windowController) {\n          // TODO: Don't bring to front if already in front (i.e. is already the active window)\n          windowController.setState({ stackingIndex: ++stackingIndex });\n        }\n      }\n    },\n    [setDesktopContextActiveWindowController]\n  );\n\n  /**\n   * Retrieves whether or not the given window controller is attached to the\n   * active window.\n   *\n   * @return {boolean}\n   */\n  const handleGetIsActiveWindow = useCallback(\n    windowController =>\n      Object.is(desktopContextActiveWindowController, windowController),\n    [desktopContextActiveWindowController]\n  );\n\n  const { startServiceClass } = useServicesContext();\n\n  // Handle when window manager is clicked on directly (no window interacted with directly)\n  const refHandleSetActiveWindow = useRef(handleSetActiveWindow);\n  refHandleSetActiveWindow.current = handleSetActiveWindow;\n  useEffect(() => {\n    if (elBase) {\n      const _handleElBaseTouch = evt => {\n        // Deselect active window if desktop base is touched\n        if (evt.target === elBase) {\n          refHandleSetActiveWindow.current(null);\n        }\n      };\n\n      elBase.addEventListener(\"mousedown\", _handleElBaseTouch);\n      elBase.addEventListener(\"touchstart\", _handleElBaseTouch, {\n        // @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n        passive: true,\n      });\n\n      return function unmount() {\n        elBase.removeEventListener(\"mousedown\", _handleElBaseTouch);\n        elBase.removeEventListener(\"touchstart\", _handleElBaseTouch, {\n          // FIXME: (jh) I'm not positive if this should be on the\n          // removeEventListener (I think not, but erroring on the side of\n          // caution)\n          // @see https://github.com/WICG/EventListenerOptions/blob/gh-pages/explainer.md\n          // @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener\n          passive: true,\n        });\n      };\n    }\n  }, [elBase]);\n\n  /**\n   * Determines which windows are rendered to the screen at any given time, as\n   * \\well as controls instantiation and association of window controllers with\n   * their respective views.\n   *\n   * @type {React.Component[]}\n   */\n  // TODO: Can this be memoized again even w/ hooks running in window\n  // descriptors?\n  // TODO: Fix issue where every window will re-render when another window\n  // actively goes on top (not sure if it's a huge deal, but is seemingly\n  // unnecessary)\n  //\n  // TODO: Somehow figure out support for reparenting if needing to change\n  // window manager layouts: https://github.com/facebook/react/issues/3965\n  // (maybe this? https://www.npmjs.com/package/react-reverse-portal)\n  const windows = appRuntimes\n    .map(appRuntime => {\n      const appDescriptor = appRuntime.getAppDescriptor();\n      if (!appDescriptor) {\n        return null;\n      }\n\n      // TODO: Ensure key is unique across the map\n      const key = appRuntime.getUUID();\n\n      // NOTE: The variables absorbed by this decompositor (except for\n      // windowProps) are NOT passed down to the underlying DOM element of the\n      // window\n      //\n      // FIXME: (jh) Perhaps this logic should be refactored and most props not\n      // utilized on every single render (maybe the complete wrapped window\n      // could be a separate component instead of re-calcuating all of this\n      // stuff on every render)\n      const {\n        view: ViewComponent,\n        titleBarView,\n        initialSharedState,\n\n        // This one is tricky, don't pass up registration ID as DOM element ID\n        id,\n\n        title,\n        serviceClasses = [],\n        isPinned,\n        isPinnedToDock,\n        isAutoStart,\n        ...windowProps\n      } = appDescriptor;\n\n      if (!ViewComponent) {\n        return null;\n      }\n\n      // TODO: Re-active previously focused element when bringing new window to\n      // top\n\n      // TODO: (mostly for development), determine changed descriptor window\n      // title and update the window controller w/ new values\n\n      // TODO: Document\n      const dataMap = getWindowControllerMapWithKey(key);\n\n      /** @type {WindowController | void} */\n      const windowController = dataMap && dataMap.windowController;\n\n      // TODO: Fix issues with rendering errors related to the usage of this\n      /*\n      if (windowController) {\n        windowController.__INTERNAL__setIsActive(\n          handleGetIsActiveWindow(windowController)\n        );\n      }\n      */\n\n      // If we previously had a window controller running with this id\n      //\n      // TODO: Implement ability to flush this and restart a window with the same id?\n      if (dataMap && !dataMap.windowController) {\n        return null;\n      }\n\n      // TODO: Memoize this handling\n      // TODO: Attach services to window controller so other UI utilities can\n      // reference what is specific to this window\n      // TODO: Rename to appServices?\n      const appServices = {};\n      for (const serviceClass of serviceClasses) {\n        const service = startServiceClass(serviceClass);\n\n        appServices[serviceClass] = service;\n      }\n\n      // TODO: Memoize this component, when refactoring outer map\n      return (\n        <WindowProvider key={key} initialSharedState={initialSharedState}>\n          <Window\n            {...windowProps}\n            elWindowManager={elBase}\n            // TODO: Remove isActive and pass in from WindowController to the window\n            isActive={handleGetIsActiveWindow(windowController)}\n            onMouseDown={() => handleSetActiveWindow(windowController)}\n            onTouchStart={() => handleSetActiveWindow(windowController)}\n            titleBarView={\n              titleBarView ? (\n                <WrappedTitleBarView\n                  titleBarView={titleBarView}\n                  appServices={appServices}\n                  windowController={windowController}\n                  appRuntime={appRuntime}\n                />\n              ) : null\n            }\n            ref={ref => {\n              if (ref && !windowController) {\n                // Begin process of attaching window controller to rendered view\n                // and setting up event bindings\n\n                const windowController = new WindowController(\n                  {},\n                  {\n                    onBringToTop: handleSetActiveWindow,\n                  }\n                );\n\n                windowController.setTitle(title);\n\n                windowController.attachWindowManagerElement(elBase);\n\n                // Link app runtime to window controller (so that when the window\n                // controller is destructed it will take down the app runtime)\n                windowController.setAppRuntime(appRuntime);\n                appRuntime.__INTERNAL__setWindowController(windowController);\n\n                // Attach the view controller to the window\n                ref.attachWindowController(windowController);\n\n                setWindowControllerMaps(prev => {\n                  const next = { ...prev };\n                  next[key] = {\n                    windowController,\n                    key,\n                    // windowSymbol: ref.windowSymbol,\n                  };\n\n                  return next;\n                });\n\n                windowController.once(EVT_DESTROYED, () => {\n                  setWindowControllerMaps(prev => {\n                    const next = { ...prev };\n\n                    next[key].windowController = null;\n\n                    return next;\n                  });\n                });\n\n                // Set this new window as the active window\n                handleSetActiveWindow(windowController);\n              }\n            }}\n          >\n            {\n              // Wrap the view so that it updates when a bound service updates\n              // NOTE: (jh) I originally tried wrapping the window itself, but\n              // it didn't work, and it's a better idea to only update what's\n              // necessary anyway\n            }\n            {windowController && (\n              <WrappedView\n                appServices={appServices}\n                windowController={windowController}\n                appRuntime={appRuntime}\n                view={ViewComponent}\n              />\n            )}\n          </Window>\n        </WindowProvider>\n      );\n    })\n    .filter(window => Boolean(window));\n\n  return (\n    <Cover>\n      {\n        // TODO: Bind touch event to this element, and if directly touching it,\n        // make currently active window not active (if cursor is in another\n        // window, ensure it is removed as well)\n        //\n        // setActiveWindowController(null)\n      }\n      <div\n        ref={setElBase}\n        style={{ width: \"100%\", height: \"100%\", position: \"relative\" }}\n      >\n        {children}\n\n        {windows}\n      </div>\n    </Cover>\n  );\n}\n\n// TODO: Document\nconst WrappedTitleBarView = function ({ titleBarView, ...rest }) {\n  return <WrappedView {...rest} view={titleBarView} />;\n};\n\n// FIXME: (jh) [As a consideration] Implement Svelte lifecycle methods, to\n// avoid users having to deal with hooks (keep hooks as more of a low-level\n// thing instead, if possible)\n// - https://svelte.dev/tutorial/onmount\n// - https://svelte.dev/tutorial/ondestroy\n// - https://svelte.dev/tutorial/update\n// - https://svelte.dev/tutorial/tick\n// Maybe we can say, \"we built a rendering engine on top of React, so that\n// React components can be used, without the complexity of dealing with React\n// hook dependencies, in order to reduce excessive rendering, or stale states,\n// caused by improper user of hook dependencies\".... could also smooth the\n// transition over to Svelte or any other rendering engine for apps created on\n// top of one of them.\n//\n// TODO: Document; rename? (NOTE: this wrapped view was designed to make it\n// easier to make the wrapping view render out-of-sequence with the containing\n// view, such as when a service updates, etc.)\nconst WrappedView = function WrappedView({\n  appServices,\n  windowController,\n  appRuntime,\n  view: ViewComponent,\n}) {\n  const forceUpdate = useForceUpdate();\n\n  const { sharedState, setSharedState } = useWindowContext();\n\n  // Re-render window when a service updates\n  useEffect(() => {\n    const _handleServiceUpdate = () => {\n      forceUpdate();\n    };\n\n    for (const service of Object.values(appServices)) {\n      // TODO: Make this channel-specific (i.e. EVT_MAIN_STATE_UPDATED)?\n      service.on(EVT_UPDATED, _handleServiceUpdate);\n    }\n\n    return function unmount() {\n      for (const service of Object.values(appServices)) {\n        // TODO: Make this channel-specific (i.e. EVT_MAIN_STATE_UPDATED)?\n        service.off(EVT_UPDATED, _handleServiceUpdate);\n      }\n    };\n  }, [appServices, forceUpdate]);\n\n  // TODO: Document\n  const setResizeHandler = useRegistrationViewOnResized(windowController);\n\n  return (\n    <ViewComponent\n      windowController={windowController}\n      appServices={appServices}\n      appRuntime={appRuntime}\n      setResizeHandler={setResizeHandler}\n      sharedState={sharedState}\n      setSharedState={setSharedState}\n    />\n  );\n};\n","import { useContext } from \"react\";\nimport { WindowContext } from \"../Window.Provider\";\n\n// TODO: Document (per-window useWindowContext)\nexport default function useWindowContext() {\n  return useContext(WindowContext);\n}\n","import { useCallback, useEffect, useRef } from \"react\";\nimport WindowController, {\n  EVT_RESIZED,\n} from \"@components/Window/classes/WindowController\";\n\n/**\n * Handles automatic invocation of AppRegistration view's setResizeHandler when\n * the relevant window resizes.\n *\n * @param {WindowController} windowController\n * @return {function}\n */\nexport default function useRegistrationViewOnResized(windowController) {\n  const refSetResizeHandler = useRef(null);\n\n  /**\n   * @param {function | void} setResizeHandler Passed up from AppRegistration view\n   * properties.\n   */\n  const handleResized = useCallback(setResizeHandler => {\n    /**\n     * onResized is passed from view, and is executed by the WindowManager when\n     * the WindowController emits EVT_RESIZED event.\n     */\n    refSetResizeHandler.current = setResizeHandler;\n  }, []);\n\n  useEffect(() => {\n    if (windowController) {\n      if (!(windowController instanceof WindowController)) {\n        throw new TypeError(\"windowController is not a WindowController\");\n      }\n\n      const _handleExecResizedCallback = () => {\n        const onResized = refSetResizeHandler.current;\n\n        // AppRegistration view might not set an onResized handler\n        if (typeof onResized === \"function\") {\n          onResized();\n        }\n      };\n\n      windowController.on(EVT_RESIZED, _handleExecResizedCallback);\n\n      return function unmount() {\n        windowController.off(EVT_RESIZED, _handleExecResizedCallback);\n      };\n    }\n  }, [windowController]);\n\n  return handleResized;\n}\n","import WindowManager from \"./WindowManager\";\n\nexport default WindowManager;\n","import LED from \"./LED\";\n\nexport default LED;\n","import React from \"react\";\nimport styles from \"./LED.module.css\";\nimport classNames from \"classnames\";\nimport PropTypes from \"prop-types\";\n\nLED.propTypes = {\n  /** The color of the LED */\n  color: PropTypes.string,\n};\n\n/**\n * @see https://github.com/aus/led.css\n * @see http://jsfiddle.net/XrHcA/\n */\nexport default function LED({ color = null, ...rest }) {\n  return (\n    <div {...rest} className={classNames(styles[\"led\"], styles[color])}></div>\n  );\n}\n","import Dock from \"./Dock\";\n\nexport default Dock;\n","import { useMemo } from \"react\";\n// import LED from \"@components/LED\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport useDesktopContext from \"@hooks/useDesktopContext\";\n\n// TODO: Incorporate this logic\n// \"The user can also click an app’s Dock icon to bring all of that app’s windows forward; the most recently accessed app window becomes the key window.\"\n// (Ref. \"Activating Windows\": https://developer.apple.com/design/human-interface-guidelines/macos/windows-and-views/window-anatomy/)\n\n// TODO: Scroll dock when scrolling mouse wheel\n\n// TODO: Document\nexport default function Dock() {\n  const { activeWindowController } = useDesktopContext();\n  const { appRegistrations, activeAppRegistrations, activateAppRegistration } =\n    useAppOrchestrationContext();\n\n  // TODO: Import type definition\n  /** @type {AppRegistration[]} */\n  const dockRegistrations = useMemo(\n    () => [\n      ...new Set([\n        ...appRegistrations.filter(registration =>\n          registration.getIsPinnedToDock()\n        ),\n        ...activeAppRegistrations,\n      ]),\n    ],\n    [appRegistrations, activeAppRegistrations]\n  );\n\n  // TODO: Import type definition\n  /** @type {AppRegistration | void} */\n  const activeRegistration = useMemo(\n    () => activeWindowController?.getAppRegistration(),\n    [activeWindowController]\n  );\n\n  return (\n    <div\n      // TODO: Move to module.css\n      style={{\n        position: \"absolute\",\n        bottom: 0,\n        left: 0,\n        width: \"100%\",\n        textAlign: \"center\",\n        isolation: \"isolate\",\n        // TODO: Handle different?\n        zIndex: 99999999,\n        overflowX: \"auto\",\n        pointerEvents: \"none\",\n      }}\n    >\n      {\n        // TODO: Add tooltip functionality\n        // - https://www.npmjs.com/package/rc-tooltip\n        // - https://www.npmjs.com/package/react-tooltip\n        // - Note: Original Shell's Antd theme used rc-tooltip as the base (https://github.com/zenOSmosis/js-shell/blob/master/frontend/src/components/Desktop/Dock/DockItem.jsx)\n        //\n        // TODO: Add button menu\n        // - See original Shell implementation: https://github.com/zenOSmosis/js-shell/blob/master/frontend/src/components/Desktop/Dock/DockItem.jsx\n      }\n      <div\n        style={{\n          display: \"inline-block\",\n          color: \"black\",\n          whiteSpace: \"nowrap\",\n          maxWidth: \"100%\",\n          pointerEvents: \"all\",\n        }}\n        className=\"button-group\"\n      >\n        {dockRegistrations.map(registration => (\n          <button\n            style={Object.assign(\n              registration === activeRegistration\n                ? {\n                    // TODO: Make this color a variable for highlighted elements\n                    backgroundColor: \"#347FE8\",\n                    color: \"#000\",\n                  }\n                : { backgroundColor: \"#000\" },\n              { minWidth: 120 }\n            )}\n            key={registration.getUUID()}\n            onClick={() => activateAppRegistration(registration)}\n          >\n            {registration.getTitle()} {/* <LED color=\"gray\" /> */}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useMemo, useState } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./AutoScaler.module.css\";\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n/**\n * Fix issue on iOS 13 where ResizeObserver isn't available.\n */\nimport { install } from \"resize-observer\";\nif (!window.ResizeObserver) {\n  install();\n}\n\n/**\n * Automatically applies CSS transform scaling to children to fill parent node,\n * while preserving aspect ratio.\n *\n * Useful for videos and canvases, where the resolution is a fixed size and\n * should not change.\n */\nexport default function AutoScaler({ children, className, ...rest }) {\n  const [elOuterWrap, setElOuterWrap] = useState(null);\n  const [elInnerWrap, setElInnerWrap] = useState(null);\n\n  const uuid = useMemo(uuidv4, []);\n\n  // Handle scaling\n  useEffect(() => {\n    if (elOuterWrap && elInnerWrap) {\n      let outerWrapSize = {\n        width: 0,\n        height: 0,\n      };\n      let innerWrapSize = {\n        width: 0,\n        height: 0,\n      };\n\n      // This is uesd w/ visibility below to try to reduce position defects\n      // when first rendering\n      elInnerWrap.style.visibility = \"hidden\";\n\n      const ro = new ResizeObserver(entries => {\n        requestSkippableAnimationFrame(() => {\n          for (const entry of entries) {\n            const size = {\n              width: entry.target.offsetWidth,\n              height: entry.target.offsetHeight,\n            };\n\n            if (entry.target === elOuterWrap) {\n              outerWrapSize = size;\n            } else {\n              innerWrapSize = size;\n            }\n          }\n\n          // Determine against all available space\n          const maxScaleX = outerWrapSize.width / innerWrapSize.width;\n          const maxScaleY = outerWrapSize.height / innerWrapSize.height;\n\n          const scale = Math.min(maxScaleX, maxScaleY);\n\n          elInnerWrap.style.transform = `scale(${scale}, ${scale})`;\n\n          if (elInnerWrap.style.visibility === \"hidden\") {\n            setTimeout(() => {\n              elInnerWrap.style.visibility = \"visible\";\n            }, 4);\n          }\n        }, uuid);\n      });\n\n      ro.observe(elOuterWrap);\n      ro.observe(elInnerWrap);\n\n      return function unmount() {\n        ro.unobserve(elOuterWrap);\n        ro.unobserve(elInnerWrap);\n      };\n    }\n  }, [elOuterWrap, elInnerWrap, uuid]);\n\n  return (\n    <div\n      {...rest}\n      ref={setElOuterWrap}\n      className={classNames(styles[\"auto-scaler\"], className)}\n    >\n      <div ref={setElInnerWrap} className={styles[\"content-wrap\"]}>\n        {children}\n      </div>\n    </div>\n  );\n}\n","import AutoScaler from \"./AutoScaler\";\n\nexport default AutoScaler;\n","// @see https://szhsin.github.io/react-menu/#basic-menu\nimport {\n  Menu as LibMenu,\n  MenuItem,\n  MenuButton,\n  MenuHeader,\n  MenuDivider,\n  SubMenu as LibSubMenu,\n  applyHOC,\n  applyStatics,\n} from \"@szhsin/react-menu\";\nimport \"@szhsin/react-menu/dist/index.css\";\nimport \"@szhsin/react-menu/dist/transitions/slide.css\";\nimport \"./Menu.css\";\n\n// TODO: Close menu when screen size changes (menu can go offscreen)\n\nconst COMMON_PROPS = {\n  // Enable menu items to overflow in case they overextend the viewport\n  overflow: \"auto\",\n};\n\nconst Menu = applyHOC(function Menu({ ...rest }) {\n  return <LibMenu {...rest} portal={true} {...COMMON_PROPS} />;\n}, LibMenu);\n\nconst SubMenu = applyStatics(LibSubMenu)(function SubMenu({ ...rest }) {\n  return <LibSubMenu {...rest} {...COMMON_PROPS} />;\n});\n\n// TODO: Apply HOC and adjust styling as necessary (overflow=\"auto\" prop works\n// on Menu & SubMenu outside of styling)\n// @see https://szhsin.github.io/react-menu/#styles-prop for managing menu\n// styles (maybe not necessary to override CSS manually)\n// @see [HOC example] https://codesandbox.io/s/0bipn\n\n// TODO: Implement keyboard accessibility across menu bar: https://szhsin.github.io/react-menu/docs#keyboard\n\n// Controlled menu: https://szhsin.github.io/react-menu/docs#controlled-menu\n// (look into unmountOnClose and using it for dynamic opening / closing of\n// menus when mouse scrolls over menu buttons in menu bar)\n\n// useMenuStateHook: https://szhsin.github.io/react-menu/docs#use-menu-state\n\nexport default Menu;\nexport { MenuItem, MenuButton, MenuHeader, MenuDivider, SubMenu };\n","import { useCallback, useMemo } from \"react\";\n// TODO: Refactor\nimport useAppOrchestrationContext from \"./useAppOrchestrationContext\";\n\n// TODO: Move to @core/hooks\n\n// FIXME: (jh) Is there any reason to not just use the appDescriptor itself,\n// and not the ID?\n\n// TODO: Document\nexport default function useAppRegistrationLink(appDescriptorID) {\n  const { getAppRegistrationTitleWithDescriptorID, activateAppRegistrationID } =\n    useAppOrchestrationContext();\n\n  const title = useMemo(\n    () => getAppRegistrationTitleWithDescriptorID(appDescriptorID),\n    [getAppRegistrationTitleWithDescriptorID, appDescriptorID]\n  );\n  const link = useCallback(\n    () => activateAppRegistrationID(appDescriptorID),\n    [activateAppRegistrationID, appDescriptorID]\n  );\n\n  return {\n    title,\n    link,\n  };\n}\n","import Padding from \"./Padding\";\n\nexport default Padding;\n","import { useEffect, useState } from \"react\";\n\nimport styles from \"./Padding.module.css\";\nimport classNames from \"classnames\";\n\nexport default function Padding({ children, className, ...rest }) {\n  const [el, setEl] = useState(null);\n  const [hasSiblings, setHasSiblings] = useState(false);\n\n  // Auto-determine if the element has siblings\n  useEffect(() => {\n    if (el) {\n      const hasSiblings = Boolean([...el.parentNode.children].length > 1);\n\n      setHasSiblings(hasSiblings);\n    }\n  }, [el]);\n\n  return (\n    <div\n      {...rest}\n      ref={setEl}\n      className={classNames(\n        styles[\"padding\"],\n        !hasSiblings && styles[\"no-siblings\"],\n        className\n      )}\n    >\n      {children}\n    </div>\n  );\n}\n","import Timer from \"./Timer\";\n\nexport default Timer;\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport NoWrap from \"../NoWrap\";\n\nimport PropTypes from \"prop-types\";\n\nTimer.propTypes = {\n  onTick: PropTypes.func.isRequired,\n};\n\n// TODO: Document\nexport default function Timer({ onTick, className, ...rest }) {\n  const [seconds, _setSeconds] = useState(onTick());\n\n  const getSeconds = useCallback(() => {\n    const seconds = onTick();\n\n    return seconds;\n  }, [onTick]);\n\n  useEffect(() => {\n    const handleUpdate = () => _setSeconds(getSeconds());\n\n    // Perform initial render\n    handleUpdate();\n\n    const updateInterval = setInterval(handleUpdate, 1000);\n\n    return function unmount() {\n      clearInterval(updateInterval);\n    };\n  }, [getSeconds]);\n\n  return <NoWrap {...rest}>{getSecondsToHHMMSS(seconds)}</NoWrap>;\n}\n\n// TODO: Refactor\n/**\n * @see https://stackoverflow.com/questions/1322732/convert-seconds-to-hh-mm-ss-with-javascript\n *\n * @param {number} seconds\n * @return {string} hh:mm:ss format\n */\nfunction getSecondsToHHMMSS(secs) {\n  // Note: This version should handle seconds if length is longer than one day\n  return new Date((secs % (60 * 60 * 24)) * 1000).toISOString().substr(11, 8);\n}\n","// NOTE: No hook is wrapped directly around this because the goal is to not\n// make it easy to expose services to windows which don't directly use said\n// service\nimport { useContext } from \"react\";\nimport { UIServicesContext } from \"@core/providers/UIServicesProvider\";\n\n// TODO: Include (either here, or elsewhere,) ability to monitor running\n// PhantomCore instances (use WeakRef here or there, as well)?\n\n// TODO: Show last update time, state, etc.\n\n// TODO: Include ability to render service reporters, once functionality is\n// integrated\n\n// TODO: Include ability to monitor React providers exposed by the service\n\nimport Padding from \"@components/Padding\";\nimport Timer from \"@components/Timer\";\nimport NoWrap from \"@components/NoWrap\";\n\nexport const REGISTRATION_ID = \"service-monitor\";\n\nconst ServiceMonitorApp = {\n  id: REGISTRATION_ID,\n  title: \"Service Monitor\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  isPinned: true,\n  view: function View() {\n    const { services } = useContext(UIServicesContext);\n\n    // TODO: Group by runtime\n\n    return (\n      <Padding style={{ overflowY: \"auto\" }}>\n        <table style={{ width: \"100%\" }}>\n          <thead>\n            <tr>\n              <td>Service Name</td>\n              <td>Uptime</td>\n              <td>f(x)</td>\n              {/**\n              <td>\n                Active\n                <br />\n                App Runtimes\n              </td>\n              <td>\n                Dynamically\n                <br />\n                Linked Providers\n              </td>  \n               */}\n            </tr>\n          </thead>\n          <tbody>\n            {services.map(service => (\n              <tr key={service.getUUID()}>\n                <td>{service.getTitle() || \"[Untitled]\"}</td>\n                <td className=\"center\">\n                  <Timer onTick={() => service.getInstanceUptime()} />\n                </td>\n                {/*\n                  <td className=\"center\">N/A</td>\n                  <td className=\"center\">N/A</td>\n                  */}\n                {/*\n              <td>\n                <button\n                  onClick={() => service.destroy()}\n                  style={{ width: \"100%\" }}\n                >\n                  Close\n                </button>\n              </td>\n                */}\n                <td className=\"center\">\n                  {\n                    // TODO: Remove\n                  }\n                  <button onClick={() => service.log(service.getState())}>\n                    <NoWrap>log(state)</NoWrap>\n                  </button>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </Padding>\n    );\n  },\n};\n\nexport default ServiceMonitorApp;\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./ButtonTransparent.module.css\";\n\n// TODO: Rename to ButtonUnstyled?\nfunction ButtonTransparent({ children, className, ...rest }) {\n  return (\n    <button\n      className={classNames(styles[\"button-transparent\"], className)}\n      {...rest}\n    >\n      {children}\n    </button>\n  );\n}\n\nexport default ButtonTransparent;\n","import ButtonTransparent from './ButtonTransparent';\n\nexport default ButtonTransparent;","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`ibcd0b21d7ccf498b89d8ce646138a3ec-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`id92dd65b22cd4a62996cb3b8e0f579db-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import Notification from \"./Notification\";\n\nexport default Notification;\n","import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport Animation from \"@components/Animation\";\nimport ButtonTransparent from \"@components/ButtonTransparent\";\nimport Padding from \"@components/Padding\";\n\nimport InfoIcon from \"@icons/InfoIcon\";\nimport CloseIcon from \"@icons/CloseIcon\";\n\nimport styles from \"./Notification.module.css\";\n\n// TODO: Add PropTypes\n// TODO: Document\nexport default function Notification({\n  body,\n  image,\n  title,\n  uuid,\n  onClose,\n  onClick,\n  // In milliseconds\n  autoCloseTime = 4000,\n  ...rest\n}) {\n  // TODO: Should this state be managed from the outside?\n  const [isClosing, setIsClosing] = useState(false);\n\n  // IMPORTANT: refOnClose is memoized to fix an issue where generating new\n  // notifications would restart the internal timer\n  const refOnClose = useRef(onClose);\n  const handleClose = useCallback(\n    evt => {\n      if (evt) {\n        evt.stopPropagation();\n      }\n\n      setIsClosing(true);\n\n      // NOTE (jh): We could also listen for Animation ended event, but decided\n      // to do the easy route at first.\n      setTimeout(\n        () => {\n          refOnClose.current(uuid);\n        },\n        // TODO: Make this value dynamic?\n        500\n      );\n    },\n    [uuid]\n  );\n\n  const [el, setEl] = useState(null);\n\n  // TODO: Document\n  useEffect(() => {\n    if (el) {\n      let autoCloseTimeout = null;\n\n      const startTimeout = () => {\n        autoCloseTimeout = setTimeout(handleClose, autoCloseTime);\n      };\n\n      startTimeout();\n\n      const stopTimeout = () => {\n        clearTimeout(autoCloseTimeout);\n      };\n\n      el.addEventListener(\"mouseover\", stopTimeout, { passive: true });\n      el.addEventListener(\"mouseout\", startTimeout, { passive: true });\n      el.addEventListener(\"touchstart\", stopTimeout, { passive: true });\n\n      return function unmount() {\n        el.removeEventListener(\"mouseover\", stopTimeout, { passive: true });\n        el.removeEventListener(\"mouseout\", startTimeout, { passive: true });\n        el.removeEventListener(\"touchstart\", stopTimeout, { passive: true });\n\n        stopTimeout();\n      };\n    }\n  }, [el, autoCloseTime, handleClose]);\n\n  // TODO: Refactor into Image component?\n  const Image = useMemo(\n    () => () => {\n      switch (typeof image) {\n        case \"string\":\n          return (\n            <img alt={title} src={image} className={styles[\"main-image\"]} />\n          );\n\n        case \"function\":\n          return image();\n\n        default:\n          return image || <InfoIcon />;\n      }\n    },\n    [image, title]\n  );\n\n  /**\n   * Note: Exports a button only if an onClick handler has been defined for\n   * the notification.\n   */\n  const MessageButton = useMemo(\n    () =>\n      ({ ...rest }) =>\n        typeof onClick === \"function\" ? (\n          <ButtonTransparent\n            {...rest}\n            onClick={onClick}\n            className={styles[\"action\"]}\n          />\n        ) : (\n          <React.Fragment {...rest} />\n        ),\n    [onClick]\n  );\n\n  return (\n    <div\n      ref={setEl}\n      onTouchEnd={handleClose}\n      onMouseUp={handleClose}\n      className={styles[\"notification\"]}\n      {...rest}\n    >\n      <Animation\n        animationName={!isClosing ? \"slideInRight\" : \"slideOutRight\"}\n        animationDuration=\".5s\"\n      >\n        <div className={styles[\"body-outer-wrap\"]}>\n          <MessageButton>\n            <Padding>\n              <div className={styles[\"main-image-wrap\"]}>\n                <Image />\n              </div>\n              <div className={styles[\"title\"]}>{title}</div>\n\n              <div className={styles[\"body\"]}>{body}</div>\n            </Padding>\n          </MessageButton>\n          <ButtonTransparent onClick={handleClose} className={styles[\"close\"]}>\n            <Padding>\n              <CloseIcon />\n            </Padding>\n          </ButtonTransparent>\n        </div>\n      </Animation>\n    </div>\n  );\n}\n","import NotificationStack from \"./NotificationStack\";\n\nexport default NotificationStack;\n","import React from \"react\";\n\nimport styles from \"./NotificationStack.module.css\";\n\nimport Notification from \"../Notification\";\n\n// TODO: Fix issue where notifications may move up if previous notifications\n// are closed before-hand\n\n// TODO: Document\n// Handles multiple-rendered notifications\nexport default function NotificationStack({\n  notifications = [],\n  onNotificationClose,\n}) {\n  return (\n    <div className={styles[\"notification-stack\"]}>\n      {\n        // NOTE: The inner-wrap enables too many UI notifications to be\n        // scrollable\n      }\n      <div className={styles[\"inner-wrap\"]}>\n        {\n          // IMPORTANT: onClose is not mapped from the data object because it is\n          // handled internally by the provider\n          notifications.map(({ body, image, onClick, title, uuid }) => {\n            return (\n              <div key={uuid}>\n                <Notification\n                  body={body}\n                  image={image}\n                  onClick={onClick}\n                  title={title}\n                  uuid={uuid}\n                  onClose={() => onNotificationClose(uuid)}\n                />\n              </div>\n            );\n          })\n        }\n      </div>\n    </div>\n  );\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nexport const EVT_NOTIFICATION = \"notification\";\n\n// TODO: Implement ability to store previous notifications so they can be retrieved\n\n/**\n * Handles management of UI notifications.\n */\nexport default class UINotificationService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"UI Notification Service\");\n\n    this.setState({\n      notifications: [],\n    });\n  }\n\n  // TODO: Document\n  // TODO: Borrow API from Apple: https://developer.apple.com/library/archive/documentation/LanguagesUtilities/Conceptual/MacAutomationScriptingGuide/DisplayNotifications.html#//apple_ref/doc/uid/TP40016239-CH61-SW1\n  showNotification({ image, title, body, onClick, onClose = () => null }) {\n    // TODO: Capture notification time\n\n    this.setState({\n      // Add new notifications to end of stack\n      notifications: [\n        ...this.getState().notifications,\n        {\n          image,\n          title,\n          body,\n          onClick,\n          onClose,\n          uuid: uuidv4(),\n        },\n      ],\n    });\n  }\n\n  // TODO: Document\n  closeNotificationWithUUID(uuid) {\n    const next = this.getState().notifications.filter(\n      ({ uuid: prevUUID, onClose }) => {\n        const isKept = uuid !== prevUUID;\n\n        if (!isKept) {\n          // Call the onClose handler passed to showNotification\n          onClose();\n        }\n\n        return isKept;\n      }\n    );\n\n    this.setState({\n      notifications: next,\n    });\n  }\n}\n","import React, { useCallback } from \"react\";\n\nimport NotificationStack from \"./views/NotificationStack\";\nimport useServiceClass from \"@hooks/useServiceClass\";\nimport UINotificationService from \"@services/UINotificationService\";\n\nexport const NotificationContext = React.createContext({});\n\n// TODO: Document\n// TODO: Borrow API logic from https://www.npmjs.com/package/react-notifications\nexport default function NotificationProvider({ children }) {\n  const { serviceInstance, serviceState } = useServiceClass(\n    UINotificationService\n  );\n\n  // TODO: Document\n  const showNotification = useCallback(\n    notification => serviceInstance.showNotification(notification),\n    [serviceInstance]\n  );\n\n  // TODO: Document\n  const closeNotificationWithUUID = useCallback(\n    uuid => serviceInstance.closeNotificationWithUUID(uuid),\n    [serviceInstance]\n  );\n\n  return (\n    <NotificationContext.Provider\n      value={{\n        showNotification,\n      }}\n    >\n      {children}\n\n      <NotificationStack\n        notifications={serviceState.notifications}\n        onNotificationClose={closeNotificationWithUUID}\n      />\n    </NotificationContext.Provider>\n  );\n}\n","import NotificationProvider, {\n  NotificationContext,\n} from \"./NotificationProvider\";\n\nexport default NotificationProvider;\nexport { NotificationContext };\n","import Modal from \"./Modal\";\n\nexport default Modal;\n","import React from \"react\";\n\nimport Cover from \"@components/Cover\";\n\n// TODO: Add PropTypes\n// TODO: Document\nexport default function Modal({ view: View, onClose, ...rest }) {\n  return (\n    <Cover>\n      <View {...rest} onClose={onClose} />\n    </Cover>\n  );\n}\n","import ModalStack from \"./ModalStack\";\n\nexport default ModalStack;\n","import React from \"react\";\n\nimport Modal from \"../Modal\";\n\n// TODO: Document\n// Handles multiple-rendered modals\nexport default function ModalStack({ modals = [] }) {\n  return (\n    <>\n      {modals.map(({ view, uuid, onClose, ...rest }) => {\n        return (\n          <div key={uuid}>\n            <Modal {...rest} view={view} uuid={uuid} onClose={onClose} />\n          </div>\n        );\n      })}\n    </>\n  );\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport { v4 as uuidv4 } from \"uuid\";\n\n/**\n * Handles management of UI modals.\n */\nexport default class UIModalService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"UI Modal Service\");\n\n    this.setState({\n      modals: [],\n    });\n  }\n\n  // TODO: Document\n  showModal(view, options = {}) {\n    const uuid = uuidv4();\n\n    let timeout = null;\n\n    const _handleClose = () => {\n      clearTimeout(timeout);\n\n      this.closeModalWithUUID(uuid);\n    };\n\n    this.setState({\n      // Add new modals to end of stack\n      modals: [\n        ...this.getState().modals,\n        {\n          view,\n          uuid,\n          onClose: _handleClose,\n        },\n      ],\n    });\n\n    // TODO: [To fix issue where typing can still occur on below elements] If\n    // an element was focused before modal is displayed, remove the focus, and\n    // [potentially] reapply to the element once the modal is gone.  Can\n    // underlying elements still be selected and can tabindex somehow fix that?\n\n    // TODO: Refactor\n    if (options.duration) {\n      timeout = setTimeout(() => {\n        this.closeModalWithUUID(uuid);\n      }, options.duration);\n    }\n  }\n\n  // TODO: Document\n  closeModalWithUUID(uuid) {\n    const next = this.getState().modals.filter(({ uuid: prevUUID }) => {\n      const isKept = uuid !== prevUUID;\n\n      return isKept;\n    });\n\n    this.setState({\n      modals: next,\n    });\n  }\n}\n","import React, { useCallback } from \"react\";\n\nimport ModalStack from \"./views/ModalStack\";\nimport useServiceClass from \"@hooks/useServiceClass\";\nimport UIModalService from \"@services/UIModalService\";\n\nexport const ModalContext = React.createContext({});\n\n// TODO: Document\nexport default function ModalProvider({ children }) {\n  const { serviceInstance, serviceState } = useServiceClass(UIModalService);\n\n  // TODO: Document\n  const showModal = useCallback(\n    modal => serviceInstance.showModal(modal),\n    [serviceInstance]\n  );\n\n  return (\n    <ModalContext.Provider\n      value={{\n        showModal,\n      }}\n    >\n      {children}\n\n      <ModalStack modals={serviceState.modals} />\n    </ModalContext.Provider>\n  );\n}\n","import ModalProvider, { ModalContext } from \"./ModalProvider\";\n\nexport default ModalProvider;\nexport { ModalContext };\n","import Desktop from \"./Desktop\";\n\nexport default Desktop;\n","import PhantomCore from \"phantom-core\";\nimport ReShellCore from \"@core\";\n\nimport FullViewport from \"../FullViewport\";\nimport WindowManager from \"../WindowManager\";\nimport Cover from \"../Cover\";\nimport Layout, { Header, Content, Row, Column } from \"../Layout\";\nimport LED from \"../LED\";\nimport Dock from \"../Dock\";\nimport AutoScaler from \"../AutoScaler\";\n\n// TODO: Change this to use data-driven Menubar\nimport Menu, {\n  MenuButton,\n  MenuItem,\n  MenuHeader,\n  MenuDivider,\n  SubMenu,\n} from \"../_Menu.LibWrapper\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\nimport useServicesContext from \"@hooks/useServicesContext\";\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\nimport useAppRegistrationLink from \"@hooks/useAppRegistrationLink\";\n\nimport { REGISTRATION_ID as SERVICE_MONITOR_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/ServiceMonitorApp\";\n\nimport NotificationProvider from \"./providers/NotificationProvider\";\nimport ModalProvider from \"./providers/ModalProvider\";\n\n// import { useEffect } from \"react\";\n\n// TODO: Implement top menu-bar\n// @see https://headlessui.dev/react/menu\n// or (better?) https://szhsin.github.io/react-menu\n\n// TODO: Implement context menu\n// @see https://szhsin.github.io/react-menu/#context-menu\n\n// TODO: Backgrounds?\n// @see https://coolbackgrounds.io (particles: https://github.com/marcbruederlin/particles.js)\n// @see [Unsplash 3D renders] https://unsplash.com/blog/unsplash-library-now-accepts-3d-renders/?utm_source=vero&utm_medium=email&utm_content=control&utm_campaign=Unsplash%20Awards%20Announcement&utm_term=Newsletter&vero_id=6421463&vero_conv=PmNPLiUVlfrNjJJhv6nsCKDC_PNDDxf0FWY02n1x7jyPWwq0KgHl-nQmk0Pq6aTzRvvwjcixMGRPZlAmMwIqQz72F0DGURijjA%3D%3D\n\n// TODO: Use prop-types\nexport default function Desktop({\n  backgroundView = <div style={{ backgroundColor: \"#ccc\" }} />,\n  appDescriptors,\n}) {\n  // FIXME: (jh) This currently triggers a \"Could ot locate appRegistration\n  // with id: service-monitor\" warning on first render; it should be refactored\n  const { link: openServiceMonitor } = useAppRegistrationLink(\n    SERVICE_MONITOR_REGISTRATION_ID\n  );\n\n  const { services } = useServicesContext();\n  const { activeWindowController /* addBackgroundAsset */ } =\n    useDesktopContext();\n  const { appRegistrations, activateAppRegistration, appRuntimes } =\n    useAppOrchestrationContext();\n\n  // TODO: Implement after PhantomWrapper (or equiv.; assets need to be wrapped in\n  // PhantomCore instances in order to be added to background collection)\n  /*\n  useEffect(() => {\n    if (backgroundView) {\n      addBackgroundAsset(backgroundView);\n    }\n  }, [backgroundView, addBackgroundAsset]);\n  */\n\n  return (\n    <FullViewport>\n      {\n        // IMPORTANT: Using NotificationProvider directly on the BaseView does\n        // not apply CSS module styling\n      }\n      <ModalProvider>\n        <NotificationProvider>\n          <Cover style={{ backgroundColor: \"#424242\" }}>\n            {\n              // TODO: Refactor\n            }\n            {backgroundView}\n          </Cover>\n          <Cover>\n            <Layout>\n              <Header\n                style={{\n                  // borderBottom: \"1px #ccc solid\",\n                  whiteSpace: \"nowrap\",\n                  backgroundColor: \"rgba(0,0,0,.5)\",\n                }}\n              >\n                <Row>\n                  <Column style={{ width: \"100%\" }}>\n                    {\n                      // TODO: Replace menu with data-driven Menubar component\n                    }\n                    <div>\n                      {\n                        // TODO: Include bookmark menu option (use browser bookmark system and / or store somewhere else); in combination w/ deep-linking functionality\n                      }\n                      <Menu\n                        menuButton={\n                          <MenuButton>\n                            {\n                              // TODO: Make this string configurable\n                            }\n                            Desktop\n                          </MenuButton>\n                        }\n                      >\n                        {\n                          // TODO: Show divider\n                        }\n                        <SubMenu label=\"Applications\">\n                          {appRegistrations\n                            .sort((a, b) => {\n                              const aTitle = a.getTitle();\n                              const bTitle = b.getTitle();\n\n                              if (aTitle < bTitle) {\n                                return -1;\n                              } else if (bTitle > aTitle) {\n                                return 1;\n                              } else {\n                                return 0;\n                              }\n                            })\n                            .map(app => (\n                              <MenuItem\n                                key={app.getUUID()}\n                                onClick={() => activateAppRegistration(app)}\n                              >\n                                {app.getTitle()}\n                              </MenuItem>\n                            ))}\n                        </SubMenu>\n                        {\n                          // TODO: Include LED to show state of application (i.e. \"green\" for \"open\" / \"gray\" for \"close\")\n                        }\n                        {appRegistrations\n                          .filter(app => app.getIsPinned())\n                          .map(app => (\n                            <MenuItem\n                              key={app.getUUID()}\n                              onClick={() => activateAppRegistration(app)}\n                            >\n                              {app.getTitle()}\n                            </MenuItem>\n                          ))}\n                        <MenuDivider />\n                        <MenuHeader>Global Window Management</MenuHeader>\n                        <MenuItem\n                          // TODO: Refactor\n                          onClick={() =>\n                            appRuntimes.forEach(runtime => {\n                              const windowController =\n                                runtime.getWindowController();\n\n                              if (windowController) {\n                                windowController.scatter();\n                              }\n                            })\n                          }\n                        >\n                          Scatter Windows\n                        </MenuItem>\n                        <MenuItem\n                          // TODO: Refactor\n                          onClick={() =>\n                            appRuntimes.forEach(runtime => {\n                              const windowController =\n                                runtime.getWindowController();\n\n                              if (windowController) {\n                                windowController.center();\n                              }\n                            })\n                          }\n                        >\n                          Center Windows\n                        </MenuItem>\n                        <MenuDivider />\n                        <MenuHeader>Desktop Operations</MenuHeader>\n                        <MenuItem\n                          onClick={() =>\n                            window.confirm(\n                              \"Are you sure you wish to close the desktop?\"\n                            ) && ReShellCore.destroy()\n                          }\n                        >\n                          Close\n                        </MenuItem>\n                        <MenuItem\n                          onClick={() =>\n                            window.confirm(\n                              \"Are you sure you wish to reload?\"\n                            ) && ReShellCore.reload()\n                          }\n                        >\n                          Reload\n                        </MenuItem>\n                      </Menu>\n                      {activeWindowController && (\n                        <>\n                          {\n                            // TODO: Implement quadrant snapping here\n                          }\n                          <Menu\n                            portal={true}\n                            menuButton={\n                              <MenuButton>\n                                <span style={{ fontWeight: \"bold\" }}>\n                                  {activeWindowController.getTitle()}\n                                </span>\n                              </MenuButton>\n                            }\n                          >\n                            <MenuItem\n                              onClick={() => {\n                                if (!activeWindowController.getIsDestroying()) {\n                                  activeWindowController.destroy();\n                                }\n                              }}\n                            >\n                              Close\n                            </MenuItem>\n                          </Menu>\n                          <Menu\n                            portal={true}\n                            menuButton={<MenuButton>Window</MenuButton>}\n                          >\n                            {\n                              // TODO: Refresh items when activeWindowController updates\n                            }\n                            <MenuItem\n                              onClick={() =>\n                                activeWindowController.setIsMinimized(true)\n                              }\n                              // disabled={activeWindowController?.getIsMinimized()}\n                            >\n                              Minimize\n                            </MenuItem>\n                            <MenuItem\n                              onClick={() =>\n                                activeWindowController.setIsMaximized(true)\n                              }\n                              // disabled={activeWindowController?.getIsMaximized()}\n                            >\n                              Maximize\n                            </MenuItem>\n                            <MenuItem\n                              onClick={() => activeWindowController.restore()}\n                              // disabled={}\n                            >\n                              Restore\n                            </MenuItem>\n                            <MenuDivider />\n                            <MenuItem\n                              onClick={() => activeWindowController.center()}\n                            >\n                              Center\n                            </MenuItem>\n                            <MenuItem\n                              onClick={() => activeWindowController.scatter()}\n                            >\n                              Scatter\n                            </MenuItem>\n                          </Menu>\n                        </>\n                      )}\n                    </div>\n                  </Column>\n                  <Column\n                    style={{\n                      // TODO: Rework so column width expands according to content\n                      maxWidth: 110,\n                    }}\n                  >\n                    <div style={{ textAlign: \"right\" }}>\n                      <Menu\n                        portal={true}\n                        menuButton={\n                          <MenuButton>\n                            Service Core{\" \"}\n                            <LED\n                              color={services.length > 0 ? \"green\" : \"gray\"}\n                            />\n                          </MenuButton>\n                        }\n                      >\n                        {services.length === 0 ? (\n                          <MenuItem>\n                            <span style={{ fontStyle: \"italic\" }}>\n                              No running services\n                            </span>\n                          </MenuItem>\n                        ) : (\n                          services.map(service => (\n                            <MenuItem\n                              key={service.getUUID()}\n                              // TODO: Open direct service in service monitor\n                              onClick={openServiceMonitor}\n                            >\n                              {service.getTitle()}\n                            </MenuItem>\n                          ))\n                        )}\n                      </Menu>\n                    </div>\n                  </Column>\n                </Row>\n              </Header>\n              <Content>\n                {\n                  // TODO: Allow videos to play on background\n                }\n\n                {\n                  // TODO: Refactor into a version component\n                }\n                <div\n                  style={{\n                    maxWidth: \"50%\",\n                    position: \"absolute\",\n                    bottom: 28,\n                    right: 10,\n                    color: \"rgba(255,255,255,.2)\",\n                    fontSize: \"2rem\",\n                  }}\n                >\n                  {\n                    // TODO: Read from package.json\n                    // @see https://stackoverflow.com/questions/48609931/how-can-i-reference-package-version-in-npm-script/48619640\n                    // (i.e. REACT_APP_VERSION=$npm_package_version)\n                    //\n                    // TODO: If wanting to overlay completely on top of all other windows, and ignore mouse, etc:\n                    // use CSS [pointer-events: none]\n                  }\n                  <AutoScaler style={{ whiteSpace: \"nowrap\" }}>\n                    <div style={{ textAlign: \"left\", fontSize: \".7em\" }}>\n                      {\n                        // TODO: Load as env variable\n                      }\n                      <div>ReShell {ReShellCore.getReShellVersion()}</div>\n                      <div>\n                        PhantomCore {PhantomCore.getPhantomCoreVersion()}\n                      </div>\n                      <div>Portal: {ReShellCore.getPortalName()}</div>\n                      <div>Env: {process.env.NODE_ENV}</div>\n                    </div>\n                  </AutoScaler>\n                </div>\n                <WindowManager appDescriptors={appDescriptors}>\n                  <Dock />\n                </WindowManager>\n              </Content>\n            </Layout>\n          </Cover>\n        </NotificationProvider>\n      </ModalProvider>\n    </FullViewport>\n  );\n}\n","import VirtualLink from \"./VirtualLink\";\n\nexport default VirtualLink;\n","import ButtonTransparent from \"../ButtonTransparent\";\n\nimport styles from \"./VirtualLink.module.css\";\nimport classNames from \"classnames\";\n\n/**\n * NOTE: Fake links need to be a button, so this button is designed to look\n * like a real link, for the most part.\n */\nexport default function VirtualLink({ children, className, onClick, ...rest }) {\n  return (\n    <ButtonTransparent\n      {...rest}\n      // IMPORTANT: The seemingly double link styles are placed on purpose (one\n      // is the normal CSS, and the other is the module.css override)\n      className={classNames(\"link\", styles[\"virtual-link\"], className)}\n      onClick={onClick}\n    >\n      {children}\n    </ButtonTransparent>\n  );\n}\n","import { useEffect, useMemo } from \"react\";\n\nconst DEFAULT_PROPS = {\n  onKeyDown: keyCode => null,\n  onKeyUp: keyCode => null,\n  onEnter: () => null,\n  onEscape: () => null,\n  isEnabled: true,\n};\n\n/**\n * Binds keyboard event handlers to the given DOM element.\n * \n * @param {DOMElement} domNode \n * @param {Object} props TODO: Document structure\n */\nexport default function useKeyboardEvents(domNode, props = {}) {\n  const { onKeyDown, onKeyUp, onEnter, onEscape, isEnabled } = useMemo(\n    () => ({ ...DEFAULT_PROPS, ...props }),\n    [props]\n  );\n\n  useEffect(() => {\n    if (!domNode || !isEnabled) {\n      return;\n    }\n\n    const _handleKeyDown = evt => {\n      // Prevent repeated calls from holding down a key\n      if (evt.repeat) {\n        return;\n      }\n\n      onKeyDown(evt.which);\n\n      switch (evt.which) {\n        case 13:\n          onEnter();\n          break;\n\n        case 27:\n          onEscape();\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    const _handleKeyUp = evt => {\n      evt.preventDefault();\n\n      onKeyUp(evt.which);\n    };\n\n    domNode.addEventListener(\"keydown\", _handleKeyDown);\n    domNode.addEventListener(\"keyup\", _handleKeyUp);\n\n    return function unmount() {\n      domNode.removeEventListener(\"keydown\", _handleKeyDown);\n      domNode.removeEventListener(\"keyup\", _handleKeyUp);\n    };\n  }, [domNode, onKeyDown, onKeyUp, onEnter, onEscape, isEnabled]);\n}\n","/**\n * Consumes a variable without using it.\n *\n * @param {any} obj\n * @return {null}\n */\nexport default function consume(obj) {\n  return Boolean(obj) ? null : null;\n}\n","import { useMemo } from \"react\";\nimport Center from \"@components/Center\";\nimport LED from \"@components/LED\";\nimport Padding from \"@components/Padding\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nimport consume from \"@utils/consume\";\n\nexport default function ApplicationSelector({\n  searchQuery = \"\",\n  onResetSearchQuery,\n}) {\n  const { appRegistrations, appRuntimes, activateAppRegistration } =\n    useAppOrchestrationContext();\n\n  const appRuntimeRegistrations = useMemo(\n    () => appRuntimes.map(runtime => runtime.getRegistration()),\n    [appRuntimes]\n  );\n\n  // TODO: Move application search into a service and implement keyword-based\n  // searching, other criteria\n  const filteredRegistrations = useMemo(\n    () =>\n      appRegistrations.filter(registration =>\n        !Boolean(searchQuery)\n          ? true\n          : registration\n              .getTitle()\n              .toUpperCase()\n              .includes(searchQuery.toUpperCase())\n      ),\n    [appRegistrations, searchQuery]\n  );\n\n  if (searchQuery?.length && !filteredRegistrations.length) {\n    return (\n      <Center>\n        <Padding style={{ fontWeight: \"bold\" }}>\n          No applications found for search.\n        </Padding>\n        <Padding>\n          <button onClick={onResetSearchQuery}>Reset Search Query</button>\n        </Padding>\n      </Center>\n    );\n  }\n\n  return (\n    <Center canOverflow={true}>\n      <Padding>\n        {filteredRegistrations.map(registration => {\n          // const isRunning = appRuntimeRegistrations.includes(registration);\n          const totalInstances = appRuntimeRegistrations.filter(\n            predicate => predicate === registration\n          ).length;\n\n          return (\n            <button\n              key={registration.getUUID()}\n              // TODO: Extract to module.css\n              style={{\n                width: 100,\n                height: 100,\n                overflow: \"hidden\",\n                backgroundColor: \"transparent\",\n                borderColor: totalInstances > 0 ? \"green\" : \"\",\n              }}\n              onClick={() => activateAppRegistration(registration)}\n            >\n              {registration.getTitle()}\n              <div style={{ position: \"absolute\", bottom: 0, right: 0 }}>\n                {[...new Array(totalInstances)].map((nonUsed, idx) => {\n                  consume(nonUsed);\n\n                  return (\n                    <LED\n                      key={idx}\n                      color={totalInstances > 0 ? \"green\" : \"gray\"}\n                      // TODO: Extract to module.css\n                      style={{ margin: \"0px 2px\" }}\n                    />\n                  );\n                })}\n              </div>\n            </button>\n          );\n        })}\n      </Padding>\n    </Center>\n  );\n}\n","import Center from \"@components/Center\";\n\nimport ReShellCore from \"@core\";\n\nexport default function PortalSwitcher() {\n  return (\n    <Center canOverflow={true}>\n      {Object.entries(ReShellCore.getPortals()).map(([portalName]) => (\n        <button\n          key={portalName}\n          onClick={() =>\n            // TODO: Use dialog modal for this, and dynamically set the title based on the current portal state\n            window.confirm(\n              \"Any unsaved state will be lost and the current call will be dropped if switching portals.  Proceed?\"\n            ) && ReShellCore.switchToPortal(portalName)\n          }\n        >\n          {portalName}\n        </button>\n      ))}\n    </Center>\n  );\n}\n","import ReShellCore from \"@core\";\n\nimport { useCallback, useEffect, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\nimport VirtualLink from \"@components/VirtualLink\";\n\nimport useKeyboardEvents from \"@hooks/useKeyboardEvents\";\n\nimport ApplicationSelector from \"./views/ApplicationSelector\";\nimport PortalSwitcher from \"./views/PortalSelector\";\n\nconst LEN_PORTALS = Object.keys(ReShellCore.getPortals()).length;\n\nconst DEFAULT_SEARCH_QUERY = \"\";\n\nconst ApplicationsApp = {\n  id: \"applications\",\n  title: \"Applications\",\n  style: {\n    width: 640,\n    height: 400,\n  },\n  isAutoStart: true,\n  isPinnedToDock: true,\n  initialSharedState: {\n    searchQuery: DEFAULT_SEARCH_QUERY,\n  },\n  // TODO: Implement the ability to set control handlers which can be driven by the menu\n  /*\n  controlMethods: {\n    // [ROLE_WINDOW_MENU_SUBITEM]\n    setIsDisplayingPortals: ({...samePropsAsView, etc.}) => {\n    }\n  },\n  */\n  // TODO: Implement custom menu functionality\n  /**\n  menu: {\n    window: [\n      {\n        role: 'view-switch'\n        getIsShown: ({sharedState}) => !sharedState.isShowingApplications\n        title: 'Show Applications',\n        onClick: ({controlMethods}) => ...\n      },\n      {\n        role: 'view-switch'\n        getIsShown: ({sharedState}) => sharedState.isShowingApplications\n        title: 'Show Portals',\n        onClick: ({controlMethods}) => ...\n      },\n  ]\n  }\n  */\n  titleBarView: function TitleBarView({ sharedState, setSharedState }) {\n    const [elSearch, setElSearch] = useState(null);\n\n    // Clear search query on escape\n    useKeyboardEvents(elSearch, {\n      onEscape: () => setSharedState({ searchQuery: \"\" }),\n    });\n\n    const handleSetSearchQuery = useCallback(\n      evt => setSharedState({ searchQuery: evt.target.value }),\n      [setSharedState]\n    );\n\n    const handleDoubleClick = useCallback(\n      evt => {\n        // Prevent double-clicks from resizing the window if there is text in\n        // the search bar (i.e. so that all text can be selected w/ the\n        // gesture)\n        if (Boolean(sharedState.searchQuery)) {\n          evt.stopPropagation();\n        }\n      },\n      [sharedState]\n    );\n\n    return (\n      <Padding>\n        {\n          // TODO: Automatically focus when window is activated (unless on mobile)\n          // TODO: Switch to Applications view on change\n          // FIXME: (jh) I tried to use type=\"search\", which gives you an X in\n          // the input field, however I wasn't able to make it clear itself. If\n          // this were an uncontrolled component, it might work. Needs some\n          // refactoring.\n        }\n        <input\n          ref={setElSearch}\n          placeholder=\"Search Applications\"\n          onChange={handleSetSearchQuery}\n          value={sharedState.searchQuery}\n          style={{ width: \"100%\" }}\n          onDoubleClick={handleDoubleClick}\n        />\n      </Padding>\n    );\n  },\n  view: function View({ windowController, sharedState, setSharedState }) {\n    const [isDisplayingPortals, setIsDisplayingPortals] = useState(false);\n\n    // Auto-switch window title depending on \"Applications\" or \"Portals\" mode\n    useEffect(() => {\n      windowController.setTitle(\n        // TODO: Use default values instead of hardcoded\n        !isDisplayingPortals ? \"Applications\" : \"Portals\"\n      );\n    }, [windowController, isDisplayingPortals]);\n\n    const searchQuery = sharedState?.searchQuery;\n\n    const handleResetSearchQuery = useCallback(\n      () => setSharedState({ searchQuery: DEFAULT_SEARCH_QUERY }),\n      [setSharedState]\n    );\n\n    return (\n      <Layout>\n        <Content>\n          {!isDisplayingPortals ? (\n            <ApplicationSelector\n              searchQuery={searchQuery}\n              onResetSearchQuery={handleResetSearchQuery}\n            />\n          ) : (\n            <PortalSwitcher />\n          )}\n        </Content>\n        {Boolean(LEN_PORTALS > 1) && (\n          <Footer>\n            <Padding>\n              <button onClick={() => setIsDisplayingPortals(prev => !prev)}>\n                {!isDisplayingPortals ? \"Portals\" : \"Applications\"}\n              </button>{\" \"}\n              <span className=\"note\">\n                {!isDisplayingPortals ? (\n                  <>\n                    Other applications may be available in{\" \"}\n                    <VirtualLink onClick={() => setIsDisplayingPortals(true)}>\n                      another portal\n                    </VirtualLink>\n                    .\n                  </>\n                ) : (\n                  <>\n                    Return to{\" \"}\n                    <VirtualLink onClick={() => setIsDisplayingPortals(false)}>\n                      application list\n                    </VirtualLink>\n                    .\n                  </>\n                )}\n              </span>\n            </Padding>\n          </Footer>\n        )}\n      </Layout>\n    );\n  },\n};\n\nexport default ApplicationsApp;\n","import ApplicationsApp from \"./ApplicationsApp\";\n\nexport default ApplicationsApp;\n","import ApplicationsApp from \"../../ExamplePortal/apps/ApplicationsApp\";\n\nconst ApplicationsOverrideApp = {\n  ...ApplicationsApp,\n  isAutoStart: false,\n};\n\nexport default ApplicationsOverrideApp;\n","import consume from \"@utils/consume\";\nimport { useEffect, useState } from \"react\";\nimport Timer from \"@components/Timer\";\nimport { EVT_RENDER_PROFILED } from \"@components/Window/classes/WindowController\";\nimport LED from \"@components/LED\";\n\nimport useDesktopContext from \"@hooks/useDesktopContext\";\n\nexport default function AppRuntimeTableRow({ appRuntime }) {\n  const { activeWindowController } = useDesktopContext();\n\n  const windowController = appRuntime.getWindowController();\n\n  const isTopMostWindowController =\n    !windowController || windowController === activeWindowController;\n\n  const [elProfilerPhase, setElProfilerPhase] = useState(null);\n  const [elProfilerActualDuration, setElProfilerActualDuration] =\n    useState(null);\n  const [elProfilerBaseDuration, setElProfilerBaseDuration] = useState(null);\n  const [elProfilerStartTime, setElProfilerStartTime] = useState(null);\n  const [elProfilerCommitTime, setElProfilerCommitTime] = useState(null);\n  const [elProfilerInteractions, setElProfilerInteractions] = useState(null);\n\n  useEffect(() => {\n    if (windowController && elProfilerPhase) {\n      // @see https://reactjs.org/docs/profiler.html\n      const handleRenderProfile = arrRenderProfile => {\n        // IMPORTANT: (jh) This was not cast to an Object because I'm not\n        // positive if that would induce a lot of extra overhead over time;\n        // React defines this as an array, so maybe it's best just leaving it\n        // the way it is\n        const [\n          id, // the \"id\" prop of the Profiler tree that has just committed\n          phase, // either \"mount\" (if the tree just mounted) or \"update\" (if it re-rendered)\n          actualDuration, // time spent rendering the committed update\n          baseDuration, // estimated time to render the entire subtree without memoization\n          startTime, // when React began rendering this update\n          commitTime, // when React committed this update\n          interactions, // the Set of interactions belonging to this update\n        ] = arrRenderProfile;\n\n        // We're not doing anything w/ id, but if we remove it from the array,\n        // the other variable names are out of sync\n        consume(id);\n\n        // We have to skip setting these as state or we'll run into an infinite loop\n        elProfilerPhase.innerHTML = phase;\n        elProfilerActualDuration.innerHTML =\n          parseFloat(actualDuration).toFixed(2);\n        elProfilerBaseDuration.innerHTML = parseFloat(baseDuration).toFixed(2);\n        elProfilerStartTime.innerHTML = parseFloat(startTime / 1000).toFixed(2);\n        elProfilerCommitTime.innerHTML = parseFloat(commitTime / 1000).toFixed(\n          2\n        );\n        elProfilerInteractions.innerHTML = Object.values(interactions).length;\n      };\n\n      windowController.on(EVT_RENDER_PROFILED, handleRenderProfile);\n\n      return function unmount() {\n        windowController.off(EVT_RENDER_PROFILED, handleRenderProfile);\n      };\n    }\n  }, [\n    windowController,\n    elProfilerPhase,\n    elProfilerActualDuration,\n    elProfilerBaseDuration,\n    elProfilerStartTime,\n    elProfilerCommitTime,\n    elProfilerInteractions,\n  ]);\n\n  return (\n    <>\n      <tr key={appRuntime.getUUID()} style={{ textAlign: \"center\" }}>\n        <td>{appRuntime.getTitle() || \"[Untitled]\"}</td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerPhase}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerActualDuration}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerBaseDuration}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerStartTime}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerCommitTime}>N/A</span>\n        </td>\n        <td style={{ backgroundColor: \"purple\" }}>\n          <span ref={setElProfilerInteractions}>N/A</span>\n        </td>\n      </tr>\n      <tr style={{ textAlign: \"center\" }}>\n        <td style={{ fontStyle: \"italic\" }}>\n          Uptime: <Timer onTick={() => appRuntime.getInstanceUptime()} />\n        </td>\n        <td colSpan=\"3\">\n          <button\n            // TODO: Implement alternate handling\n            onClick={() => console.log({ appRuntime })}\n            disabled\n          >\n            Process\n          </button>\n          <span> | </span>\n          <button\n            // TODO: Implement alternate handling\n            onClick={() =>\n              console.log({ environment: appRuntime.getEnvironment() })\n            }\n            disabled\n          >\n            Environment\n          </button>\n        </td>\n        <td>\n          <LED color={isTopMostWindowController ? \"green\" : \"gray\"} />\n        </td>\n        <td colSpan=\"2\">\n          <button\n            onClick={() => windowController.bringToTop()}\n            style={{ backgroundColor: \"blue\" }}\n            disabled={isTopMostWindowController}\n          >\n            Bring to Top\n          </button>\n          <span> | </span>\n          <button\n            onClick={() => {\n              if (!appRuntime.getIsDestroying()) {\n                appRuntime.destroy();\n              }\n            }}\n            style={{ backgroundColor: \"red\" }}\n          >\n            Close\n          </button>\n        </td>\n      </tr>\n      <tr>\n        <td colSpan=\"7\" style={{ backgroundColor: \"gray\", height: 4 }}></td>\n      </tr>\n    </>\n  );\n}\n","import AppRuntimeTableRow from \"./AppRuntime.Table.Row\";\n\n// TODO: Document\nexport default function AppRuntimeTable({ appRuntimes }) {\n  return (\n    <table style={{ width: \"100%\" }}>\n      <thead>\n        <tr>\n          <td rowSpan=\"2\">Name</td>\n          <td colSpan=\"6\" style={{ backgroundColor: \"purple\" }}>\n            Profiler\n          </td>\n          <td colSpan=\"2\"></td>\n        </tr>\n        <tr>\n          <td style={{ backgroundColor: \"purple\" }}>Phase</td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Actual\n            <br />\n            Duration\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Base\n            <br />\n            Duration\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Start\n            <br />\n            Time\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>\n            Commit\n            <br />\n            Time\n          </td>\n          <td style={{ backgroundColor: \"purple\" }}>Interactions</td>\n        </tr>\n      </thead>\n      <tbody>\n        {appRuntimes.map((runtime) => (\n          <AppRuntimeTableRow key={runtime.getUUID()} appRuntime={runtime} />\n        ))}\n      </tbody>\n    </table>\n  );\n}\n","import PhantomCore from \"phantom-core\";\n\nimport Padding from \"@components/Padding\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport AppRuntimeTable from \"./AppRuntime.Table\";\nimport Timer from \"@components/Timer\";\n\nimport useAppOrchestrationContext from \"@hooks/useAppOrchestrationContext\";\n\nconst ApplicationMonitorApp = {\n  id: \"application-monitor\",\n  title: \"Application Monitor\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  isPinned: true,\n  view: function View() {\n    const { appRuntimes } = useAppOrchestrationContext();\n\n    // TODO: Determine if profiler is available in the current environment\n\n    // TODO: Group by registration\n    // TODO: Show attached services, per application\n    // TODO: Show last render time / frequency / graph?\n    // TODO: Implement ability to record render profile intervals, with the ability to show them in a graph (per application; use legend)\n    // TODO: Implement ability to show how linked services affect render profiles; capture in recordings\n    // TODO: Implement ability to do call stack tracing (only when recording)\n\n    return (\n      <Layout>\n        <Content>\n          <Padding style={{ overflowY: \"auto\" }}>\n            <AppRuntimeTable appRuntimes={appRuntimes} />\n          </Padding>\n        </Content>\n        <Footer style={{ fontSize: \".8rem\" }}>\n          <Padding>\n            PhantomCore uptime: <Timer onTick={() => PhantomCore.getUptime()} />\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ApplicationMonitorApp;\n","import ApplicationMonitorApp from \"./ApplicationMonitorApp\";\n\nexport default ApplicationMonitorApp;\n","import ButtonPanel from \"./ButtonPanel\";\n\nexport default ButtonPanel;\n","import React, { useRef, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\n\nButtonPanel.propTypes = {\n  buttons: PropTypes.arrayOf(\n    PropTypes.shape({\n      // TODO: Require to be React component (or any?)\n      // TODO: Rename to view, or label\n      content: PropTypes.any.isRequired,\n\n      onClick: PropTypes.func.isRequired,\n\n      type: PropTypes.string,\n\n      disabled: PropTypes.bool,\n\n      // Optional style override\n      style: PropTypes.string,\n\n      // Optional style override\n      className: PropTypes.string,\n\n      /** If set to true, this acts as the default button */\n      isSelected: PropTypes.bool,\n    })\n  ),\n};\n\nexport default function ButtonPanel({ buttons, className, ...rest }) {\n  const [selectedIdx, setSelectedIdx] = useState(() => {\n    let selectedIdx = 0;\n\n    buttons.forEach((button, idx) => {\n      if (button.isSelected) {\n        selectedIdx = idx;\n      }\n    });\n\n    return selectedIdx;\n  });\n\n  // TODO: Document\n  const refRenderIdx = useRef(-1);\n  ++refRenderIdx.current;\n\n  return (\n    <div className={classNames(\"button-group\", className)} {...rest}>\n      {buttons.map(\n        (\n          {\n            content: Content,\n            onClick,\n            disabled,\n            isSelected,\n            style,\n            className,\n            type = \"button\",\n            ...args\n          },\n          idx\n        ) => {\n          // If first render, and we're at the defaultSelectedIdx, call the onClick handler\n          // TODO: Detect if first render of React after page updates\n          if (refRenderIdx.current === 0 && selectedIdx === idx) {\n            // Fixes issue:  Cannot update a component (`X`) while rendering a\n            // different component (`Y`).\n            setTimeout(() => {\n              onClick();\n            });\n          }\n\n          return (\n            <button\n              {...args}\n              key={idx}\n              type={type}\n              onClick={() => {\n                setSelectedIdx(idx);\n\n                onClick();\n              }}\n              disabled={disabled}\n              style={style}\n              className={classNames([\n                selectedIdx === idx && \"active\",\n                className,\n              ])}\n            >\n              {\n                // TODO: Refactor\n                typeof Content === \"string\" ? (\n                  Content\n                ) : typeof Content === \"function\" ? (\n                  <Content />\n                ) : (\n                  { Content }\n                )\n              }\n            </button>\n          );\n        }\n      )}\n    </div>\n  );\n}\n","import ExternalLink from \"./ExternalLink\";\n\nexport default ExternalLink;\n","export default function ExternalLink({ children, target = \"_blank\", ...rest }) {\n  return (\n    <a {...rest} target={target}>\n      {children}\n    </a>\n  );\n}\n","import ExternalLinkButton from \"./ExternalLinkButton\";\n\nexport default ExternalLinkButton;\n","// TODO: Document w/ prop-types\nexport default function ExternalLinkButton({\n  href,\n  target = \"_blank\",\n  ...rest\n}) {\n  return (\n    <button\n      {...rest}\n      // TODO: Refactor to useCallback\n      onClick={() => window.open(href, target)}\n    />\n  );\n}\n","import Full from \"@components/Full\";\nimport Padding from \"@components/Padding\";\nimport ExternalLink from \"@components/ExternalLink\";\nimport ExternalLinkButton from \"@components/ExternalLinkButton\";\n\nconst LINKS = {\n  PhantomCore: \"https://github.com/zenOSmosis/phantom-core\",\n  PhantomCollection:\n    \"https://github.com/zenOSmosis/phantom-core/tree/main/src/PhantomCollection\",\n\n  ReShellCore: \"https://github.com/zenOSmosis/reshell.org-static\",\n\n  SyncObject: \"https://github.com/zenOSmosis/sync-object\",\n  MediaStreamController:\n    \"https://github.com/zenOSmosis/media-stream-track-controller\",\n  WebRTCPeer: \"https://github.com/zenOSmosis/webrtc-peer\",\n};\n\n// TODO: Refactor\nconst LINK_BUTTON_STYLE = {\n  minHeight: \"4em\",\n  whiteSpace: \"wrap\",\n  width: \"100%\",\n  height: \"100%\",\n};\n\nexport default function Details() {\n  return (\n    <Full style={{ overflowY: \"auto\" }}>\n      <p>\n        ReShell is a browser-based layout framework and UI services engine\n        composed of various{\" \"}\n        <a\n          href=\"https://github.com/zenosmosis\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n        >\n          open-source components\n        </a>\n        .\n      </p>\n      <p>\n        It is currently in an alpha phase, and other builds may have other\n        built-in applications.\n      </p>\n      <p>\n        Leveraged off of the core code for{\" \"}\n        <ExternalLink href=\"https://speaker.app\">Speaker.app</ExternalLink> and\n        other{\" \"}\n        <ExternalLink href=\"https://zenosmosis.com\">zenOSmosis</ExternalLink>{\" \"}\n        projects based on{\" \"}\n        <ExternalLink href=\"https://github.com/zenOSmosis/phantom-core\">\n          PhantomCore\n        </ExternalLink>\n        , a library for managing the JavaScript application lifecycle.\n      </p>\n\n      <p style={{ fontWeight: \"bold\" }}>Some included technologies:</p>\n\n      <div style={{ textAlign: \"center\" }}>\n        <div\n          style={{ display: \"inline-grid\", gridTemplateColumns: \"1fr 1fr 1fr\" }}\n        >\n          {Object.entries(LINKS).map(([title, urlOrAction], idx) => {\n            return (\n              <Padding key={idx}>\n                {typeof urlOrAction === \"string\" ? (\n                  <ExternalLinkButton\n                    href={urlOrAction}\n                    style={LINK_BUTTON_STYLE}\n                  >\n                    {title}\n                  </ExternalLinkButton>\n                ) : (\n                  <button onClick={urlOrAction} style={LINK_BUTTON_STYLE}>\n                    {title}\n                  </button>\n                )}\n              </Padding>\n            );\n          })}\n        </div>\n      </div>\n    </Full>\n  );\n}\n","import Details from \"./Details\";\n\nexport default Details;\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport ExternalLink from \"@components/ExternalLink\";\n\nconst LINKS = {\n  zenOSmosis: \"https://zenOSmosis.com\",\n  GitHub: \"https://github.com/zenosmosis\",\n  \"Speaker.app\": \"https://speaker.app\",\n};\n\nexport default function Resources() {\n  return (\n    <Center canOverflow={true}>\n      <p style={{ fontWeight: \"bold\" }}>Additional resources:</p>\n      <div style={{ display: \"inline-block\", textAlign: \"left\" }}>\n        {Object.entries(LINKS).map(([name, url], idx) => (\n          <Padding key={idx}>\n            {name}:{\" \"}\n            {\n              // TODO: Use ExternalLink component for this\n            }\n            <ExternalLink href={url}>{url}</ExternalLink>\n          </Padding>\n        ))}\n      </div>\n\n      <hr />\n\n      <p>\n        To contact us directly, email:{\" \"}\n        <ExternalLink href=\"mailto:info@zenosmosis.com\">\n          info@zenosmosis.com\n        </ExternalLink>\n        .\n      </p>\n    </Center>\n  );\n}\n","import Resources from \"./Resources\";\n\nexport default Resources;\n","const FULL_YEAR = new Date().getFullYear();\n\n/**\n * @return {string}\n */\nexport default function getCopyright() {\n  return `Copyright © 2010 - ${FULL_YEAR} zenOSmosis. All rights reserved.`;\n}\n","import Padding from \"@components/Padding\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport AutoScaler from \"@components/AutoScaler\";\nimport ButtonPanel from \"@components/ButtonPanel\";\nimport VirtualLink from \"@components/VirtualLink\";\nimport NoWrap from \"@components/NoWrap\";\n\nimport Details from \"./views/Details\";\nimport Resources from \"./views/Resources\";\n\nimport getCopyright from \"@utils/getCopyright\";\n\n// TODO: Include ReShell documentation here, as well as architecture overview\n\n// TODO: Include property for \"about\" view (per app), where its rendered HTML can be utilized for SEO purposes\n\n// TODO: Include license link type: https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types\n\n// TODO: Include \"declarative API\" (it is React, but the components themselves\n// do their base to abstract away logic w/ their opinionated internal handling,\n// while trying to stay very performant themselves)\n\nexport const REGISTRATION_ID = \"about-reshell\";\n\nconst AboutReShellApp = {\n  id: REGISTRATION_ID,\n  title: \"About ReShell\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  initialSharedState: {\n    screen: \"overview\",\n  },\n  titleBarView: function TitleBarView({ sharedState, setSharedState }) {\n    /*\n    const handleSetSearchQuery = useCallback(\n      evt => setSharedState({ searchQuery: evt.target.value }),\n      [setSharedState]\n    );\n\n    const handleDoubleClick = useCallback(\n      evt => {\n        // Prevent double-clicks from resizing the window if there is text in\n        // the search bar\n        if (Boolean(sharedState.searchQuery)) {\n          evt.stopPropagation();\n        }\n      },\n      [sharedState]\n    );\n    */\n\n    return (\n      <Padding>\n        <ButtonPanel\n          // Force update if the screen changes\n          key={sharedState.screen}\n          buttons={[\n            {\n              content: \"Overview\",\n              onClick: () => setSharedState({ screen: \"overview\" }),\n              isSelected: sharedState.screen === \"overview\",\n            },\n            {\n              content: \"Details\",\n              onClick: () => setSharedState({ screen: \"details\" }),\n              isSelected: sharedState.screen === \"details\",\n            },\n            {\n              content: \"Resources\",\n              onClick: () => setSharedState({ screen: \"resources\" }),\n              isSelected: sharedState.screen === \"resources\",\n            },\n          ]}\n        />\n      </Padding>\n    );\n  },\n  view: function View({ sharedState, setSharedState }) {\n    return (\n      <Padding>\n        <Layout>\n          <Content>\n            {sharedState.screen === \"overview\" && (\n              <AutoScaler>\n                <Center>\n                  <div style={{ fontSize: \"8rem\", fontStyle: \"italic\" }}>\n                    ReShell\n                  </div>\n                  <NoWrap style={{ fontSize: \"1.5rem\" }}>\n                    App layout framework and UI services engine\n                  </NoWrap>\n                </Center>\n              </AutoScaler>\n            )}\n\n            {sharedState.screen === \"details\" && <Details />}\n\n            {sharedState.screen === \"resources\" && <Resources />}\n          </Content>\n          <Footer style={{ textAlign: \"center\" }}>\n            {sharedState.screen === \"overview\" && (\n              <p>\n                <VirtualLink\n                  onClick={() => setSharedState({ screen: \"details\" })}\n                >\n                  Details\n                </VirtualLink>{\" \"}\n                |{\" \"}\n                <VirtualLink\n                  onClick={() => setSharedState({ screen: \"resources\" })}\n                >\n                  Resources\n                </VirtualLink>\n              </p>\n            )}\n\n            <div style={{ opacity: 0.5 }}>{getCopyright()}</div>\n\n            {/*\n              <div style={{ padding: 4 }}>\n               Get\n              started with{\" \"}\n              {\n                // TODO: Make link\n              }\n              <span style={{ color: \"orange\", textDecoration: \"underline\" }}>\n                wrapping your app with ReShell\n              </span>\n              .\n            </div>\n              */}\n          </Footer>\n        </Layout>\n      </Padding>\n    );\n  },\n};\n\nexport default AboutReShellApp;\n","import AboutReShellApp, { REGISTRATION_ID } from \"./AboutReShellApp\";\n\nexport default AboutReShellApp;\nexport { REGISTRATION_ID };\n","import AboutReShellApp from \"../../ExamplePortal/apps/AboutReShellApp\";\n\nconst AboutReShellOverrideApp = {\n  ...AboutReShellApp,\n  isAutoStart: true,\n};\n\nexport default AboutReShellOverrideApp;\n","import ReShellCore from \"@core\";\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport Center from \"@components/Center\";\nimport Layout, { Header, Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\n\nimport fetchIsLatestVersion from \"@utils/fetchIsLatestVersion\";\n\nimport dayjs from \"dayjs\";\n\nexport const REGISTRATION_ID = \"check-for-updates\";\n\nconst CheckForUpdatesApp = {\n  id: REGISTRATION_ID,\n  title: \"Check for Updates\",\n  style: {\n    width: 320,\n    height: 240,\n  },\n  isPinned: true,\n  view: function View() {\n    const [isLatest, setIsLatest] = useState(true);\n    const [isChecking, setIsChecking] = useState(false);\n    const [isError, setIsError] = useState(false);\n    const [lastCheckTime, setLastCheckTime] = useState(null);\n\n    const refIsChecking = useRef(null);\n    refIsChecking.current = isChecking;\n\n    // TODO: Refactor into service\n    const handleCheckForUpdates = useCallback(async () => {\n      const isChecking = refIsChecking.current;\n\n      if (isChecking) {\n        return;\n      }\n\n      try {\n        setIsError(false);\n        setIsChecking(true);\n\n        const isLatest = await fetchIsLatestVersion();\n\n        setIsLatest(isLatest);\n      } catch (err) {\n        console.error(err);\n\n        setIsError(true);\n        setIsLatest(false);\n      } finally {\n        setIsChecking(false);\n        setLastCheckTime(new Date().getTime());\n      }\n    }, []);\n\n    // Automatically check for updates when app starts\n    useEffect(() => {\n      handleCheckForUpdates();\n    }, [handleCheckForUpdates]);\n\n    return (\n      <Layout>\n        <Header>\n          <Padding style={{ textAlign: \"center\" }}>\n            <button onClick={handleCheckForUpdates} disabled={isChecking}>\n              Check for Updates\n            </button>\n          </Padding>\n        </Header>\n        <Content>\n          <Center canOverflow={true}>\n            {isError ? (\n              <>\n                <p>\n                  There was an error checking for updates.{\" \"}\n                  <button onClick={handleCheckForUpdates}>Try again?</button>\n                </p>\n              </>\n            ) : isLatest ? (\n              <p>You appear to be running the latest version of ReShell.</p>\n            ) : (\n              <>\n                <p>\n                  Your version of ReShell appears out of date.{\" \"}\n                  <button onClick={() => ReShellCore.forceUpdate()}>\n                    Refresh?\n                  </button>\n                </p>\n              </>\n            )}\n          </Center>\n        </Content>\n        <Footer>\n          <Padding>\n            <div className=\"note\">\n              Last checked:{\" \"}\n              {lastCheckTime ? dayjs(lastCheckTime).format(\"LLL\") : \"N/A\"}\n            </div>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default CheckForUpdatesApp;\n","import CheckForUpdatesApp, { REGISTRATION_ID } from \"./CheckForUpdatesApp\";\n\nexport default CheckForUpdatesApp;\nexport { REGISTRATION_ID };\n","import ColorAdjusterApp from \"./ColorAdjusterApp\";\n\nexport default ColorAdjusterApp;\n","import { useState, useEffect } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\n\nimport styles from \"./ColorAdjuster.module.css\";\n\nconst ColorAdjusterApp = {\n  id: \"color-adjuster\",\n  title: \"Color Adjuster\",\n  style: {\n    width: 640,\n    height: 400,\n  },\n  // serviceClasses: [],\n  view: function View({ windowController, appServices }) {\n    // TODO: Add service state; fix issue where if choosing grayscale, closing, then re-opening disables grayscale\n    const [isGrayscale, setIsGrayscale] = useState(false);\n\n    useEffect(() => {\n      if (isGrayscale) {\n        document.body.classList.add(\"grayscale\");\n      } else {\n        document.body.classList.remove(\"grayscale\");\n      }\n    }, [isGrayscale]);\n\n    return (\n      <Layout className={styles[\"color-adjuster\"]}>\n        <Content>\n          <Center>\n            <button onClick={() => setIsGrayscale(prev => !prev)}>\n              {isGrayscale ? \"Disable\" : \"Enable\"} Grayscale\n            </button>\n          </Center>\n        </Content>\n        <Footer>\n          {\n            // @see https://color.adobe.com/create/color-wheel\n\n            [\"#B04628\", \"#B9FC6D\", \"#FC7853\", \"#3A65FC\", \"#314EB0\"].map(\n              (color, idx) => (\n                <div\n                  key={idx}\n                  style={{\n                    backgroundColor: color,\n                    height: 100,\n                    width: \"20%\",\n                    display: \"inline-block\",\n                  }}\n                >\n                  <Center>\n                    <span\n                      style={{\n                        padding: 4,\n                        backgroundColor: \"rgba(0,0,0,.4)\",\n                        borderRadius: 4,\n                      }}\n                    >\n                      {color}\n                    </span>\n                  </Center>\n                </div>\n              )\n            )\n          }\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ColorAdjusterApp;\n","import ObjectViewer from \"./ObjectViewer\";\n\nexport default ObjectViewer;\n","import Full from \"../Full\";\nimport ReactJson from \"react-json-view\";\nimport classNames from \"classnames\";\nimport styles from \"./ObjectViewer.module.css\";\nimport PropTypes from \"prop-types\";\n\nObjectViewer.propTypes = {\n  src: PropTypes.object.isRequired,\n};\n\nexport default function ObjectViewer({ className, src, ...rest }) {\n  return (\n    <Full {...rest} className={classNames(styles[\"object-viewer\"], className)}>\n      <ReactJson\n        src={src}\n        theme=\"monokai\"\n        // NOTE: className appears to be unsupported here\n        style={{ width: \"100%\", height: \"100%\" }}\n      />\n    </Full>\n  );\n}\n","import Layout, { Content /* Footer */ } from \"@components/Layout\";\nimport ObjectViewer from \"@components/ObjectViewer\";\n\n// TODO: Include ability to show environment of any given AppRuntime?\n\nexport const REGISTRATION_ID = \"environment\";\n\nconst EnvironmentApp = {\n  id: REGISTRATION_ID,\n  title: \"Environment\",\n  style: {\n    width: 640 * 0.8,\n    height: 480 * 0.8,\n  },\n  view: function View() {\n    return (\n      <Layout>\n        <Content>\n          <ObjectViewer src={process.env} />\n        </Content>\n      </Layout>\n    );\n  },\n};\n\nexport default EnvironmentApp;\n","import EnvironmentApp, { REGISTRATION_ID } from \"./EnvironmentApp\";\n\nexport default EnvironmentApp;\nexport { REGISTRATION_ID };\n","import AppLinkButton from \"./AppLinkButton\";\n\nexport default AppLinkButton;\n","import { useMemo } from \"react\";\nimport useAppRegistrationLink from \"@hooks/useAppRegistrationLink\";\nimport ButtonTransparent from \"../ButtonTransparent\";\n\nimport PropTypes from \"prop-types\";\n\n// TODO: Apply \"active\" class to button whenever registration is active?\n\nAppLinkButton.propTypes = {\n  id: PropTypes.string.isRequired,\n\n  title: PropTypes.string,\n};\n\n// TODO: Document\nexport default function AppLinkButton({\n  id,\n  children = null,\n  title = null,\n  ...rest\n}) {\n  const { title: registrationTitle, link } = useAppRegistrationLink(id);\n\n  // If there are children, show a non-styled button, otherwise, show a\n  // standard button\n  const ButtonView = useMemo(\n    () => props =>\n      children ? <ButtonTransparent {...props} /> : <button {...props} />,\n    [children]\n  );\n\n  if (!link) {\n    return null;\n  }\n\n  return (\n    <ButtonView\n      // IMPORTANT: ...rest is moved before onClick handler so the internal\n      // onClick handler will not be overridden\n      {...rest}\n      onClick={link}\n    >\n      {children || title || registrationTitle}\n    </ButtonView>\n  );\n}\n","import ReShellCore from \"@core\";\nimport PhantomCore from \"phantom-core\";\n\nimport Layout, {\n  Header,\n  Content,\n  Footer,\n  Row,\n  Column,\n} from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport ObjectViewer from \"@components/ObjectViewer\";\n\nimport { REGISTRATION_ID as ENVIRONMENT_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/EnvironmentApp\";\nimport { REGISTRATION_ID as CHECK_FOR_UPDATES_REGISTRATION_ID } from \"@portals/ExamplePortal/apps/CheckForUpdatesApp\";\n\nconst packageJson = require(\"@root/package.json\");\n\nexport const REGISTRATION_ID = \"software-info\";\n\nconst SoftwareInfoApp = {\n  id: REGISTRATION_ID,\n  title: \"Software Info\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  view: function View() {\n    return (\n      <Layout>\n        <Header>\n          <Padding>Package.json content</Padding>\n        </Header>\n        <Content>\n          <ObjectViewer src={packageJson} />\n        </Content>\n        <Footer>\n          <Padding>\n            <Row>\n              <Column>\n                <Center>\n                  <div\n                    style={{ float: \"left\", textAlign: \"left\" }}\n                    className=\"note\"\n                  >\n                    ReShell version: {ReShellCore.getReShellVersion()}\n                    <br />\n                    PhantomCore version: {PhantomCore.getPhantomCoreVersion()}\n                    <br />\n                    Portal: {ReShellCore.getPortalName()}\n                  </div>\n                </Center>\n              </Column>\n              <Column>\n                <Center style={{ textAlign: \"right\" }}>\n                  <AppLinkButton id={CHECK_FOR_UPDATES_REGISTRATION_ID} />{\" \"}\n                  <AppLinkButton id={ENVIRONMENT_REGISTRATION_ID} />\n                </Center>\n              </Column>\n            </Row>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default SoftwareInfoApp;\n","import SoftwareInfoApp, { REGISTRATION_ID } from \"./SoftwareInfoApp\";\n\nexport default SoftwareInfoApp;\nexport { REGISTRATION_ID };\n","import { deepMerge } from \"phantom-core\";\nimport UIServiceCore from \"@core/classes/UIServiceCore\";\nimport KeyVaultService from \"./KeyVaultService\";\n\nimport { utils } from \"media-stream-track-controller\";\n\nconst KEY_STORAGE_ENGINE_MEDIA_DEVICES = \"media-devices\";\n\nconst KEY_DMETA_DEVICE = \"device\";\nconst KEY_DMETA_USER_METADATA = \"userMetadata\";\n\n/**\n * Manages arbitrary associative information for media devices.\n */\nexport default class MediaDeviceCachingService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setState({\n      devicesWithUserMetadata: [],\n    });\n\n    this.setTitle(\"Media Device Caching Service\");\n\n    this._storageEngine =\n      this.useServiceClass(KeyVaultService).getSecureLocalStorageEngine();\n\n    // Set initial state from local storage\n    (async () => {\n      this._fetchCachedMediaDeviceUserMetadata().then(devicesWithUserMetadata =>\n        this.setState({ devicesWithUserMetadata })\n      );\n    })();\n  }\n\n  /**\n   * Adds user-defined information to the given media device.\n   *\n   * Subsequent calls will deep merge userMetadata with existing metadata.\n   *\n   * @param {MediaDeviceInfo} device\n   * @param {Object} userMetadata\n   * @return {Promise<void>}\n   */\n  async setMediaDeviceUserMetadata(device, userMetadata) {\n    if (typeof device !== \"object\") {\n      throw new TypeError(\"device must be an object\");\n    }\n\n    if (typeof userMetadata !== \"object\") {\n      throw new TypeError(\"userMetadata must be an object\");\n    }\n\n    // Current device (may be overwritten after fetching from cache)\n    let update = {\n      [KEY_DMETA_DEVICE]: device,\n      [KEY_DMETA_USER_METADATA]: userMetadata,\n    };\n\n    // Previously cached devices without the current device\n    const filteredCache = await this._fetchCachedMediaDeviceUserMetadata().then(\n      devicesWithUserMetadata =>\n        // Remove matched device from prev\n        devicesWithUserMetadata.filter(pred => {\n          const isMatch = utils.mediaDevice.getIsSameMediaDevice(\n            pred.device,\n            device\n          );\n\n          if (isMatch) {\n            // Deep merge new meta data on top of previous metadata\n            update = deepMerge(pred, {\n              [KEY_DMETA_USER_METADATA]: userMetadata,\n            });\n          }\n\n          return !isMatch;\n        })\n    );\n\n    // This is what will be written back to the local storage cache\n    const next = [...filteredCache, update];\n\n    await this._storageEngine.setItem(KEY_STORAGE_ENGINE_MEDIA_DEVICES, next);\n\n    this.setState({ devicesWithUserMetadata: next });\n  }\n\n  /**\n   * Fetches stored device information from local storage.\n   *\n   * @return {Promise<Object[]>} TODO: Document structure\n   */\n  async _fetchCachedMediaDeviceUserMetadata() {\n    const cache = await this._storageEngine.fetchItem(\n      KEY_STORAGE_ENGINE_MEDIA_DEVICES\n    );\n\n    if (Array.isArray(cache)) {\n      return cache;\n    } else {\n      return [];\n    }\n  }\n\n  /**\n   * Retrieves stored device information from local state.\n   *\n   * NOTE: This does not make a disk call, only reads from memory (current\n   * state); it is not intended to be asynchronous\n   *\n   * @param {MediaDeviceInfo} device\n   * @return {Object} TODO: Document structure\n   */\n  getMediaDeviceUserMetadata(device) {\n    const cachedDevice = this.getState().devicesWithUserMetadata.find(pred =>\n      utils.mediaDevice.getIsSameMediaDevice(pred.device, device)\n    );\n\n    if (cachedDevice) {\n      return cachedDevice[KEY_DMETA_USER_METADATA];\n    }\n  }\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport {\n  MediaStreamTrackControllerFactory,\n  MediaStreamTrackControllerFactoryCollection,\n  utils,\n} from \"media-stream-track-controller\";\n\nimport MediaDeviceCachingService from \"./MediaDeviceCachingService\";\n\n// TODO: Refactor\nclass InputMediaDeviceFactoryCollection extends MediaStreamTrackControllerFactoryCollection {}\n\n/**\n * Manages capturing of physical input media devices (i.e. microphone or camera).\n *\n * It does not manage virtual devices, such as screen captures, canvas, etc.\n */\nexport default class InputMediaDevicesService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Input Media Devices Service\");\n\n    this.setState({\n      isFetchingMediaDevices: false,\n      isAudioContextStarted: false,\n      devices: [],\n    });\n\n    this._mediaDeviceCachingService = this.useServiceClass(\n      MediaDeviceCachingService\n    );\n\n    this._inputMediaDeviceFactoryCollection = this.bindCollectionClass(\n      InputMediaDeviceFactoryCollection\n    );\n\n    // TODO: Re-fetch when devices have been changed (listen to event; backport\n    // from original Speaker.app)\n    //\n    // TODO: Capture fetch errors and set them as state / UI notifications\n\n    this.fetchInputMediaDevices();\n  }\n\n  /**\n   * Performs a \"system call\" against the browser in order to determine\n   * physical input media devices.\n   *\n   * This will internally cache the media device info in the state, and calls\n   * to this.getInputMediaDevices() can retrieve that state for the UI.\n   *\n   * @param {boolean} isAggressive [default = true]  If true, temporarily\n   * turn on devices in order to obtain label information.\n   * @return {MediaDeviceInfo[] || Object[]}\n   */\n  async fetchInputMediaDevices(isAggressive = true) {\n    this.setState({ isFetchingMediaDevices: true });\n\n    // Fixes issue where sending media stream track to remote peers is muted\n    // until something starts the audio context (TODO: Define which\n    // environments this is happening in; all? Should this fix be moved into\n    // media-stream-track-controller itself?)\n    //\n    // IMPORTANT: This isn't the ONLY fix related to this, and others are\n    // specified in the LocalZenRTCPeer connect sequence (currently part of\n    // SpeakerAppPortal)\n    await this.untilAudioContextResumed();\n\n    const inputMediaDevices = await utils.mediaDevice\n      .fetchInputMediaDevices(isAggressive)\n      .catch(console.error)\n      .finally(() => this.setState({ isFetchingMediaDevices: false }));\n\n    // TODO: Remove\n    console.log({ inputMediaDevices });\n\n    // Set the captured device information as state so that calls to\n    // this.getInputMediaDevices() can retrieve cached state, and any UI\n    // listeners can see the state of cached device information.\n    this.setState({ devices: inputMediaDevices });\n\n    return inputMediaDevices;\n  }\n\n  // TODO: Document\n  async untilAudioContextResumed() {\n    await utils.audioContext.untilAudioContextResumed();\n\n    this.setState({\n      isAudioContextStarted: true,\n    });\n  }\n\n  /**\n   * Retrieves whether or not this service is currently fetching media devices.\n   *\n   * @return {boolean}\n   */\n  getIsFetchingMediaDevices() {\n    return this.getState().isFetchingMediaDevices;\n  }\n\n  // TODO: Document\n  //\n  // IMPORTANT: This depends on a prior resolved call to\n  // this.fetchInputMediaDevices() before this will return anything\n  getInputMediaDevices() {\n    const { devices } = this.getState();\n\n    return devices || [];\n  }\n\n  // TODO: Document\n  //\n  // IMPORTANT: This depends on a prior resolved call to\n  // this.fetchInputMediaDevices() before this will return anything\n  getAudioInputMediaDevices() {\n    const inputMediaDevices = this.getInputMediaDevices();\n\n    // TODO: Use utility function for filtering\n    return inputMediaDevices.filter(predicate =>\n      predicate.kind.includes(\"audioinput\")\n    );\n  }\n\n  // TODO: Document\n  getCaptureFactories() {\n    return this._inputMediaDeviceFactoryCollection.getTrackControllerFactories();\n  }\n\n  // TODO: Document\n  getIsAudioMediaDeviceBeingCaptured(mediaDeviceInfo) {\n    return Boolean(\n      MediaStreamTrackControllerFactory.getFactoriesWithInputMediaDevice(\n        mediaDeviceInfo,\n        // TODO: Use constant here\n        // TODO: Auto-detect this input value from the device (within\n        // media-stream-track-controller)\n        \"audio\"\n      ).length\n    );\n  }\n\n  // TODO: Document\n  getMediaDeviceCaptureFactory(mediaDeviceInfo) {\n    const factories =\n      MediaStreamTrackControllerFactory.getFactoriesWithInputMediaDevice(\n        mediaDeviceInfo,\n        // TODO: Use constant here\n        \"audio\"\n      );\n\n    if (factories) {\n      return factories[0];\n    }\n  }\n\n  // TODO: Document\n  //\n  // IMPORTANT: For most use cases, use this.captureSpecificMediaDevice\n  // instead\n  /*\n  async captureDefaultAudioInputDevice(\n    userConstraints = {},\n    factoryOptions = {}\n  ) {\n    // TODO: Implement ability to apply preset quality settings to default\n    // audio device (potentially obtain default audio device from list, apply\n    // the settings there, then call this.captureSpecificMediaDevice())\n\n    const factory = await utils.mediaDevice.captureMediaDevice(\n      userConstraints,\n      factoryOptions\n    );\n\n    this._inputMediaDeviceFactoryCollection.addTrackControllerFactory(\n      factory\n    );\n\n    return factory;\n  }\n  */\n\n  // TODO: Document\n  async captureSpecificMediaDevice(\n    mediaDeviceInfo,\n    userConstraints = {},\n    factoryOptions = {}\n  ) {\n    const factory = await utils.mediaDevice.captureSpecificMediaDevice(\n      mediaDeviceInfo,\n      userConstraints,\n      factoryOptions\n    );\n\n    this._inputMediaDeviceFactoryCollection.addTrackControllerFactory(factory);\n\n    return factory;\n  }\n\n  // TODO: Document\n  async uncaptureSpecificMediaDevice(mediaDeviceInfo) {\n    return utils.mediaDevice.uncaptureSpecificMediaDevice(mediaDeviceInfo);\n  }\n\n  /**\n   * Determines whether or not any audio input devices are currently capturing.\n   *\n   * @return {boolean}\n   */\n  getIsCapturingAnyAudio() {\n    return this._inputMediaDeviceFactoryCollection.getAudioTrackControllers()\n      .length;\n  }\n\n  /**\n   * Determines whether or not all audio input devices are muted.\n   *\n   * @return {boolean}\n   */\n  getIsAllAudioMuted() {\n    return this._inputMediaDeviceFactoryCollection.getIsAudioMuted();\n  }\n\n  /**\n   * Sets whether or not all audio input devices are muted.\n   *\n   * @param {boolean} isAllAudioMuted\n   * @return {void}\n   */\n  setIsAllAudioMuted(isAllAudioMuted) {\n    return this._inputMediaDeviceFactoryCollection.setIsAudioMuted(\n      isAllAudioMuted\n    );\n  }\n\n  /**\n   * Mutes all audio input devices.\n   *\n   * NOTE: Subsequently added input devices will not be muted by default.\n   *\n   * @return {void}\n   */\n  muteAllAudio() {\n    return this._inputMediaDeviceFactoryCollection.muteAudio();\n  }\n\n  /**\n   * Unmutes all audio input devices.\n   *\n   * @return {void}\n   */\n  unmuteAllAudio() {\n    return this._inputMediaDeviceFactoryCollection.unmuteAudio();\n  }\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`i91eec2200f934fc6a4087e250fa26340-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import { PhantomCollection } from \"phantom-core\";\nimport { useEffect, useState } from \"react\";\nimport usePrevious from \"./usePrevious\";\n\n/**\n * @typedef {Object} ArrayDiff\n * @property {any[]} added Elements added since last change\n * @property {any[]} removed Elements removed since last change\n *\n * @param {any[]} next\n * @return {ArrayDiff}\n */\nexport default function useArrayDiff(next) {\n  // IMPORTANT: Using empty array for previous default value\n  const prev = usePrevious(next, []);\n\n  const [addedRemoved, _setAddedRemoved] = useState({ added: [], removed: [] });\n\n  useEffect(() => {\n    // NOTE: This check is inside the useEffect so it is not re-run more often\n    // than it should\n    if (!Array.isArray(next)) {\n      throw new Error(\"next should be an array\");\n    }\n\n    const { added, removed } = PhantomCollection.getChildrenDiff(prev, next);\n\n    if (added.length || removed.length) {\n      _setAddedRemoved({\n        added,\n        removed,\n      });\n    }\n  }, [prev, next]);\n\n  return {\n    added: addedRemoved.added,\n    removed: addedRemoved.removed,\n  };\n}\n","import { useEffect, useRef } from \"react\";\n\nconst DEFAULT_REF_VALUE = null;\n\n/**\n * Adapted from:\n * @see https://usehooks.com/usePrevious\n *\n * getPreviousValue, a memoized callback with no dependencies, was added so\n * that the value could be obtained from within a hook without the value being\n * called as a dependency, which could cause an additional render.\n *\n * @param {any} value The current value\n * @param {boolean} defaultPreviousValue? [default = null]\n * @return {any} The previous value\n */\nexport default function usePrevious(\n  value,\n  defaultPreviousValue = DEFAULT_REF_VALUE\n) {\n  // The ref object is a generic container whose \"current\" property is mutable\n  // and can hold any value, similar to an instance property on a class\n  const refPrev = useRef(defaultPreviousValue);\n\n  // Store current value in ref\n  // Only re-run if value changes\n  useEffect(() => {\n    refPrev.current = value;\n  }, [value]);\n\n  // Return previous value (happens before update in useEffect above)\n  return refPrev.current;\n}\n","import { useEffect, useMemo, useRef, useState } from \"react\";\nimport { MultiAudioMediaStreamTrackLevelMonitor } from \"media-stream-track-controller\";\nimport useArrayDiff from \"./useArrayDiff\";\n\nconst { EVT_AUDIO_LEVEL_UPDATED } = MultiAudioMediaStreamTrackLevelMonitor;\n\n/**\n * Utilizes a MultiAudioMediaStreamTrackLevelMonitor as a React hook.\n *\n * @param {MediaStreamTrack | MediaStreamTrack[] | null} mediaStreamTrackOrTracks?\n * [default = []] A single track, or an array of tracks.  It is made optional\n * because rendered audio level meters may not already have an associated\n * MediaStreamTrack. NOTE: It will automatically filter out non-audio tracks.\n * @param {function} onAudioLevelChange Callback which is executed each time the audio level is changed.\n * @return {void}\n */\nexport default function useMultiAudioMediaStreamTrackLevelMonitor(\n  mediaStreamTrackOrTracks = [],\n  onAudioLevelChange\n) {\n  /**\n   * @type {MediaStreamTrack[]}\n   */\n  const mediaStreamTracks = useMemo(\n    () =>\n      (!mediaStreamTrackOrTracks\n        ? []\n        : Array.isArray(mediaStreamTrackOrTracks)\n        ? mediaStreamTrackOrTracks\n        : [mediaStreamTrackOrTracks]\n      ).filter(\n        track => track instanceof MediaStreamTrack && track.kind === \"audio\"\n      ),\n    [mediaStreamTrackOrTracks]\n  );\n\n  const [mediaStreamMonitor, _setMediaStreamMonitor] = useState(null);\n\n  const refOnAudioLevelChange = useRef(onAudioLevelChange);\n  refOnAudioLevelChange.current = onAudioLevelChange;\n\n  // Instantiate and bind MultiAudioMediaStreamTrackLevelMonitor audio level\n  // state to hook state\n  useEffect(() => {\n    const mediaStreamMonitor = new MultiAudioMediaStreamTrackLevelMonitor();\n\n    // NOTE: This event handler will automatically be unbound once the class\n    // destructs\n    mediaStreamMonitor.on(EVT_AUDIO_LEVEL_UPDATED, audioLevel => {\n      refOnAudioLevelChange.current(audioLevel);\n    });\n\n    _setMediaStreamMonitor(mediaStreamMonitor);\n\n    return function unmount() {\n      if (!mediaStreamMonitor.getIsDestroying()) {\n        mediaStreamMonitor.destroy();\n      }\n    };\n  }, []);\n\n  const { added: addedMediaStreamTracks, removed: removedMediaStreamTracks } =\n    useArrayDiff(mediaStreamTracks);\n\n  // Sync hook's media stream tracks with the audio monitor instance\n  useEffect(() => {\n    if (mediaStreamMonitor) {\n      // Handle added / existing tracks\n      for (const track of addedMediaStreamTracks) {\n        mediaStreamMonitor.addMediaStreamTrack(track);\n      }\n\n      // Handle removed tracks\n      for (const track of removedMediaStreamTracks) {\n        mediaStreamMonitor.removeMediaStreamTrack(track);\n      }\n    }\n  }, [mediaStreamMonitor, addedMediaStreamTracks, removedMediaStreamTracks]);\n}\n","import AudioLevelMeter from \"./AudioLevelMeter\";\n\nexport default AudioLevelMeter;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./AudioLevelMeter.module.css\";\n\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport PropTypes from \"prop-types\";\n\nimport useMultiAudioMediaStreamTrackLevelMonitor from \"@hooks/useMultiAudioMediaStreamTrackLevelMonitor\";\n\nAudioLevelMeter.propTypes = {\n  className: PropTypes.string,\n\n  /** When multiple audio tracks may be used together */\n  mediaStreamTracks: PropTypes.arrayOf(PropTypes.instanceOf(MediaStreamTrack)),\n\n  /** When only a single track is used */\n  mediaStreamTrack: PropTypes.instanceOf(MediaStreamTrack),\n};\n\n/**\n * A vertical bar audio meter which takes up its full available vertical space\n * by default.\n *\n * Borrowed from:\n * @see https://codepen.io/snart1/pen/rRvwwr\n */\nexport default function AudioLevelMeter({\n  className,\n  mediaStreamTrack,\n  mediaStreamTracks,\n  ...rest\n}) {\n  const [elAudioLevel, setElAudioLevel] = useState(null);\n\n  const uuid = useMemo(uuidv4, []);\n\n  /**\n   * @param {number} audioLevel A float value from 0 - 100, where 100\n   * represents maximum strength.\n   * @return {void}\n   */\n  const handleAudioLevelChange = useCallback(\n    audioLevel => {\n      if (elAudioLevel) {\n        requestSkippableAnimationFrame(() => {\n          // Inset is inverse of the audio level\n          const inset = 100 - audioLevel;\n\n          elAudioLevel.style.clipPath = `inset(${inset}% 0 0 0)`;\n          elAudioLevel.style.WebkitClipPath = `inset(${inset}% 0 0 0)`;\n        }, uuid);\n      }\n    },\n    [elAudioLevel, uuid]\n  );\n\n  // Set initial level (otherwise they will default to appearing fully\n  // maxed-out, due to the CSS rules)\n  useEffect(() => {\n    if (elAudioLevel) {\n      handleAudioLevelChange(0);\n    }\n  }, [handleAudioLevelChange, elAudioLevel]);\n\n  useMultiAudioMediaStreamTrackLevelMonitor(\n    mediaStreamTrack || mediaStreamTracks,\n    handleAudioLevelChange\n  );\n\n  return (\n    <div className={classNames(styles[\"levels\"], className)} {...rest}>\n      {/*\n        NOTE: The original version of this supported a nice multi-track\n        reading, which is not compatible with this implementation. However it\n        could be enabled by adapting the following to the current setup.\n\n        {renderedLevels.map((percent, idx) => (\n        */}\n\n      <div className={styles[\"level-container\"]}>\n        <div ref={setElAudioLevel} className={styles[\"level\"]}></div>\n      </div>\n      {/*\n      ))}\n      */}\n    </div>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`ie8e4f3089b614c28aa33b6aaeff7d8b0-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","import Padding from \"@components/Padding\";\nimport ButtonTransparent from \"@components/ButtonTransparent\";\nimport Center from \"@components/Center\";\nimport AudioLevelMeter from \"@components/audioMeters/AudioLevelMeter\";\n\nimport MicrophoneIcon from \"@icons/MicrophoneIcon\";\nimport CloseIcon from \"@icons/CloseIcon\";\n\n// TODO: Document and add prop-types\nexport default function AudioInputDeviceTableRow({\n  device,\n  mediaStreamTracks,\n  isCapturing,\n  onToggleCapture,\n  isMuted,\n  onToggleMute,\n  audioQualityPresets,\n  audioQualityPresetName,\n  onChangeAudioQualityPresetName,\n}) {\n  // TODO: Use constant for check type\n  if (device.kind !== \"audioinput\") {\n    throw new TypeError(\"device is not an audioinput device\");\n  }\n\n  return (\n    <tr style={isCapturing ? { backgroundColor: \"rgba(0,174,255,.2)\" } : null}>\n      <td>\n        <Padding>\n          <div style={{ fontWeight: \"bold\" }}>\n            {device.label || `[Unknown Label]`}\n          </div>\n\n          <div style={{ marginTop: 4 }}>\n            <span style={{ fontSize: \".7em\" }}>Quality:</span>{\" \"}\n            {!isCapturing ? (\n              <select\n                value={audioQualityPresetName}\n                onChange={evt =>\n                  onChangeAudioQualityPresetName(evt.target.value)\n                }\n                // FIXME: (jh) Due to issues with dynamically changing\n                // constraints while a media device is capturing in Chromium-\n                // based browsers, along with issues with WebRTCPeer / ZenRTCPeer\n                // not seeming to handle rapid track unpublishing / republishing,\n                // it seems better to force the user to have to stop the media\n                // device capturing before changing the preferred audio quality\n                // settings\n                disabled={isCapturing}\n              >\n                {audioQualityPresets.map((preset, idx) => {\n                  const presetName = preset.name;\n\n                  return (\n                    <option key={idx} value={presetName}>\n                      {presetName}\n                    </option>\n                  );\n                })}\n              </select>\n            ) : (\n              <button\n                onClick={onToggleCapture}\n                style={{ minWidth: 145, textAlign: \"left\" }}\n              >\n                {audioQualityPresetName}{\" \"}\n                <CloseIcon style={{ color: \"orange\", float: \"right\" }} />\n              </button>\n            )}\n          </div>\n        </Padding>\n      </td>\n\n      <td className=\"center\">\n        <Padding>\n          <button\n            onClick={onToggleCapture}\n            style={{\n              backgroundColor: isCapturing ? \"red\" : \"#347FE8\",\n              width: \"100%\",\n            }}\n          >\n            {isCapturing ? \"Stop\" : \"Start\"}\n          </button>\n        </Padding>\n      </td>\n      <td className=\"center\">\n        <Padding>\n          <ButtonTransparent\n            disabled={!isCapturing}\n            onClick={onToggleMute}\n            style={{\n              color: !isCapturing ? \"inherit\" : isMuted ? \"white\" : \"orange\",\n            }}\n          >\n            <div style={{ textAlign: \"center\" }}></div>\n            <MicrophoneIcon style={{ fontSize: \"1.5em\" }} />\n            <div style={{ fontSize: \".7em\", marginTop: 4 }}>\n              {!isCapturing ? \"N/A\" : isMuted ? \"Yes\" : \"No\"}\n            </div>\n          </ButtonTransparent>\n        </Padding>\n      </td>\n      <td\n        className=\"center\"\n        style={{\n          width: 80,\n          // NOTE: This height cascades down to the audio level meter and helps\n          // keep the row height consistent regardless of whether the meter is\n          // active or not\n          height: 70,\n        }}\n      >\n        <Padding>\n          {isCapturing ? (\n            device.kind === \"audioinput\" && (\n              <AudioLevelMeter mediaStreamTracks={mediaStreamTracks} />\n            )\n          ) : (\n            <Center style={{ color: \"gray\", fontSize: \".7em\" }}>Off</Center>\n          )}\n        </Padding>\n      </td>\n    </tr>\n  );\n}\n","import { useCallback, useEffect } from \"react\";\n\nimport useServiceClass from \"@hooks/useServiceClass\";\nimport InputMediaDevicesService from \"@services/InputMediaDevicesService\";\nimport MediaDeviceCachingService from \"@services/MediaDeviceCachingService\";\n\n// FIXME: (jh) Move to service class?\nimport { utils } from \"media-stream-track-controller\";\nconst { audioQualityPresets } = utils.constraints;\n\n// FIXME: (jh) Move to service class?\nconst DEFAULT_AUDIO_QUALITY_PRESET =\n  audioQualityPresets.AUDIO_QUALITY_PRESET_TALK_RADIO;\n\n// TODO: Document\nexport default function useInputMediaDevicesSelectorState({\n  onDeviceCapture = device => null,\n  onDeviceUncapture = device => null,\n}) {\n  const { serviceInstance: inputMediaDevicesService } = useServiceClass(\n    InputMediaDevicesService\n  );\n\n  const { serviceInstance: mediaDevicesCachingService } = useServiceClass(\n    MediaDeviceCachingService\n  );\n\n  // Automatically fetch input media devices when component mounts\n  useEffect(() => {\n    if (inputMediaDevicesService) {\n      inputMediaDevicesService.fetchInputMediaDevices();\n    }\n  }, [inputMediaDevicesService]);\n\n  /**\n   * @return {Promise<void>}\n   */\n  const setDevicePreferredAudioQualityPresetName = useCallback(\n    async (device, audioQualityPresetName) => {\n      // TODO: Use constant\n      if (device.kind !== \"audioinput\") {\n        console.warn(\n          `Cannot set device preferred audio quality preset name for \"${device.kind}\" kind.  Expected audioinput kind.`\n        );\n        return;\n      }\n\n      const audioQualityPreset =\n        utils.constraints.audioQualityPresets.getAudioQualityPresetWithName(\n          audioQualityPresetName\n        );\n\n      return mediaDevicesCachingService.setMediaDeviceUserMetadata(device, {\n        audioQualityPreset,\n      });\n\n      // TODO: Uncapture device (if being captured)\n      // TODO: Re-capture device (using new audio constraints)\n    },\n    [mediaDevicesCachingService]\n  );\n\n  // FIXME: (jh) Constraint matching could be moved into the service level\n  // instead\n  /**\n   * @return {Promise<void>}\n   */\n  const captureSpecificMediaDevice = useCallback(\n    async device => {\n      const deviceUserMetadata =\n        mediaDevicesCachingService.getMediaDeviceUserMetadata(device);\n\n      let preferredConstraints =\n        deviceUserMetadata &&\n        deviceUserMetadata.audioQualityPreset?.constraints;\n\n      // TODO: Use constant for kind\n      if (!preferredConstraints && device.kind === \"audioinput\") {\n        preferredConstraints =\n          audioQualityPresets.getAudioQualityPresetConstraints(\n            DEFAULT_AUDIO_QUALITY_PRESET\n          );\n      }\n\n      // Start the capturing\n      return inputMediaDevicesService.captureSpecificMediaDevice(\n        device,\n        preferredConstraints\n        // FIXME: (jh) Use device title in factory options?\n      );\n    },\n    [inputMediaDevicesService, mediaDevicesCachingService]\n  );\n\n  /**\n   * @return {string}\n   */\n  const getDevicePreferredAudioQualityPresetName = useCallback(\n    device => {\n      const deviceUserMetadata =\n        mediaDevicesCachingService.getMediaDeviceUserMetadata(device);\n\n      if (deviceUserMetadata) {\n        return deviceUserMetadata.audioQualityPreset?.name;\n      } else {\n        return DEFAULT_AUDIO_QUALITY_PRESET.name;\n      }\n    },\n    [mediaDevicesCachingService]\n  );\n\n  // TODO: Document\n  const toggleSpecificAudioInputDevice = useCallback(\n    async device => {\n      const isCapturing =\n        inputMediaDevicesService.getIsAudioMediaDeviceBeingCaptured(device);\n\n      if (!isCapturing) {\n        // IMPORTANT: Using the local (non-service) version here, as it\n        // utilizes the user constraint handling\n        await captureSpecificMediaDevice(device);\n\n        // UI callback\n        onDeviceCapture(device);\n      } else {\n        // Stop the capturing\n        await inputMediaDevicesService.uncaptureSpecificMediaDevice(device);\n\n        // UI callback\n        onDeviceUncapture(device);\n      }\n    },\n    [\n      inputMediaDevicesService,\n      captureSpecificMediaDevice,\n      onDeviceCapture,\n      onDeviceUncapture,\n    ]\n  );\n\n  const audioInputDevices =\n    inputMediaDevicesService?.getAudioInputMediaDevices() || [];\n\n  const capturedAudioInputDevices = audioInputDevices.filter(device =>\n    inputMediaDevicesService?.getIsAudioMediaDeviceBeingCaptured(device)\n  );\n\n  return {\n    inputMediaDevicesService,\n    mediaDevicesCachingService,\n    audioInputDevices,\n    capturedAudioInputDevices,\n    audioQualityPresets,\n    toggleSpecificAudioInputDevice,\n    setDevicePreferredAudioQualityPresetName,\n    getDevicePreferredAudioQualityPresetName,\n  };\n}\n","import InputMediaDevicesSelector from \"./InputMediaDevicesSelector\";\n\nexport default InputMediaDevicesSelector;\n","import Full from \"../Full\";\nimport Layout, { Header, Content, Footer } from \"../Layout\";\nimport Padding from \"../Padding\";\nimport Center from \"../Center\";\nimport Cover from \"../Cover\";\n\nimport RCACableIcon from \"@icons/RCACableIcon\";\n\nimport AudioInputDeviceTableRow from \"./subComponents/AudioInputDeviceTableRow\";\n\nimport useInputMediaDevicesSelectorState from \"./subHooks/useInputMediaDevicesSelectorState\";\n\n// TODO: Document and add prop-types\n// TODO: Refactor for all input device types\nexport default function InputMediaDevicesSelector({\n  onDeviceCapture = device => null,\n  onDeviceUncapture = device => null,\n}) {\n  const {\n    inputMediaDevicesService,\n    mediaDevicesCachingService,\n    audioInputDevices,\n    capturedAudioInputDevices,\n    audioQualityPresets,\n    toggleSpecificAudioInputDevice,\n    setDevicePreferredAudioQualityPresetName,\n    getDevicePreferredAudioQualityPresetName,\n  } = useInputMediaDevicesSelectorState({\n    onDeviceCapture,\n    onDeviceUncapture,\n  });\n\n  if (!inputMediaDevicesService || !mediaDevicesCachingService) {\n    return null;\n  }\n\n  const lenAudioInputDevices = audioInputDevices.length;\n\n  const isFetching = inputMediaDevicesService.getIsFetchingMediaDevices();\n\n  if (!audioInputDevices.length) {\n    return (\n      <Center style={{ fontWeight: \"bold\" }}>\n        {isFetching\n          ? \"Fetching audio devices...\"\n          : \"No audio input devices are currently available.\"}\n      </Center>\n    );\n  }\n\n  const lenCapturedAudioInputDevices = capturedAudioInputDevices.length;\n\n  return (\n    <Layout>\n      <Header>Select device(s) for sound input:</Header>\n      <Content>\n        <Padding>\n          <Full\n            style={{\n              overflow: \"auto\",\n              border: \"4px #22668F solid\",\n              borderRadius: 4,\n            }}\n          >\n            <table style={{ width: \"100%\" }}>\n              <thead>\n                <tr>\n                  <td>Name</td>\n                  <td className=\"center\">f(x)</td>\n                  <td className=\"center\">Muted</td>\n                  <td className=\"center\">Level</td>\n                </tr>\n              </thead>\n              <tbody>\n                {audioInputDevices.map((device, idx) => {\n                  // TODO: Remove\n                  // console.log({ device });\n\n                  const isCapturing =\n                    capturedAudioInputDevices.includes(device);\n\n                  const deviceCaptureFactory =\n                    inputMediaDevicesService.getMediaDeviceCaptureFactory(\n                      device\n                    );\n\n                  const mediaStreamTracks =\n                    isCapturing &&\n                    deviceCaptureFactory?.getOutputMediaStream()?.getTracks();\n\n                  // TODO: Remove\n                  const audioTrackController =\n                    isCapturing &&\n                    deviceCaptureFactory?.getAudioTrackControllers()[0];\n                  if (audioTrackController) {\n                    console.log({\n                      settings: audioTrackController.getSettings(),\n                    });\n                  }\n\n                  return (\n                    <AudioInputDeviceTableRow\n                      key={idx}\n                      device={device}\n                      mediaStreamTracks={mediaStreamTracks}\n                      isCapturing={isCapturing}\n                      onToggleCapture={() =>\n                        toggleSpecificAudioInputDevice(device)\n                      }\n                      isMuted={deviceCaptureFactory?.getIsMuted()}\n                      onToggleMute={() => deviceCaptureFactory?.toggleMute()}\n                      audioQualityPresets={audioQualityPresets}\n                      audioQualityPresetName={getDevicePreferredAudioQualityPresetName(\n                        device\n                      )}\n                      onChangeAudioQualityPresetName={audioQualityPresetName =>\n                        setDevicePreferredAudioQualityPresetName(\n                          device,\n                          audioQualityPresetName\n                        )\n                      }\n                    />\n                  );\n                })}\n              </tbody>\n            </table>\n          </Full>\n        </Padding>\n      </Content>\n\n      <Footer style={{ minHeight: 50 }}>\n        <Padding>\n          <RCACableIcon\n            style={{\n              fontSize: 38,\n              marginLeft: 20,\n              color: \"rgba(255,255,255,.2)\",\n            }}\n          />\n          <Cover>\n            <Center>\n              <div>\n                {lenAudioInputDevices} audio input device\n                {lenAudioInputDevices !== 1 && \"s\"} available.\n              </div>\n              <div>\n                {lenCapturedAudioInputDevices} audio input device\n                {lenCapturedAudioInputDevices !== 1 && \"s\"} currently being\n                captured.\n              </div>\n            </Center>\n          </Cover>\n        </Padding>\n      </Footer>\n    </Layout>\n  );\n}\n","import StaggeredWaveLoading from \"./StaggeredWaveLoading\";\n\nexport default StaggeredWaveLoading;\n","import React from \"react\";\nimport styles from \"./StaggeredWaveLoading.module.css\";\n\n// @see https://codepen.io/alphardex/pen/XWWWBmQ\nexport default function StaggeredWaveLoading({ ...rest }) {\n  return (\n    <div className={styles[\"loading-wrapper\"]} {...rest}>\n      <div className={styles[\"loading\"]}>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n        <div className={styles[\"dot\"]}></div>\n      </div>\n    </div>\n  );\n}\n","import Preload from \"./Preload\";\n\nexport default Preload;\n","import React from \"react\";\nimport AutoScaler from \"../AutoScaler\";\nimport StaggeredWaveLoading from \"../StaggeredWaveLoading\";\nimport PropTypes from \"prop-types\";\n\nimport usePreload from \"@hooks/usePreload\";\n\nPreload.propTypes = {\n  /** An array of URLs to preload */\n  preloadResources: PropTypes.arrayOf(PropTypes.string.isRequired).isRequired,\n\n  /** Called when there is a loading error  */\n  onError: PropTypes.func,\n\n  /** If true, disables loading indicator */\n  disabledLoadingIndicator: PropTypes.bool,\n};\n\nexport default function Preload({\n  children,\n  preloadResources,\n  disabledLoadingIndicator = false,\n  onError = err => console.warn(\"Caught\", err),\n  ...rest\n}) {\n  const { isPreloaded /* progress */ } = usePreload(preloadResources);\n\n  if (!isPreloaded && !disabledLoadingIndicator) {\n    return (\n      <AutoScaler {...rest}>\n        <StaggeredWaveLoading />\n      </AutoScaler>\n    );\n  } else {\n    return <React.Fragment>{children}</React.Fragment>;\n  }\n}\n","export default __webpack_public_path__ + \"static/media/vu.8cb21748.png\";","export default \"data:image/png;base64,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\"","import VUMeter from \"./VUMeter\";\n\nexport default VUMeter;\n","import React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport Preload from \"@components/Preload\";\n\nimport classNames from \"classnames\";\nimport styles from \"./VUMeter.module.css\";\n\nimport PropTypes from \"prop-types\";\n\nimport useMultiAudioMediaStreamTrackLevelMonitor from \"@hooks/useMultiAudioMediaStreamTrackLevelMonitor\";\n\nimport requestSkippableAnimationFrame from \"request-skippable-animation-frame\";\nimport { v4 as uuidv4 } from \"uuid\";\n\nimport vuBackground from \"./images/vu.png\";\nimport vuNeedle from \"./images/needle.png\";\n\nVUMeter.propTypes = {\n  label: PropTypes.string,\n\n  className: PropTypes.string,\n\n  /** When multiple audio tracks may be used together */\n  mediaStreamTracks: PropTypes.arrayOf(PropTypes.instanceOf(MediaStreamTrack)),\n\n  /** When only a single track is used */\n  mediaStreamTrack: PropTypes.instanceOf(MediaStreamTrack),\n};\n\n/**\n * A needle-based audio meter.\n */\nexport default function VUMeter({\n  label = \"Mono\",\n  className,\n  mediaStreamTrack,\n  mediaStreamTracks,\n  ...rest\n}) {\n  const [elVU, setElVU] = useState(null);\n  const [elNeedle, setElNeedle] = useState(null);\n\n  const uuid = useMemo(uuidv4, []);\n\n  useEffect(() => {\n    if (elVU && elNeedle) {\n      elVU.style.backgroundImage = `url(${vuBackground})`;\n      elVU.style.backgroundPosition = \"top left\";\n      elVU.style.backgroundRepeat = \"no-repeat\";\n\n      elNeedle.style.backgroundImage = `url(${vuNeedle})`;\n      elNeedle.style.backgroundPosition = \"top left\";\n      elNeedle.style.backgroundRepeat = \"no-repeat\";\n    }\n  }, [elVU, elNeedle]);\n\n  /**\n   * @param {number} audioLevel A float value from 0 - 100, where 100\n   * represents maximum strength.\n   * @return {void}\n   */\n  const handleAudioLevelChange = useCallback(\n    audioLevel => {\n      if (elNeedle) {\n        requestSkippableAnimationFrame(() => {\n          elNeedle.style.transform = `rotateZ(${Math.min(\n            87 * (audioLevel / 100)\n          )}deg)`;\n        }, uuid);\n      }\n    },\n    [elNeedle, uuid]\n  );\n\n  // Set initial level\n  useEffect(() => {\n    if (elNeedle) {\n      handleAudioLevelChange(0);\n    }\n  }, [handleAudioLevelChange, elNeedle]);\n\n  useMultiAudioMediaStreamTrackLevelMonitor(\n    mediaStreamTrack || mediaStreamTracks,\n    handleAudioLevelChange\n  );\n\n  return (\n    <Preload preloadResources={[vuBackground, vuNeedle]}>\n      <div\n        ref={setElVU}\n        className={classNames(styles[\"vu\"], className)}\n        {...rest}\n      >\n        <div className={styles[\"mask\"]}>\n          <div\n            ref={setElNeedle}\n            className={styles[\"needle\"]}\n            style={{ transform: \"rotateZ(0deg)\" }}\n          ></div>\n        </div>\n        <p className={styles[\"vu-label\"]}>{label}</p>\n      </div>\n    </Preload>\n  );\n}\n","import InputMediaDevicesService from \"@services/InputMediaDevicesService\";\n\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport AudioLevelMeter from \"@components/audioMeters/AudioLevelMeter\";\nimport VULevelMeter from \"@components/audioMeters/VUMeter\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"../InputMediaDevicesApp\";\n\nexport const REGISTRATION_ID = \"vu-meter\";\n\nconst VUMeterApp = {\n  id: REGISTRATION_ID,\n  title: \"VU Meter\",\n  style: {\n    width: 360,\n    height: 360,\n    backgroundColor: \"rgba(0,0,0,.4)\",\n  },\n  serviceClasses: [InputMediaDevicesService],\n  view: ({ appServices }) => {\n    const mds = appServices[InputMediaDevicesService];\n\n    const captureFactories = mds.getCaptureFactories();\n    // const isCapturing = Boolean(captureFactories.length);\n\n    // TODO: Add labels / controls (or adapt this program to be something else\n    // entirely)\n\n    const mediaStreamTracks = captureFactories\n      .map(factory =>\n        factory\n          .getAudioTrackControllers()\n          .map(controller => controller.getOutputMediaStreamTrack())\n      )\n      .flat();\n\n    return (\n      <Layout>\n        <Content>\n          <Center canOverflow={true}>\n            <div>\n              <VULevelMeter mediaStreamTracks={mediaStreamTracks} />\n              <AudioLevelMeter\n                style={{ marginLeft: 20, height: 160, width: 40 }}\n                mediaStreamTracks={mediaStreamTracks}\n              />\n            </div>\n            {/*\n              <div>\n                <button\n                  onClick={() => {\n                    !isCapturing\n                      ? mds.captureDefaultAudioInputDevice()\n                      : captureFactories.forEach(factory => factory.destroy());\n                  }}\n                  style={{ backgroundColor: isCapturing ? \"red\" : null }}\n                >\n                  {!isCapturing ? \"Start Microphone\" : \"Stop Capturing\"}\n                </button>\n              </div>\n              */}\n          </Center>\n        </Content>\n        <Footer>\n          <Padding>\n            <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default VUMeterApp;\n","import VUMeterApp, { REGISTRATION_ID } from \"./VUMeterApp\";\n\nexport default VUMeterApp;\nexport { REGISTRATION_ID };\n","import React, { useEffect, useMemo, useState, useRef } from \"react\";\n\n/**\n * Represents audio or video element.\n *\n * TODO: Document and rename\n */\nexport default function AVBase({\n  mediaStreamTrack,\n  mediaType = \"video\",\n  onEl = el => null,\n  ...rest\n}) {\n  const [el, setEl] = useState(null);\n\n  const mediaStream = useMemo(\n    () => mediaStreamTrack && new MediaStream([mediaStreamTrack]),\n    [mediaStreamTrack]\n  );\n\n  // TODO: Document\n  // Contains internal fixes which help Firefox and iOS start playing media\n  // tracks\n  useEffect(() => {\n    if (!el) {\n      return;\n    }\n\n    // Fixes issue in Firefox where setting mediaStream to undefined would keep\n    // video on last frame\n    if (!mediaStream) {\n      el.srcObject = null;\n      return;\n    }\n\n    el.srcObject = mediaStream;\n\n    // TODO: Emit events when playing in order to perform \"read receipts\" for\n    // remote participants\n\n    el.play()\n      .then(() => (el.muted = false))\n      .catch(err => console.warn(\"Caught\", err));\n  }, [el, mediaStream]);\n\n  const refOnEl = useRef(onEl);\n\n  // TODO: Document\n  useEffect(() => {\n    const onEl = refOnEl.current;\n\n    if (el && typeof onEl === \"function\") {\n      onEl(el);\n    }\n  }, [el]);\n\n  return React.createElement(mediaType, {\n    ref: setEl,\n    autoPlay: false,\n    muted: true,\n    playsInline: true,\n    controls: false,\n    ...rest,\n  });\n}\n","import React from \"react\";\nimport classNames from \"classnames\";\nimport styles from \"./Video.module.css\";\n\nimport AVBase from \"./AVBase\";\n\n// NOTE: (jh) There is also an aspect-ratio CSS property:\n// @see https://css-tricks.com/almanac/properties/a/aspect-ratio/\n\n/**\n * Plays a single video MediaStreamTrack out the monitor.\n */\nexport default function Video({ className, ...rest }) {\n  return (\n    <AVBase className={classNames(styles[\"video\"], className)} {...rest} />\n  );\n}\n","import UIServiceCore from \"@core/classes/UIServiceCore\";\nimport {\n  MediaStreamTrackControllerFactoryCollection,\n  utils,\n} from \"media-stream-track-controller\";\n\n// TODO: Build out; ensuring added children are media device controller factories\nclass ScreenCaptureFactoryCollection extends MediaStreamTrackControllerFactoryCollection {}\n\n// TODO: Document\nexport default class ScreenCapturerService extends UIServiceCore {\n  constructor(...args) {\n    super(...args);\n\n    this.setTitle(\"Screen Capturer Service\");\n\n    this.bindCollectionClass(ScreenCaptureFactoryCollection);\n  }\n\n  // TODO: Document\n  async startScreenCapture(constraints = {}, factoryOptions = {}) {\n    const factory = await utils.screen.captureScreen(\n      constraints,\n      factoryOptions\n    );\n\n    this.getCollectionInstance(\n      ScreenCaptureFactoryCollection\n    ).addTrackControllerFactory(factory);\n\n    return factory;\n  }\n\n  /**\n   * Returns all media stream tracks from all of the factories as a flat array.\n   *\n   * @return {MediaStreamTrack[]}\n   */\n  getMediaStreamTracks() {\n    return this.getCollectionInstance(ScreenCaptureFactoryCollection)\n      .getChildren()\n      .map(factory =>\n        factory\n          .getTrackControllers()\n          .map(controller => controller.getOutputMediaStreamTrack())\n      )\n      .flat();\n  }\n\n  // TODO: Document\n  getCaptureFactories() {\n    return this.getCollectionInstance(\n      ScreenCaptureFactoryCollection\n    ).getChildren();\n  }\n}\n","import { EVT_DESTROYED } from \"phantom-core\";\nimport { useCallback, useEffect, useState } from \"react\";\n\nimport Layout, { Content, Footer, Row, Column } from \"@components/Layout\";\nimport Cover from \"@components/Cover\";\nimport Center from \"@components/Center\";\nimport { Video } from \"@components/audioVideoRenderers\";\nimport LED from \"@components/LED\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport AudioLevelMeter from \"@components/audioMeters/AudioLevelMeter\";\n\nimport useGetIsUnmounting from \"@hooks/useGetIsUnmounting\";\n\nimport ScreenCapturerService from \"@services/ScreenCapturerService\";\n\nimport { REGISTRATION_ID as INPUT_MEDIA_DEVICES_REGISTRATION_ID } from \"../InputMediaDevicesApp\";\n\nexport const REGISTRATION_ID = \"screen-capture-window\";\n\n// TODO: Include ability to screen record and take arbitrary snapshot from video feed (separate from ScreenShot app which is a one-time deal)\n\nconst ScreenCaptureApp = {\n  id: REGISTRATION_ID,\n  title: \"Screen Capture\",\n  style: {\n    width: 640 * 0.8,\n    height: 480 * 0.8,\n  },\n  serviceClasses: [ScreenCapturerService],\n  view: function View({ appServices }) {\n    const scs = appServices[ScreenCapturerService];\n\n    const [screenCaptureFactory, setScreenCaptureFactory] = useState(null);\n\n    const getIsUnmounting = useGetIsUnmounting();\n\n    // TODO: Document\n    const handleStartScreenCapture = useCallback(\n      async (constraints = {}, factoryOptions = {}) => {\n        const factory = await scs.startScreenCapture(\n          constraints,\n          factoryOptions\n        );\n\n        setScreenCaptureFactory(factory);\n\n        factory.once(EVT_DESTROYED, () => {\n          // Unmounting check fixes an issue where memory-leak error is\n          // presented when closing the window with an active screen capture\n          if (!getIsUnmounting()) {\n            setScreenCaptureFactory(null);\n          }\n        });\n\n        return factory;\n      },\n      [scs, getIsUnmounting]\n    );\n\n    // Stop the screen capture on unmount\n    useEffect(() => {\n      if (screenCaptureFactory) {\n        return () => {\n          if (!screenCaptureFactory.getIsDestroying()) {\n            screenCaptureFactory.destroy();\n          }\n        };\n      }\n    }, [screenCaptureFactory]);\n\n    const videoTrack = screenCaptureFactory\n      ?.getVideoTrackControllers()[0]\n      ?.getOutputTrack();\n\n    const audioTrack = screenCaptureFactory\n      ?.getAudioTrackControllers()[0]\n      ?.getOutputTrack();\n\n    return (\n      <Layout style={{ backgroundColor: \"#424242\", color: \"#999\" }}>\n        <Content>\n          <Row>\n            <Column>\n              <Video mediaStreamTrack={videoTrack} />\n              {!screenCaptureFactory && (\n                <Cover>\n                  <Center>\n                    <div>\n                      <button\n                        onClick={() => handleStartScreenCapture()}\n                        style={{\n                          backgroundColor: \"green\",\n                          width: 200,\n                          height: 200,\n                          borderRadius: 200,\n                          fontWeight: \"bold\",\n                          fontSize: \"1.4rem\",\n                          border: \"8px #ccc solid\",\n                        }}\n                      >\n                        Start Screen Capture\n                      </button>\n                    </div>\n                  </Center>\n                </Cover>\n              )}\n            </Column>\n            <Column style={{ width: 50, maxWidth: 50 }}>\n              {/**\n               * Audio level monitoring.\n               *\n               * FIXME: (jh) This was originally set up for two-channel\n               * support, with independent meters, and it will require the\n               * audio track to be split into independent tracks in order to\n               * function as desired.\n               *\n               * The current functionality should represent both channels as\n               * a mono representation.\n               */}\n              <Row style={{ textAlign: \"center\" }}>\n                <Column>\n                  <Layout>\n                    <Content>\n                      <AudioLevelMeter mediaStreamTrack={audioTrack} />\n                    </Content>\n                    <Footer>Audio</Footer>\n                  </Layout>\n                </Column>\n              </Row>\n            </Column>\n          </Row>\n        </Content>\n        <Footer>\n          <Padding>\n            <Row>\n              <Column>\n                <Center>\n                  <AppLinkButton id={INPUT_MEDIA_DEVICES_REGISTRATION_ID} />\n                </Center>\n              </Column>\n              <Column>\n                <Center>\n                  <button\n                    style={{\n                      backgroundColor: !screenCaptureFactory ? \"green\" : \"red\",\n                      whiteSpace: \"nowrap\",\n                    }}\n                    onClick={() => {\n                      if (\n                        screenCaptureFactory &&\n                        !screenCaptureFactory.getIsDestroying()\n                      ) {\n                        screenCaptureFactory.destroy();\n                      } else {\n                        handleStartScreenCapture();\n                      }\n                    }}\n                  >\n                    {!screenCaptureFactory ? \"Capture\" : \"Stop\"}\n                  </button>\n                </Center>\n              </Column>\n              <Column>\n                <Row>\n                  <Column>\n                    <Center>\n                      <LED\n                        color={screenCaptureFactory ? \"green\" : \"gray\"}\n                        style={{ float: \"left\", marginLeft: 8 }}\n                      />\n                    </Center>\n                  </Column>\n                  <Column>\n                    <Center>\n                      <button disabled style={{ whiteSpace: \"nowrap\" }}>\n                        Video Stats\n                      </button>\n                    </Center>\n                  </Column>\n                </Row>\n              </Column>\n            </Row>\n          </Padding>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default ScreenCaptureApp;\n","import { useCallback, useEffect, useRef } from \"react\";\n\n// TODO: Document\nexport default function useGetIsUnmounting() {\n  const refIsUnmounting = useRef(false);\n\n  useEffect(() => {\n    return function unmount() {\n      refIsUnmounting.current = true;\n    };\n  }, []);\n\n  const getIsUnmounting = useCallback(() => refIsUnmounting.current, []);\n\n  return getIsUnmounting;\n}\n","import ScreenCaptureApp, { REGISTRATION_ID } from \"./ScreenCaptureApp\";\n\nexport default ScreenCaptureApp;\nexport { REGISTRATION_ID };\n","import InputMediaDevicesService from \"@services/InputMediaDevicesService\";\n\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Padding from \"@components/Padding\";\nimport AppLinkButton from \"@components/AppLinkButton\";\nimport InputMediaDevicesSelector from \"@components/InputMediaDevicesSelector\";\n\nimport { REGISTRATION_ID as VU_METER_REGISTRATION_ID } from \"../VUMeterApp\";\nimport { REGISTRATION_ID as SCREEN_CAPTURE_REGISTRATION_ID } from \"../ScreenCaptureApp\";\n\nexport const REGISTRATION_ID = \"input-media-devices\";\n\nconst InputMediaDevicesApp = {\n  id: REGISTRATION_ID,\n  title: \"Input Media Devices\",\n  style: {\n    width: 640,\n    height: 380,\n  },\n  serviceClasses: [InputMediaDevicesService],\n  view: function View({ appServices }) {\n    const mds = appServices[InputMediaDevicesService];\n\n    return (\n      <Padding>\n        <Layout>\n          <Content>\n            <InputMediaDevicesSelector />\n          </Content>\n          <Footer>\n            <button\n              onClick={() => mds.fetchInputMediaDevices(true)}\n              style={{ float: \"right\" }}\n            >\n              Refetch\n            </button>\n\n            <span className=\"button-group\">\n              <AppLinkButton id={VU_METER_REGISTRATION_ID} />\n              <AppLinkButton id={SCREEN_CAPTURE_REGISTRATION_ID} />\n            </span>\n          </Footer>\n        </Layout>\n      </Padding>\n    );\n  },\n};\n\nexport default InputMediaDevicesApp;\n","import InputMediaDevicesApp, { REGISTRATION_ID } from \"./InputMediaDevicesApp\";\n\nexport default InputMediaDevicesApp;\nexport { REGISTRATION_ID };\n","/**\n * String renderings for orders of magnitude of data.\n *\n * Using decimal bbreviations as specified in:\n * @see https://en.wikipedia.org/wiki/Megabyte\n *\n * Adapted from:\n * @see https://gist.github.com/lanqy/5193417\n *\n * @param {number} bytes\n * @return {string}\n */\nconst bytesToSize = bytes => {\n  const sizes = [\"bytes\", \"kB\", \"MB\", \"GB\", \"TB\"];\n  if (bytes === 0) return `0 ${sizes[0]}`;\n  const i = parseInt(\n    Math.floor(Math.log(Math.abs(bytes)) / Math.log(1024)),\n    10\n  );\n  if (i === 0) return `${bytes} ${sizes[i]}`;\n  return `${(bytes / 1024 ** i).toFixed(1)} ${sizes[i]}`;\n};\n\nexport default bytesToSize;\n","import MemoryInfoApp from \"./MemoryInfoApp\";\n\nexport default MemoryInfoApp;\n","import { useCallback, useEffect, useState } from \"react\";\nimport Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\n\nimport bytesToSize from \"@utils/bytesToSize\";\n\nconst MemoryInfoApp = {\n  id: \"memory-info\",\n  title: \"Memory Info\",\n  style: {\n    width: 280,\n    height: 150,\n  },\n  view: function View() {\n    const [\n      { jsHeapSizeLimit, totalJSHeapSize, usedJSHeapSize },\n      _setMemoryInfo,\n    ] = useState({\n      jsHeapSizeLimit: \"N/A\",\n      totalJSHeapSize: \"N/A\",\n      usedJSHeapSize: \"N/A\",\n    });\n\n    // TODO: Document\n    const fetchMemoryInfo = useCallback(() => {\n      if (!window.performance.memory) {\n        return;\n      }\n\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Performance/memory\n      const { jsHeapSizeLimit, totalJSHeapSize, usedJSHeapSize } =\n        window.performance.memory;\n\n      const memoryInfo = {\n        jsHeapSizeLimit: bytesToSize(jsHeapSizeLimit),\n        totalJSHeapSize: bytesToSize(totalJSHeapSize),\n        usedJSHeapSize: bytesToSize(usedJSHeapSize),\n      };\n\n      _setMemoryInfo(memoryInfo);\n\n      return memoryInfo;\n    }, []);\n\n    // Automatically refresh heap\n    useEffect(() => {\n      const initialFetch = fetchMemoryInfo();\n\n      if (initialFetch) {\n        const refetchInterval = setInterval(() => {\n          fetchMemoryInfo();\n        }, 1000);\n\n        return function unmount() {\n          clearInterval(refetchInterval);\n        };\n      }\n    }, [fetchMemoryInfo]);\n\n    // TODO: Incorporate graphing library\n\n    return (\n      <Layout style={{ backgroundColor: \"#424242\", color: \"#999\" }}>\n        <Content>\n          <Center>\n            <table style={{ display: \"inline-block\" }}>\n              <thead>\n                <tr>\n                  <td>Heap Size Limit</td>\n                  <td>Total Heap Size</td>\n                  <td>Used Heap Size</td>\n                </tr>\n              </thead>\n\n              <tbody>\n                <tr>\n                  {\n                    // TODO: Render as formatted strings (i.e. \"... GB\")\n                  }\n                  <td>{jsHeapSizeLimit}</td>\n                  <td>{totalJSHeapSize}</td>\n                  <td>{usedJSHeapSize}</td>\n                </tr>\n              </tbody>\n            </table>\n          </Center>\n        </Content>\n        <Footer style={{ fontSize: \".8rem\" }}>\n          <a\n            href=\"https://developer.mozilla.org/en-US/docs/Web/API/Performance/memory\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            style={{ float: \"left\" }}\n          >\n            MDN Documentation\n          </a>\n          <span style={{ float: \"right\" }}>\n            Only supported in Chromium-based browsers.\n          </span>\n        </Footer>\n      </Layout>\n    );\n  },\n};\n\nexport default MemoryInfoApp;\n","import LocalStorageItems from \"./LocalStorageItems\";\n\nexport default LocalStorageItems;\n","import Layout, { Content, Footer } from \"@components/Layout\";\nimport Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\n\nexport default function LocalStorageItems({\n  keyStorageEngineMaps = [],\n  onGetValue,\n  onEmpty,\n  onNewItem,\n}) {\n  if (!keyStorageEngineMaps.length) {\n    return (\n      <Center>\n        <Padding>\n          <Padding style={{ fontWeight: \"bold\" }}>No Key Vault items.</Padding>\n          <Padding className=\"note\">\n            These may be automatically managed by other applications as needed,\n            in order to perform key / value pair storage operations.\n          </Padding>\n          <Padding className=\"note\">\n            You have the ability to clear all local / session storage via this\n            utility.\n          </Padding>\n          <Padding>\n            <button onClick={onNewItem}>Add new item...</button>\n          </Padding>\n        </Padding>\n      </Center>\n    );\n  }\n\n  return (\n    <Layout>\n      <Content>\n        <Padding style={{ overflowY: \"auto\" }}>\n          <table style={{ width: \"100%\" }}>\n            <thead>\n              <tr>\n                <td></td>\n                <td>Key</td>\n                <td>Value</td>\n                {/*\n                    <td>Kind</td>\n                    */}\n                <td>Encryption</td>\n                <td>Storage Engine</td>\n              </tr>\n            </thead>\n            <tbody>\n              {keyStorageEngineMaps.map((keyMap, idx) => {\n                const { key, /* kind, */ storageEngine } = keyMap;\n\n                return (\n                  <tr key={idx}>\n                    <td className=\"center\">\n                      <input type=\"checkbox\"></input>\n                    </td>\n                    <td>{key}</td>\n                    <td className=\"center\">\n                      <button onClick={() => onGetValue(key, storageEngine)}>\n                        Get\n                      </button>\n                    </td>\n                    {/*\n                        <td className=\"center\">{kind}</td>\n                        */}\n\n                    <td className=\"center\">\n                      {storageEngine.getEncryptionType() || \"Not Encrypted\"}\n                    </td>\n                    <td className=\"center\">{storageEngine.getTitle()}</td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </Padding>\n      </Content>\n      <Footer>\n        <Padding>\n          <button onClick={onEmpty}>Empty</button>\n        </Padding>\n      </Footer>\n    </Layout>\n  );\n}\n","/**\n * @param {HTMLFormElement} formElement\n * @return {Object}\n */\nexport default function getFormValues(formElement) {\n  const elements = formElement.elements;\n\n  const values = {};\n\n  for (const el of [...elements]) {\n    const key = el.name || el.id;\n\n    if (key) {\n      values[key] = el.value;\n    }\n  }\n\n  return values;\n}\n","import Form from \"./Form\";\n\nexport default Form;\n","import useFormController from \"./hooks/useFormController\";\n\n// TODO: Document and add prop-types\nexport default function Form({\n  children,\n  autoComplete = \"off\",\n  validator = formValues => null,\n  onChange = formValues => null,\n  onSubmit = formValues => null,\n  ...rest\n}) {\n  const {\n    setFormRef,\n    handleFormChange,\n    handleFormSubmit,\n    handleFormValidate,\n    errors,\n    isValid,\n  } = useFormController({\n    onSubmit,\n    onChange,\n    validator,\n  });\n\n  return (\n    <form\n      {...rest}\n      ref={setFormRef}\n      autoComplete={autoComplete}\n      onChange={handleFormChange}\n      onSubmit={handleFormSubmit}\n    >\n      {\n        // TODO: Modify so that non-functional children presents an error showing how to use.  Look for other examples for how other libraries do this and adapt accordingly.\n        children({\n          errors,\n          isValid,\n          submit: handleFormSubmit,\n          validate: handleFormValidate,\n        })\n      }\n    </form>\n  );\n}\n","import { useCallback, useEffect, useState } from \"react\";\n\nimport getFormValues from \"@utils/getFormValues\";\n\n// TODO: Track dirty state\n\n// TODO: Document\n// NOTE: This is supposed to be a simpler alternative to: https://react-hook-form.com/\n// Was struggling to make it easily work with onChange events in a clean way\nexport default function useFormController({\n  onSubmit,\n  onChange = () => null,\n  validator = () => null,\n}) {\n  const [formElement, setFormRef] = useState(null);\n\n  // Perform initial checks to help ensure field values can be obtained and\n  // that the form will not submit when the user doesn't expect it to\n  useEffect(() => {\n    if (formElement) {\n      // Ensure form values can be detected\n      if (!Object.values(getFormValues(formElement)).length) {\n        console.warn(\n          \"No form values detected for form element.  All input fields should have a name or id attribute.\",\n          formElement\n        );\n      }\n\n      // Ensure button elements have a type attribute\n      for (const el of formElement.elements) {\n        if (el.tagName.toUpperCase() === \"BUTTON\" && !el.getAttribute(\"type\")) {\n          console.warn(\n            `All button elements should have a type attribute specified or they will default to \"submit\"`,\n            el\n          );\n          break;\n        }\n      }\n    }\n  }, [formElement]);\n\n  const [isValid, setIsValid] = useState(false);\n  const [errors, setErrors] = useState({});\n\n  // TODO: Document\n  const handleFormValidate = useCallback(\n    formValues => {\n      let hasErrors = false;\n\n      const errors = Object.fromEntries(\n        Object.entries(validator(formValues) || {}).filter(predicate => {\n          const isError = Boolean(predicate[1]);\n\n          if (isError) {\n            hasErrors = true;\n          }\n\n          return isError;\n        })\n      );\n\n      const isValid = !hasErrors;\n      setIsValid(isValid);\n      setErrors(errors);\n      return isValid;\n    },\n    [validator]\n  );\n\n  // TODO: Document\n  const handleFormChange = useCallback(\n    evt => {\n      const formValues = getFormValues(formElement);\n      handleFormValidate(formValues);\n\n      onChange(formValues);\n    },\n    [handleFormValidate, formElement, onChange]\n  );\n\n  // TODO: Document\n  const handleFormSubmit = useCallback(\n    evt => {\n      evt.preventDefault();\n\n      const formValues = getFormValues(formElement);\n      const isValid = handleFormValidate(formValues);\n\n      if (isValid) {\n        onSubmit(formValues);\n      }\n    },\n    [handleFormValidate, formElement, onSubmit]\n  );\n\n  return {\n    isValid,\n    handleFormValidate,\n    handleFormChange,\n    handleFormSubmit,\n    errors,\n    setFormRef,\n  };\n}\n","import Center from \"@components/Center\";\nimport Padding from \"@components/Padding\";\nimport Form from \"@components/Form\";\n\nexport default function KeyEditorForm({\n  initialKey,\n  initialValue,\n  initialStorageEngine,\n  storageEngines,\n  onSubmit,\n}) {\n  return (\n    <Center canOverflow={true}>\n      <Form\n        onSubmit={onSubmit}\n        validator={formValues => {\n          return {\n            // TODO: Refactor into KeyEditorForm\n            key:\n              formValues.key.length < 1 &&\n              \"Key must contain at least one character\",\n          };\n        }}\n      >\n        {({ errors, isValid }) => (\n          <>\n            <Padding>\n              <input\n                name=\"key\"\n                type=\"text\"\n                placeholder=\"Key\"\n                defaultValue={initialKey}\n                required\n              />\n            </Padding>\n\n            {errors?.key && (\n              <div className=\"note\" style={{ color: \"red\" }}>\n                {errors.key}\n              </div>\n            )}\n\n            <Padding>\n              <textarea\n                name=\"value\"\n                placeholder=\"Value\"\n                defaultValue={initialValue}\n              ></textarea>\n            </Padding>\n\n            <Padding style={{ marginTop: 20, textAlign: \"left\" }}>\n              <label>Storage Engine</label>\n              <select\n                name=\"storageEngineShortUUID\"\n                defaultValue={initialStorageEngine?.getShortUUID()}\n                required\n              >\n                {storageEngines.map(storageEngine => {\n                  const title = storageEngine.getTitle();\n                  const shortUUID = storageEngine.getShortUUID();\n\n                  return (\n                    <option key={title} value={shortUUID}>\n                      {title}\n                    </option>\n                  );\n                })}\n              </select>\n            </Padding>\n\n            <div>\n              <input type=\"submit\" value=\"Submit\" disabled={!isValid} />\n            </div>\n          </>\n        )}\n      </Form>\n    </Center>\n  );\n}\n","\nimport DynamicIcon from './DynamicIcon';\n\nexport default DynamicIcon;\n","import React from 'react';\nimport './style.css';\n\n/**\n * Dynamically generated ReactComponent.\n */ \nconst DynamicIcon = ({ className, ...propsRest }) => {\n  return (\n    <i\n      {...propsRest}\n      className={`id0d6dd5d02e64b979154a770ab790dba-icon${className ? ` ${className}` : ''}`}\n    />\n  );\n};\n\nexport default DynamicIcon;\n","// TODO: Implement ability to see how much storage is used\n\n// TODO: Use for local user profiles\n// TODO: Use for optional backend for notes, etc. (anything which can save a file of a reasonably small size)\n\n// TODO: Implement ability to export / import local storage data\n\nimport { useCallback, useEffect, useState } from \"react\";\n\nimport Padding from \"@components/Padding\";\nimport Layout, { Header, Content } from \"@components/Layout\";\nimport LocalStorageItems from \"./views/LocalStorageItems\";\nimport KeyEditorForm from \"./views/KeyEditorForm\";\n\nimport BackArrowIcon from \"@icons/BackArrowIcon\";\n\nimport KeyVaultService from \"@services/KeyVaultService\";\n\nconst KeyVaultApp = {\n  id: \"key-vault\",\n  title: \"Key Vault\",\n  style: {\n    width: 640,\n    height: 480,\n  },\n  serviceClasses: [KeyVaultService],\n  view: function View({ appServices }) {\n    const localDataPersistenceService = appServices[KeyVaultService];\n\n    const [keyStorageEngineMaps, setKeyStorageEngineMaps] = useState([]);\n\n    // TODO: Refactor so this automatically updates if other applications set state\n    const handleFetchKeyStorageEngineMaps = useCallback(async () => {\n      const keyMaps =\n        await localDataPersistenceService.fetchKeyStorageEngineMaps();\n\n      const keyStorageEngineMaps = [];\n\n      for (const keyMap of keyMaps) {\n        const key = keyMap[0];\n        const storageEngine = keyMap[1];\n        const value = await storageEngine.fetchItem(key);\n\n        // TODO: Move this detection into the service (consider automatically\n        // coercing primitive types:\n        // @see https://developer.mozilla.org/en-US/docs/Glossary/Primitive\n        // const kind = typeof value;\n\n        keyStorageEngineMaps.push({\n          key,\n          storageEngine,\n          value,\n          // kind,\n        });\n      }\n\n      setKeyStorageEngineMaps(keyStorageEngineMaps);\n    }, [localDataPersistenceService]);\n\n    const [isCreatingNewKey, setIsCreatingNewKey] = useState(false);\n\n    // Auto-fetch\n    useEffect(() => {\n      handleFetchKeyStorageEngineMaps();\n    }, [handleFetchKeyStorageEngineMaps]);\n\n    const handleGetValue = useCallback(async (key, storageEngine) => {\n      const value = await storageEngine.fetchItem(key);\n\n      // TODO: Implement\n\n      // TODO: Remove\n      console.log({ key, value });\n\n      // TODO: Remove\n      alert(\"TODO: Implement get value\");\n    }, []);\n\n    // TODO: Document\n    const handleKeyValueSubmit = useCallback(\n      formValues => {\n        const storageEngine =\n          localDataPersistenceService.getStorageEngineWithShortUUID(\n            formValues[\"storageEngineShortUUID\"]\n          );\n\n        storageEngine\n          .setItem(formValues[\"key\"], formValues[\"value\"])\n          .then(() => {\n            handleFetchKeyStorageEngineMaps();\n\n            setIsCreatingNewKey(false);\n          });\n      },\n      [localDataPersistenceService, handleFetchKeyStorageEngineMaps]\n    );\n\n    // TODO: Document\n    const handleEmpty = useCallback(() => {\n      // TODO: Replace window.confirm w/ an async prompt\n      if (window.confirm(\"Are you sure you wish to empty the Key Vault?\")) {\n        localDataPersistenceService\n          .clearAllStorageEngines()\n          .then(handleFetchKeyStorageEngineMaps);\n      }\n    }, [localDataPersistenceService, handleFetchKeyStorageEngineMaps]);\n\n    return (\n      <Layout>\n        <Header>\n          <Padding>\n            {/*\n              <button>Session Storage</button>\n            <button>IndexedDB</button>\n            <button>Key Vault</button>\n            <button>Memory</button>\n              */}\n            <button onClick={() => setIsCreatingNewKey(prev => !prev)}>\n              {!isCreatingNewKey ? (\n                <>(+) New Item</>\n              ) : (\n                <>\n                  <BackArrowIcon /> Back\n                </>\n              )}\n            </button>\n          </Padding>\n        </Header>\n        <Content>\n          {!isCreatingNewKey ? (\n            <LocalStorageItems\n              keyStorageEngineMaps={keyStorageEngineMaps}\n              onGetValue={handleGetValue}\n              onEmpty={handleEmpty}\n              // TODO: Move to callback\n              onNewItem={() => setIsCreatingNewKey(true)}\n            />\n          ) : (\n            <KeyEditorForm\n              storageEngines={localDataPersistenceService.getStorageEngines()}\n              onSubmit={handleKeyValueSubmit}\n            />\n          )}\n        </Content>\n      </Layout>\n    );\n  },\n};\n\nexport default KeyVaultApp;\n","import KeyVaultApp from \"./KeyVaultApp\";\n\nexport default KeyVaultApp;\n","import ReShellOrg from \"./ReShell.org\";\n\nexport default ReShellOrg;\n","import Desktop from \"@components/Desktop\";\n\nimport ApplicationsApp from \"./apps/ApplicationsApp\";\nimport ApplicationMonitorApp from \"../ExamplePortal/apps/ApplicationMonitorApp\";\nimport AboutReShellApp from \"./apps/AboutReShellApp\";\nimport CheckForUpdatesApp from \"../ExamplePortal/apps/CheckForUpdatesApp\";\nimport ColorAdjusterApp from \"../ExamplePortal/apps/ColorAdjusterApp\";\nimport EnvironmentApp from \"../ExamplePortal/apps/EnvironmentApp\";\nimport ServiceMonitorApp from \"../ExamplePortal/apps/ServiceMonitorApp\";\nimport SoftwareInfoApp from \"../ExamplePortal/apps/SoftwareInfoApp\";\nimport InputMediaDevicesApp from \"../ExamplePortal/apps/InputMediaDevicesApp\";\nimport ScreenCaptureApp from \"../ExamplePortal/apps/ScreenCaptureApp\";\nimport VUMeterApp from \"../ExamplePortal/apps/VUMeterApp\";\nimport MemoryInfoApp from \"../ExamplePortal/apps/MemoryInfoApp\";\nimport KeyVaultApp from \"../ExamplePortal/apps/KeyVaultApp\";\n\n// import WindowAPIDiscovererWindow from \"./apps/WindowAPIDiscovererWindow\";\n\n// import InputMediaDevicesSelectorView from \"./views/InputMediaDevicesSelectorView\";\n\nexport default function ReShellOrgPortal() {\n  return (\n    <Desktop\n      appDescriptors={[\n        ApplicationsApp,\n        ApplicationMonitorApp,\n        AboutReShellApp,\n        CheckForUpdatesApp,\n        ColorAdjusterApp,\n        EnvironmentApp,\n        InputMediaDevicesApp,\n        MemoryInfoApp,\n        ScreenCaptureApp,\n        ServiceMonitorApp,\n        SoftwareInfoApp,\n        VUMeterApp,\n        KeyVaultApp,\n      ]}\n    />\n  );\n}\n"],"sourceRoot":""}